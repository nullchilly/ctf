import socket
import string

known_part_of_the_key = "Flag{yjEYMHy4yh6V9TZOc0jz7NAoxgq5jMo3gc}"

def Checker(s, bs):
    global known_part_of_the_key
    strings = string.ascii_letters + string.digits + "%/+=:}"
    # strings = [chr(i) for i in range(128)]
    # print(strings)
    while True:
        for ch in strings:
            s.send((known_part_of_the_key + ch).encode())
            resp = s.recv(2048)
            if len(resp) == bs:
                print(known_part_of_the_key)
                known_part_of_the_key = known_part_of_the_key + ch

host = "112.137.129.250"
port = 9999
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((host, port))
banner = sock.recv(1024) # Receive the banner
print(banner.decode())
sock.send(known_part_of_the_key.encode())
resp = sock.recv(2048)
base_size = len(resp)
Checker(sock, base_size)
