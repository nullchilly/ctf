<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-ippm-rfc8889bis-04" indexInclude="true" ipr="trust200902" number="9342" obsoletes="8889" prepTime="2022-12-14T13:20:23" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-ippm-rfc8889bis-04" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9342" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="Clustered Alternate-Marking Method">Clustered Alternate-Marking Method</title>
    <seriesInfo name="RFC" value="9342" stream="IETF"/>
    <author role="editor" fullname="Giuseppe Fioccola" initials="G." surname="Fioccola">
      <organization showOnFrontPage="true">Huawei Technologies</organization>
      <address>
        <postal>
          <street>Riesstrasse, 25</street>
          <city>Munich</city>
          <code>80992</code>
          <country>Germany</country>
        </postal>
        <email>giuseppe.fioccola@huawei.com</email>
      </address>
    </author>
    <author fullname="Mauro Cociglio" initials="M." surname="Cociglio">
      <organization showOnFrontPage="true">Telecom Italia</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country/>
        </postal>
        <email>mauro.cociglio@outlook.com</email>
      </address>
    </author>
    <author fullname="Amedeo Sapio" initials="A." surname="Sapio">
      <organization showOnFrontPage="true">Intel Corporation</organization>
      <address>
        <postal>
          <street>4750 Patrick Henry Dr.</street>
          <city>Santa Clara</city>
          <region>CA</region>
          <code>95054</code>
          <country>United States of America</country>
        </postal>
        <email>amedeo.sapio@intel.com</email>
      </address>
    </author>
    <author fullname="Riccardo Sisto" initials="R." surname="Sisto">
      <organization showOnFrontPage="true">Politecnico di Torino</organization>
      <address>
        <postal>
          <street>Corso Duca degli Abruzzi, 24</street>
          <city>Torino</city>
          <code>10129</code>
          <country>Italy</country>
        </postal>
        <email>riccardo.sisto@polito.it</email>
      </address>
    </author>
    <author fullname="Tianran Zhou" initials="T." surname="Zhou">
      <organization showOnFrontPage="true">Huawei Technologies</organization>
      <address>
        <postal>
          <street>156 Beiqing Rd.</street>
          <city>Beijing</city>
          <code>100095</code>
          <region/>
          <country>China</country>
        </postal>
        <email>zhoutianran@huawei.com</email>
      </address>
    </author>
    <date month="12" year="2022"/>
    <area>tsv</area>
    <workgroup>ippm</workgroup>
    <keyword>Multipoint</keyword>
    <keyword>Cluster</keyword>
    <keyword>Performance</keyword>
    <keyword>Measurement</keyword>
    <keyword>Monitoring</keyword>
    <keyword>Passive</keyword>
    <keyword>Hybrid</keyword>
    <keyword>Loss</keyword>
    <keyword>Delay</keyword>
    <keyword>Delay Variation</keyword>
    <keyword>Hashing</keyword>
    <keyword>Closed-Loop</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">This document generalizes and expands the Alternate-Marking methodology to measure 
	    any kind of unicast flow whose packets can follow several different paths in the
		network; this can result in a multipoint-to-multipoint network. 
		The network clustering approach is presented and, for this reason, 
		the technique described here is called "Clustered Alternate Marking".
		This document obsoletes RFC 8889.</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9342" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-summary-of-changes-from-rfc">Summary of Changes from RFC 8889</xref></t>
              </li>
              <li pn="section-toc.1-1.1.2.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.2.1"><xref derivedContent="1.2" format="counter" sectionFormat="of" target="section-1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-language">Requirements Language</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-terminology">Terminology</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2">
              <li pn="section-toc.1-1.2.2.1">
                <t indent="0" pn="section-toc.1-1.2.2.1.1"><xref derivedContent="2.1" format="counter" sectionFormat="of" target="section-2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-correlation-with-rfc-5644">Correlation with RFC 5644</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-flow-classification">Flow Classification</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extension-of-the-method-to-">Extension of the Method to Multipoint Flows</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-monitoring-network">Monitoring Network</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-network-packet-loss">Network Packet Loss</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-network-clustering">Network Clustering</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-algorithm-for-clusters-part">Algorithm for Clusters Partition</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-multipoint-packet-loss-meas">Multipoint Packet-Loss Measurement</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-multipoint-delay-and-delay-">Multipoint Delay and Delay Variation</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t indent="0" pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-delay-measurements-on-a-mul">Delay Measurements on a Multipoint-Paths Basis</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2.1.2">
                  <li pn="section-toc.1-1.7.2.1.2.1">
                    <t indent="0" pn="section-toc.1-1.7.2.1.2.1.1"><xref derivedContent="7.1.1" format="counter" sectionFormat="of" target="section-7.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-marking-measurement">Single-Marking Measurement</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.7.2.2">
                <t indent="0" pn="section-toc.1-1.7.2.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-delay-measurements-on-a-sin">Delay Measurements on a Single-Packet Basis</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2.2.2">
                  <li pn="section-toc.1-1.7.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.7.2.2.2.1.1"><xref derivedContent="7.2.1" format="counter" sectionFormat="of" target="section-7.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-and-double-marking-m">Single- and Double-Marking Measurement</xref></t>
                  </li>
                  <li pn="section-toc.1-1.7.2.2.2.2">
                    <t indent="0" pn="section-toc.1-1.7.2.2.2.2.1"><xref derivedContent="7.2.2" format="counter" sectionFormat="of" target="section-7.2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-hashing-selection-method">Hashing Selection Method</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-synchronization-and-timing">Synchronization and Timing</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-recommendations-for-deploym">Recommendations for Deployment</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-a-closed-loop-performance-m">A Closed-Loop Performance-Management Approach</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="12" format="counter" sectionFormat="of" target="section-12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="13" format="counter" sectionFormat="of" target="section-13"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.2">
              <li pn="section-toc.1-1.13.2.1">
                <t indent="0" pn="section-toc.1-1.13.2.1.1"><xref derivedContent="13.1" format="counter" sectionFormat="of" target="section-13.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.2">
                <t indent="0" pn="section-toc.1-1.13.2.2.1"><xref derivedContent="13.2" format="counter" sectionFormat="of" target="section-13.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.14">
            <t indent="0" pn="section-toc.1-1.14.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-of-monitoring-netwo">Example of Monitoring Network and Clusters Partition</xref></t>
          </li>
          <li pn="section-toc.1-1.15">
            <t indent="0" pn="section-toc.1-1.15.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.16">
            <t indent="0" pn="section-toc.1-1.16.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.c"/><xref derivedContent="" format="title" sectionFormat="of" target="name-contributors">Contributors</xref></t>
          </li>
          <li pn="section-toc.1-1.17">
            <t indent="0" pn="section-toc.1-1.17.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.d"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">The Alternate-Marking Method, as described in <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>, 
	  is applicable to a point-to-point path. The extension proposed in this document applies to the most general case 
      of a multipoint-to-multipoint path and enables flexible and adaptive performance measurements in a managed network.</t>
      <t indent="0" pn="section-1-2">The Alternate-Marking methodology consists of splitting the packet flow into marking blocks, and 
	  the monitoring parameters are the packet counters and the timestamps for each marking period.
	  In some applications of the Alternate-Marking Method, a lot of flows and nodes are to be monitored. 
	  Multipoint Alternate Marking aims to reduce these values and makes the performance monitoring more 
	  flexible in case a detailed analysis is not needed.
      For instance, by considering n measurement points and m monitored flows, the order of magnitude 
	  of the packet counters for each time interval is n*m*2 (1 per color).
      The number of measurement points and monitored flows may vary and depends on the portion of the network
      we are monitoring (core network, metro network, access network, etc.) and the granularity 
      (for each service, each customer, etc.). So if both n and m are high values, the packet counters 
      increase a lot, and Multipoint Alternate Marking offers a tool to control these parameters.</t>
      <t indent="0" pn="section-1-3">The approach presented in this document is applied only to unicast flows and not to multicast.
      Broadcast, Unknown Unicast, and Multicast (BUM) traffic is not considered here, 
	  because traffic replication is not covered by the Multipoint Alternate-Marking Method. 
	  Furthermore, it can be applicable to anycast flows, and Equal-Cost Multipath (ECMP)
      paths can also be easily monitored with this technique.</t>
      <t indent="0" pn="section-1-4"><xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/> applies to point-to-point unicast flows and BUM traffic.
	  For BUM traffic, the basic method of <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/> can be easily 
	  applied link by link; therefore, the multicast flow tree distribution can be split into separate unicast point-to-point links.</t>
      <t indent="0" pn="section-1-5">This document and its Clustered Alternate-Marking Method applies to multipoint-to-multipoint 
      unicast flows, anycast, and ECMP flows. Therefore, the Alternate-Marking Method can be extended to any kind of
      multipoint-to-multipoint paths, and the network-clustering approach presented in this document
	  is the formalization of how to implement this property and allow a flexible and 
	  optimized performance measurement support for network management in every situation.</t>
      <t indent="0" pn="section-1-6">Without network clustering, it is possible to apply Alternate Marking only for all 
      the network or per single flow. Instead, with network clustering, it is possible to partition 
      the network into clusters at different levels in order to provide the needed degree of detail.
	  In some circumstances, it is possible to monitor a multipoint network by monitoring the network clusters,
	  without examining in depth.  In case of problems (packet loss is measured or the delay is too high), 
	  the filtering criteria could be enhanced in order to perform a detailed analysis by using a different	
 	  combination of clusters up to a per-flow measurement as described in <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.</t>
      <t indent="0" pn="section-1-7">This approach fits very well with the Closed-Loop Network and Software-Defined Network (SDN) paradigm, 
      where the SDN orchestrator and the SDN controllers are the brains of the network and can manage flow control 
      to the switches and routers and, in the same way, can calibrate the performance measurements
      depending on the desired accuracy. An SDN controller application can orchestrate how accurately the network
      performance monitoring is set up by applying the Multipoint Alternate Marking as described in this document.</t>
      <t indent="0" pn="section-1-8">It is important to underline that, as an extension of <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>, 
	  this is a methodology document, so the mechanism that can be used to transmit the counters and the timestamps is out of scope here.</t>
      <t indent="0" pn="section-1-9">This document assumes that the blocks are created according to a fixed timer as per <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.
	  Switching after a fixed number of packets is possible, but it is out of scope here.</t>
      <t indent="0" pn="section-1-10">Note that the fragmented packets' case can be managed with the Alternate-Marking methodology, and the same guidance provided in
	  <xref target="RFC9341" sectionFormat="of" section="6" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9341#section-6" derivedContent="RFC9341"/> also applies in the case of Multipoint Alternate Marking.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-1.1">
        <name slugifiedName="name-summary-of-changes-from-rfc">Summary of Changes from RFC 8889</name>
        <t indent="0" pn="section-1.1-1">This document defines the Multipoint Alternate-Marking Method, addressing
	  ambiguities and overtaking its experimental phase in the original specification 
	  <xref target="RFC8889" format="default" sectionFormat="of" derivedContent="RFC8889"/>.</t>
        <t indent="0" pn="section-1.1-2">The relevant changes are:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-1.1-3">
          <li pn="section-1.1-3.1">Added the recommendations about the different deployments in case one or two flag bits 
		are available for marking (<xref target="finding" format="default" sectionFormat="of" derivedContent="Section 9"/>).</li>
          <li pn="section-1.1-3.2">Changed the structure to improve readability.</li>
          <li pn="section-1.1-3.3">Removed the wording about the experimentation of the method and considerations that no longer apply.</li>
          <li pn="section-1.1-3.4">Revised the description of detailed aspects of the methodology, e.g., synchronization and timing.</li>
        </ul>
        <t indent="0" pn="section-1.1-4">It is important to note that all the changes are totally backward compatible with <xref target="RFC8889" format="default" sectionFormat="of" derivedContent="RFC8889"/>, 
	  and no new additional technique has been introduced in this document compared to <xref target="RFC8889" format="default" sectionFormat="of" derivedContent="RFC8889"/>.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-1.2">
        <name slugifiedName="name-requirements-language">Requirements Language</name>
        <t indent="0" pn="section-1.2-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      </section>
    </section>
    <section anchor="terms" numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-terminology">Terminology</name>
      <t indent="0" pn="section-2-1">The use of the basic terms are identical to those found in Alternate Marking <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.
      It is to be remembered that <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/> is valid for point-to-point unicast flows and BUM traffic.</t>
      <t indent="0" pn="section-2-2">The important new terms are explained below:</t>
      <dl indent="3" newline="false" spacing="normal" pn="section-2-3">
        <dt pn="section-2-3.1">Multipoint Alternate Marking:
        </dt>
        <dd pn="section-2-3.2">Extension to <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>, valid for
	multipoint-to-multipoint unicast flows, anycast, and ECMP flows. It
	can also be referred to as "Clustered Alternate Marking".
	</dd>
        <dt pn="section-2-3.3">Flow definition:
        </dt>
        <dd pn="section-2-3.4">The concept of flow is generalized in this document. The
	identification fields are selected without any constraints and, in
	general, the flow can be a multipoint-to-multipoint flow, as a result
	of aggregate point-to-point flows.
	</dd>
        <dt pn="section-2-3.5">Monitoring network:
        </dt>
        <dd pn="section-2-3.6">Identified with the nodes of the network that are the measurement
	points (MPs) and the links that are the connections between MPs. The
	monitoring network graph depends on the flow definition, so it can
	represent a specific flow or the entire network topology as aggregate
	of all the flows. Each node of the monitoring network cannot be both a
	source and a destination of the flow.
	</dd>
        <dt pn="section-2-3.7">Cluster: 
        </dt>
        <dd pn="section-2-3.8">Smallest identifiable non-trivial subnetwork of the entire
	monitoring network graph that still satisfies the condition that the
	number of packets that go in is the same as the number that go out.  A
	cluster partition algorithm, such as that found in <xref target="nclustering_algo" format="default" sectionFormat="of" derivedContent="Section 5.1"/>, can be applied to split
	the monitoring network into clusters.
	</dd>
        <dt pn="section-2-3.9">Multipoint metrics:
        </dt>
        <dd pn="section-2-3.10">Packet loss, delay, and delay variation are extended to the case
	of multipoint flows.  It is possible to compute these metrics on the
	basis of multipoint paths in order to associate the measurements to a
	cluster, a combination of clusters, or the entire monitored
	network. For delay and delay variation, it is also possible to define
	the metrics on a single-packet basis, and it means that the multipoint
	path is used to easily couple packets between input and output nodes
	of a multipoint path.
	</dd>
      </dl>
      <t indent="0" pn="section-2-4">The next section highlights the correlation with the terms used in <xref target="RFC5644" format="default" sectionFormat="of" derivedContent="RFC5644"/>.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1">
        <name slugifiedName="name-correlation-with-rfc-5644">Correlation with RFC 5644</name>
        <t indent="0" pn="section-2.1-1"><xref target="RFC5644" format="default" sectionFormat="of" derivedContent="RFC5644"/> is limited to active measurements
     using a single source packet or stream. Its scope is also limited to observations of corresponding packets along the
     path (spatial metric) and at one or more destinations (one-to-group) along the path.</t>
        <t indent="0" pn="section-2.1-2">Instead, the scope of this memo is to define multiparty metrics for passive and hybrid
	 measurements in a group-to-group topology with multiple sources and destinations.</t>
        <t indent="0" pn="section-2.1-3"><xref target="RFC5644" format="default" sectionFormat="of" derivedContent="RFC5644"/> introduces metric names that can be reused here
	 but have to be extended and rephrased to be applied to the Alternate-Marking schema:</t>
        <ol spacing="normal" type="a" indent="adaptive" start="1" pn="section-2.1-4">
	   <li pn="section-2.1-4.1" derivedCounter="a.">the multiparty metrics are not only one-to-group metrics but can also be group-to-group 
	 metrics;</li>
          <li pn="section-2.1-4.2" derivedCounter="b.">the spatial metrics, used for measuring the performance of segments of a source-to-destination path, 
	 are applied here to clusters.</li>
        </ol>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-flow-classification">Flow Classification</name>
      <t indent="0" pn="section-3-1">A unicast flow is identified by all the packets having a set of common characteristics.
	  This definition is inspired by <xref target="RFC7011" format="default" sectionFormat="of" derivedContent="RFC7011"/>.</t>
      <t indent="0" pn="section-3-2">As an example, by considering a flow as all the packets sharing the same 
	  source IP address or the same destination IP address, it is easy to understand
	  that the resulting pattern will not be a point-to-point connection
	  but a point-to-multipoint or multipoint-to-point connection.</t>
      <t indent="0" pn="section-3-3">In general, a flow can be defined by a set of selection rules used to match 
	  a subset of the packets processed by the network device. These rules
	  specify a set of Layer 3 and Layer 4 header fields (identification fields) 
	  and the relative values that must be found in matching packets.</t>
      <t indent="0" pn="section-3-4">The choice of the identification fields directly affects the type of
	  paths that the flow would follow in the network. In fact, it is
	  possible to relate a set of identification fields with the pattern
	  of the resulting graphs, as listed in <xref target="Flows" format="default" sectionFormat="of" derivedContent="Figure 1"/>.</t>
      <t indent="0" pn="section-3-5">A TCP 5-tuple usually identifies flows following either a single path 
	  or a point-to-point multipath (in the case of load balancing). On the contrary,
	  a single source address selects aggregate flows following a point-to-multipoint path, 
	  while a multipoint-to-point path can be the result of a matching on a single 
	  destination address. 
	  In the case where a selection rule and its reverse are used for bidirectional measurements, 
	  they can correspond to a point-to-multipoint path in one direction 
	  and a multipoint-to-point path in the opposite direction.</t>
      <t indent="0" pn="section-3-6">So the flows to be monitored are selected into the monitoring points 
	  using packet selection rules, which can also change the pattern of the monitored
	  network.</t>
      <t indent="0" pn="section-3-7">Note that, more generally, the flow can be defined at different levels based 
	  on the potential encapsulation, and additional conditions that are not in the packet header 
	  can also be included as part of matching criteria.</t>
      <t indent="0" pn="section-3-8">The Alternate-Marking Method is applicable only to a single path (and
	  partially to a one-to-one multipath), so the extension proposed in
	  this document is suitable also for the most general case of multipoint-to-multipoint, 
	  which embraces all the other patterns in <xref target="Flows" format="default" sectionFormat="of" derivedContent="Figure 1"/>.</t>
      <figure anchor="Flows" align="left" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-flow-classification-2">Flow Classification</name>
        <artwork name="" type="" align="left" alt="" pn="section-3-9.1">
       point-to-point single path  
           +------+      +------+      +------+
       ---&lt;&gt;  R1  &lt;&gt;----&lt;&gt;  R2  &lt;&gt;----&lt;&gt;  R3  &lt;&gt;---
           +------+      +------+      +------+


       point-to-point multipath
                        +------+
                       &lt;&gt;  R2  &lt;&gt;
                      / +------+ \
                     /            \
           +------+ /              \ +------+
       ---&lt;&gt;  R1  &lt;&gt;                &lt;&gt;  R4  &lt;&gt;---
           +------+ \              / +------+
                     \            /
                      \ +------+ /
                       &lt;&gt;  R3  &lt;&gt;
                        +------+


       point-to-multipoint
                                   +------+
                                  &lt;&gt;  R4  &lt;&gt;---
                                 / +------+
                       +------+ /
                      &lt;&gt;  R2  &lt;&gt;
                     / +------+ \
           +------+ /            \ +------+
       ---&lt;&gt;  R1  &lt;&gt;              &lt;&gt;  R5  &lt;&gt;---
           +------+ \              +------+
                     \ +------+
                      &lt;&gt;  R3  &lt;&gt;
                       +------+ \
                                 \ +------+
                                  &lt;&gt;  R6  &lt;&gt;---
                                   +------+


       multipoint-to-point
           +------+
       ---&lt;&gt;  R1  &lt;&gt;
           +------+ \
                     \ +------+
                     &lt;&gt;  R4  &lt;&gt;
                     / +------+ \
           +------+ /            \ +------+
       ---&lt;&gt;  R2  &lt;&gt;              &lt;&gt;  R6  &lt;&gt;---
           +------+              / +------+
                       +------+ /
                      &lt;&gt;  R5  &lt;&gt;
                     / +------+
           +------+ /
       ---&lt;&gt;  R3  &lt;&gt;
           +------+


       multipoint-to-multipoint
           +------+                +------+
       ---&lt;&gt;  R1  &lt;&gt;              &lt;&gt;  R6  &lt;&gt;---
           +------+ \            / +------+
                     \ +------+ /
                      &lt;&gt;  R4  &lt;&gt;
                       +------+ \
           +------+              \ +------+
       ---&lt;&gt;  R2  &lt;&gt;             &lt;&gt;  R7  &lt;&gt;---
           +------+ \            / +------+
                     \ +------+ /
                      &lt;&gt;  R5  &lt;&gt;
                     / +------+ \
           +------+ /            \ +------+
       ---&lt;&gt;  R3  &lt;&gt;              &lt;&gt;  R8  &lt;&gt;---
           +------+                +------+
</artwork>
      </figure>
      <t indent="0" pn="section-3-10">The case of unicast flow is considered in <xref target="Flows" format="default" sectionFormat="of" derivedContent="Figure 1"/>. 
	  The anycast flow is also covered, since it is only a special case of a unicast flow if routing is
	  stable throughout the measurement period.
	  Furthermore, an ECMP flow is in scope by definition, since it is a point-to-multipoint unicast flow.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-extension-of-the-method-to-">Extension of the Method to Multipoint Flows</name>
      <t indent="0" pn="section-4-1">By using the Alternate-Marking Method, only point-to-point paths can be monitored.  
	   To have an IP (TCP/UDP) flow that follows a point-to-point path, in general we have to define,
	   with a specific value, 5 identification fields (IP Source, IP Destination, Transport Protocol,	
 	   Source Port, and Destination Port).</t>
      <t indent="0" pn="section-4-2">Multipoint Alternate Marking enables the performance measurement for multipoint flows 
      selected by identification fields without any constraints (even the entire network production traffic).
	  It is also possible to use multiple marking points for the same monitored flow.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-monitoring-network">Monitoring Network</name>
        <t indent="0" pn="section-4.1-1">The monitoring network is deduced from the production network by identifying 
	    the nodes of the graph that are the measurement points and the links that are the 
	    connections between measurement points. It can be modeled as a set of nodes and
		a set of directed arcs that connect pairs of nodes.</t>
        <t indent="0" pn="section-4.1-2">There are some techniques that can help with the building of the monitoring network (as an example,
	    see <xref target="RFC9198" format="default" sectionFormat="of" derivedContent="RFC9198"/>). In general, there are different options:
        the monitoring network can be obtained by considering all the possible
        paths for the traffic or periodically checking the traffic (e.g., daily,
        weekly, and monthly) and updating the graph as appropriate, 
	    but this is up to the Network Management System (NMS) configuration.</t>
        <t indent="0" pn="section-4.1-3">So a graph model of the monitoring network can be built according to the Alternate-Marking 
	    Method, where the monitored interfaces and links are identified. Only the measurement points and links
	    where the traffic has flowed have to be represented in the graph.</t>
        <t indent="0" pn="section-4.1-4">A simple example of a monitoring network graph is shown in <xref target="Appendix" format="default" sectionFormat="of" derivedContent="Appendix A"/>.</t>
        <t indent="0" pn="section-4.1-5">Each monitoring point is characterized by the packet counter 
	    that refers only to a marking period of the monitored flow.
		Also, it is assumed that there is a monitoring point at all possible egress points 
		of the multipoint monitored network.</t>
        <t indent="0" pn="section-4.1-6">The same is also applicable for the delay, but it will be described 
	    in the following sections.</t>
        <t indent="0" pn="section-4.1-7">The rest of the document assumes that the traffic is going from left to right
		in order to simplify the explanation. But the analysis done for one direction applies 
		equally to all directions.</t>
      </section>
      <section anchor="Nploss" numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-network-packet-loss">Network Packet Loss</name>
        <t indent="0" pn="section-4.2-1">Since all the packets of the considered flow leaving the
	    network have previously entered the network, the number of
	    packets counted by all the input nodes is always greater than,
	    or equal to, the number of packets counted by all the output nodes. 
		It is assumed that routing is stable during the measurement period 
		while packet fragmentation must be handled as described in 
		<xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.</t>
        <t indent="0" pn="section-4.2-2">In the case of no packet loss occurring in the marking period, 
		if all the input and output points of the network domain to be monitored 
		are measurement points, the sum of the number of packets on all the 
	    ingress interfaces equals the number on egress interfaces for the 
	    monitored flow. In this circumstance, if no packet loss occurs, 
	    the intermediate measurement points only have the task of splitting 
	    the measurement.</t>
        <t indent="0" pn="section-4.2-3">It is possible to define the network packet loss of one monitored flow
	    for a single period. In a packet network, the number of lost packets is the 
	    number of packets counted by the input nodes minus the number of packets 
	    counted by the output nodes. This is true for every packet flow 
	    in each marking period.</t>
        <t indent="0" pn="section-4.2-4">The monitored network packet loss with n input nodes and m output nodes 
	    is given by:</t>
        <artwork align="left" pn="section-4.2-5">
PL = (PI1 + PI2 +...+ PIn) - (PO1 + PO2 +...+ POm)
</artwork>
        <t indent="0" pn="section-4.2-6">where:</t>
        <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-4.2-7">
          <li pn="section-4.2-7.1">PL is the network packet loss (number of lost packets);
	  </li>
          <li pn="section-4.2-7.2">PIi is the number of packets flowed through the i-th
	  	  input node in this period; and
		  </li>
          <li pn="section-4.2-7.3">POj is the number of packets flowed through the
		  	  j-th output node in this period.
			  </li>
        </ul>
        <t indent="0" pn="section-4.2-8">The equation is applied on a per-time-interval basis and a per-flow basis:</t>
        <ul empty="false" spacing="normal" bare="false" indent="3" pn="section-4.2-9">
          <li pn="section-4.2-9.1">The reference interval is the Alternate-Marking period, as defined
	     in <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.</li>
          <li pn="section-4.2-9.2">The flow definition is generalized here. Indeed, as described before, a multipoint packet flow 
	     is considered, and the identification fields can be selected without any constraints.</li>
        </ul>
      </section>
    </section>
    <section anchor="nclustering" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-network-clustering">Network Clustering</name>
      <t indent="0" pn="section-5-1">The previous equation of <xref target="Nploss" format="default" sectionFormat="of" derivedContent="Section 4.2"/> can determine the number of packets lost 
	  globally in the monitored network, exploiting only the data provided by the counters 
	  in the input and output nodes.</t>
      <t indent="0" pn="section-5-2">In addition, it is possible to leverage the data provided by the other counters 
	  in the network to converge on the smallest identifiable subnetworks where the losses occur.</t>
      <t indent="0" pn="section-5-3">As defined in <xref target="terms" format="default" sectionFormat="of" derivedContent="Section 2"/>, a cluster is a non-trivial subnetwork of the 
	  entire monitoring network graph that still satisfies the condition that the number of packets that
	  go in is the same as the number that go out, if no packet loss occurs.
	  According to this definition, a cluster should contain all the arcs emanating from its input nodes
	  and all the arcs terminating at its output nodes. This ensures that we can count all the packets 
	  (and only those) exiting an input node again at the output node, whatever path they follow.</t>
      <t indent="0" pn="section-5-4">As for the entire monitoring network graph, the cluster is defined on a per-flow basis.
	  In a completely monitored network (a network where every network interface is monitored), 
	  each network device corresponds to a cluster, and each physical link corresponds to two
	  clusters (one for each device).</t>
      <t indent="0" pn="section-5-5">Clusters can have different sizes depending on the flow-filtering criteria adopted.</t>
      <t indent="0" pn="section-5-6">Moreover, sometimes clusters can be optionally simplified. For example, when two monitored interfaces 
	  are divided by a single router (one is the input interface, the other is the output interface, 
	  and the router has only these two interfaces), instead of counting exactly twice, upon entering and leaving, 
	  it is possible to consider a single measurement point. In this case,
	  we do not care about the internal packet loss of the router.</t>
      <t indent="0" pn="section-5-7">It is worth highlighting that it might also be convenient to define clusters based on the topological 
	  information so that they are applicable to all the possible flows in the monitored network.</t>
      <t indent="0" pn="section-5-8">Note that, in case of translation or encapsulation, the cluster properties must also be invariant.</t>
      <section anchor="nclustering_algo" numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-algorithm-for-clusters-part">Algorithm for Clusters Partition</name>
        <t indent="0" pn="section-5.1-1">A simple algorithm can be applied in order to split the monitoring network into clusters. 
	  This can be done for each direction separately; indeed, a node cannot be both a source 
	  and a destination. The clusters partition is based on the monitoring network graph, 
	  which can be valid for a specific flow or can also be general and valid for the entire network topology.</t>
        <t indent="0" pn="section-5.1-2">It is a two-step algorithm:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5.1-3">
          <li pn="section-5.1-3.1">Group the links where there is the same starting node;</li>
          <li pn="section-5.1-3.2">Join the grouped links with at least one ending node in common.</li>
        </ul>
        <t indent="0" pn="section-5.1-4">Considering that the links are unidirectional, the first step
	  implies listing all the links as connections between two nodes and
	  grouping the different links if they have the same starting node. 
	  Note that it is possible to start from any link, and the procedure
	  will work. Following this classification, the second step implies 
	  eventually joining the groups classified in the first step by looking at the ending nodes. 
	  If different groups have at least one common ending node, they are put together and belong to the same set.
	  After the application of the two steps of the algorithm, each one of the composed sets of links, 
	  together with the endpoint nodes, constitutes a cluster.</t>
        <t indent="0" pn="section-5.1-5">A simple application of the clusters partition is shown in <xref target="Appendix" format="default" sectionFormat="of" derivedContent="Appendix A"/>.</t>
        <t indent="0" pn="section-5.1-6">The algorithm, as applied in the example of a point-to-multipoint network,
	  works for the more general case of a multipoint-to-multipoint network in the same way. 
	  It should be highlighted that for a multipoint-to-multipoint network, the multiple sources
	  <bcp14>MUST</bcp14> mark the traffic coherently and <bcp14>MUST</bcp14> be synchronized with all the other nodes 
	  according to the timing requirements detailed in <xref target="sync-timing" format="default" sectionFormat="of" derivedContent="Section 8"/>.</t>
        <t indent="0" pn="section-5.1-7">When the clusters partition is done, the calculation of packet loss, delay, and delay variation 
	  can be made on a cluster basis. 
	  Note that the packet counters for each marking period permit calculating the packet rate
	  on a cluster basis, so Committed Information Rate (CIR) and Excess Information Rate (EIR) 
	  could also be deduced on a cluster basis.</t>
        <t indent="0" pn="section-5.1-8">Obviously, by combining some clusters in a new connected subnetwork, the packet-loss rule is still true.
	  So it is also possible to consider combinations of clusters if and where it suits.</t>
        <t indent="0" pn="section-5.1-9">In this way, in a very large network, there is no need to configure detailed 
	  filter criteria to inspect the traffic. It is possible to check a multipoint network and, 
	  in case of problems, go deep with a step-by-step cluster analysis, 
	  but only for the cluster or combination of clusters where the problem happens.</t>
        <t indent="0" pn="section-5.1-10">In summary, once a flow is defined, the algorithm to build the clusters partition 
	  is based on topological information; therefore, it considers all the possible links and 
	  nodes that could potentially be crossed by the given flow, even if there is no traffic. 
	  So if the flow does not enter or traverse all the nodes, the counters have a non-zero
	  value for the involved nodes and a zero value for the other nodes without traffic; 
	  but in the end, all the formulas are still valid.</t>
        <t indent="0" pn="section-5.1-11">The algorithm described above is an iterative clustering algorithm since it executes steps in iterations, 
	  but it is also possible to apply a recursive clustering algorithm as detailed in 
	  <xref target="IEEE-ACM-TON-MPNPM" format="default" sectionFormat="of" derivedContent="IEEE-ACM-TON-MPNPM"/>.</t>
        <t indent="0" pn="section-5.1-12">The complete and mathematical analysis of the possible algorithms for the clusters 
	  partition, including the considerations in terms of efficiency and a comparison 
	  between the different methods, is in the paper <xref target="IEEE-ACM-TON-MPNPM" format="default" sectionFormat="of" derivedContent="IEEE-ACM-TON-MPNPM"/>.</t>
      </section>
    </section>
    <section anchor="Mploss" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-multipoint-packet-loss-meas">Multipoint Packet-Loss Measurement</name>
      <t indent="0" pn="section-6-1">The network packet loss, defined in <xref target="Nploss" format="default" sectionFormat="of" derivedContent="Section 4.2"/>, valid for the
	  entire monitored flow, can easily be extended to each multipoint path
	  (e.g., the whole multipoint network, a cluster, or a combination of clusters). 
	  In this way, it is possible to calculate Multipoint Packet Loss that is representative of a multipoint path.</t>
      <t indent="0" pn="section-6-2">The same equation of <xref target="Nploss" format="default" sectionFormat="of" derivedContent="Section 4.2"/> can be applied to a generic multipoint path 
	  like a cluster or a combination of clusters, where the number of packets are those entering and leaving 
	  the multipoint path.</t>
      <t indent="0" pn="section-6-3">By applying the algorithm described in <xref target="nclustering_algo" format="default" sectionFormat="of" derivedContent="Section 5.1"/>, it is possible to split 
	  the monitoring network into clusters. Then, packet loss can be measured on a cluster basis for each single period 
	  by considering the counters of the input and output nodes that belong to the specific cluster.
	  This can be done for every packet flow in each marking period.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-multipoint-delay-and-delay-">Multipoint Delay and Delay Variation</name>
      <t indent="0" pn="section-7-1">The same line of reasoning can be applied to delay and delay variation.
      The delay measurement methods defined in <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>
	  can be extended to the case of multipoint flows.
      It is important to highlight that both delay and delay-variation measurements 
      make sense in a multipoint path. The delay variation is calculated by considering 
      the same packets selected for measuring the delay.</t>
      <t indent="0" pn="section-7-2">In general, it is possible to perform delay and delay-variation measurements 
      on the basis of multipoint paths or single packets:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-7-3">
        <li pn="section-7-3.1">Delay measurements on the basis of multipoint paths mean that the delay value is representative
	    of an entire multipoint path (e.g., the whole multipoint network, a cluster, or a combination 
	    of clusters).</li>
        <li pn="section-7-3.2">Delay measurements on a single-packet basis mean that it is possible to use
	    a multipoint path just to easily couple packets between input and output nodes of a multipoint path,
		as described in the following sections.</li>
      </ul>
      <section anchor="Mdelay" numbered="true" toc="include" removeInRFC="false" pn="section-7.1">
        <name slugifiedName="name-delay-measurements-on-a-mul">Delay Measurements on a Multipoint-Paths Basis</name>
        <section anchor="M_single-marking" numbered="true" toc="include" removeInRFC="false" pn="section-7.1.1">
          <name slugifiedName="name-single-marking-measurement">Single-Marking Measurement</name>
          <t indent="0" pn="section-7.1.1-1">Mean delay and mean delay-variation measurements can also be generalized
		to the case of multipoint flows. It is possible to compute the average 
		one-way delay of packets in one block, a cluster, or the entire 
		monitored network.</t>
          <t indent="0" pn="section-7.1.1-2">The average latency can be measured as the difference
		between the weighted averages of the mean timestamps of the
		sets of output and input nodes. This means that, in the calculation, 
		it is possible to weigh the timestamps with the number of packets 
		for each endpoint.</t>
          <t indent="0" pn="section-7.1.1-3">Note that, since the one-way delay value is representative of a multipoint path,
		it is possible to calculate the two-way delay of a multipoint path by summing 
		the one-way delays of the two directions, similarly to <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.</t>
        </section>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-7.2">
        <name slugifiedName="name-delay-measurements-on-a-sin">Delay Measurements on a Single-Packet Basis</name>
        <section anchor="p_sd-marking" numbered="true" toc="include" removeInRFC="false" pn="section-7.2.1">
          <name slugifiedName="name-single-and-double-marking-m">Single- and Double-Marking Measurement</name>
          <t indent="0" pn="section-7.2.1-1">Delay and delay-variation measurements associated with only one picked packet per period,
		both single and double marked, cannot be easily performed in a multipoint scenario 
		since there are some limitations:</t>
          <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-7.2.1-2">
            <li pn="section-7.2.1-2.1">Single Marking based on the first/last packet of the
		  interval does not work properly.  Indeed, by considering a
		  point-to-multipoint scenario, it is not possible to
		  recognize which path the first packet of each block takes
		  over the multipoint flow in order to correlate it.  This is
		  also true for the general case of the
		  multipoint-to-multipoint scenario.
		  </li>
            <li pn="section-7.2.1-2.2">Double Marking or multiplexed marking works but only
		  through statistical means.  In a point-to-multipoint
		  scenario, by selecting only a single packet with the second
		  marking for each block, it is possible to follow and
		  calculate the delay for that picked packet.  But the
		  measurement can only be done for a single path in each
		  marking period.  To traverse all the paths of the multipoint
		  flow, it can theoretically be done by continuing the
		  measurement for the following marking periods and expect to
		  span all the paths.  In the general case of a
		  multipoint-to-multipoint path, it is also needed to take
		  into account the multiple source nodes that complicate the
		  correlation of the samples. In this case, it can be possible
		  to select the second marked packet only for a source node at
		  a time for each block and cover the remaining source nodes
		  one by one in the next marking periods.
		  </li>
          </ul>
          <t indent="0" pn="section-7.2.1-3">Note that, since the one-way delay measurement is done on a single-packet basis, it is always possible 
		to calculate the two-way delay, but it is not immediate since it is necessary to couple the measurement
		on each single path with the opposite direction. In this case, the NMS can do the calculation.</t>
          <t indent="0" pn="section-7.2.1-4">If a delay measurement is performed for more than one picked packet and for all the paths of the 
		multipoint flow in the same marking period, neither the Single- nor the Double-Marking Method are 
		applicable in the multipoint scenario. The packets follow different paths, and it becomes very difficult 
		to correlate marked packets in a multipoint-to-multipoint path if there are more than one per period.</t>
          <t indent="0" pn="section-7.2.1-5">A desirable option is to monitor simultaneously all the paths of a multipoint path 
		in the same marking period. For this purpose, hashing can be used, as reported in the next section.</t>
        </section>
        <section anchor="p_hashing" numbered="true" toc="include" removeInRFC="false" pn="section-7.2.2">
          <name slugifiedName="name-hashing-selection-method">Hashing Selection Method</name>
          <t indent="0" pn="section-7.2.2-1">Sampling and filtering techniques for IP packet selection are introduced in <xref target="RFC5474" format="default" sectionFormat="of" derivedContent="RFC5474"/> and <xref target="RFC5475" format="default" sectionFormat="of" derivedContent="RFC5475"/>.</t>
          <t indent="0" pn="section-7.2.2-2">The hash-based selection methodologies for delay measurement can work in a multipoint-to-multipoint path 
		and can be used either coupled to mean delay or standalone.</t>
          <t indent="0" pn="section-7.2.2-3"><xref target="IEEE-NETWORK-PNPM" format="default" sectionFormat="of" derivedContent="IEEE-NETWORK-PNPM"/> introduces how to use the hash method 
		(see <xref target="RFC5474" format="default" sectionFormat="of" derivedContent="RFC5474"/> and <xref target="RFC5475" format="default" sectionFormat="of" derivedContent="RFC5475"/>)
		combined with the Alternate-Marking Method for point-to-point flows.
        It is also called "Mixed Hashed Marking" because it refers to the conjunction of the marking method and 
		the hashing technique. It involves only the Single Marking; indeed, it is supposed that Double Marking 
		is not used with hashing. The coupling of the Single Marking with the hashing selection allows choosing
		a simplified hash function since the alternation of blocks gives temporal boundaries for the hashing samples. 
		The marking batches anchor the samples selected with hashing, and this eases the correlation of the hashing 
		packets along the path. For example, in case a hashed sample is lost, it is confined to the considered block 
		without affecting the identification of the samples for the following blocks.</t>
          <t indent="0" pn="section-7.2.2-4">Using the hash-based sampling, the number of samples in each block may vary a lot because it depends on 
		the packet rate that is variable. A dynamic approach can help to have an almost fixed number
        of samples for each marking period, and this is a better option for making regular measurements over time.  
		In the hash-based sampling, Alternate Marking is used to create periods, so that hash-based
        samples are divided into batches, which allows anchoring the selected samples to their period.  
		Moreover, in a dynamic hash-based sampling, it can be possible to dynamically adapt the length of the hash value
		to meet the current packet rate, so that the number of samples is bounded in each marking period.</t>
          <t indent="0" pn="section-7.2.2-5">In a multipoint environment, the hashing selection may be the solution 
		for performing delay measurements on specific packets and overcoming the
        Single- and Double-Marking limitations.</t>
        </section>
      </section>
    </section>
    <section anchor="sync-timing" numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-synchronization-and-timing">Synchronization and Timing</name>
      <t indent="0" pn="section-8-1">It is important to consider the timing aspects, since out-of-order packets happen and have 
	 to be handled as well, as described in <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.</t>
      <t indent="0" pn="section-8-2">However, in a multisource situation, an additional issue has to be considered. With multipoint path, 
	 the egress nodes will receive alternate marked packets in random order from different ingress nodes,
	 and this must not affect the measurement.</t>
      <t indent="0" pn="section-8-3">So, if we analyze a multipoint-to-multipoint path with more than one marking node,
     it is important to recognize the reference measurement interval. In general, the measurement 
	 interval for describing the results is the interval of the marking node that is more aligned with 
	 the start of the measurement, as reported in <xref target="measint" format="default" sectionFormat="of" derivedContent="Figure 2"/>.</t>
      <t indent="0" pn="section-8-4">Note that the mark switching approach based on a fixed timer is considered in this document.</t>
      <figure anchor="measint" align="left" suppress-title="false" pn="figure-2">
        <name slugifiedName="name-measurement-interval">Measurement Interval</name>
        <artwork name="" type="" align="left" alt="" pn="section-8-5.1">
        time -&gt; start         stop
        T(R1)   |-------------|
        T(R2)     |-------------|
        T(R3)        |------------|
</artwork>
      </figure>
      <t indent="0" pn="section-8-6">In <xref target="measint" format="default" sectionFormat="of" derivedContent="Figure 2"/>, it is assumed that the node with the
      earliest clock (R1) identifies the right starting and ending times of the measurement, 
	  but it is just an assumption and other possibilities could occur. 
	  So in this case, T(R1) is the measurement interval, and its recognition is essential 
	  in order to make comparisons with other active/passive/hybrid packet-loss metrics.</t>
      <t indent="0" pn="section-8-7">Regarding the timing constraints of the methodology, <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/> 
	  already describes two contributions that are taken into account: the clock error between network devices and
	  the network delay between the measurement points.</t>
      <t indent="0" pn="section-8-8">When we expand to a multipoint environment, we have to consider that there are more marking nodes that mark the traffic 
	  based on synchronized clock time. But, due to different synchronization issues that may happen, the marking batches 
	  can be of different lengths and with different offsets when they get mixed in a multipoint flow. 
	  According to <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>, the maximum clock skew between the network devices
	  is A. Therefore, the additional gap that results between the multiple sources can be incorporated into A.</t>
      <figure anchor="timing" align="left" suppress-title="false" pn="figure-3">
        <name slugifiedName="name-timing-aspects">Timing Aspects</name>
        <artwork name="" type="" align="left" alt="" pn="section-8-9.1">
...BBBBBBBBB | AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA | BBBBBBBBB...
             |&lt;======================================&gt;|
             |                   L                    |
...=========&gt;|&lt;==================&gt;&lt;==================&gt;|&lt;==========...
             |         L/2                L/2         |
             |&lt;====&gt;|                          |&lt;====&gt;|
                d   |                          |   d
                    |&lt;========================&gt;|
                    available counting interval
</artwork>
      </figure>
      <t indent="0" pn="section-8-10">Moreover, it is assumed that the multipoint path can be modeled with a normal distribution; 
	  otherwise, it is necessary to reformulate based on the type of distribution.
	  Under	this assumption, the definition of the guard band d is still applicable as defined in
	  <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/> and is given by:</t>
      <artwork align="left" pn="section-8-11">
d = A + D_avg + 3*D_stddev,
</artwork>
      <t indent="0" pn="section-8-12">where A is the clock accuracy, D_avg is the average value of the network delay, 
	  and D_stddev is the standard deviation of the delay.</t>
      <t indent="0" pn="section-8-13">As shown in <xref target="timing" format="default" sectionFormat="of" derivedContent="Figure 3"/> and according to <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>, 
	  the condition that must be satisfied to enable the method to function properly is that the available counting interval
	  must be &gt; 0, and that means:</t>
      <artwork align="left" pn="section-8-14">
L - 2d &gt; 0.
</artwork>
      <t indent="0" pn="section-8-15">This formula needs to be verified for each measurement point on the multipoint path.</t>
      <t indent="0" pn="section-8-16">Note that the timing considerations are valid for both packet loss and delay measurements.</t>
    </section>
    <section anchor="finding" numbered="true" toc="include" removeInRFC="false" pn="section-9">
      <name slugifiedName="name-recommendations-for-deploym">Recommendations for Deployment</name>
      <t indent="0" pn="section-9-1">The methodology described in the previous sections can be applied to 
	  various performance measurement problems, as also explained in <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.
	  <xref target="RFC8889" format="default" sectionFormat="of" derivedContent="RFC8889"/> reports experimental examples and  <xref target="IEEE-NETWORK-PNPM" format="default" sectionFormat="of" derivedContent="IEEE-NETWORK-PNPM"/> also includes 
	  some information about the deployment experience.</t>
      <t indent="0" pn="section-9-2">Different deployments are possible using one flag bit, two flag bits, or the hashing selection:</t>
      <dl indent="3" newline="false" spacing="normal" pn="section-9-3">
        <dt pn="section-9-3.1">One flag:
        </dt>
        <dd pn="section-9-3.2">packet-loss measurement <bcp14>MUST</bcp14> be done as described
	in <xref target="Mploss" format="default" sectionFormat="of" derivedContent="Section 6"/> by applying the network
	clustering partition described in <xref target="nclustering" format="default" sectionFormat="of" derivedContent="Section 5"/>.  Delay measurement <bcp14>MUST</bcp14> be done
	according to the mean delay calculation representative of the
	multipoint path, as described in <xref target="M_single-marking" format="default" sectionFormat="of" derivedContent="Section 7.1.1"/>. A Single-Marking Method based on the first/last
	packet of the interval cannot be applied, as mentioned in <xref target="p_sd-marking" format="default" sectionFormat="of" derivedContent="Section 7.2.1"/>.
	</dd>
        <dt pn="section-9-3.3">Two flags:
        </dt>
        <dd pn="section-9-3.4">packet-loss measurement <bcp14>MUST</bcp14> be done as described
	in <xref target="Mploss" format="default" sectionFormat="of" derivedContent="Section 6"/> by applying the network
	clustering partition described in <xref target="nclustering" format="default" sectionFormat="of" derivedContent="Section 5"/>.  Delay measurement <bcp14>SHOULD</bcp14> be done
	on a single-packet basis according to the Double-Marking Method (<xref target="p_sd-marking" format="default" sectionFormat="of" derivedContent="Section 7.2.1"/>).  In this case, the mean delay
	calculation (<xref target="M_single-marking" format="default" sectionFormat="of" derivedContent="Section 7.1.1"/>)
	<bcp14>MAY</bcp14> also be used as a representative value of a
	multipoint path. The choice depends on the kind of information that is
	needed, as further detailed below.
	</dd>
        <dt pn="section-9-3.5">One flag with hash-based selection:
        </dt>
        <dd pn="section-9-3.6">packet-loss measurement <bcp14>MUST</bcp14> be done as described
	in <xref target="Mploss" format="default" sectionFormat="of" derivedContent="Section 6"/> by applying the network
	clustering partition described in <xref target="nclustering" format="default" sectionFormat="of" derivedContent="Section 5"/>.  Hash-based selection methodologies, introduced in
	<xref target="p_hashing" format="default" sectionFormat="of" derivedContent="Section 7.2.2"/>, <bcp14>MUST</bcp14> be
	used for delay measurement.
	</dd>
      </dl>
      <t indent="0" pn="section-9-4">Similarly to <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>, there are some operational guidelines to consider
	  when deciding which recommendation to use (i.e., one flag or two flags or one flag with hash-based selection.</t>
      <ul empty="false" spacing="normal" bare="false" indent="3" pn="section-9-5">
        <li pn="section-9-5.1">The Multipoint Alternate-Marking Method utilizes specific flags in the packet header, so an important factor is the number of
	   flags available for the implementation. Indeed, if there is only one flag available, there is no other way, while if two flags are available,
	   the option with two flags can be considered in comparison with the option of one flag with hash-based selection.</li>
        <li pn="section-9-5.2">The duration of the Alternate-Marking period affects the frequency of the measurement, and this is a parameter that can be 
	   decided on the basis of the required temporal sampling. But it cannot be freely chosen, as explained in <xref target="sync-timing" format="default" sectionFormat="of" derivedContent="Section 8"/>.</li>
        <li pn="section-9-5.3">The Multipoint Alternate-Marking methodologies enable packet loss, delay, and delay variation calculation, but in accordance with 
	   the method used (e.g., Single Marking, Double Marking, or hashing selection), there is a different kind of information that can be derived. 
	   For example, to get measurements on a multipoint-paths basis, one flag can be used. To get measurements on a single-packet basis,
	   two flags are preferred. For this reason, the type of data needed in the specific scenario is an additional element to take into account.</li>
        <li pn="section-9-5.4">The Multipoint Alternate-Marking Methods imply different computational load depending on the method employed. Therefore, the available 
	   computational resources on the measurement points can also influence the choice. As an example, mean delay calculation may 
	   require more processing, and it may not be the best option to minimize the computational load.</li>
      </ul>
      <t indent="0" pn="section-9-6">The experiment with Multipoint Alternate-Marking methodologies confirmed the benefits of the Alternate-Marking methodology
	  <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/> as its extension to the general case of 
	  multipoint-to-multipoint scenarios.</t>
      <t indent="0" pn="section-9-7">The Multipoint Alternate-Marking Method <bcp14>MUST</bcp14> only be applied to controlled domains,
	  as per <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-10">
      <name slugifiedName="name-a-closed-loop-performance-m">A Closed-Loop Performance-Management Approach</name>
      <t indent="0" pn="section-10-1">The Multipoint Alternate-Marking framework that is introduced in this document adds flexibility 
	to Performance Management (PM), because it can reduce the order of magnitude of the packet counters. 
	This allows an SDN orchestrator to supervise, control, and manage PM in large networks.</t>
      <t indent="0" pn="section-10-2">The monitoring network can be considered as a whole or split into clusters that are the 
	smallest subnetworks (group-to-group segments), maintaining the
	packet-loss property for each subnetwork. The clusters can also be
	combined in new, connected subnetworks at different levels, depending on
	the detail we want to achieve.</t>
      <t indent="0" pn="section-10-3">An SDN controller or an NMS can calibrate performance measurements, 
	since they are aware of the network topology. They can start without examining in depth. In case of necessity 
	(packet loss is measured or the delay is too high), the filtering criteria could be immediately reconfigured
	in order to perform a partition of the network by using clusters and/or different combinations of clusters. 
	In this way, the problem can be localized in a specific cluster or a single combination of clusters, 
	and a more detailed analysis can be performed step by step by successive approximation up to 
	a point-to-point flow detailed analysis. This is the so-called "closed loop".</t>
      <t indent="0" pn="section-10-4">This approach can be called "network zooming" and can be performed in two different ways:</t>
      <ol indent="adaptive" spacing="normal" start="1" type="1" pn="section-10-5">
<li pn="section-10-5.1" derivedCounter="1.">change the traffic filter and select more detailed flows;
</li>
        <li pn="section-10-5.2" derivedCounter="2.">activate new measurement points by defining more specified clusters.
</li>
      </ol>
      <t indent="0" pn="section-10-6">The network-zooming approach implies that some filters or rules are changed; therefore, there is a 
	transient time to wait once the new network configuration takes effect. This time can be determined 
	by the network orchestrator/controller, based on the network conditions.</t>
      <t indent="0" pn="section-10-7">For example, if the network zooming identifies the performance problem for the traffic coming from 
	a specific source, we need to recognize the marked signal from this specific source node and its relative path. 
	For this purpose, we can activate all the available measurement points
	and better specify the flow filter criteria 
	(i.e., 5-tuple). As an alternative, it can be enough to select packets
	from the specific source for delay measurements; 
	in this case, it is possible to apply the hashing technique, as mentioned in the previous sections.</t>
      <t indent="0" pn="section-10-8"><xref target="I-D.song-opsawg-ifit-framework" format="default" sectionFormat="of" derivedContent="OPSAWG-IFIT-FRAMEWORK"/> defines an architecture where the centralized 
	data collector and network management can apply the intelligent and flexible Alternate-Marking algorithm
	as previously described.</t>
      <t indent="0" pn="section-10-9">As for <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>, it is possible to classify the traffic and mark a portion of 
	the total traffic. For each period, the packet rate and bandwidth are calculated from the number of packets.
	In this way, the network orchestrator becomes aware if the traffic rate surpasses limits. 
	In addition, more precision can be obtained by reducing the marking period; indeed, some implementations use
	a marking period of 1 sec or less.</t>
      <t indent="0" pn="section-10-10">In addition, an SDN controller could also collect the measurement history.</t>
      <t indent="0" pn="section-10-11">It is important to mention that the Multipoint Alternate-Marking framework also helps Traffic Visualization. 
	Indeed, this methodology is very useful for identifying which path or cluster is crossed by the flow.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-11">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-11-1">This document specifies a method of performing measurements that does not 
      directly affect Internet security or applications that run on the Internet.
      However, implementation of this method must be mindful of security
      and privacy concerns, as explained in <xref target="RFC9341" format="default" sectionFormat="of" derivedContent="RFC9341"/>.</t>
    </section>
    <section anchor="IANA" numbered="true" toc="include" removeInRFC="false" pn="section-12">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-12-1">This document has no IANA actions.</t>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.song-opsawg-ifit-framework" to="OPSAWG-IFIT-FRAMEWORK"/>
    <references pn="section-13">
      <name slugifiedName="name-references">References</name>
      <references pn="section-13.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author fullname="S. Bradner" initials="S." surname="Bradner"/>
            <date month="March" year="1997"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized.  This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
          <format target="https://www.rfc-editor.org/info/rfc2119" type="TXT"/>
        </reference>
        <reference anchor="RFC5475" target="https://www.rfc-editor.org/info/rfc5475" quoteTitle="true" derivedAnchor="RFC5475">
          <front>
            <title>Sampling and Filtering Techniques for IP Packet Selection</title>
            <author fullname="T. Zseby" initials="T." surname="Zseby"/>
            <author fullname="M. Molina" initials="M." surname="Molina"/>
            <author fullname="N. Duffield" initials="N." surname="Duffield"/>
            <author fullname="S. Niccolini" initials="S." surname="Niccolini"/>
            <author fullname="F. Raspall" initials="F." surname="Raspall"/>
            <date month="March" year="2009"/>
            <abstract>
              <t indent="0">This document describes Sampling and Filtering techniques for IP packet selection.  It provides a categorization of schemes and defines what parameters are needed to describe the most common selection schemes.  Furthermore, it shows how techniques can be combined to build more elaborate packet Selectors.  The document provides the basis for the definition of information models for configuring selection techniques in Metering Processes and for reporting the technique in use to a Collector. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5475"/>
          <seriesInfo name="DOI" value="10.17487/RFC5475"/>
          <format target="https://www.rfc-editor.org/info/rfc5475" type="TXT"/>
        </reference>
        <reference anchor="RFC5644" target="https://www.rfc-editor.org/info/rfc5644" quoteTitle="true" derivedAnchor="RFC5644">
          <front>
            <title>IP Performance Metrics (IPPM): Spatial and Multicast</title>
            <author fullname="E. Stephan" initials="E." surname="Stephan"/>
            <author fullname="L. Liang" initials="L." surname="Liang"/>
            <author fullname="A. Morton" initials="A." surname="Morton"/>
            <date month="October" year="2009"/>
            <abstract>
              <t indent="0">The IETF has standardized IP Performance Metrics (IPPM) for measuring end-to-end performance between two points.  This memo defines two new categories of metrics that extend the coverage to multiple measurement points.  It defines spatial metrics for measuring the performance of segments of a source to destination path, and metrics for measuring the performance between a source and many destinations in multiparty communications (e.g., a multicast tree). [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5644"/>
          <seriesInfo name="DOI" value="10.17487/RFC5644"/>
          <format target="https://www.rfc-editor.org/info/rfc5644" type="TXT"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <date month="May" year="2017"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
          <format target="https://www.rfc-editor.org/info/rfc8174" type="TXT"/>
        </reference>
        <reference anchor="RFC9341" target="https://www.rfc-editor.org/info/rfc9341" quoteTitle="true" derivedAnchor="RFC9341">
          <front>
            <title>Alternate-Marking Method</title>
            <author initials="G." surname="Fioccola" fullname="Giuseppe Fioccola" role="editor">
              <organization showOnFrontPage="true">Huawei Technologies</organization>
            </author>
            <author initials="M." surname="Cociglio" fullname="Mauro Cociglio">
              <organization showOnFrontPage="true">Telecom Italia</organization>
            </author>
            <author initials="G." surname="Mirsky" fullname="Greg Mirsky">
              <organization showOnFrontPage="true">Ericsson</organization>
            </author>
            <author initials="T." surname="Mizrahi" fullname="Tal Mizrahi">
              <organization showOnFrontPage="true">Huawei Technologies</organization>
            </author>
            <author initials="T." surname="Zhou" fullname="Tianran Zhou">
              <organization showOnFrontPage="true">Huawei Technologies</organization>
            </author>
            <date month="December" year="2022"/>
          </front>
          <seriesInfo name="RFC" value="9341"/>
          <seriesInfo name="DOI" value="10.17487/RFC9341"/>
        </reference>
      </references>
      <references pn="section-13.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="IEEE-ACM-TON-MPNPM" quoteTitle="true" target="https://doi.org/10.1109/TNET.2019.2950157" derivedAnchor="IEEE-ACM-TON-MPNPM">
          <front>
            <title>Multipoint Passive Monitoring in Packet Networks</title>
            <author surname="Cociglio" initials="M">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Fioccola" initials="G">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Marchetto" initials="G">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Sapio" initials="A">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Sisto" initials="R">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="December" year="2019"/>
          </front>
          <refcontent>IEEE/ACM Transactions on Networking, Vol. 27, Issue 6</refcontent>
          <seriesInfo name="DOI" value="10.1109/TNET.2019.2950157"/>
        </reference>
        <reference anchor="IEEE-NETWORK-PNPM" quoteTitle="true" target="https://doi.org/10.1109/MNET.2019.1800152" derivedAnchor="IEEE-NETWORK-PNPM">
          <front>
            <title>AM-PM: Efficient Network Telemetry using Alternate Marking</title>
            <author surname="Mizrahi" initials="T">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Navon" initials="G">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Fioccola" initials="G">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Cociglio" initials="M">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Chen" initials="M">
              <organization showOnFrontPage="true"/>
            </author>
            <author surname="Mirsky" initials="G">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="July" year="2019"/>
          </front>
          <refcontent>IEEE Network, Vol. 33, Issue 4</refcontent>
          <seriesInfo name="DOI" value="10.1109/MNET.2019.1800152"/>
        </reference>
        <reference anchor="I-D.song-opsawg-ifit-framework" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-song-opsawg-ifit-framework-19" derivedAnchor="OPSAWG-IFIT-FRAMEWORK">
          <front>
            <title>A Framework for In-situ Flow Information Telemetry</title>
            <author initials="H." surname="Song" fullname="Haoyu Song">
              <organization showOnFrontPage="true">Futurewei</organization>
            </author>
            <author initials="F." surname="Qin" fullname="Fengwei Qin">
              <organization showOnFrontPage="true">China Mobile</organization>
            </author>
            <author initials="H." surname="Chen" fullname="Huanan Chen">
              <organization showOnFrontPage="true">China Telecom</organization>
            </author>
            <author initials="J." surname="Jin" fullname="Jaewhan Jin">
              <organization showOnFrontPage="true">LG U+</organization>
            </author>
            <author initials="J." surname="Shin" fullname="Jongyoon Shin">
              <organization showOnFrontPage="true">SK Telecom</organization>
            </author>
            <date month="October" day="24" year="2022"/>
            <abstract>
              <t indent="0">   As network scale increases and network operation becomes more
   sophisticated, existing Operation, Administration, and Maintenance
   (OAM) methods are no longer sufficient to meet the monitoring and
   measurement requirements.  Emerging data-plane on-path telemetry
   techniques, such as IOAM and AltMrk, which provide high-precision
   flow insight and issue notifications in real time can supplement
   existing proactive and reactive methods that run in active and
   passive modes.  They enable quality of experience for users and
   applications, and identification of network faults and deficiencies.
   This document describes a reference framework, named as In-situ Flow
   Information Telemetry, for the on-path telemetry techniques.

   The high-level framework outlines the system architecture for
   applying the on-path telemetry techniques to collect and correlate
   performance measurement information from the network.  It identifies
   the components that coordinate existing protocol tools and telemetry
   mechanisms, and addresses deployment challenges for flow-oriented on-
   path telemetry techniques, especially in carrier networks.

   The document is a guide for system designers applying the referenced
   techniques.  It is also intended to motivate further work to enhance
   the OAM ecosystem.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-song-opsawg-ifit-framework-19"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-song-opsawg-ifit-framework-19.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="RFC5474" target="https://www.rfc-editor.org/info/rfc5474" quoteTitle="true" derivedAnchor="RFC5474">
          <front>
            <title>A Framework for Packet Selection and Reporting</title>
            <author fullname="N. Duffield" initials="N." role="editor" surname="Duffield"/>
            <author fullname="D. Chiou" initials="D." surname="Chiou"/>
            <author fullname="B. Claise" initials="B." surname="Claise"/>
            <author fullname="A. Greenberg" initials="A." surname="Greenberg"/>
            <author fullname="M. Grossglauser" initials="M." surname="Grossglauser"/>
            <author fullname="J. Rexford" initials="J." surname="Rexford"/>
            <date month="March" year="2009"/>
            <abstract>
              <t indent="0">This document specifies a framework for the PSAMP (Packet SAMPling) protocol.  The functions of this protocol are to select packets from a stream according to a set of standardized Selectors, to form a stream of reports on the selected packets, and to export the reports to a Collector.  This framework details the components of this architecture, then describes some generic requirements, motivated by the dual aims of ubiquitous deployment and utility of the reports for applications.  Detailed requirements for selection, reporting, and exporting are described, along with configuration requirements of the PSAMP functions.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5474"/>
          <seriesInfo name="DOI" value="10.17487/RFC5474"/>
          <format target="https://www.rfc-editor.org/info/rfc5474" type="TXT"/>
        </reference>
        <reference anchor="RFC7011" target="https://www.rfc-editor.org/info/rfc7011" quoteTitle="true" derivedAnchor="RFC7011">
          <front>
            <title>Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information</title>
            <author fullname="B. Claise" initials="B." role="editor" surname="Claise"/>
            <author fullname="B. Trammell" initials="B." role="editor" surname="Trammell"/>
            <author fullname="P. Aitken" initials="P." surname="Aitken"/>
            <date month="September" year="2013"/>
            <abstract>
              <t indent="0">This document specifies the IP Flow Information Export (IPFIX) protocol, which serves as a means for transmitting Traffic Flow information over the network.  In order to transmit Traffic Flow information from an Exporting Process to a Collecting Process, a common representation of flow data and a standard means of communicating them are required.  This document describes how the IPFIX Data and Template Records are carried over a number of transport protocols from an IPFIX Exporting Process to an IPFIX Collecting Process.  This document obsoletes RFC 5101.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="77"/>
          <seriesInfo name="RFC" value="7011"/>
          <seriesInfo name="DOI" value="10.17487/RFC7011"/>
          <format target="https://www.rfc-editor.org/info/rfc7011" type="TXT"/>
        </reference>
        <reference anchor="RFC8889" target="https://www.rfc-editor.org/info/rfc8889" quoteTitle="true" derivedAnchor="RFC8889">
          <front>
            <title>Multipoint Alternate-Marking Method for Passive and Hybrid Performance Monitoring</title>
            <author fullname="G. Fioccola" initials="G." role="editor" surname="Fioccola"/>
            <author fullname="M. Cociglio" initials="M." surname="Cociglio"/>
            <author fullname="A. Sapio" initials="A." surname="Sapio"/>
            <author fullname="R. Sisto" initials="R." surname="Sisto"/>
            <date month="August" year="2020"/>
            <abstract>
              <t indent="0">The Alternate-Marking method, as presented in RFC 8321, can only be applied to point-to-point flows, because it assumes that all the packets of the flow measured on one node are measured again by a single second node.  This document generalizes and expands this methodology to measure any kind of unicast flow whose packets can follow several different paths in the network -- in wider terms, a multipoint-to-multipoint network.  For this reason, the technique here described is called "Multipoint Alternate Marking".</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8889"/>
          <seriesInfo name="DOI" value="10.17487/RFC8889"/>
          <format target="https://www.rfc-editor.org/info/rfc8889" type="TXT"/>
        </reference>
        <reference anchor="RFC9198" target="https://www.rfc-editor.org/info/rfc9198" quoteTitle="true" derivedAnchor="RFC9198">
          <front>
            <title>Advanced Unidirectional Route Assessment (AURA)</title>
            <author fullname="J. Alvarez-Hamelin" initials="J." surname="Alvarez-Hamelin"/>
            <author fullname="A. Morton" initials="A." surname="Morton"/>
            <author fullname="J. Fabini" initials="J." surname="Fabini"/>
            <author fullname="C. Pignataro" initials="C." surname="Pignataro"/>
            <author fullname="R. Geib" initials="R." surname="Geib"/>
            <date month="May" year="2022"/>
            <abstract>
              <t indent="0">This memo introduces an advanced unidirectional route assessment (AURA) metric and associated measurement methodology based on the IP Performance Metrics (IPPM) framework (RFC 2330).  This memo updates RFC 2330 in the areas of path-related terminology and path description, primarily to include the possibility of parallel subpaths between a given Source and Destination pair, owing to the presence of multipath technologies.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9198"/>
          <seriesInfo name="DOI" value="10.17487/RFC9198"/>
          <format target="https://www.rfc-editor.org/info/rfc9198" type="TXT"/>
        </reference>
      </references>
    </references>
    <section anchor="Appendix" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-example-of-monitoring-netwo">Example of Monitoring Network and Clusters Partition</name>
      <t indent="0" pn="section-appendix.a-1"><xref target="monitored-graph" format="default" sectionFormat="of" derivedContent="Figure 4"/> shows a simple example of a
	    monitoring network graph:</t>
      <figure anchor="monitored-graph" align="left" suppress-title="false" pn="figure-4">
        <name slugifiedName="name-monitoring-network-graph">Monitoring Network Graph</name>
        <artwork name="" type="" align="left" alt="" pn="section-appendix.a-2.1">
                                                 +------+
                                                &lt;&gt;  R6  &lt;&gt;---
                                               / +------+
                        +------+     +------+ / 
                       &lt;&gt;  R2  &lt;&gt;---&lt;&gt;  R4  &lt;&gt;             
                      / +------+ \   +------+ \             
                     /            \            \ +------+
           +------+ /   +------+   \ +------+   &lt;&gt;  R7  &lt;&gt;---
       ---&lt;&gt;  R1  &lt;&gt;---&lt;&gt;  R3  &lt;&gt;---&lt;&gt;  R5  &lt;&gt;   +------+    
           +------+ \   +------+ \   +------+ \     
                     \            \            \ +------+
                      \            \            &lt;&gt;  R8  &lt;&gt;---
                       \            \            +------+
                        \            \
                         \            \ +------+   
                          \            &lt;&gt;  R9  &lt;&gt;---
                           \            +------+
                            \
                             \ +------+
                              &lt;&gt;  R10 &lt;&gt;---
                               +------+
</artwork>
      </figure>
      <t indent="0" pn="section-appendix.a-3">In the monitoring network graph example, it is possible to identify the clusters partition 
	  by applying this two-step algorithm described in <xref target="nclustering_algo" format="default" sectionFormat="of" derivedContent="Section 5.1"/>.</t>
      <t indent="0" pn="section-appendix.a-4">The first step identifies the following groups:</t>
      <ul spacing="normal" empty="true" bare="false" indent="3" pn="section-appendix.a-5">
        <li pn="section-appendix.a-5.1">Group 1: (R1-R2), (R1-R3), (R1-R10)</li>
        <li pn="section-appendix.a-5.2">Group 2: (R2-R4), (R2-R5)</li>
        <li pn="section-appendix.a-5.3">Group 3: (R3-R5), (R3-R9)</li>
        <li pn="section-appendix.a-5.4">Group 4: (R4-R6), (R4-R7)</li>
        <li pn="section-appendix.a-5.5">Group 5: (R5-R8)</li>
      </ul>
      <t indent="0" pn="section-appendix.a-6">Then, the second step builds the clusters partition (in particular,
	  we can underline that Groups 2 and 3 connect together, since R5 is in common):</t>
      <ul spacing="normal" empty="true" bare="false" indent="3" pn="section-appendix.a-7">
        <li pn="section-appendix.a-7.1">Cluster 1: (R1-R2), (R1-R3), (R1-R10)</li>
        <li pn="section-appendix.a-7.2">Cluster 2: (R2-R4), (R2-R5), (R3-R5), (R3-R9)</li>
        <li pn="section-appendix.a-7.3">Cluster 3: (R4-R6), (R4-R7)</li>
        <li pn="section-appendix.a-7.4">Cluster 4: (R5-R8)</li>
      </ul>
      <t indent="0" pn="section-appendix.a-8">The flow direction considered here is from left to right. For the opposite direction,
	    the same reasoning can be applied, and in this example, you get the
	    same clusters partition.</t>
      <t indent="0" pn="section-appendix.a-9">In the end, the following 4 clusters are obtained:</t>
      <figure anchor="clusters" align="left" suppress-title="false" pn="figure-5">
        <name slugifiedName="name-clusters-example">Clusters Example</name>
        <artwork name="" type="" align="left" alt="" pn="section-appendix.a-10.1">
       Cluster 1
                        +------+
                       &lt;&gt;  R2  &lt;&gt;---
                      / +------+
                     /
           +------+ /   +------+
       ---&lt;&gt;  R1  &lt;&gt;---&lt;&gt;  R3  &lt;&gt;---
           +------+ \   +------+
                     \
                      \
                       \
                        \
                         \
                          \
                           \
                            \
                             \ +------+
                              &lt;&gt;  R10 &lt;&gt;---
                               +------+


       Cluster 2
           +------+     +------+
       ---&lt;&gt;  R2  &lt;&gt;---&lt;&gt;  R4  &lt;&gt;---
           +------+ \   +------+
                     \
           +------+   \ +------+
       ---&lt;&gt;  R3  &lt;&gt;---&lt;&gt;  R5  &lt;&gt;---
           +------+ \   +------+
                     \
                      \
                       \
                        \
                         \ +------+
                          &lt;&gt;  R9  &lt;&gt;---
                           +------+


       Cluster 3
                       +------+
                      &lt;&gt;  R6  &lt;&gt;---
                     / +------+
           +------+ /
       ---&lt;&gt;  R4  &lt;&gt;
           +------+ \
                     \ +------+
                      &lt;&gt;  R7  &lt;&gt;---
                       +------+


       Cluster 4
           +------+
       ---&lt;&gt;  R5  &lt;&gt;
           +------+ \
                     \ +------+
                      &lt;&gt;  R8  &lt;&gt;---
                       +------+
</artwork>
      </figure>
      <t indent="0" pn="section-appendix.a-11">There are clusters with more than two nodes as well as two-node clusters.
		In the two-node clusters, the loss is on the link (Cluster 4).
		In more-than-two-node clusters, the loss is on the cluster, but 
		we cannot know in which link (Cluster 1, 2, or 3).</t>
    </section>
    <section anchor="Acknowledgements" numbered="false" toc="include" removeInRFC="false" pn="section-appendix.b">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.b-1">The authors would like to thank <contact fullname="Martin Duke"/> and <contact fullname="Tommy Pauly"/>
	  for their assistance and their detailed and valuable reviews.</t>
    </section>
    <section anchor="Contributors" numbered="false" toc="include" removeInRFC="false" pn="section-appendix.c">
      <name slugifiedName="name-contributors">Contributors</name>
      <author fullname="Greg Mirsky" initials="G" surname="Mirsky">
        <organization showOnFrontPage="true">Ericsson</organization>
        <address>
          <postal>
        </postal>
          <email>gregimirsky@gmail.com</email>
        </address>
      </author>
      <author fullname="Tal Mizrahi" initials="T" surname="Mizrahi">
        <organization showOnFrontPage="true">Huawei Technologies</organization>
        <address>
          <postal>
        </postal>
          <email>tal.mizrahi.phd@gmail.com</email>
        </address>
      </author>
      <author fullname="Xiao Min" initials="X" surname="Min">
        <organization showOnFrontPage="true">ZTE Corp.</organization>
        <address>
          <postal>
        </postal>
          <email>xiao.min2@zte.com.cn</email>
        </address>
      </author>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.d">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author role="editor" fullname="Giuseppe Fioccola" initials="G." surname="Fioccola">
        <organization showOnFrontPage="true">Huawei Technologies</organization>
        <address>
          <postal>
            <street>Riesstrasse, 25</street>
            <city>Munich</city>
            <code>80992</code>
            <country>Germany</country>
          </postal>
          <email>giuseppe.fioccola@huawei.com</email>
        </address>
      </author>
      <author fullname="Mauro Cociglio" initials="M." surname="Cociglio">
        <organization showOnFrontPage="true">Telecom Italia</organization>
        <address>
          <postal>
            <street/>
            <city/>
            <code/>
            <country/>
          </postal>
          <email>mauro.cociglio@outlook.com</email>
        </address>
      </author>
      <author fullname="Amedeo Sapio" initials="A." surname="Sapio">
        <organization showOnFrontPage="true">Intel Corporation</organization>
        <address>
          <postal>
            <street>4750 Patrick Henry Dr.</street>
            <city>Santa Clara</city>
            <region>CA</region>
            <code>95054</code>
            <country>United States of America</country>
          </postal>
          <email>amedeo.sapio@intel.com</email>
        </address>
      </author>
      <author fullname="Riccardo Sisto" initials="R." surname="Sisto">
        <organization showOnFrontPage="true">Politecnico di Torino</organization>
        <address>
          <postal>
            <street>Corso Duca degli Abruzzi, 24</street>
            <city>Torino</city>
            <code>10129</code>
            <country>Italy</country>
          </postal>
          <email>riccardo.sisto@polito.it</email>
        </address>
      </author>
      <author fullname="Tianran Zhou" initials="T." surname="Zhou">
        <organization showOnFrontPage="true">Huawei Technologies</organization>
        <address>
          <postal>
            <street>156 Beiqing Rd.</street>
            <city>Beijing</city>
            <code>100095</code>
            <region/>
            <country>China</country>
          </postal>
          <email>zhoutianran@huawei.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
