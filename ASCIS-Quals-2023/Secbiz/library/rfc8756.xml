<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="info" docName="draft-jenkins-cnsa-cmc-profile-05" indexInclude="true" ipr="trust200902" number="8756" prepTime="2020-03-27T11:22:12" scripts="Common,Latin" sortRefs="true" submissionType="independent" symRefs="true" tocDepth="2" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-jenkins-cnsa-cmc-profile-05" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc8756" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="CNSA Suite CMC Profile">Commercial National Security Algorithm (CNSA) Suite Profile of Certificate Management over CMS</title>
    <seriesInfo name="RFC" value="8756" stream="independent"/>
    <author fullname="Michael Jenkins" initials="M." surname="Jenkins">
      <organization abbrev="NSA" showOnFrontPage="true">National Security Agency</organization>
      <address>
        <email>mjjenki@nsa.gov</email>
      </address>
    </author>
    <author fullname="Lydia Zieglar" initials="L." surname="Zieglar">
      <organization abbrev="NSA" showOnFrontPage="true">National Security Agency</organization>
      <address>
        <email>llziegl@tycho.ncsc.mil</email>
      </address>
    </author>
    <date month="03" year="2020"/>
    <area>Security</area>
    <workgroup>Network Working Group</workgroup>
    <keyword>NSA</keyword>
    <keyword>CNSA</keyword>
    <keyword>NSS</keyword>
    <keyword>certificate</keyword>
    <keyword>enrollment</keyword>
    <abstract pn="section-abstract">
      <t pn="section-abstract-1">This document specifies a profile of the Certificate Management over CMS (CMC) protocol for managing X.509 public key certificates in applications that use the Commercial National Security Algorithm (CNSA) Suite published by the United States Government.
</t>
      <t pn="section-abstract-2">The profile applies to the capabilities, configuration, and operation of all components of US National Security Systems that manage X.509 public key certificates over CMS.  It is also appropriate for all other US Government systems that process high-value information.
</t>
      <t pn="section-abstract-3">The profile is made publicly available here for use by developers and operators of these and any other system deployments.
</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t pn="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.
        </t>
        <t pn="section-boilerplate.1-2">
            This is a contribution to the RFC Series, independently of any
            other RFC stream.  The RFC Editor has chosen to publish this
            document at its discretion and makes no statement about its value
            for implementation or deployment.  Documents approved for
            publication by the RFC Editor are not candidates for any level of
            Internet Standard; see Section 2 of RFC 7841.
        </t>
        <t pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc8756" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t pn="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-terminology">Terminology</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-the-commercial-national-sec">The Commercial National Security Algorithm Suite</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t keepWithNext="true" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-and-assumption">Requirements and Assumptions</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t keepWithNext="true" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-client-requirements-generat">Client Requirements: Generating PKI Requests</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t keepWithNext="true" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tagged-certification-reques">Tagged Certification Request</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t keepWithNext="true" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-certificate-request-message">Certificate Request Message</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t keepWithNext="true" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ra-requirements">RA Requirements</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t keepWithNext="true" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ra-processing-of-requests">RA Processing of Requests</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t keepWithNext="true" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ra-generated-pki-requests">RA-Generated PKI Requests</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t keepWithNext="true" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ra-generated-pki-responses">RA-Generated PKI Responses</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t keepWithNext="true" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ca-requirements">CA Requirements</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t keepWithNext="true" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ca-processing-of-pki-reques">CA Processing of PKI Requests</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t keepWithNext="true" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ca-generated-pki-responses">CA-Generated PKI Responses</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t keepWithNext="true" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-client-requirements-process">Client Requirements: Processing PKI Responses</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t keepWithNext="true" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-shared-secrets">Shared-Secrets</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t keepWithNext="true" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t keepWithNext="true" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t keepWithNext="true" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.11.2">
              <li pn="section-toc.1-1.11.2.1">
                <t keepWithNext="true" pn="section-toc.1-1.11.2.1.1"><xref derivedContent="11.1" format="counter" sectionFormat="of" target="section-11.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.2">
                <t keepWithNext="true" pn="section-toc.1-1.11.2.2.1"><xref derivedContent="11.2" format="counter" sectionFormat="of" target="section-11.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.12">
            <t keepWithNext="true" pn="section-toc.1-1.12.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-scenarios">Scenarios</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.2">
              <li pn="section-toc.1-1.12.2.1">
                <t keepWithNext="true" pn="section-toc.1-1.12.2.1.1"><xref derivedContent="A.1" format="counter" sectionFormat="of" target="section-a.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-initial-enrollment">Initial Enrollment</xref></t>
              </li>
              <li pn="section-toc.1-1.12.2.2">
                <t keepWithNext="true" pn="section-toc.1-1.12.2.2.1"><xref derivedContent="A.2" format="counter" sectionFormat="of" target="section-a.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rekey">Rekey</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.13">
            <t keepWithNext="true" pn="section-toc.1-1.13.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="intro" numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t pn="section-1-1">This document specifies a profile of the Certificate Management over CMS (CMC) protocol to comply with the United States National Security Agency's Commercial National Security Algorithm (CNSA) Suite <xref target="CNSA" format="default" sectionFormat="of" derivedContent="CNSA"/>. The profile applies to the capabilities, configuration, and operation of all components of US National Security Systems <xref target="SP80059" format="default" sectionFormat="of" derivedContent="SP80059"/>. It is also appropriate for all other US Government systems that process high-value information. It is made publicly available for use by developers and operators of these and any other system deployments.
</t>
      <t pn="section-1-2">This document does not define any new cryptographic algorithm suites; instead, it defines a CNSA-compliant profile of CMC. CMC is defined in <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/>, <xref target="RFC5273" format="default" sectionFormat="of" derivedContent="RFC5273"/>, and <xref target="RFC5274" format="default" sectionFormat="of" derivedContent="RFC5274"/> and is updated by <xref target="RFC6402" format="default" sectionFormat="of" derivedContent="RFC6402"/>. This document profiles CMC to manage X.509 public key certificates in compliance with the CNSA Suite Certificate and Certificate Revocation List (CRL) profile <xref target="RFC8603" format="default" sectionFormat="of" derivedContent="RFC8603"/>. This document specifically focuses on defining CMC interactions for both the initial enrollment and rekey of CNSA Suite public key certificates between a client and a Certification Authority (CA).  One or more Registration Authorities (RAs) may act as intermediaries between the client and the CA.  This profile may be further tailored by specific communities to meet their needs.  Specific communities will also define certificate policies that implementations need to comply with.
</t>
      <section anchor="terms" numbered="true" toc="include" removeInRFC="false" pn="section-1.1">
        <name slugifiedName="name-terminology">Terminology</name>
        <t pn="section-1.1-1">The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>", "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> when, and only when, they appear in all capitals, as shown here.
</t>
        <t pn="section-1.1-2">The terminology in <xref target="RFC5272" sectionFormat="comma" section="2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5272#section-2.1" derivedContent="RFC5272"/> applies to this profile.</t>
        <t pn="section-1.1-3">The term "certificate request" is used to refer to a single PKCS #10
      or  Certificate Request Message Format (CRMF) structure. All PKI Requests are Full PKI Requests, and all PKI Responses are Full PKI Responses; the respective set of terms should be interpreted synonymously in this document.</t>
      </section>
    </section>
    <section anchor="cnsa" numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-the-commercial-national-sec">The Commercial National Security Algorithm Suite</name>
      <t pn="section-2-1">The National Security Agency (NSA) profiles commercial cryptographic algorithms and protocols as part of its mission to support secure, interoperable communications for US Government National Security Systems. To this end, it publishes guidance both to assist with the US Government transition to new algorithms and to provide vendors -- and the Internet community in general -- with information concerning their proper use and configuration within the scope of US Government National Security Systems.</t>
      <t pn="section-2-2">Recently, cryptographic transition plans have become overshadowed by
      the prospect of the development of a cryptographically relevant quantum
      computer. The NSA has established the Commercial National Security
      Algorithm (CNSA) Suite to provide vendors and IT users near-term
      flexibility in meeting their cybersecurity interoperability
      requirements. The purpose behind this flexibility is to avoid having vendors and customers make two major transitions in a relatively short timeframe, as we anticipate a need to shift to quantum-resistant cryptography in the near future.</t>
      <t pn="section-2-3">The NSA is authoring a set of RFCs, including this one, to provide updated guidance concerning the use of certain commonly available commercial algorithms in IETF protocols. These RFCs can be used in conjunction with other RFCs and cryptographic guidance (e.g., NIST Special Publications) to properly protect Internet traffic and data-at-rest for US Government National Security Systems.</t>
    </section>
    <section anchor="reqts" numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-requirements-and-assumption">Requirements and Assumptions</name>
      <t pn="section-3-1">Elliptic Curve Digital Signature Algorithm (ECDSA) and Elliptic Curve
      Diffie-Hellman (ECDH) key pairs are on the P-384 curve.  FIPS 186-4 <xref target="FIPS186" format="default" sectionFormat="of" derivedContent="FIPS186"/>, Appendix B.4 provides useful guidance for elliptic curve key pair generation that <bcp14>SHOULD</bcp14> be followed by systems that conform to this document.</t>
      <t pn="section-3-2">RSA key pairs (public, private) are identified by the modulus size expressed in bits; RSA-3072 and RSA-4096 are computed using moduli of 3072 bits and 4096 bits, respectively.</t>
      <t pn="section-3-3">RSA signature key pairs used in CNSA Suite-compliant implementations are either RSA-3072 or RSA-4096. The RSA exponent e <bcp14>MUST</bcp14> satisfy 2<sup>16</sup> &lt; e &lt; 2<sup>256</sup> and be odd per <xref target="FIPS186" format="default" sectionFormat="of" derivedContent="FIPS186"/>.
</t>
      <t pn="section-3-4">It is recognized that, while the vast majority of RSA signatures are currently made using the RSASSA-PKCS1-v1_5 algorithm, the preferred RSA signature scheme for new applications is RSASSA-PSS.  CNSA Suite-compliant X.509 certificates will be issued in accordance with <xref target="RFC8603" format="default" sectionFormat="of" derivedContent="RFC8603"/>, and while those certificates must be signed and validated using RSASSA-PKCS1-v1_5, the subject's private key can be used to generate signatures of either signing scheme.  Where use of RSASSA-PSS is indicated in this document, the following parameters apply:

</t>
      <ul spacing="normal" bare="false" empty="false" pn="section-3-5">
        <li pn="section-3-5.1">The hash algorithm <bcp14>MUST</bcp14> be id-sha384 as defined in <xref target="RFC8017" format="default" sectionFormat="of" derivedContent="RFC8017"/>;</li>
        <li pn="section-3-5.2">The mask generation function <bcp14>MUST</bcp14> use the algorithm identifier mfg1SHA384Identifier as defined in <xref target="RFC4055" format="default" sectionFormat="of" derivedContent="RFC4055"/>;</li>
        <li pn="section-3-5.3">The salt length <bcp14>MUST</bcp14> be 48 octets; and</li>
        <li pn="section-3-5.4">The trailerField <bcp14>MUST</bcp14> have value 1.</li>
      </ul>
      <t pn="section-3-6">

These parameters will not appear in a certificate and <bcp14>MUST</bcp14> be securely
      communicated with the signature, as required by <xref target="RFC4056" sectionFormat="of" section="2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4056#section-2.2" derivedContent="RFC4056"/>. Application developers are obliged to ensure that the chosen signature scheme is appropriate for the application and will be interoperable within the intended operating scope of the application.</t>
      <t pn="section-3-7">This document assumes that the required trust anchors have been securely provisioned to the client and, when applicable, to any RAs.</t>
      <t pn="section-3-8">All requirements in <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/>, <xref target="RFC5273" format="default" sectionFormat="of" derivedContent="RFC5273"/>, <xref target="RFC5274" format="default" sectionFormat="of" derivedContent="RFC5274"/>, and <xref target="RFC6402" format="default" sectionFormat="of" derivedContent="RFC6402"/> apply, except where overridden by this profile.</t>
      <t pn="section-3-9">This profile was developed with the scenarios described in <xref target="scenarios" format="default" sectionFormat="of" derivedContent="Appendix A"/> in mind.  However, use of this profile is not limited to just those scenarios.</t>
      <t pn="section-3-10">The term "client" in this profile typically refers to an end-entity. However, it may instead refer to a third party acting on the end-entity's behalf.  The client may or may not be the entity that actually generates the key pair, but it does perform the CMC protocol interactions with the RA and/or CA.  For example, the client may be a token management system that communicates with a cryptographic token through an out-of-band secure protocol.</t>
      <t pn="section-3-11">This profile uses the term "rekey" in the same manner as CMC does (defined in <xref target="RFC5272" sectionFormat="of" section="2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5272#section-2" derivedContent="RFC5272"/>).  The profile makes no specific statements about the ability to do "renewal" operations; however, the statements applicable to "rekey" should be applied to "renewal" as well.</t>
      <t pn="section-3-12">This profile may be used to manage RA and/or CA certificates.  In that case, the RA and/or CA whose certificate is being managed is considered to be the end-entity.</t>
      <t pn="section-3-13">This profile does not discuss key establishment certification requests from cryptographic modules that cannot generate a one-time signature with a key establishment key for proof-of-possession purposes.  In that case, a separate profile would be needed to define the use of another proof-of-possession technique.</t>
    </section>
    <section anchor="client-reqts-gen" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-client-requirements-generat">Client Requirements: Generating PKI Requests</name>
      <t pn="section-4-1">This section specifies the conventions employed when a client requests a certificate from a Public Key Infrastructure (PKI).
</t>
      <t pn="section-4-2">The Full PKI Request <bcp14>MUST</bcp14> be used; it <bcp14>MUST</bcp14> be encapsulated in a SignedData; and the SignedData <bcp14>MUST</bcp14> be constructed in accordance with <xref target="RFC8755" format="default" sectionFormat="of" derivedContent="RFC8755"/>. The PKIData content type defined in <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/> is used with the following additional requirements:
</t>
      <ul spacing="normal" bare="false" empty="false" pn="section-4-3">
        <li pn="section-4-3.1">
          <t pn="section-4-3.1.1">controlSequence <bcp14>SHOULD</bcp14> be present.
          </t>
          <ul spacing="normal" bare="false" empty="false" pn="section-4-3.1.2">
            <li pn="section-4-3.1.2.1">TransactionId and SenderNonce <bcp14>SHOULD</bcp14> be included. Other CMC controls <bcp14>MAY</bcp14> be included.</li>
            <li pn="section-4-3.1.2.2">
              <t pn="section-4-3.1.2.2.1">If the request is being authenticated using a shared-secret, then Identity Proof Version 2 control <bcp14>MUST</bcp14> be included with the following constraints:
              </t>
              <ul spacing="normal" bare="false" empty="false" pn="section-4-3.1.2.2.2">
                <li pn="section-4-3.1.2.2.2.1">hashAlgId <bcp14>MUST</bcp14> be id-sha384 for all certification requests (algorithm OIDs are defined in <xref target="RFC5754" format="default" sectionFormat="of" derivedContent="RFC5754"/>).</li>
                <li pn="section-4-3.1.2.2.2.2">macAlgId <bcp14>MUST</bcp14> be HMAC-SHA384 (the Hashed
		Message Authentication Code (HMAC) algorithm is defined in <xref target="RFC4231" format="default" sectionFormat="of" derivedContent="RFC4231"/>).</li>
              </ul>
            </li>
            <li pn="section-4-3.1.2.3">If the subject name included in the certification request is NULL
	    or otherwise does not uniquely identify the end-entity, then the
	    POP Link Random control <bcp14>MUST</bcp14> be included, and the
	    POP Link Witness Version 2 control <bcp14>MUST</bcp14> be included
	    in the inner PKCS #10 <xref target="RFC2986" format="default" sectionFormat="of" derivedContent="RFC2986"/> or
	    Certificate Request Message Format (CRMF) <xref target="RFC4211" format="default" sectionFormat="of" derivedContent="RFC4211"/> request as described in Sections <xref target="tgd-cert-reqst" format="counter" sectionFormat="of" derivedContent="4.1"/> and <xref target="cert-reqst-msg" format="counter" sectionFormat="of" derivedContent="4.2"/>.
      </li>
          </ul>
        </li>
        <li pn="section-4-3.2">reqSequence <bcp14>MUST</bcp14> be present.  It <bcp14>MUST</bcp14> include at least one tcr (see <xref target="tgd-cert-reqst" format="default" sectionFormat="of" derivedContent="Section 4.1"/>) or crm (see <xref target="cert-reqst-msg" format="default" sectionFormat="of" derivedContent="Section 4.2"/>) TaggedRequest. Support for the orm choice is <bcp14>OPTIONAL</bcp14>.
   </li>
      </ul>
      <t pn="section-4-4">The private signing key used to generate the encapsulating SignedData <bcp14>MUST</bcp14> correspond to the public key of an existing signature certificate unless an appropriate signature certificate does not yet exist, such as during initial enrollment.</t>
      <t pn="section-4-5">The encapsulating SignedData <bcp14>MUST</bcp14> be generated using SHA-384 and either ECDSA on P-384 or RSA using either RSASSA-PKCS1-v1_5 or RSASSA-PSS with an RSA-3072 or RSA-4096 key.</t>
      <t pn="section-4-6">If an appropriate signature certificate does not yet exist and if a Full PKI Request includes one or more certification requests and is authenticated using a shared-secret (because no appropriate certificate exists yet to authenticate the request), the Full PKI Request <bcp14>MUST</bcp14> be signed using the private key corresponding to the public key of one of the requested certificates.  When necessary (i.e., because there is no existing signature certificate and there is no signature certification request included), a Full PKI Request <bcp14>MAY</bcp14> be signed using a key pair intended for use in a key establishment certificate.  However, servers are not required to allow this behavior.</t>
      <section anchor="tgd-cert-reqst" numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-tagged-certification-reques">Tagged Certification Request</name>
        <t pn="section-4.1-1">The reqSequence tcr choice conveys PKCS #10 <xref target="RFC2986" format="default" sectionFormat="of" derivedContent="RFC2986"/> syntax.  The CertificateRequest <bcp14>MUST</bcp14>
	comply with <xref target="RFC5272" sectionFormat="comma" section="3.2.1.2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5272#section-3.2.1.2.1" derivedContent="RFC5272"/>, with the following additional requirements:

        </t>
        <ul spacing="normal" bare="false" empty="false" pn="section-4.1-2">
          <li pn="section-4.1-2.1">
            <t pn="section-4.1-2.1.1">certificationRequestInfo:

            </t>
            <ul spacing="normal" bare="false" empty="false" pn="section-4.1-2.1.2">
              <li pn="section-4.1-2.1.2.1">subjectPublicKeyInfo <bcp14>MUST</bcp14> be set as defined in <xref target="RFC8603" sectionFormat="of" section="5.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8603#section-5.4" derivedContent="RFC8603"/>.</li>
              <li pn="section-4.1-2.1.2.2">
                <t pn="section-4.1-2.1.2.2.1">Attributes:

                </t>
                <ul spacing="normal" bare="false" empty="false" pn="section-4.1-2.1.2.2.2">
                  <li pn="section-4.1-2.1.2.2.2.1">
                    <t pn="section-4.1-2.1.2.2.2.1.1">The ExtensionReq attribute <bcp14>MUST</bcp14> be included with its contents as follows:

                    </t>
                    <ul spacing="normal" bare="false" empty="false" pn="section-4.1-2.1.2.2.2.1.2">
                      <li pn="section-4.1-2.1.2.2.2.1.2.1">The keyUsage extension <bcp14>MUST</bcp14> be included, and it <bcp14>MUST</bcp14> be set as defined in <xref target="RFC8603" format="default" sectionFormat="of" derivedContent="RFC8603"/>.</li>
                      <li pn="section-4.1-2.1.2.2.2.1.2.2">For rekey requests, the SubjectAltName extension <bcp14>MUST</bcp14> be included and set equal to the SubjectAltName of the certificate that is being used to sign the SignedData encapsulating the request (i.e., not the certificate being rekeyed) if the subject field of the certificate being used to generate the signature is NULL.</li>
                      <li pn="section-4.1-2.1.2.2.2.1.2.3">Other extension requests <bcp14>MAY</bcp14> be included as desired.</li>
                    </ul>
                  </li>
                  <li pn="section-4.1-2.1.2.2.2.2">The ChangeSubjectName attribute, as defined in <xref target="RFC6402" format="default" sectionFormat="of" derivedContent="RFC6402"/>, <bcp14>MUST</bcp14> be included if the Full PKI Request encapsulating this Tagged Certification Request is being signed by a key for which a certificate currently exists and the existing certificate's subject field or SubjectAltName extension does not match the desired subject name or SubjectAltName extension of this certification request.</li>
                  <li pn="section-4.1-2.1.2.2.2.3">The POP Link Witness Version 2 attribute <bcp14>MUST</bcp14> be included if the request is being authenticated using a shared-secret and the subject name in the certification request is NULL or otherwise does not uniquely identify the end-entity.  In the POP Link Witness Version 2 attribute, keyGenAlgorithm <bcp14>MUST</bcp14> be id-sha384 for certification requests, as defined in <xref target="RFC5754" format="default" sectionFormat="of" derivedContent="RFC5754"/>; macAlgorithm <bcp14>MUST</bcp14> be HMAC-SHA384, as defined in <xref target="RFC4231" format="default" sectionFormat="of" derivedContent="RFC4231"/>.</li>
                </ul>
              </li>
              <li pn="section-4.1-2.1.2.3">signatureAlgorithm <bcp14>MUST</bcp14> be ecdsa-with-sha384 for P-384 certification requests and sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096 certification requests.</li>
              <li pn="section-4.1-2.1.2.4">signature <bcp14>MUST</bcp14> be generated using the private key corresponding to the public key in the CertificationRequestInfo for both signature and key establishment certification requests.  The signature provides proof-of-possession of the private key to the CA.</li>
            </ul>
          </li>
        </ul>
      </section>
      <section anchor="cert-reqst-msg" numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-certificate-request-message">Certificate Request Message</name>
        <t pn="section-4.2-1">The reqSequence crm choice conveys Certificate Request Message
	Format (CRMF) <xref target="RFC4211" format="default" sectionFormat="of" derivedContent="RFC4211"/>
	syntax.  The CertReqMsg <bcp14>MUST</bcp14> comply with <xref target="RFC5272" sectionFormat="comma" section="3.2.1.2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2" derivedContent="RFC5272"/>, with the following additional requirements:

        </t>
        <ul spacing="normal" bare="false" empty="false" pn="section-4.2-2">
          <li pn="section-4.2-2.1">popo <bcp14>MUST</bcp14> be included using the signature (POPOSigningKey)
	  proof-of-possession choice and be set as defined in <xref target="RFC4211" sectionFormat="comma" section="4.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4211#section-4.1" derivedContent="RFC4211"/> for both signature and key establishment certification requests. The POPOSigningKey poposkInput field <bcp14>MUST</bcp14> be omitted.  The POPOSigningKey algorithmIdentifier <bcp14>MUST</bcp14> be ecdsa-with-sha384 for P-384 certification requests and sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096 certification requests.  The signature <bcp14>MUST</bcp14> be generated using the private key corresponding to the public key in the CertTemplate.</li>
        </ul>
        <t pn="section-4.2-3">The CertTemplate <bcp14>MUST</bcp14> comply with <xref target="RFC5272" sectionFormat="comma" section="3.2.1.2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2" derivedContent="RFC5272"/>, with the following additional requirements:
</t>
        <ul spacing="normal" bare="false" empty="false" pn="section-4.2-4">
          <li pn="section-4.2-4.1">If version is included, it <bcp14>MUST</bcp14> be set to 2 as defined in
	  <xref target="RFC8603" sectionFormat="of" section="5.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8603#section-5.3" derivedContent="RFC8603"/>.</li>
          <li pn="section-4.2-4.2">publicKey <bcp14>MUST</bcp14> be set as defined in <xref target="RFC8603" sectionFormat="of" section="5.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8603#section-5.4" derivedContent="RFC8603"/>.</li>
          <li pn="section-4.2-4.3">
            <t pn="section-4.2-4.3.1">Extensions:</t>
            <ul spacing="normal" bare="false" empty="false" pn="section-4.2-4.3.2">
              <li pn="section-4.2-4.3.2.1">The keyUsage extension <bcp14>MUST</bcp14> be included, and it <bcp14>MUST</bcp14> be set as defined in <xref target="RFC8603" format="default" sectionFormat="of" derivedContent="RFC8603"/>.</li>
              <li pn="section-4.2-4.3.2.2">For rekey requests, the SubjectAltName extension <bcp14>MUST</bcp14> be included and set equal to the SubjectAltName of the certificate that is being used to sign the SignedData encapsulating the request (i.e., not the certificate being rekeyed) if the subject name of the certificate being used to generate the signature is NULL.</li>
              <li pn="section-4.2-4.3.2.3">Other extension requests <bcp14>MAY</bcp14> be included as desired.</li>
            </ul>
          </li>
          <li pn="section-4.2-4.4">
            <t pn="section-4.2-4.4.1">Controls:

            </t>
            <ul spacing="normal" bare="false" empty="false" pn="section-4.2-4.4.2">
              <li pn="section-4.2-4.4.2.1">The ChangeSubjectName attribute, as defined in <xref target="RFC6402" format="default" sectionFormat="of" derivedContent="RFC6402"/>, <bcp14>MUST</bcp14> be included if the Full PKI Request encapsulating this Tagged Certification Request is being signed by a key for which a certificate currently exists and the existing certificate's subject name or SubjectAltName extension does not match the desired subject name or SubjectAltName extension of this certification request.</li>
              <li pn="section-4.2-4.4.2.2">The POP Link Witness Version 2 attribute <bcp14>MUST</bcp14> be included if the request is being authenticated using a shared-secret and the subject name in the certification request is NULL or otherwise does not uniquely identify the end-entity.  In the POP Link Witness Version 2 attribute, keyGenAlgorithm <bcp14>MUST</bcp14> be id-sha384 for certification requests; macAlgorithm <bcp14>MUST</bcp14> be HMAC-SHA384 when keyGenAlgorithm is id-sha384.</li>
            </ul>
          </li>
        </ul>
      </section>
    </section>
    <section anchor="ra_reqts" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-ra-requirements">RA Requirements</name>
      <t pn="section-5-1">This section addresses the optional case where one or more RAs act as
      intermediaries between clients and a CA as described in <xref target="RFC5272" sectionFormat="of" section="7" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5272#section-7" derivedContent="RFC5272"/>.  In this section, the term "client" refers to the entity from which the RA received the PKI Request. This section is only applicable to RAs.</t>
      <section anchor="ra-proc-reqst" numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-ra-processing-of-requests">RA Processing of Requests</name>
        <t pn="section-5.1-1">RAs conforming to this document <bcp14>MUST</bcp14> ensure that only the permitted signature, hash, and MAC algorithms described throughout this profile are used in requests; if they are not, the RA <bcp14>MUST</bcp14> reject those requests.  The RA <bcp14>SHOULD</bcp14> return a CMCFailInfo with the value of badAlg <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/>.</t>
        <t pn="section-5.1-2">When processing end-entity-generated SignedData objects, RAs <bcp14>MUST NOT</bcp14> perform Cryptographic Message Syntax (CMS) Content Constraints (CCC) certificate extension processing <xref target="RFC6010" format="default" sectionFormat="of" derivedContent="RFC6010"/>.</t>
        <t pn="section-5.1-3">Other RA processing is performed as described in <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/>.</t>
      </section>
      <section anchor="ra-gend-pki-reqst" numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-ra-generated-pki-requests">RA-Generated PKI Requests</name>
        <t pn="section-5.2-1">RAs mediate the certificate request process by collecting client requests in batches. The RA <bcp14>MUST</bcp14> encapsulate client-generated PKI Requests in a new RA-signed PKI Request, it <bcp14>MUST</bcp14> create a Full PKI Request encapsulated in a SignedData, and the SignedData <bcp14>MUST</bcp14> be constructed in accordance with <xref target="RFC8755" format="default" sectionFormat="of" derivedContent="RFC8755"/>.  The PKIData content type complies with <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/> with the following additional requirements:

        </t>
        <ul spacing="normal" bare="false" empty="false" pn="section-5.2-2">
          <li pn="section-5.2-2.1">controlSequence <bcp14>MUST</bcp14> be present. It
	  <bcp14>MUST</bcp14> include the following CMC controls: Transaction
	  ID, Sender Nonce, and Batch Requests. Other appropriate CMC controls
	  <bcp14>MAY</bcp14> be included.</li>
          <li pn="section-5.2-2.2">cmsSequence <bcp14>MUST</bcp14> be present.  It contains the original, unmodified request(s) received from the client.</li>
        </ul>
        <sourcecode name="" type="" markers="false" pn="section-5.2-3">
      SignedData (applied by the RA)
        PKIData
          controlSequence (Transaction ID, Sender Nonce,
                                               Batch Requests)
          cmsSequence
            SignedData (applied by client)
              PKIData
                controlSequence (Transaction ID, Sender Nonce)
                reqSequence
                  TaggedRequest
                  {TaggedRequest}
            {SignedData     (second client request)
              PKIData...}
</sourcecode>
        <t pn="section-5.2-4">Authorization to sign RA-generated Full PKI Requests
	<bcp14>SHOULD</bcp14> be indicated in the RA certificate by inclusion
	of the id-kp-cmcRA Extended Key Usage (EKU) from <xref target="RFC6402" format="default" sectionFormat="of" derivedContent="RFC6402"/>. The RA certificate <bcp14>MAY</bcp14> also include
	the CCC certificate extension <xref target="RFC6010" format="default" sectionFormat="of" derivedContent="RFC6010"/>, or it <bcp14>MAY</bcp14> indicate authorization
	through inclusion of the CCC certificate extension alone. The RA
	certificate may also be authorized through the local configuration.</t>
        <t pn="section-5.2-5">If the RA is authorized via the CCC extension, then the CCC extension <bcp14>MUST</bcp14> include the object identifier for the PKIData content type. CCC <bcp14>SHOULD</bcp14> be included if constraints are to be placed on the content types generated.</t>
        <t pn="section-5.2-6">The outer SignedData <bcp14>MUST</bcp14> be generated using SHA-384 and either ECDSA on P-384 or RSA using RSASSA-PKCS1-v1_5 or RSASSA-PSS with an RSA-3072 or RSA-4096 key.
</t>
        <t pn="section-5.2-7">If the Full PKI Response is a successful response to a PKI Request that only contained a Get Certificate or Get CRL control, then the algorithm used in the response <bcp14>MUST</bcp14> match the algorithm used in the request.
</t>
      </section>
      <section anchor="ra-gend-resp" numbered="true" toc="include" removeInRFC="false" pn="section-5.3">
        <name slugifiedName="name-ra-generated-pki-responses">RA-Generated PKI Responses</name>
        <t pn="section-5.3-1">In order for an RA certificate using the CCC certificate extension to be authorized to generate responses, the object identifier for the PKIResponse content type must be present in the CCC certificate extension.</t>
      </section>
    </section>
    <section anchor="ca-reqts" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-ca-requirements">CA Requirements</name>
      <t pn="section-6-1">This section specifies the requirements for CAs that receive PKI Requests and generate PKI Responses.</t>
      <section anchor="ca-proc-reqst" numbered="true" toc="include" removeInRFC="false" pn="section-6.1">
        <name slugifiedName="name-ca-processing-of-pki-reques">CA Processing of PKI Requests</name>
        <t pn="section-6.1-1">CAs conforming to this document <bcp14>MUST</bcp14> ensure that
	only the permitted signature, hash, and MAC algorithms described
	throughout this profile are used in requests; if they are not, the CA
	<bcp14>MUST</bcp14> reject those requests.  The CA
	<bcp14>SHOULD</bcp14> return a CMCStatusInfoV2 control with a CMCStatus of failed and a CMCFailInfo with the value of badAlg <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/>.</t>
        <t pn="section-6.1-2">For requests involving an RA (i.e., batched requests), the CA
	<bcp14>MUST</bcp14> verify the RA's authorization.  The following
	certificate fields <bcp14>MUST NOT</bcp14> be modifiable using the
	Modify Certification Request control: publicKey and the keyUsage
	extension.  The request <bcp14>MUST</bcp14> be rejected if an attempt
	to modify those certification request fields is present.  The CA
	<bcp14>SHOULD</bcp14> return a CMCStatusInfoV2 control with a CMCStatus of failed and a CMCFailInfo with a value of badRequest.</t>
        <t pn="section-6.1-3">When processing end-entity-generated SignedData objects, CAs <bcp14>MUST NOT</bcp14> perform CCC certificate extension processing <xref target="RFC6010" format="default" sectionFormat="of" derivedContent="RFC6010"/>.</t>
        <t pn="section-6.1-4">If a client-generated PKI Request includes the ChangeSubjectName
	attribute as described in <xref target="tgd-cert-reqst" format="default" sectionFormat="of" derivedContent="Section 4.1"/> or <xref target="cert-reqst-msg" format="counter" sectionFormat="of" derivedContent="4.2"/>
	above, the CA <bcp14>MUST</bcp14> ensure that name change is
	authorized. The mechanism for ensuring that the name change is
	authorized is out of scope.  A CA that performs this check and finds
	that the name change is not authorized <bcp14>MUST</bcp14> reject the
	PKI Request. The CA <bcp14>SHOULD</bcp14> return an Extended CMC
	Status Info control (CMCStatusInfoV2) with a CMCStatus of failed.</t>
        <t pn="section-6.1-5">Other processing of PKIRequests is performed as described in <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/>.</t>
      </section>
      <section anchor="ca-gend-resp" numbered="true" toc="include" removeInRFC="false" pn="section-6.2">
        <name slugifiedName="name-ca-generated-pki-responses">CA-Generated PKI Responses</name>
        <t pn="section-6.2-1">CAs send PKI Responses to both client-generated requests and RA-generated requests. If a Full PKI Response is returned in direct response to a client-generated request, it <bcp14>MUST</bcp14> be encapsulated in a SignedData, and the SignedData <bcp14>MUST</bcp14> be constructed in accordance with <xref target="RFC8755" format="default" sectionFormat="of" derivedContent="RFC8755"/>.</t>
        <t pn="section-6.2-2">If the PKI Response is in response to an RA-generated PKI Request, then the above PKI Response is encapsulated in another CA-generated PKI Response.  That PKI Response <bcp14>MUST</bcp14> be encapsulated in a SignedData, and the SignedData <bcp14>MUST</bcp14> be constructed in accordance with <xref target="RFC8755" format="default" sectionFormat="of" derivedContent="RFC8755"/>.  The above PKI Response is placed in the encapsulating PKI Response cmsSequence field.  The other fields are as above with the addition of the batch response control in controlSequence.  The following illustrates a successful CA response to an RA-encapsulated PKI Request, both of which include Transaction IDs and Nonces:</t>
        <sourcecode name="" type="" markers="false" pn="section-6.2-3">
      SignedData (applied by the CA)
        PKIResponse
          controlSequence (Transaction ID, Sender Nonce, Recipient
                           Nonce, Batch Response)
          cmsSequence
            SignedData (applied by CA and includes returned
                        certificates)
              PKIResponse
                controlSequence (Transaction ID, Sender Nonce,
                                 Recipient Nonce)
</sourcecode>
        <t pn="section-6.2-4">The same private key used to sign certificates <bcp14>MUST NOT</bcp14> be used to sign Full PKI Response messages.  Instead, a separate certificate indicating authorization to sign CMC responses <bcp14>MUST</bcp14> be used.</t>
        <t pn="section-6.2-5">Authorization to sign Full PKI Responses <bcp14>SHOULD</bcp14> be indicated in the CA certificate by inclusion of the id-kp-cmcCA EKU from <xref target="RFC6402" format="default" sectionFormat="of" derivedContent="RFC6402"/>. The CA certificate <bcp14>MAY</bcp14> also include the CCC certificate extension <xref target="RFC6010" format="default" sectionFormat="of" derivedContent="RFC6010"/>, or it <bcp14>MAY</bcp14> indicate authorization through inclusion of the CCC certificate extension alone. The CA certificate may also be authorized through local configuration.</t>
        <t pn="section-6.2-6">In order for a CA certificate using the CCC certificate extension to be authorized to generate responses, the object identifier for the PKIResponse content type must be present in the CCC certificate extension. CCC <bcp14>SHOULD</bcp14> be included if constraints are to be placed on the content types generated.</t>
        <t pn="section-6.2-7">Signatures applied to individual certificates are as required in <xref target="RFC8603" format="default" sectionFormat="of" derivedContent="RFC8603"/>.</t>
        <t pn="section-6.2-8">The signature on the SignedData of a successful response to a
	client-generated request, or each individual inner SignedData on the
	successful response to an RA-generated request, <bcp14>MUST</bcp14> be
	generated using SHA-384 and either ECDSA on P-384 or RSA using
	RSASSA-PKCS1-v1_5 or RSASSA-PSS with an RSA-3072 or RSA-4096 key. An
	unsuccessful response <bcp14>MUST</bcp14> be signed using the same key
	type and algorithm that signed the request.</t>
        <t pn="section-6.2-9">The outer SignedData on the Full PKI Response to any RA-generated
	PKI Request <bcp14>MUST</bcp14> be signed with the same key type and algorithm that signed the request.</t>
        <t pn="section-6.2-10">The SignedData on a successful Full PKI Response to a PKI Request
	that only contained a Get Certificate or Get CRL control
	<bcp14>MUST</bcp14> be signed with the same key type and algorithm that signed the request.</t>
      </section>
    </section>
    <section anchor="client-reqts-proc" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-client-requirements-process">Client Requirements: Processing PKI Responses</name>
      <t pn="section-7-1">Clients conforming to this document <bcp14>MUST</bcp14> ensure that only the permitted signature, hash, and MAC algorithms described throughout this profile are used in responses; if they are not, the client <bcp14>MUST</bcp14> reject those responses.</t>
      <t pn="section-7-2">Clients <bcp14>MUST</bcp14> authenticate all Full PKI Responses.  This includes verifying that the PKI Response is signed by an authorized CA or RA whose certificate validates back to a trust anchor.  The authorized CA certificate <bcp14>MUST</bcp14> include the id-kp-cmcCA EKU and/or a CCC extension that includes the object identifier for the PKIResponse content type.  Otherwise, the CA is determined to be authorized to sign responses through an implementation-specific mechanism.  The PKI Response can be signed by an RA if it is an error message, if it is a response to a Get Certificate or Get CRL request, or if the PKI Response contains an inner PKI Response signed by a CA.  In the last case, each layer of PKI Response <bcp14>MUST</bcp14> still contain an authorized, valid signature signed by an entity with a valid certificate that verifies back to an acceptable trust anchor.  The authorized RA certificate <bcp14>MUST</bcp14> include the id-kp-cmcRA EKU and/or include a CCC extension that includes the object identifier for the PKIResponse content type.  Otherwise, the RA is determined to be authorized to sign responses through local configuration.</t>
      <t pn="section-7-3">When a newly issued certificate is included in the PKI Response, the client <bcp14>MUST</bcp14> verify that the newly issued certificate's public key matches the public key that the client requested.  The client <bcp14>MUST</bcp14> also ensure that the certificate's signature is valid and that the signature validates back to an acceptable trust anchor.</t>
      <t pn="section-7-4">Clients <bcp14>MUST</bcp14> reject PKI Responses that do not pass
      these tests. Local policy will determine whether the client returns a
      Full PKI Response with an Extended CMC Status Info control
      (CMCStatusInfoV2) with the CMCStatus set to failed to a user console, error log, or the server.</t>
      <t pn="section-7-5">If the Full PKI Response contains an Extended CMC Status Info control with a CMCStatus set to failed, then local policy will determine whether the client resends a duplicate certification request back to the server or an error state is returned to a console or error log.</t>
    </section>
    <section anchor="shared-secrets" numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-shared-secrets">Shared-Secrets</name>
      <t pn="section-8-1">When the Identity Proof V2 and POP Link Witness V2 controls are used, the shared-secret <bcp14>MUST</bcp14> be randomly generated and securely distributed.  The shared-secret <bcp14>MUST</bcp14> provide at least 192 bits of strength.</t>
    </section>
    <section anchor="sec-considerations" numbered="true" toc="include" removeInRFC="false" pn="section-9">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t pn="section-9-1">Protocol security considerations are found in <xref target="RFC2986" format="default" sectionFormat="of" derivedContent="RFC2986"/>, <xref target="RFC4211" format="default" sectionFormat="of" derivedContent="RFC4211"/>, <xref target="RFC8755" format="default" sectionFormat="of" derivedContent="RFC8755"/>, <xref target="RFC5272" format="default" sectionFormat="of" derivedContent="RFC5272"/>, <xref target="RFC5273" format="default" sectionFormat="of" derivedContent="RFC5273"/>, <xref target="RFC5274" format="default" sectionFormat="of" derivedContent="RFC5274"/>, <xref target="RFC8603" format="default" sectionFormat="of" derivedContent="RFC8603"/>, and <xref target="RFC6402" format="default" sectionFormat="of" derivedContent="RFC6402"/>. When CCC is used to authorize RA and CA certificates, then the security considerations in <xref target="RFC6010" format="default" sectionFormat="of" derivedContent="RFC6010"/> also apply.  Algorithm security considerations are found in <xref target="RFC8755" format="default" sectionFormat="of" derivedContent="RFC8755"/>.</t>
      <t pn="section-9-2">Compliant with NIST Special Publication 800-57 <xref target="SP80057" format="default" sectionFormat="of" derivedContent="SP80057"/>, this profile defines proof-of-possession of a key establishment private key by performing a digital signature.  Except for one-time proof-of-possession, a single key pair <bcp14>MUST NOT</bcp14> be used for both signature and key establishment.</t>
      <t pn="section-9-3">This specification requires implementations to generate key pairs and other random values.  The use of inadequate pseudorandom number generators (PRNGs) can result in little or no security.  The generation of quality random numbers is difficult.  NIST Special Publication 800-90A <xref target="SP80090A" format="default" sectionFormat="of" derivedContent="SP80090A"/>, FIPS 186-3 <xref target="FIPS186" format="default" sectionFormat="of" derivedContent="FIPS186"/>, and <xref target="RFC4086" format="default" sectionFormat="of" derivedContent="RFC4086"/> offer random number generation guidance.</t>
      <t pn="section-9-4">When RAs are used, the list of authorized RAs <bcp14>MUST</bcp14> be
      securely distributed out of band to CAs.</t>
      <t pn="section-9-5">Presence of the POP Link Witness Version 2 and POP Link Random attributes protects against substitution attacks.</t>
      <t pn="section-9-6">The certificate policy for a particular environment will specify whether expired certificates can be used to sign certification requests.</t>
    </section>
    <section anchor="iana-considerations" numbered="true" toc="include" removeInRFC="false" pn="section-10">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t pn="section-10-1">This document has no IANA actions.</t>
    </section>
  </middle>
  <back>
    <references pn="section-11">
      <name slugifiedName="name-references">References</name>
      <references pn="section-11.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="CNSA" target="https://www.cnss.gov/CNSS/issuances/Policies.cfm" quoteTitle="true" derivedAnchor="CNSA">
          <front>
            <title>Use of Public Standards for Secure Information Sharing</title>
            <seriesInfo name="CNSS Policy" value="15"/>
            <author>
              <organization showOnFrontPage="true">Committee on National Security Systems</organization>
            </author>
            <date month="October" year="2016"/>
          </front>
        </reference>
        <reference anchor="FIPS186" target="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf" quoteTitle="true" derivedAnchor="FIPS186">
          <front>
            <title>Digital Signature Standard (DSS)</title>
            <seriesInfo name="DOI" value="10.6028/NIST.FIPS.186-4"/>
            <seriesInfo name="FIPS PUB" value="186-4"/>
            <author>
              <organization showOnFrontPage="true">National Institute of Standards and Technology</organization>
            </author>
            <date month="July" year="2013"/>
          </front>
        </reference>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC2986" target="https://www.rfc-editor.org/info/rfc2986" quoteTitle="true" derivedAnchor="RFC2986">
          <front>
            <title>PKCS #10: Certification Request Syntax Specification Version 1.7</title>
            <author initials="M." surname="Nystrom" fullname="M. Nystrom">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Kaliski" fullname="B. Kaliski">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2000" month="November"/>
            <abstract>
              <t>This memo represents a republication of PKCS #10 v1.7 from RSA Laboratories' Public-Key Cryptography Standards (PKCS) series, and change control is retained within the PKCS process.  The body of this document, except for the security considerations section, is taken directly from the PKCS #9 v2.0 or the PKCS #10 v1.7 document.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2986"/>
          <seriesInfo name="DOI" value="10.17487/RFC2986"/>
        </reference>
        <reference anchor="RFC4055" target="https://www.rfc-editor.org/info/rfc4055" quoteTitle="true" derivedAnchor="RFC4055">
          <front>
            <title>Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</title>
            <author initials="J." surname="Schaad" fullname="J. Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Kaliski" fullname="B. Kaliski">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Housley" fullname="R. Housley">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="June"/>
            <abstract>
              <t>This document supplements RFC 3279.  It describes the conventions for using the RSA Probabilistic Signature Scheme (RSASSA-PSS) signature algorithm, the RSA Encryption Scheme - Optimal Asymmetric Encryption Padding (RSAES-OAEP) key transport algorithm and additional one-way hash functions with the Public-Key Cryptography Standards (PKCS) #1 version 1.5 signature algorithm in the Internet X.509 Public Key Infrastructure (PKI).  Encoding formats, algorithm identifiers, and parameter formats are specified.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4055"/>
          <seriesInfo name="DOI" value="10.17487/RFC4055"/>
        </reference>
        <reference anchor="RFC4056" target="https://www.rfc-editor.org/info/rfc4056" quoteTitle="true" derivedAnchor="RFC4056">
          <front>
            <title>Use of the RSASSA-PSS Signature Algorithm in Cryptographic Message Syntax (CMS)</title>
            <author initials="J." surname="Schaad" fullname="J. Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="June"/>
            <abstract>
              <t>This document specifies the conventions for using the RSASSA-PSS (RSA Probabilistic Signature Scheme) digital signature algorithm with the Cryptographic Message Syntax (CMS).  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4056"/>
          <seriesInfo name="DOI" value="10.17487/RFC4056"/>
        </reference>
        <reference anchor="RFC4086" target="https://www.rfc-editor.org/info/rfc4086" quoteTitle="true" derivedAnchor="RFC4086">
          <front>
            <title>Randomness Requirements for Security</title>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Schiller" fullname="J. Schiller">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Crocker" fullname="S. Crocker">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="June"/>
            <abstract>
              <t>Security systems are built on strong cryptographic algorithms that foil pattern analysis attempts.  However, the security of these systems is dependent on generating secret quantities for passwords, cryptographic keys, and similar quantities.  The use of pseudo-random processes to generate secret quantities can result in pseudo-security. A sophisticated attacker may find it easier to reproduce the environment that produced the secret quantities and to search the resulting small set of possibilities than to locate the quantities in the whole of the potential number space.</t>
              <t>Choosing random quantities to foil a resourceful and motivated adversary is surprisingly difficult.  This document points out many pitfalls in using poor entropy sources or traditional pseudo-random number generation techniques for generating such quantities.  It recommends the use of truly random hardware techniques and shows that the existing hardware on many systems can be used for this purpose. It provides suggestions to ameliorate the problem when a hardware solution is not available, and it gives examples of how large such quantities need to be for some applications.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="106"/>
          <seriesInfo name="RFC" value="4086"/>
          <seriesInfo name="DOI" value="10.17487/RFC4086"/>
        </reference>
        <reference anchor="RFC4211" target="https://www.rfc-editor.org/info/rfc4211" quoteTitle="true" derivedAnchor="RFC4211">
          <front>
            <title>Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)</title>
            <author initials="J." surname="Schaad" fullname="J. Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="September"/>
            <abstract>
              <t>This document describes the Certificate Request Message Format (CRMF) syntax and semantics.  This syntax is used to convey a request for a certificate to a Certification Authority (CA), possibly via a Registration Authority (RA), for the purposes of X.509 certificate production.  The request will typically include a public key and the associated registration information.  This document does not define a certificate request protocol.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4211"/>
          <seriesInfo name="DOI" value="10.17487/RFC4211"/>
        </reference>
        <reference anchor="RFC4231" target="https://www.rfc-editor.org/info/rfc4231" quoteTitle="true" derivedAnchor="RFC4231">
          <front>
            <title>Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512</title>
            <author initials="M." surname="Nystrom" fullname="M. Nystrom">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="December"/>
            <abstract>
              <t>This document provides test vectors for the HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 message authentication schemes.  It also provides ASN.1 object identifiers and Uniform Resource Identifiers (URIs) to identify use of these schemes in protocols.  The test vectors provided in this document may be used for conformance testing.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4231"/>
          <seriesInfo name="DOI" value="10.17487/RFC4231"/>
        </reference>
        <reference anchor="RFC5272" target="https://www.rfc-editor.org/info/rfc5272" quoteTitle="true" derivedAnchor="RFC5272">
          <front>
            <title>Certificate Management over CMS (CMC)</title>
            <author initials="J." surname="Schaad" fullname="J. Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Myers" fullname="M. Myers">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="June"/>
            <abstract>
              <t>This document defines the base syntax for CMC, a Certificate Management protocol using the Cryptographic Message Syntax (CMS). This protocol addresses two immediate needs within the Internet Public Key Infrastructure (PKI) community:</t>
              <t>1.  The need for an interface to public key certification products and services based on CMS and PKCS #10 (Public Key Cryptography Standard), and</t>
              <t>2.  The need for a PKI enrollment protocol for encryption only keys due to algorithm or hardware design.</t>
              <t>CMC also requires the use of the transport document and the requirements usage document along with this document for a full definition.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5272"/>
          <seriesInfo name="DOI" value="10.17487/RFC5272"/>
        </reference>
        <reference anchor="RFC5273" target="https://www.rfc-editor.org/info/rfc5273" quoteTitle="true" derivedAnchor="RFC5273">
          <front>
            <title>Certificate Management over CMS (CMC): Transport Protocols</title>
            <author initials="J." surname="Schaad" fullname="J. Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Myers" fullname="M. Myers">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="June"/>
            <abstract>
              <t>This document defines a number of transport mechanisms that are used to move CMC (Certificate Management over CMS (Cryptographic Message Syntax)) messages.  The transport mechanisms described in this document are HTTP, file, mail, and TCP.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5273"/>
          <seriesInfo name="DOI" value="10.17487/RFC5273"/>
        </reference>
        <reference anchor="RFC5274" target="https://www.rfc-editor.org/info/rfc5274" quoteTitle="true" derivedAnchor="RFC5274">
          <front>
            <title>Certificate Management Messages over CMS (CMC): Compliance Requirements</title>
            <author initials="J." surname="Schaad" fullname="J. Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Myers" fullname="M. Myers">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="June"/>
            <abstract>
              <t>This document provides a set of compliance statements about the CMC (Certificate Management over CMS) enrollment protocol.  The ASN.1 structures and the transport mechanisms for the CMC enrollment protocol are covered in other documents.  This document provides the information needed to make a compliant version of CMC.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5274"/>
          <seriesInfo name="DOI" value="10.17487/RFC5274"/>
        </reference>
        <reference anchor="RFC5754" target="https://www.rfc-editor.org/info/rfc5754" quoteTitle="true" derivedAnchor="RFC5754">
          <front>
            <title>Using SHA2 Algorithms with Cryptographic Message Syntax</title>
            <author initials="S." surname="Turner" fullname="S. Turner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="January"/>
            <abstract>
              <t>This document describes the conventions for using the Secure Hash Algorithm (SHA) message digest algorithms (SHA-224, SHA-256, SHA-384, SHA-512) with the Cryptographic Message Syntax (CMS).  It also describes the conventions for using these algorithms with the CMS and the Digital Signature Algorithm (DSA), Rivest Shamir Adleman (RSA), and Elliptic Curve DSA (ECDSA) signature algorithms.  Further, it provides SMIMECapabilities attribute values for each algorithm.   [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5754"/>
          <seriesInfo name="DOI" value="10.17487/RFC5754"/>
        </reference>
        <reference anchor="RFC6010" target="https://www.rfc-editor.org/info/rfc6010" quoteTitle="true" derivedAnchor="RFC6010">
          <front>
            <title>Cryptographic Message Syntax (CMS) Content Constraints Extension</title>
            <author initials="R." surname="Housley" fullname="R. Housley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Ashmore" fullname="S. Ashmore">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Wallace" fullname="C. Wallace">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="September"/>
            <abstract>
              <t>This document specifies the syntax and semantics for the Cryptographic Message Syntax (CMS) content constraints extension. This extension is used to determine whether a public key is appropriate to use in the processing of a protected content.  In particular, the CMS content constraints extension is one part of the authorization decision; it is used when validating a digital signature on a CMS SignedData content or validating a message authentication code (MAC) on a CMS AuthenticatedData content or CMS AuthEnvelopedData content.  The signed or authenticated content type is identified by an ASN.1 object identifier, and this extension indicates the content types that the public key is authorized to validate.  If the authorization check is successful, the CMS content constraints extension also provides default values for absent attributes.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6010"/>
          <seriesInfo name="DOI" value="10.17487/RFC6010"/>
        </reference>
        <reference anchor="RFC6402" target="https://www.rfc-editor.org/info/rfc6402" quoteTitle="true" derivedAnchor="RFC6402">
          <front>
            <title>Certificate Management over CMS (CMC) Updates</title>
            <author initials="J." surname="Schaad" fullname="J. Schaad">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="November"/>
            <abstract>
              <t>This document contains a set of updates to the base syntax for CMC, a Certificate Management protocol using the Cryptographic Message Syntax (CMS).  This document updates RFC 5272, RFC 5273, and RFC 5274.</t>
              <t>The new items in this document are: new controls for future work in doing server side key generation, definition of a Subject Information Access value to identify CMC servers, and the registration of a port number for TCP/IP for the CMC service to run on.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6402"/>
          <seriesInfo name="DOI" value="10.17487/RFC6402"/>
        </reference>
        <reference anchor="RFC8017" target="https://www.rfc-editor.org/info/rfc8017" quoteTitle="true" derivedAnchor="RFC8017">
          <front>
            <title>PKCS #1: RSA Cryptography Specifications Version 2.2</title>
            <author initials="K." surname="Moriarty" fullname="K. Moriarty" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Kaliski" fullname="B. Kaliski">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Jonsson" fullname="J. Jonsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Rusch" fullname="A. Rusch">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="November"/>
            <abstract>
              <t>This document provides recommendations for the implementation of public-key cryptography based on the RSA algorithm, covering cryptographic primitives, encryption schemes, signature schemes with appendix, and ASN.1 syntax for representing keys and for identifying the schemes.</t>
              <t>This document represents a republication of PKCS #1 v2.2 from RSA Laboratories' Public-Key Cryptography Standards (PKCS) series.  By publishing this RFC, change control is transferred to the IETF.</t>
              <t>This document also obsoletes RFC 3447.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8017"/>
          <seriesInfo name="DOI" value="10.17487/RFC8017"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t>RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8603" target="https://www.rfc-editor.org/info/rfc8603" quoteTitle="true" derivedAnchor="RFC8603">
          <front>
            <title>Commercial National Security Algorithm (CNSA) Suite Certificate and Certificate Revocation List (CRL) Profile</title>
            <author initials="M." surname="Jenkins" fullname="M. Jenkins">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Zieglar" fullname="L. Zieglar">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="May"/>
            <abstract>
              <t>This document specifies a base profile for X.509 v3 Certificates and X.509 v2 Certificate Revocation Lists (CRLs) for use with the United States National Security Agency's Commercial National Security Algorithm (CNSA) Suite.  The profile applies to the capabilities, configuration, and operation of all components of US National Security Systems that employ such X.509 certificates.  US National Security Systems are described in NIST Special Publication 800-59. It is also appropriate for all other US Government systems that process high-value information.  It is made publicly available for use by developers and operators of these and any other system deployments.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8603"/>
          <seriesInfo name="DOI" value="10.17487/RFC8603"/>
        </reference>
        <reference anchor="RFC8755" target="https://www.rfc-editor.org/info/rfc8755" quoteTitle="true" derivedAnchor="RFC8755">
          <front>
            <title>Using Commercial National Security Algorithm Suite Algorithms in Secure/Multipurpose Internet Mail Extensions</title>
            <author initials="M." surname="Jenkins" fullname="M. Jenkins">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="March"/>
            <abstract>
              <t>The United States Government has published the National Security Agency (NSA) Commercial National Security Algorithm (CNSA) Suite, which defines cryptographic algorithm policy for national security applications. This document specifies the conventions for using the United States National Security Agency's CNSA Suite algorithms in Secure/Multipurpose Internet Mail Extensions (S/MIME) as specified in RFC 8551. It applies to the capabilities, configuration, and operation of all components of US National Security Systems that employ S/MIME messaging. US National Security Systems are described in NIST Special Publication 800-59. It is also appropriate for all other US Government systems that process high-value information. It is made publicly available for use by developers and operators of these and any other system deployments.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8755"/>
          <seriesInfo name="DOI" value="10.17487/RFC8755"/>
        </reference>
      </references>
      <references pn="section-11.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="SP80057" target="http://doi.org/10.6028/NIST.SP.800-57pt1r4" quoteTitle="true" derivedAnchor="SP80057">
          <front>
            <title>Recommendation for Key Management, Part 1: General</title>
            <seriesInfo name="DOI" value="10.6028/NIST.SP.800-57pt1r4"/>
            <seriesInfo name="Special Publication" value="800-57, Part 1,          Revision 4"/>
            <author>
              <organization showOnFrontPage="true">National Institute of Standards and Technology</organization>
            </author>
            <date month="January" year="2016"/>
          </front>
        </reference>
        <reference anchor="SP80059" target="https://csrc.nist.gov/publications/detail/sp/800-59/final" quoteTitle="true" derivedAnchor="SP80059">
          <front>
            <title>Guideline for Identifying an Information System as a National Security System</title>
            <seriesInfo name="DOI" value="10.6028/NIST.SP.800-59"/>
            <seriesInfo name="Special Publication" value="800-59"/>
            <author>
              <organization showOnFrontPage="true">National Institute of Standards and Technology</organization>
            </author>
            <date month="August" year="2003"/>
          </front>
        </reference>
        <reference anchor="SP80090A" target="http://doi.org/10.6028/NIST.SP.800-90Ar1" quoteTitle="true" derivedAnchor="SP80090A">
          <front>
            <title>Recommendation for Random Number Generation Using Deterministic Random Bit Generators</title>
            <seriesInfo name="DOI" value="10.6028/NIST.SP.800-90Ar1"/>
            <seriesInfo name="Special Publication 800-90A" value="Revision           1"/>
            <author>
              <organization showOnFrontPage="true">National Institute of Standards and Technology</organization>
            </author>
            <date month="June" year="2015"/>
          </front>
        </reference>
      </references>
    </references>
    <section anchor="scenarios" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-scenarios">Scenarios</name>
      <t pn="section-appendix.a-1">This section illustrates several potential certificate enrollment and rekey scenarios supported by this profile.  This section does not intend to place any limits or restrictions on the use of CMC.</t>
      <section anchor="init_enroll" numbered="true" toc="include" removeInRFC="false" pn="section-a.1">
        <name slugifiedName="name-initial-enrollment">Initial Enrollment</name>
        <t pn="section-a.1-1">This section describes three scenarios for authenticating initial enrollment requests:
        </t>
        <ol spacing="normal" type="1" start="1" pn="section-a.1-2">
          <li pn="section-a.1-2.1" derivedCounter="1.">Previously certified signature key-pair (e.g., Manufacturer Installed Certificate).</li>
          <li pn="section-a.1-2.2" derivedCounter="2.">Shared-secret distributed securely out of band.</li>
          <li pn="section-a.1-2.3" derivedCounter="3.">RA authentication.</li>
        </ol>
        <section anchor="prev_inst" numbered="true" toc="exclude" removeInRFC="false" pn="section-a.1.1">
          <name slugifiedName="name-previously-certified-signat">Previously Certified Signature Key-Pair</name>
          <t pn="section-a.1.1-1">In this scenario, the end-entity has a private signing key and a corresponding public key certificate obtained from a cryptographic module manufacturer recognized by the CA. The end-entity signs a Full PKI Request with the private key that corresponds to the subject public key of the previously installed signature certificate. The CA will verify the authorization of the previously installed certificate and issue an appropriate new certificate to the end-entity.</t>
        </section>
        <section anchor="ss_oob" numbered="true" toc="exclude" removeInRFC="false" pn="section-a.1.2">
          <name slugifiedName="name-shared-secret-distributed-s">Shared-Secret Distributed Securely Out of Band</name>
          <t pn="section-a.1.2-1">In this scenario, the CA distributes a shared-secret out of band
	  to the end-entity that the end-entity uses to authenticate its
	  certification request.  The end-entity signs the Full PKI Request
	  with the private key for which the certification is being
	  requested. The end-entity includes the Identity Proof Version 2
	  control to authenticate the request using the shared-secret.  The CA
	  uses either the Identification control or the subject name in the
	  end-entity's enclosed PKCS #10 <xref target="RFC2986" format="default" sectionFormat="of" derivedContent="RFC2986"/> or CRMF <xref target="RFC4211" format="default" sectionFormat="of" derivedContent="RFC4211"/>
	  certification request message to identify the request.  The
	  end-entity performs either the POP Link Witness Version 2 mechanism
	  as described in <xref target="RFC5272" sectionFormat="comma" section="6.3.1.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5272#section-6.3.1.1" derivedContent="RFC5272"/> or the shared-secret/subject distinguished
	  name linking mechanism as described in <xref target="RFC5272" sectionFormat="comma" section="6.3.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5272#section-6.3.2" derivedContent="RFC5272"/>.  The subject name in the
	  enclosed PKCS #10 <xref target="RFC2986" format="default" sectionFormat="of" derivedContent="RFC2986"/> or CRMF <xref target="RFC4211" format="default" sectionFormat="of" derivedContent="RFC4211"/> certification
	  request does not necessarily match the issued certificate, as it may
	  be used just to help identify the request (and the corresponding shared-secret) to the CA.</t>
        </section>
        <section anchor="ra_auth" numbered="true" toc="exclude" removeInRFC="false" pn="section-a.1.3">
          <name slugifiedName="name-ra-authentication">RA Authentication</name>
          <t pn="section-a.1.3-1">In this scenario, the end-entity does not automatically
	  authenticate its enrollment request to the CA, either because the
	  end-entity has nothing to authenticate the request with or because
	  the organizational policy requires an RA's involvement.  The end-entity
	  creates a Full PKI Request and sends it to an RA.  The RA verifies
	  the authenticity of the request. If the request is approved, the RA encapsulates and
	  signs the request as described in <xref target="cert-reqst-msg" format="default" sectionFormat="of" derivedContent="Section 4.2"/>,
	  forwarding the new request on to the CA. The subject name in the PKCS
	  #10 <xref target="RFC2986" format="default" sectionFormat="of" derivedContent="RFC2986"/> or CRMF <xref target="RFC4211" format="default" sectionFormat="of" derivedContent="RFC4211"/> certification request is not required to match the issued certificate; it may be used just to help identify the request to the RA and/or CA.</t>
        </section>
      </section>
      <section anchor="rekey" numbered="true" toc="include" removeInRFC="false" pn="section-a.2">
        <name slugifiedName="name-rekey">Rekey</name>
        <t pn="section-a.2-1">There are two scenarios to support the rekey of certificates that
	are already enrolled.  One addresses the rekey of signature
	certificates, and the other addresses the rekey of key establishment
	certificates. Typically, organizational policy will require certificates to be currently valid to be rekeyed, and it may require initial enrollment to be repeated when rekey is not possible.  However, some organizational policies might allow a grace period during which an expired certificate could be used to rekey.</t>
        <section anchor="rk_sig" numbered="true" toc="exclude" removeInRFC="false" pn="section-a.2.1">
          <name slugifiedName="name-rekey-of-signature-certific">Rekey of Signature Certificates</name>
          <t pn="section-a.2.1-1">When a signature certificate is rekeyed, the <xref target="RFC2986" format="default" sectionFormat="of" derivedContent="RFC2986">PKCS #10</xref> or <xref target="RFC4211" format="default" sectionFormat="of" derivedContent="RFC4211">CRMF</xref> certification request message enclosed in the Full PKI Request will include the same subject name as the current signature certificate.  The Full PKI Request will be signed by the current private key corresponding to the current signature certificate.</t>
        </section>
        <section anchor="rk_kes" numbered="true" toc="exclude" removeInRFC="false" pn="section-a.2.2">
          <name slugifiedName="name-rekey-of-key-establishment-">Rekey of Key Establishment Certificates</name>
          <t pn="section-a.2.2-1">When a key establishment certificate is rekeyed, the Full PKI Request will generally be signed by the current private key corresponding to the current signature certificate.  If there is no current signature certificate, one of the initial enrollment options in <xref target="init_enroll" format="default" sectionFormat="of" derivedContent="Appendix A.1"/> may be used. 
</t>
        </section>
      </section>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author fullname="Michael Jenkins" initials="M." surname="Jenkins">
        <organization abbrev="NSA" showOnFrontPage="true">National Security Agency</organization>
        <address>
          <email>mjjenki@nsa.gov</email>
        </address>
      </author>
      <author fullname="Lydia Zieglar" initials="L." surname="Zieglar">
        <organization abbrev="NSA" showOnFrontPage="true">National Security Agency</organization>
        <address>
          <email>llziegl@tycho.ncsc.mil</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
