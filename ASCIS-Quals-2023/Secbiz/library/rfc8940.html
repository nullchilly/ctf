<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 8940: Extensible Authentication Protocol (EAP) Session-Id Derivation for EAP Subscriber Identity Module (EAP-SIM), EAP Authentication and Key Agreement (EAP-AKA), and Protected EAP (PEAP)</title>
<meta content="Alan DeKok" name="author">
<meta content="
       
   RFC 5247 is updated to define and clarify EAP Session-Id derivation
   for multiple Extensible Authentication         
    Protocol (EAP) methods.  The derivation of Session-Id was not given
   for EAP Subscriber Identity Module (EAP-SIM) or EAP Authentication and Key Agreement (EAP-AKA) when using the fast reconnect exchange instead
   of full authentication.  The derivation of Session-Id for full
   authentication is clarified for both EAP-SIM and EAP-AKA.  The
   derivation of Session-Id for Protected EAP (PEAP) is also given.  The definition for
   PEAP follows the definition for other TLS-based EAP methods. 
    " name="description">
<meta content="xml2rfc 3.3.0" name="generator">
<meta content="EAP" name="keyword">
<meta content="PEAP" name="keyword">
<meta content="EAP-AKA" name="keyword">
<meta content="EAP-SIM" name="keyword">
<meta content="ERP" name="keyword">
<meta content="FILS" name="keyword">
<meta content="Session-ID" name="keyword">
<meta content="fast reconnect" name="keyword">
<meta content="TLS" name="keyword">
<meta content="8940" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.3.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8940.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://dx.doi.org/10.17487/rfc8940" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-emu-eap-session-id-07.txt" rel="prev">
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8940</td>
<td class="center">EAP Session-Id Derivation</td>
<td class="right">October 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">DeKok</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc8940" class="eref">8940</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc5247" class="eref">5247</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-10" class="published">October 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. DeKok</div>
<div class="org">FreeRADIUS</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8940</h1>
<h1 id="title">Extensible Authentication Protocol (EAP) Session-Id Derivation for EAP Subscriber Identity Module (EAP-SIM), EAP Authentication and Key Agreement (EAP-AKA), and Protected EAP (PEAP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
   RFC 5247 is updated to define and clarify EAP Session-Id derivation
   for multiple Extensible Authentication         
    Protocol (EAP) methods.  The derivation of Session-Id was not given
   for EAP Subscriber Identity Module (EAP-SIM) or EAP Authentication and Key Agreement (EAP-AKA) when using the fast reconnect exchange instead
   of full authentication.  The derivation of Session-Id for full
   authentication is clarified for both EAP-SIM and EAP-AKA.  The
   derivation of Session-Id for Protected EAP (PEAP) is also given.  The definition for
   PEAP follows the definition for other TLS-based EAP methods.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8940">https://www.rfc-editor.org/info/rfc8940</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-updates-to-rfc-5247-appendi" class="xref">Updates to RFC 5247, Appendix A</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-eap-aka" class="xref">EAP-AKA</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-eap-sim" class="xref">EAP-SIM</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-rationale-for-eap-aka-and-e" class="xref">Rationale for EAP-AKA and EAP-SIM Updates</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-session-id-for-peap" class="xref">Session-Id for PEAP</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
   EAP <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span> Session-Id derivation has not
   been defined for EAP-SIM and EAP-AKA when using the fast reconnect exchange
   instead of full authentication.  <span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span>
   defines the Session-Id for these EAP methods, but that derivation is only
   applicable for the full authentication case.  The Session-Id derivation was
   not defined for EAP-AKA', but <span>[<a href="#I-D.ietf-emu-rfc5448bis" class="xref">AKAP</a>]</span> now defines it, along with other updates.  As such, the
   definition for EAP-AKA' is not included here.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
   Further, the derivation of Session-Id for full authentication is
   clarified, as the text in <span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span> is
   ambiguous.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
   The IEEE has defined Fast Initial Link Setup (FILS) authentication <span>[<a href="#FILS" class="xref">FILS</a>]</span>, which needs the EAP Session-Id in order
   for the EAP Re-authentication Protocol (ERP) <span>[<a href="#RFC6696" class="xref">RFC6696</a>]</span> to work.  It is therefore important to address the
   existing deficiencies in the definition of EAP Session-Id.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
   Finally, <span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span> did not define
   Session-Id for PEAP <span>[<a href="#MS-PEAP" class="xref">MS-PEAP</a>]</span> <span>[<a href="#I-D.josefsson-pppext-eap-tls-eap" class="xref">PEAP</a>]</span>. We correct
   these deficiencies here by updating <span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span> with the Session-Id derivation during fast-reconnect
   exchange for EAP-SIM and EAP-AKA; clarifying the Session-Id derivation
   during full authentication for EAP-SIM and EAP-AKA; and defining the
   Session-Id derivation for PEAP, which is the same for both full
   authentication and fast reconnect.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-2">
<section id="section-2">
      <h2 id="name-updates-to-rfc-5247-appendi">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-updates-to-rfc-5247-appendi" class="section-name selfRef">Updates to RFC 5247, Appendix A</a>
      </h2>
<p id="section-2-1">
   This section updates <span>[<a href="#RFC5247" class="xref">RFC5247</a>], <a href="https://www.rfc-editor.org/rfc/rfc5247#appendix-A" class="relref">Appendix A</a></span> to define Session-Id for fast reconnect exchange for EAP-AKA and
   EAP-SIM.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="sect-2.1">
<section id="section-2.1">
        <h3 id="name-eap-aka">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-eap-aka" class="section-name selfRef">EAP-AKA</a>
        </h3>
<p id="section-2.1-1">
   For EAP-AKA, <span>[<a href="#RFC5247" class="xref">RFC5247</a>], <a href="https://www.rfc-editor.org/rfc/rfc5247#appendix-A" class="relref">Appendix A</a></span> says:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<blockquote id="section-2.1-2">
          <span class="break"></span><dl class="dlNewline" id="section-2.1-2.1">
            <dt id="section-2.1-2.1.1">EAP-AKA</dt>
            <dd style="margin-left: 1.5em" id="section-2.1-2.1.2">
              <p id="section-2.1-2.1.2.1">EAP-AKA is defined in <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.  The EAP-AKA Session-Id is the concatenation of
      the EAP Type Code (0x17) with the contents of the RAND field from
      the AT_RAND attribute, followed by the contents of the AUTN field in
      the AT_AUTN attribute:<a href="#section-2.1-2.1.2.1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-2.1.2.2">
<pre>
   Session-Id = 0x17 || RAND || AUTN
</pre><a href="#section-2.1-2.1.2.2" class="pilcrow">¶</a>
</div>
</dd>
          <dd class="break"></dd>
</dl>
</blockquote>
<p id="section-2.1-3">It should say:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<blockquote id="section-2.1-4">
          <span class="break"></span><dl class="dlNewline" id="section-2.1-4.1">
            <dt id="section-2.1-4.1.1">EAP-AKA</dt>
            <dd style="margin-left: 1.5em" id="section-2.1-4.1.2">
              <p id="section-2.1-4.1.2.1">EAP-AKA is defined in <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.  When using full
      authentication, the EAP-AKA Session-Id is the concatenation of the EAP
      Type Code (0x17) with the contents of the RAND field from the AT_RAND
      attribute, followed by the contents of the AUTN field in the AT_AUTN
      attribute:<a href="#section-2.1-4.1.2.1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-4.1.2.2">
<pre>
   Session-Id = 0x17 || RAND || AUTN
</pre><a href="#section-2.1-4.1.2.2" class="pilcrow">¶</a>
</div>
<p id="section-2.1-4.1.2.3">When using fast reconnect, the EAP-AKA Session-Id is the
       concatenation of the EAP Type Code (0x17) with the contents of the
       NONCE_S field from the AT_NONCE_S attribute, followed by the contents
       of the MAC field from the AT_MAC attribute from
       EAP-Request/AKA-Reauthentication:<a href="#section-2.1-4.1.2.3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-4.1.2.4">
<pre>
   Session-Id = 0x17 || NONCE_S || MAC
</pre><a href="#section-2.1-4.1.2.4" class="pilcrow">¶</a>
</div>
</dd>
          <dd class="break"></dd>
</dl>
</blockquote>
</section>
</div>
<div id="sect-2.2">
<section id="section-2.2">
        <h3 id="name-eap-sim">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-eap-sim" class="section-name selfRef">EAP-SIM</a>
        </h3>
<p id="section-2.2-1">
   Similarly for EAP-SIM, <span>[<a href="#RFC5247" class="xref">RFC5247</a>], <a href="https://www.rfc-editor.org/rfc/rfc5247#appendix-A" class="relref">Appendix A</a></span> says:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<blockquote id="section-2.2-2">
          <span class="break"></span><dl class="dlNewline" id="section-2.2-2.1">
            <dt id="section-2.2-2.1.1">EAP-SIM                                                                                </dt>
            <dd style="margin-left: 1.5em" id="section-2.2-2.1.2">
              <p id="section-2.2-2.1.2.1">EAP-SIM is defined in <span>[<a href="#RFC4186" class="xref">RFC4186</a>]</span>.  The EAP-SIM
 Session-Id is the concatenation of the EAP Type Code (0x12) with the
 contents of the RAND field from the AT_RAND attribute, followed by the
 contents of the NONCE_MT field in the AT_NONCE_MT attribute:<a href="#section-2.2-2.1.2.1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-2.1.2.2">
<pre>
   Session-Id = 0x12 || RAND || NONCE_MT
</pre><a href="#section-2.2-2.1.2.2" class="pilcrow">¶</a>
</div>
</dd>
          <dd class="break"></dd>
</dl>
</blockquote>
<p id="section-2.2-3">It should say:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<blockquote id="section-2.2-4">
          <span class="break"></span><dl class="dlNewline" id="section-2.2-4.1">
            <dt id="section-2.2-4.1.1">EAP-SIM
            </dt>
            <dd style="margin-left: 1.5em" id="section-2.2-4.1.2">
              <p id="section-2.2-4.1.2.1">EAP-SIM is defined in <span>[<a href="#RFC4186" class="xref">RFC4186</a>]</span>.
              When using full authentication, the EAP-SIM Session-Id is the
              concatenation of the EAP Type Code (0x12) with the contents of the
              RAND field from the AT_RAND attribute, followed by the contents of
              the NONCE_MT field in the AT_NONCE_MT attribute. 
              RFC 4186 says that the EAP server should obtain "n" GSM
              triplets where "n=2" or "n=3".<a href="#section-2.2-4.1.2.1" class="pilcrow">¶</a></p>
<p id="section-2.2-4.1.2.2">For "n=2", the Session-Id is therefore defined as<a href="#section-2.2-4.1.2.2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-4.1.2.3">
<pre>
   Session-Id = 0x12 || RAND1 || RAND2 || NONCE_MT
</pre><a href="#section-2.2-4.1.2.3" class="pilcrow">¶</a>
</div>
<p id="section-2.2-4.1.2.4">which is 49 octets in length.<a href="#section-2.2-4.1.2.4" class="pilcrow">¶</a></p>
<p id="section-2.2-4.1.2.5">For "n=3", the Session-Id is therefore defined as<a href="#section-2.2-4.1.2.5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-4.1.2.6">
<pre>
   Session-Id = 0x12 || RAND1 || RAND2 || RAND3 || NONCE_MT
</pre><a href="#section-2.2-4.1.2.6" class="pilcrow">¶</a>
</div>
<p id="section-2.2-4.1.2.7">which is 65 octets in length.<a href="#section-2.2-4.1.2.7" class="pilcrow">¶</a></p>
<p id="section-2.2-4.1.2.8">RAND1, RAND2, and RAND3 correspond to the RAND value from the
 first, second, and third GSM triplet, respectively.<a href="#section-2.2-4.1.2.8" class="pilcrow">¶</a></p>
<p id="section-2.2-4.1.2.9">When using fast reconnect, the EAP-SIM Session-Id is the
 concatenation of the EAP Type Code (0x12) with the contents of the
 NONCE_S field from the AT_NONCE_S attribute, followed by the contents
 of the MAC field from the AT_MAC attribute from
 EAP-Request/SIM/Reauthentication:<a href="#section-2.2-4.1.2.9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.2-4.1.2.10">
<pre>
   Session-Id = 0x12 || NONCE_S || MAC
</pre><a href="#section-2.2-4.1.2.10" class="pilcrow">¶</a>
</div>
<p id="section-2.2-4.1.2.11">which is 33 octets in length.<a href="#section-2.2-4.1.2.11" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</blockquote>
</section>
</div>
<div id="sect-2.3">
<section id="section-2.3">
        <h3 id="name-rationale-for-eap-aka-and-e">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-rationale-for-eap-aka-and-e" class="section-name selfRef">Rationale for EAP-AKA and EAP-SIM Updates</a>
        </h3>
<p id="section-2.3-1">
<span><a href="https://www.rfc-editor.org/rfc/rfc5247#appendix-A" class="relref">Appendix A</a> of [<a href="#RFC5247" class="xref">RFC5247</a>]</span> was supposed to define exported parameters for
   existing EAP methods. The way Session-Id was defined for
   EAP-AKA and EAP-SIM works only for the full authentication case, i.e., it
   cannot be used when the optional fast reconnect case is used since the used
   parameters (RAND, AUTN, NONCE_MT) are not used in the fast reconnect
   case. Based on <span>[<a href="#RFC4187" class="xref">RFC4187</a>], <a href="https://www.rfc-editor.org/rfc/rfc4187#section-5.2" class="relref">Section 5.2</a></span>
   and similar text in
   <span>[<a href="#RFC4186" class="xref">RFC4186</a>], <a href="https://www.rfc-editor.org/rfc/rfc4186#section-5.2" class="relref">Section 5.2</a></span>, NONCE_S corresponds to RAND and MAC
   in EAP-Request/AKA-Reauthentication, and EAP-Request/SIM/Reauthentication
   corresponds to AUTN. That would seem to imply that the Session-Id could be
   defined using NONCE_S and MAC instead of RAND and AUTN/NONCE_MT.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">
   This derivation is done via a random value created by the server,
   along with a secret key and the peer's identity.  We believe that
   this derivation is secure, though no formal analysis has been done.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-session-id-for-peap">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-session-id-for-peap" class="section-name selfRef">Session-Id for PEAP</a>
      </h2>
<p id="section-3-1">
   <span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span> did not define Session-Id for Microsoft's
   Protected EAP (PEAP).  For consistency with the EAP-TLS definition given in
   <span>[<a href="#RFC5216" class="xref">RFC5216</a>], <a href="https://www.rfc-editor.org/rfc/rfc5216#section-2.3" class="relref">Section 2.3</a></span>, we define it as:<a href="#section-3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3-2">
<pre>
   Session-Id = 0x19 || client.random || server.random
</pre><a href="#section-3-2" class="pilcrow">¶</a>
</div>
<p id="section-3-3">
   This definition is that same for both full authentication and for fast reconnect.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
   This definition is already in widespread use in all known PEAP
   implementations.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
   Note that this definition for Session-Id only applies when TLS 1.2 or
   earlier is used.  A different derivation is defined for TLS 1.3 in
   <span>[<a href="#I-D.ietf-emu-tls-eap-types" class="xref">TLS-EAP-TYPES</a>]</span>.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">
   This specification defines EAP Session-Ids for ERP with EAP-SIM and
   EAP-AKA.  It therefore enables ERP key hierarchy establishment using
   fast reconnect with EAP-SIM and EAP-AKA.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
   The Session-Id definitions given here are unique per session, unforgeable, and unguessable by an outside party, as per the
   requirements of <span>[<a href="#RFC5247" class="xref">RFC5247</a>], <a href="https://www.rfc-editor.org/rfc/rfc5247#section-10" class="relref">Section 10</a></span>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">    
   The definitions used here have been widely deployed for years in
   all major EAP implementations.  However, we acknowledge that very
   little security analysis has been done for these definitions.  As a
   result, any security issues would result in serious issues for the
   Internet as a whole.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
   These updates do not modify the security considerations outlined in
   <span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">
   This document has no IANA actions.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FILS">[FILS]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Information technology--Telecommunications and information exchange between systems - Local and metropolitan area networks--Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications - Amendment 1: Fast Initial Link Setup"</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2016.7792308</span>, <span class="seriesInfo">IEEE Std 802.11ai-2016</span>, <time datetime="2016-12" class="refDate">December 2016</time>, <span>&lt;<a href="https://doi.org/10.1109/IEEESTD.2016.7792308">https://doi.org/10.1109/IEEESTD.2016.7792308</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span><span class="refAuthor">, Blunk, L.</span><span class="refAuthor">, Vollbrecht, J.</span><span class="refAuthor">, Carlson, J.</span><span class="refAuthor">, and H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5216">[RFC5216]</dt>
        <dd>
<span class="refAuthor">Simon, D.</span><span class="refAuthor">, Aboba, B.</span><span class="refAuthor">, and R. Hurst</span>, <span class="refTitle">"The EAP-TLS Authentication Protocol"</span>, <span class="seriesInfo">RFC 5216</span>, <span class="seriesInfo">DOI 10.17487/RFC5216</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5216">https://www.rfc-editor.org/info/rfc5216</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5247">[RFC5247]</dt>
      <dd>
<span class="refAuthor">Aboba, B.</span><span class="refAuthor">, Simon, D.</span><span class="refAuthor">, and P. Eronen</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Key Management Framework"</span>, <span class="seriesInfo">RFC 5247</span>, <span class="seriesInfo">DOI 10.17487/RFC5247</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5247">https://www.rfc-editor.org/info/rfc5247</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-emu-rfc5448bis">[AKAP]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span><span class="refAuthor">, Lehtovirta, V.</span><span class="refAuthor">, Torvinen, V.</span><span class="refAuthor">, and P. Eronen</span>, <span class="refTitle">"Improved Extensible Authentication Protocol Method for 3GPP Mobile Network Authentication and Key Agreement (EAP-AKA')"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-emu-rfc5448bis-07</span>, <time datetime="2020-03-09" class="refDate">9 March 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-emu-rfc5448bis-07">https://tools.ietf.org/html/draft-ietf-emu-rfc5448bis-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Err5011">[Err5011]</dt>
        <dd>
<span class="refAuthor">RFC Errata</span>, <span class="refTitle">Erratum ID 5011</span>, <span class="refContent">RFC 5247</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid5011">https://www.rfc-editor.org/errata/eid5011</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MS-PEAP">[MS-PEAP]</dt>
        <dd>
<span class="refAuthor">Microsoft</span>, <span class="refTitle">"[MS-PEAP]: Protected Extensible Authentication Protocol (PEAP)"</span>, <span>&lt;<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-peap/5308642b-90c9-4cc4-beec-fb367325c0f9">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-peap/5308642b-90c9-4cc4-beec-fb367325c0f9</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.josefsson-pppext-eap-tls-eap">[PEAP]</dt>
        <dd>
<span class="refAuthor">Palekar, A.</span><span class="refAuthor">, Josefsson, S.</span><span class="refAuthor">, Simon, D.</span><span class="refAuthor">, and G. Zorn</span>, <span class="refTitle">"Protected EAP Protocol (PEAP) Version 2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-josefsson-pppext-eap-tls-eap-10</span>, <time datetime="2004-10-21" class="refDate">21 October 2004</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-josefsson-pppext-eap-tls-eap-10">https://tools.ietf.org/html/draft-josefsson-pppext-eap-tls-eap-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4186">[RFC4186]</dt>
        <dd>
<span class="refAuthor">Haverinen, H., Ed.</span><span class="refAuthor"> and J. Salowey, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)"</span>, <span class="seriesInfo">RFC 4186</span>, <span class="seriesInfo">DOI 10.17487/RFC4186</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4186">https://www.rfc-editor.org/info/rfc4186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4187">[RFC4187]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span><span class="refAuthor"> and H. Haverinen</span>, <span class="refTitle">"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"</span>, <span class="seriesInfo">RFC 4187</span>, <span class="seriesInfo">DOI 10.17487/RFC4187</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4187">https://www.rfc-editor.org/info/rfc4187</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6696">[RFC6696]</dt>
        <dd>
<span class="refAuthor">Cao, Z.</span><span class="refAuthor">, He, B.</span><span class="refAuthor">, Shi, Y.</span><span class="refAuthor">, Wu, Q., Ed.</span><span class="refAuthor">, and G. Zorn, Ed.</span>, <span class="refTitle">"EAP Extensions for the EAP Re-authentication Protocol (ERP)"</span>, <span class="seriesInfo">RFC 6696</span>, <span class="seriesInfo">DOI 10.17487/RFC6696</span>, <time datetime="2012-07" class="refDate">July 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6696">https://www.rfc-editor.org/info/rfc6696</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-emu-tls-eap-types">[TLS-EAP-TYPES]</dt>
      <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"TLS-based EAP types and TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-emu-tls-eap-types-01</span>, <time datetime="2020-07-29" class="refDate">29 July 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-emu-tls-eap-types-01">https://tools.ietf.org/html/draft-ietf-emu-tls-eap-types-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">
The issue corrected in this specification was first reported by <span class="contact-name">Jouni Malinen</span> in a technical erratum for RFC 5247 <span>[<a href="#Err5011" class="xref">Err5011</a>]</span>.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">
The text in this document follows Jouni's suggestions.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alan DeKok</span></div>
<div dir="auto" class="left"><span class="org">The FreeRADIUS Server Project</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aland@freeradius.org" class="email">aland@freeradius.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
