<!DOCTYPE html>
<html lang="en" class="BCP RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 9210: DNS Transport over TCP - Operational Requirements</title>
<meta content="John Kristoff" name="author">
<meta content="Duane Wessels" name="author">
<meta content="
       This document updates RFCs 1123 and 1536.  This
     document requires the operational practice of permitting
     DNS messages to be carried over TCP on the Internet as a Best
     Current Practice.  This operational requirement is aligned with the
     implementation requirements in RFC 7766.  The use of TCP includes
     both DNS over unencrypted TCP as well as over an encrypted TLS
     session.  The document also considers the consequences of this
     form of DNS communication and the potential operational issues that
     can arise when this Best Current Practice is not upheld. 
    " name="description">
<meta content="xml2rfc 3.12.2" name="generator">
<meta content="DNS" name="keyword">
<meta content="TCP" name="keyword">
<meta content="9210" name="rfc.number">
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9210.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://dx.doi.org/10.17487/rfc9210" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-dns-tcp-requirements-15" rel="prev">
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9210</td>
<td class="center">DNS Transport over TCP</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kristoff &amp; Wessels</td>
<td class="center">Best Current Practice</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc9210" class="eref">9210</a></dd>
<dt class="label-bcp">BCP:</dt>
<dd class="bcp">235</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc1123" class="eref">1123</a>, <a href="https://www.rfc-editor.org/rfc/rfc1536" class="eref">1536</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Best Current Practice</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03" class="published">March 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Kristoff</div>
<div class="org">Dataplane.org</div>
</div>
<div class="author">
      <div class="author-name">D. Wessels</div>
<div class="org">Verisign</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9210</h1>
<h1 id="title">DNS Transport over TCP - Operational Requirements</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document updates RFCs 1123 and 1536.  This
     document requires the operational practice of permitting
     DNS messages to be carried over TCP on the Internet as a Best
     Current Practice.  This operational requirement is aligned with the
     implementation requirements in RFC 7766.  The use of TCP includes
     both DNS over unencrypted TCP as well as over an encrypted TLS
     session.  The document also considers the consequences of this
     form of DNS communication and the potential operational issues that
     can arise when this Best Current Practice is not upheld.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This memo documents an Internet Best Current Practice.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further information
            on BCPs is available in Section 2 of RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9210">https://www.rfc-editor.org/info/rfc9210</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-history-of-dns-over-tcp" class="xref">History of DNS over TCP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-uneven-transport-usage-and-" class="xref">Uneven Transport Usage and Preference</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-waiting-for-large-messages-" class="xref">Waiting for Large Messages and Reliability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-edns0" class="xref">EDNS(0)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-fragmentation-and-truncatio" class="xref">Fragmentation and Truncation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-only-zone-transfers-use-tcp" class="xref">"Only Zone Transfers Use TCP"</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-reuse-pipelining-and-out-of" class="xref">Reuse, Pipelining, and Out-of-Order Processing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-dns-over-tcp-requirements" class="xref">DNS-over-TCP Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-network-and-system-consider" class="xref">Network and System Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-connection-establishment-an" class="xref">Connection Establishment and Admission</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-connection-management" class="xref">Connection Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-connection-termination" class="xref">Connection Termination</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-dns-over-tls" class="xref">DNS over TLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-defaults-and-recommended-li" class="xref">Defaults and Recommended Limits</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-dns-over-tcp-filtering-risk" class="xref">DNS-over-TCP Filtering Risks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-truncation-retries-and-time" class="xref">Truncation, Retries, and Timeouts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-dns-root-zone-ksk-rollover" class="xref">DNS Root Zone KSK Rollover</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-logging-and-monitoring" class="xref">Logging and Monitoring</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-rfcs-related-to-dns-transpo" class="xref">RFCs Related to DNS Transport over TCP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-rfc-1035-domain-names-imple" class="xref">RFC 1035 - DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-rfc-1536-common-dns-impleme" class="xref">RFC 1536 - Common DNS Implementation Errors and Suggested Fixes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-rfc-1995-incremental-zone-t" class="xref">RFC 1995 - Incremental Zone Transfer in DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-A.4" class="xref">A.4</a>.  <a href="#name-rfc-1996-a-mechanism-for-pr" class="xref">RFC 1996 - A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#appendix-A.5" class="xref">A.5</a>.  <a href="#name-rfc-2181-clarifications-to-" class="xref">RFC 2181 - Clarifications to the DNS Specification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#appendix-A.6" class="xref">A.6</a>.  <a href="#name-rfc-2694-dns-extensions-to-" class="xref">RFC 2694 - DNS extensions to Network Address Translators (DNS_ALG)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.7">
                <p id="section-toc.1-1.11.2.7.1"><a href="#appendix-A.7" class="xref">A.7</a>.  <a href="#name-rfc-3225-indicating-resolve" class="xref">RFC 3225 - Indicating Resolver Support of DNSSEC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.8">
                <p id="section-toc.1-1.11.2.8.1"><a href="#appendix-A.8" class="xref">A.8</a>.  <a href="#name-rfc-3226-dnssec-and-ipv6-a6" class="xref">RFC 3226 - DNSSEC and IPv6 A6 aware server/resolver message size requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.9">
                <p id="section-toc.1-1.11.2.9.1"><a href="#appendix-A.9" class="xref">A.9</a>.  <a href="#name-rfc-4472-operational-consid" class="xref">RFC 4472 - Operational Considerations and Issues with IPv6 DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.10">
                <p id="section-toc.1-1.11.2.10.1"><a href="#appendix-A.10" class="xref">A.10</a>. <a href="#name-rfc-5452-measures-for-makin" class="xref">RFC 5452 - Measures for Making DNS More Resilient against Forged Answers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.11">
                <p id="section-toc.1-1.11.2.11.1"><a href="#appendix-A.11" class="xref">A.11</a>. <a href="#name-rfc-5507-design-choices-whe" class="xref">RFC 5507 - Design Choices When Expanding the DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.12">
                <p id="section-toc.1-1.11.2.12.1"><a href="#appendix-A.12" class="xref">A.12</a>. <a href="#name-rfc-5625-dns-proxy-implemen" class="xref">RFC 5625 - DNS Proxy Implementation Guidelines</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.13">
                <p id="section-toc.1-1.11.2.13.1"><a href="#appendix-A.13" class="xref">A.13</a>. <a href="#name-rfc-5936-dns-zone-transfer-" class="xref">RFC 5936 - DNS Zone Transfer Protocol (AXFR)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.14">
                <p id="section-toc.1-1.11.2.14.1"><a href="#appendix-A.14" class="xref">A.14</a>. <a href="#name-rfc-7534-as112-nameserver-o" class="xref">RFC 7534 - AS112 Nameserver Operations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.15">
                <p id="section-toc.1-1.11.2.15.1"><a href="#appendix-A.15" class="xref">A.15</a>. <a href="#name-rfc-6762-multicast-dns" class="xref">RFC 6762 - Multicast DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.16">
                <p id="section-toc.1-1.11.2.16.1"><a href="#appendix-A.16" class="xref">A.16</a>. <a href="#name-rfc-6891-extension-mechanis" class="xref">RFC 6891 - Extension Mechanisms for DNS (EDNS(0))</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.17">
                <p id="section-toc.1-1.11.2.17.1"><a href="#appendix-A.17" class="xref">A.17</a>. <a href="#name-iab-rfc-6950-architectural-" class="xref">IAB RFC 6950 - Architectural Considerations on Application Features in the DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.18">
                <p id="section-toc.1-1.11.2.18.1"><a href="#appendix-A.18" class="xref">A.18</a>. <a href="#name-rfc-7477-child-to-parent-sy" class="xref">RFC 7477 - Child-to-Parent Synchronization in DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.19">
                <p id="section-toc.1-1.11.2.19.1"><a href="#appendix-A.19" class="xref">A.19</a>. <a href="#name-rfc-7720-dns-root-name-serv" class="xref">RFC 7720 - DNS Root Name Service Protocol and Deployment Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.20">
                <p id="section-toc.1-1.11.2.20.1"><a href="#appendix-A.20" class="xref">A.20</a>. <a href="#name-rfc-7766-dns-transport-over" class="xref">RFC 7766 - DNS Transport over TCP - Implementation Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.21">
                <p id="section-toc.1-1.11.2.21.1"><a href="#appendix-A.21" class="xref">A.21</a>. <a href="#name-rfc-7828-the-edns-tcp-keepa" class="xref">RFC 7828 - The edns-tcp-keepalive EDNS(0) Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.22">
                <p id="section-toc.1-1.11.2.22.1"><a href="#appendix-A.22" class="xref">A.22</a>. <a href="#name-rfc-7858-specification-for-" class="xref">RFC 7858 - Specification for DNS over Transport Layer Security (TLS)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.23">
                <p id="section-toc.1-1.11.2.23.1"><a href="#appendix-A.23" class="xref">A.23</a>. <a href="#name-rfc-7873-domain-name-system" class="xref">RFC 7873 - Domain Name System (DNS) Cookies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.24">
                <p id="section-toc.1-1.11.2.24.1"><a href="#appendix-A.24" class="xref">A.24</a>. <a href="#name-rfc-7901-chain-query-reques" class="xref">RFC 7901 - CHAIN Query Requests in DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.25">
                <p id="section-toc.1-1.11.2.25.1"><a href="#appendix-A.25" class="xref">A.25</a>. <a href="#name-rfc-8027-dnssec-roadblock-a" class="xref">RFC 8027 - DNSSEC Roadblock Avoidance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.26">
                <p id="section-toc.1-1.11.2.26.1"><a href="#appendix-A.26" class="xref">A.26</a>. <a href="#name-rfc-8094-dns-over-datagram-" class="xref">RFC 8094 - DNS over Datagram Transport Layer Security (DTLS)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.27">
                <p id="section-toc.1-1.11.2.27.1"><a href="#appendix-A.27" class="xref">A.27</a>. <a href="#name-rfc-8162-using-secure-dns-t" class="xref">RFC 8162 - Using Secure DNS to Associate Certificates with Domain Names for S/MIME</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.28">
                <p id="section-toc.1-1.11.2.28.1"><a href="#appendix-A.28" class="xref">A.28</a>. <a href="#name-rfc-8324-dns-privacy-author" class="xref">RFC 8324 - DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.29">
                <p id="section-toc.1-1.11.2.29.1"><a href="#appendix-A.29" class="xref">A.29</a>. <a href="#name-rfc-8467-padding-policies-f" class="xref">RFC 8467 - Padding Policies for Extension Mechanisms for DNS (EDNS(0))</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.30">
                <p id="section-toc.1-1.11.2.30.1"><a href="#appendix-A.30" class="xref">A.30</a>. <a href="#name-rfc-8482-providing-minimal-" class="xref">RFC 8482 - Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.31">
                <p id="section-toc.1-1.11.2.31.1"><a href="#appendix-A.31" class="xref">A.31</a>. <a href="#name-rfc-8483-yeti-dns-testbed" class="xref">RFC 8483 - Yeti DNS Testbed</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.32">
                <p id="section-toc.1-1.11.2.32.1"><a href="#appendix-A.32" class="xref">A.32</a>. <a href="#name-rfc-8484-dns-queries-over-h" class="xref">RFC 8484 - DNS Queries over HTTPS (DoH)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.33">
                <p id="section-toc.1-1.11.2.33.1"><a href="#appendix-A.33" class="xref">A.33</a>. <a href="#name-rfc-8490-dns-stateful-opera" class="xref">RFC 8490 - DNS Stateful Operations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.34">
                <p id="section-toc.1-1.11.2.34.1"><a href="#appendix-A.34" class="xref">A.34</a>. <a href="#name-rfc-8501-reverse-dns-in-ipv" class="xref">RFC 8501 - Reverse DNS in IPv6 for Internet Service Providers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.35">
                <p id="section-toc.1-1.11.2.35.1"><a href="#appendix-A.35" class="xref">A.35</a>. <a href="#name-rfc-8806-running-a-root-ser" class="xref">RFC 8806 - Running a Root Server Local to a Resolver</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.36">
                <p id="section-toc.1-1.11.2.36.1"><a href="#appendix-A.36" class="xref">A.36</a>. <a href="#name-rfc-8906-a-common-operation" class="xref">RFC 8906 - A Common Operational Problem in DNS Servers: Failure to Communicate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.37">
                <p id="section-toc.1-1.11.2.37.1"><a href="#appendix-A.37" class="xref">A.37</a>. <a href="#name-rfc-8932-recommendations-fo" class="xref">RFC 8932 - Recommendations for DNS Privacy Service Operators</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.38">
                <p id="section-toc.1-1.11.2.38.1"><a href="#appendix-A.38" class="xref">A.38</a>. <a href="#name-rfc-8945-secret-key-transac" class="xref">RFC 8945 - Secret Key Transaction Authentication for DNS (TSIG)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DNS messages are delivered using UDP or TCP communications.
     While most DNS transactions are carried over UDP, some operators
     have been led to believe that any DNS-over-TCP traffic is unwanted
     or unnecessary for general DNS operation.  When DNS over TCP has
     been restricted, a variety of communication failures and debugging
     challenges often arise.  As DNS and new naming system features have
     evolved, TCP as a transport has become increasingly important for
     the correct and safe operation of an Internet DNS.  Reflecting
     modern usage, the DNS standards declare that
     support for TCP is a required part of the DNS implementation
     specifications <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span>.  This document is the
     equivalent of formal requirements for the operational community,
     encouraging system administrators, network engineers, and security
     staff to ensure DNS-over-TCP communications support is on par with
     DNS-over-UDP communications. It updates <span>[<a href="#RFC1123" class="xref">RFC1123</a>], <a href="https://www.rfc-editor.org/rfc/rfc1123#section-6.1.3.2" class="relref">Section 6.1.3.2</a></span> to clarify that all DNS resolvers and recursive
     servers
     <span class="bcp14">MUST</span> support and service both TCP and UDP queries and also
     updates <span>[<a href="#RFC1536" class="xref">RFC1536</a>]</span> to remove the misconception
     that TCP is only useful for zone transfers.<a href="#section-1-1" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-history-of-dns-over-tcp">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-history-of-dns-over-tcp" class="section-name selfRef">History of DNS over TCP</a>
      </h2>
<p id="section-2-1">The curious state of disagreement between operational best practices
     and guidance for DNS transport protocols derives from conflicting
     messages operators have received from other operators, implementors,
     and even the IETF.  Sometimes these mixed signals have been
     explicit; on other occasions, conflicting messages have been implicit.  This
     section presents an interpretation of the storied and conflicting
     history that led to this document.  This section is included for
     informational purposes only.<a href="#section-2-1" class="pilcrow">¶</a></p>
<section id="section-2.1">
        <h3 id="name-uneven-transport-usage-and-">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-uneven-transport-usage-and-" class="section-name selfRef">Uneven Transport Usage and Preference</a>
        </h3>
<p id="section-2.1-1">In the original suite of DNS specifications, <span>[<a href="#RFC1034" class="xref">RFC1034</a>]</span> and <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> clearly specify
       that DNS messages could be carried in either
       UDP or TCP, but they also state that there is a preference for UDP as the
       best transport for queries in the general case.  As stated in
       <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span>:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<blockquote id="section-2.1-2">
          While virtual circuits can be used for any DNS activity,
         datagrams are preferred for queries due to their lower overhead
         and better performance.<a href="#section-2.1-2" class="pilcrow">¶</a>
</blockquote>
<p id="section-2.1-3">Another early, important, and influential document, <span>[<a href="#RFC1123" class="xref">RFC1123</a>]</span>, marks the preference for a transport protocol more explicitly:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<blockquote id="section-2.1-4">
DNS resolvers and recursive servers <span class="bcp14">MUST</span> support UDP, and
         <span class="bcp14">SHOULD</span> support TCP, for sending (non-zone-transfer) queries.<a href="#section-2.1-4" class="pilcrow">¶</a>
</blockquote>
<p id="section-2.1-5">
       and it further stipulates that:<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<blockquote id="section-2.1-6">
A name server <span class="bcp14">MAY</span> limit the resources it devotes to TCP
         queries, but it <span class="bcp14">SHOULD NOT</span> refuse to service a TCP query just
         because it would have succeeded with UDP.<a href="#section-2.1-6" class="pilcrow">¶</a>
</blockquote>
<p id="section-2.1-7">Culminating in <span>[<a href="#RFC1536" class="xref">RFC1536</a>]</span>, DNS over TCP
       came to be associated primarily with the zone transfer mechanism,
       while most DNS queries and responses were seen as the dominion of
       UDP.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2">
        <h3 id="name-waiting-for-large-messages-">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-waiting-for-large-messages-" class="section-name selfRef">Waiting for Large Messages and Reliability</a>
        </h3>
<p id="section-2.2-1">In the original specifications, the maximum DNS-over-UDP
       message size was enshrined at 512 bytes.  However, even while
        <span>[<a href="#RFC1123" class="xref">RFC1123</a>]</span> prefers UDP for non-zone transfer
       queries, it foresaw that DNS over TCP would become more popular in the future to overcome this limitation:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<blockquote id="section-2.2-2">
[...] it is also clear that some new DNS record types
         defined in the future will contain information exceeding the
         512 byte limit that applies to UDP, and hence will require
         TCP.<a href="#section-2.2-2" class="pilcrow">¶</a>
</blockquote>
<p id="section-2.2-3">At least two new, widely anticipated developments were set to
 elevate the need for DNS-over-TCP transactions. The first was
       dynamic updates defined in <span>[<a href="#RFC2136" class="xref">RFC2136</a>]</span>, and the
       second was the set of extensions collectively known as "DNSSEC",
       whose operational considerations were originally given in <span>[<a href="#RFC2541" class="xref">RFC2541</a>]</span>
       (note that <span>[<a href="#RFC2541" class="xref">RFC2541</a>]</span> has been obsoleted by <span>[<a href="#RFC6781" class="xref">RFC6781</a>]</span>).  The
       former suggests that<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<blockquote id="section-2.2-4">
       ...requestors who require an accurate response
code must use TCP.<a href="#section-2.2-4" class="pilcrow">¶</a>
</blockquote>
<p id="section-2.2-5">
       while the latter warns that<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<blockquote id="section-2.2-6">... larger keys
       increase the size of the KEY and SIG RRs.  This increases the chance
       of DNS UDP packet overflow and the possible necessity for using
       higher overhead TCP in responses.<a href="#section-2.2-6" class="pilcrow">¶</a>
</blockquote>
<p id="section-2.2-7">Yet, defying some expectations, DNS over TCP remained little used
       in real traffic across the Internet in the late 1990s.  Dynamic updates saw
       little deployment between autonomous networks.  Around the time
       DNSSEC was first defined, another new feature helped solidify
       UDP transport dominance for message transactions.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
</section>
<section id="section-2.3">
        <h3 id="name-edns0">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-edns0" class="section-name selfRef">EDNS(0)</a>
        </h3>
<p id="section-2.3-1">In 1999, the IETF published the Extension Mechanisms for DNS (EDNS(0)) in <span>[<a href="#RFC2671" class="xref">RFC2671</a>]</span> (which was obsoleted by <span>[<a href="#RFC6891" class="xref">RFC6891</a>]</span> in 2013).  That document
       standardized a way for communicating DNS nodes to perform
       rudimentary capabilities negotiation.  One such capability
       written into the base specification and present in every EDNS(0)-compatible
       message is the value of the maximum UDP payload size
       the sender can support.  This unsigned 16-bit field specifies,
       in bytes, the maximum (possibly fragmented) DNS message size a
       node is capable of receiving over UDP.  In practice, typical values are
       a subset of the 512- to 4096-byte range.  EDNS(0) became
       widely deployed over the next several years, and numerous surveys
       (see <span>[<a href="#CASTRO2010" class="xref">CASTRO2010</a>]</span> and <span>[<a href="#NETALYZR" class="xref">NETALYZR</a>]</span>)
       have shown that many systems support larger UDP MTUs
       with EDNS(0).<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The natural effect of EDNS(0) deployment meant DNS messages
       larger than 512 bytes would be less reliant on TCP than they
       might otherwise have been.  While a non-negligible population of
       DNS systems lacked EDNS(0) or fell back to TCP when necessary,
       DNS clients still strongly prefer UDP to TCP.
       For example, as of 2014,
       DNS-over-TCP transactions remained a very small fraction of
       overall DNS traffic received by root name servers <span>[<a href="#VERISIGN" class="xref">VERISIGN</a>]</span>.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
<section id="section-2.4">
        <h3 id="name-fragmentation-and-truncatio">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-fragmentation-and-truncatio" class="section-name selfRef">Fragmentation and Truncation</a>
        </h3>
<p id="section-2.4-1">Although EDNS(0) provides a way for endpoints to signal support for
       DNS messages exceeding 512 bytes, the realities of a diverse and
       inconsistently deployed Internet may result in some large messages
       being unable to reach their destination.  Any IP datagram whose size
       exceeds the MTU of a link it transits will be fragmented and then
       reassembled by the receiving host.  Unfortunately, it is not uncommon
       for middleboxes and firewalls to block IP fragments.  If one or more
       fragments do not arrive, the application does not receive the message,
       and the request times out.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">For IPv4-connected hosts, the MTU is often an Ethernet
       payload size of 1500 bytes.  This means that the largest unfragmented
       UDP DNS message that can be sent over IPv4 is likely 1472 bytes,
       although tunnel encapsulation may reduce that maximum message
       size in some cases.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">For
       IPv6, the situation is a little more complicated.  First, IPv6 headers
       are 40 bytes (versus 20 without options in IPv4).  Second, approximately
       one-third of DNS recursive resolvers
       use the minimum MTU of 1280 bytes <span>[<a href="#APNIC" class="xref">APNIC</a>]</span>.
       Third, fragmentation in IPv6 can only be
       done by the host originating the datagram.  The need to fragment is
       conveyed in an ICMPv6 "Packet Too Big" message.  The originating host
       indicates a fragmented datagram with IPv6 extension headers.
       Unfortunately, it is quite common for both ICMPv6 and IPv6 extension
       headers to be blocked by middleboxes.  According to
       <span>[<a href="#HUSTON" class="xref">HUSTON</a>]</span>, some 35% of IPv6-capable
       recursive resolvers were unable to receive a fragmented IPv6 packet.
       When the originating host receives a signal that
       fragmentation is required, it is expected to populate its path
       MTU cache for that destination.  The application will then retry
       the query after a timeout since the host does not generally retain
       copies of messages sent over UDP for potential retransmission.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">The practical consequence of all this is that DNS requestors
       must be prepared to retry queries with different EDNS(0) maximum
       message size values. Administrators of <span>[<a href="#BIND" class="xref">BIND</a>]</span> are likely to be 
       familiar with seeing the following message in their system logs: "success resolving ... after reducing the
       advertised EDNS(0) UDP packet size to 512 octets".<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5">Often, reducing the EDNS(0) UDP packet size leads to a
       successful response.  That is, the necessary data fits within the
       smaller message size.  However, when the data does not fit, the
       server sets the truncated flag in its response, indicating the
       client should retry over TCP to receive the whole response.  This
       is undesirable from the client's point of view because it adds
       more latency and is potentially undesirable from the server's point
       of view due to the increased resource requirements of TCP.<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<p id="section-2.4-6">Note that a receiver is unable to differentiate between packets
       lost due to congestion and packets (fragments) intentionally
       dropped by firewalls or middleboxes.  Over network paths with
       non-trivial amounts of packet loss, larger, fragmented DNS responses
       are more likely to never arrive and time out compared to smaller,
       unfragmented responses.  Clients might be misled into retrying
       queries with different EDNS(0) UDP packet size values for the
       wrong reason.<a href="#section-2.4-6" class="pilcrow">¶</a></p>
<p id="section-2.4-7">The issues around fragmentation, truncation, and TCP are
       driving certain implementation and policy decisions in the DNS.
       Notably, Cloudflare implemented a technique that minimizes the number of DNSSEC denial-of-existence records (for its online signing platform)
       <span>[<a href="#CLOUDFLARE" class="xref">CLOUDFLARE</a>]</span> and uses an Elliptic Curve Digital
       Signature Algorithm (ECDSA) such that
       its signed responses fit easily in 512 bytes.  The Key Signing Key (KSK) Rollover
       Design Team <span>[<a href="#DESIGNTEAM" class="xref">DESIGNTEAM</a>]</span> spent a lot of time
       thinking and worrying about response sizes.  There is growing
       sentiment in the DNSSEC community that RSA key sizes beyond
       2048 bits are impractical and that critical infrastructure zones
       should transition to elliptic curve algorithms to keep response
       sizes manageable <span>[<a href="#ECDSA" class="xref">ECDSA</a>]</span>.<a href="#section-2.4-7" class="pilcrow">¶</a></p>
<p id="section-2.4-8">More recently, renewed security concerns about fragmented DNS
       messages (see <span>[<a href="#I-D.ietf-dnsop-avoid-fragmentation" class="xref">AVOID_FRAGS</a>]</span> and <span>[<a href="#FRAG_POISON" class="xref">FRAG_POISON</a>]</span>)
       are leading implementors to consider smaller responses and lower
       default EDNS(0) UDP payload size values for both queriers and
       responders <span>[<a href="#FLAGDAY2020" class="xref">FLAGDAY2020</a>]</span>.<a href="#section-2.4-8" class="pilcrow">¶</a></p>
</section>
<section id="section-2.5">
        <h3 id="name-only-zone-transfers-use-tcp">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-only-zone-transfers-use-tcp" class="section-name selfRef">"Only Zone Transfers Use TCP"</a>
        </h3>
<p id="section-2.5-1">Today, the majority of the DNS community expects, or at least
       has a desire, to see DNS-over-TCP transactions occur without
       interference <span>[<a href="#FLAGDAY2020" class="xref">FLAGDAY2020</a>]</span>.  However, there has also been a long-held belief by
       some operators, particularly for security-related reasons, that
       DNS-over-TCP services should be purposely limited or not provided
       at all <span>[<a href="#CHES94" class="xref">CHES94</a>]</span> <span>[<a href="#DJBDNS" class="xref">DJBDNS</a>]</span>.  A popular meme is
       that DNS over TCP is only ever used for zone
       transfers and is generally unnecessary otherwise, with filtering
       all DNS-over-TCP traffic even described as a best practice.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">The position on restricting DNS over TCP had some
       justification given that historical implementations of DNS
       name servers provided very little in the way of TCP connection
       management (for example, see <span><a href="https://www.rfc-editor.org/rfc/rfc7766#section-6.1.2" class="relref">Section 6.1.2</a> of [<a href="#RFC7766" class="xref">RFC7766</a>]</span> for more details).  However, modern
       standards and implementations are nearing parity with the more
       sophisticated TCP management techniques employed by, for example,
       HTTP(S) servers and load balancers.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
</section>
<section id="section-2.6">
        <h3 id="name-reuse-pipelining-and-out-of">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-reuse-pipelining-and-out-of" class="section-name selfRef">Reuse, Pipelining, and Out-of-Order Processing</a>
        </h3>
<p id="section-2.6-1">The idea that a TCP connection can support multiple transactions
       goes back as far as <span>[<a href="#RFC0883" class="xref">RFC0883</a>]</span>, which states:
       "Multiple messages may be sent over a virtual circuit." Although
       <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span>, which updates the former, omits this
       particular detail, it has been generally accepted that a TCP connection
       can be used for more than one query and response.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2"><span>[<a href="#RFC5966" class="xref">RFC5966</a>]</span> clarifies that servers are not
       required to preserve the order of queries and responses over
       any transport.
       <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span>, which updates the former, further
       encourages query pipelining over TCP to achieve performance on
       par with UDP.
       A server that sends out-of-order responses to pipelined queries
       avoids head-of-line blocking when the response for a later
       query is ready before the response to an earlier query.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<p id="section-2.6-3">However, TCP can potentially suffer from a different
       head-of-line blocking problem due to packet loss.
       Since TCP itself enforces ordering, a single lost segment
       delays delivery of data in any following segments until
       the lost segment is retransmitted and successfully received.<a href="#section-2.6-3" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-3">
      <h2 id="name-dns-over-tcp-requirements">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dns-over-tcp-requirements" class="section-name selfRef">DNS-over-TCP Requirements</a>
      </h2>
<p id="section-3-1">An average increase in DNS message size (e.g., due to DNSSEC),
     the continued development of new DNS features (<a href="#dnsrfcs" class="xref">Appendix A</a>), and a denial-of-service mitigation
     technique (<a href="#Security" class="xref">Section 8</a>) all show that
     DNS-over-TCP transactions are as important to the correct and safe
     operation of the Internet DNS as ever, if not more so.
     Furthermore, there has been research that argues
     connection-oriented DNS transactions may provide security and
     privacy advantages over UDP transport <span>[<a href="#TDNS" class="xref">TDNS</a>]</span>.
     In fact, the standard for DNS over TLS <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>
     is just this sort of specification.  Therefore, this document makes
     explicit that it is undesirable for network operators to
      artificially inhibit DNS-over-TCP transport.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2"><span><a href="https://www.rfc-editor.org/rfc/rfc1123#section-6.1.3.2" class="relref">Section 6.1.3.2</a> of [<a href="#RFC1123" class="xref">RFC1123</a>]</span> is updated as follows:<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">OLD:<a href="#section-3-3" class="pilcrow">¶</a></p>
<blockquote id="section-3-4">
        DNS resolvers and recursive servers <span class="bcp14">MUST</span> support UDP, and
        <span class="bcp14">SHOULD</span> support TCP, for sending (non-zone-transfer) queries.<a href="#section-3-4" class="pilcrow">¶</a>
</blockquote>
<p id="section-3-5">NEW:<a href="#section-3-5" class="pilcrow">¶</a></p>
<blockquote id="section-3-6">
          All DNS resolvers and servers <span class="bcp14">MUST</span> support and service 
          both UDP and TCP queries.<a href="#section-3-6" class="pilcrow">¶</a>
</blockquote>
<p id="section-3-7">Note that:<a href="#section-3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-8.1">DNS servers (including forwarders) <span class="bcp14">MUST</span> support and service
         TCP for receiving queries so that clients can reliably receive
         responses that are larger than what either side considers too large
         for UDP.<a href="#section-3-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-8.2">DNS clients <span class="bcp14">MUST</span> support TCP for sending
         queries so that they can retry truncated UDP responses as necessary.<a href="#section-3-8.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-9">
     Furthermore, the requirement in <span><a href="https://www.rfc-editor.org/rfc/rfc1123#section-6.1.3.2" class="relref">Section 6.1.3.2</a> of [<a href="#RFC1123" class="xref">RFC1123</a>]</span> around limiting the resources a server devotes
     to queries is hereby updated:<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">OLD:<a href="#section-3-10" class="pilcrow">¶</a></p>
<blockquote id="section-3-11">
          A name server <span class="bcp14">MAY</span> limit the resources it devotes to TCP queries,
          but it <span class="bcp14">SHOULD NOT</span> refuse to service a TCP query just
          because it would have succeeded with UDP.<a href="#section-3-11" class="pilcrow">¶</a>
</blockquote>
<p id="section-3-12">

     NEW:<a href="#section-3-12" class="pilcrow">¶</a></p>
<blockquote id="section-3-13">
           A name server <span class="bcp14">MAY</span> limit the resources it devotes to queries, but
           it <span class="bcp14">MUST NOT</span> refuse to service a query just because it would have
           succeeded with another transport protocol.<a href="#section-3-13" class="pilcrow">¶</a>
</blockquote>
<p id="section-3-14">Lastly, <span><a href="https://www.rfc-editor.org/rfc/rfc1536#section-1" class="relref">Section 1</a> of [<a href="#RFC1536" class="xref">RFC1536</a>]</span> is updated to eliminate
     the misconception that TCP is only useful for zone transfers:<a href="#section-3-14" class="pilcrow">¶</a></p>
<p id="section-3-15">OLD:<a href="#section-3-15" class="pilcrow">¶</a></p>
<blockquote id="section-3-16">
         DNS implements the classic request-response scheme of
         client-server interaction. UDP is, therefore, the chosen protocol
         for communication though TCP is used for zone transfers.<a href="#section-3-16" class="pilcrow">¶</a>
</blockquote>
<p id="section-3-17">

     NEW:<a href="#section-3-17" class="pilcrow">¶</a></p>
<blockquote id="section-3-18">
          DNS implements the classic request-response scheme of
          client-server interaction.<a href="#section-3-18" class="pilcrow">¶</a>
</blockquote>
<p id="section-3-19">The filtering of DNS over TCP is harmful in the general
     case.  DNS resolver and server operators <span class="bcp14">MUST</span> support and provide
     DNS service over both UDP and TCP transports.  Likewise, network
     operators <span class="bcp14">MUST</span> allow DNS service over both UDP and TCP transports.
     It is acknowledged that DNS-over-TCP service can pose operational
     challenges that are not present when running DNS over UDP alone,
     and vice versa.  However,
     the potential damage incurred by prohibiting DNS-over-TCP
     service is more detrimental to the continued utility and success of
     the DNS than when its usage is allowed.<a href="#section-3-19" class="pilcrow">¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-network-and-system-consider">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-network-and-system-consider" class="section-name selfRef">Network and System Considerations</a>
      </h2>
<p id="section-4-1">This section describes measures that systems and applications
   can take to optimize performance over TCP and to protect themselves
   from TCP-based resource exhaustion and attacks.<a href="#section-4-1" class="pilcrow">¶</a></p>
<section id="section-4.1">
        <h3 id="name-connection-establishment-an">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-connection-establishment-an" class="section-name selfRef">Connection Establishment and Admission</a>
        </h3>
<p id="section-4.1-1">Resolvers and other DNS clients should be aware that some
       servers might not be reachable over TCP.  For this reason, clients
       <span class="bcp14">MAY</span> track and limit the number of TCP connections and
       connection attempts to a single server.  Reachability problems
       can be caused by network elements close to the server, close
       to the client, or anywhere along the path between them.  Mobile
       clients that cache connection failures <span class="bcp14">MAY</span> do so on a per-network
       basis or <span class="bcp14">MAY</span> clear such a cache upon change of network.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Additionally, DNS clients
       <span class="bcp14">MAY</span> enforce a short timeout on unestablished connections
       rather than rely on the host operating system's TCP connection
       timeout, which is often around 60-120 seconds (i.e., due to an
       initial retransmission timeout of 1 second, the exponential
       back-off rules of <span>[<a href="#RFC6298" class="xref">RFC6298</a>]</span>, and a limit of six
       retries as is the default in Linux).<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The SYN flooding attack is a denial-of-service method
       affecting hosts that run TCP server processes <span>[<a href="#RFC4987" class="xref">RFC4987</a>]</span>.  This attack can be very effective if
       not mitigated.  One of the most effective mitigation techniques
       is SYN cookies, described in <span><a href="https://www.rfc-editor.org/rfc/rfc4987#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC4987" class="xref">RFC4987</a>]</span>, which allows the server to avoid allocating
       any state until the successful completion of the three-way
       handshake.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Services not intended for use by the public Internet,
       such as most recursive name servers, <span class="bcp14">SHOULD</span> be protected
       with access controls.  Ideally, these controls are placed in
       the network, well before any unwanted TCP packets can
       reach the DNS server host or application.  If this is not
       possible, the controls can be placed in the application
       itself.  In some situations (e.g., attacks), it may be necessary
       to deploy access controls for DNS services that should
       otherwise be globally reachable.  See also <span>[<a href="#RFC5358" class="xref">RFC5358</a>]</span>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">The FreeBSD and NetBSD operating systems have an "accept filter" feature
       (<span>[<a href="#accept_filter" class="xref">accept_filter</a>]</span>)
       that postpones delivery of TCP connections to applications
       until a complete, valid request has been received.  The
       dns_accf(9) filter ensures that a valid DNS message is
       received.  If not, the bogus connection never reaches the
       application.
       The Linux TCP_DEFER_ACCEPT feature, while more limited in scope,
       can provide some of the same benefits as the BSD accept filter
       feature.
       These features are implemented as low-level socket options
       and are not activated automatically. If applications wish to
       use these features, they need to make specific calls to set the
       right options, and administrators may also need to configure the
       applications to appropriately use the features.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">Per <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span>, applications and administrators
       are advised to remember that TCP <span class="bcp14">MAY</span> be used before sending
       any UDP queries.  Networks and applications <span class="bcp14">MUST NOT</span> be configured
       to refuse TCP queries that were not preceded by a UDP query.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">TCP Fast Open (TFO) <span>[<a href="#RFC7413" class="xref">RFC7413</a>]</span> allows TCP
       clients to shorten the handshake for subsequent connections
       to the same server.  TFO saves one round-trip time in the
       connection setup.  DNS servers <span class="bcp14">SHOULD</span> enable TFO when possible.
       Furthermore, DNS servers clustered behind a single service
       address (e.g., anycast or load balancing) <span class="bcp14">SHOULD</span> either use the
       same TFO server key on all instances or disable TFO for all members of the cluster.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">DNS clients <span class="bcp14">MAY</span> also enable TFO.  At the time of this writing, it is not implemented or is disabled by default on some operating systems.
       <span>[<a href="#WIKIPEDIA_TFO" class="xref">WIKIPEDIA_TFO</a>]</span> describes applications and operating systems
       that support TFO.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2">
        <h3 id="name-connection-management">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-connection-management" class="section-name selfRef">Connection Management</a>
        </h3>
<p id="section-4.2-1">Since host memory for TCP state is a finite resource, DNS
       clients and
       servers <span class="bcp14">SHOULD</span> actively manage their connections.  Applications
       that do not actively manage their connections
       can encounter resource exhaustion leading to denial of
       service.  For DNS, as in other protocols, there is a trade-off
       between keeping connections open for potential future use and
       the need to free up resources for new connections that will arrive.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Operators of DNS server software <span class="bcp14">SHOULD</span> be aware that operating
       system and application vendors <span class="bcp14">MAY</span> impose a limit on the total
       number of established connections.  These limits may be designed
       to protect against DDoS attacks or performance degradation.
       Operators <span class="bcp14">SHOULD</span> understand how to increase these limits if
       necessary and the consequences of doing so.  Limits imposed by
       the application <span class="bcp14">SHOULD</span> be lower than limits imposed by the
       operating system so that the application can apply its own
       policy to connection management, such as closing the oldest
       idle connections first.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">DNS server software <span class="bcp14">MAY</span> provide a configurable limit on
       the number of established connections per source IP address
       or subnet.  This can be used to ensure that a single or small
       set of users cannot consume all TCP resources and deny
       service to other users.  Note, however, that if this limit
       is enabled, it possibly limits client performance while leaving
       some TCP resources unutilized. Operators <span class="bcp14">SHOULD</span> be aware of
       these trade-offs and ensure this limit, if configured, 
       is set appropriately based on the number and diversity
       of their users and  whether users connect from unique IP addresses or
       through a shared Network Address Translator (NAT) <span>[<a href="#RFC3022" class="xref">RFC3022</a>]</span>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">DNS server software <span class="bcp14">SHOULD</span> provide a configurable timeout
       for idle TCP connections.  This can be used to free up resources
       for new connections and to ensure that idle
       connections are eventually closed.  At the same time, it possibly
       limits client performance while leaving some TCP resources unutilized.
       For very busy name servers, this
       might be set to a low value, such as a few seconds.  For
       less busy servers, it might be set to a higher value, such
       as tens of seconds. DNS clients and servers <span class="bcp14">SHOULD</span> signal
       their timeout values using the edns-tcp-keepalive EDNS(0)
       option <span>[<a href="#RFC7828" class="xref">RFC7828</a>]</span>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">DNS server software <span class="bcp14">MAY</span> provide a configurable limit on
       the number of transactions per TCP connection.
       This can help protect against unfair connection use (e.g., not releasing
       connection slots to other clients) and network evasion attacks.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">Similarly, DNS server software <span class="bcp14">MAY</span> provide a configurable
       limit on the total duration of a TCP connection.
       This can help protect against unfair connection use, slow read attacks, 
       and network evasion attacks.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">Since clients may not be aware of server-imposed limits,
       clients utilizing TCP for DNS need to always be prepared to
       re-establish connections or otherwise retry outstanding
       queries.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3">
        <h3 id="name-connection-termination">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-connection-termination" class="section-name selfRef">Connection Termination</a>
        </h3>
<p id="section-4.3-1">The TCP peer that initiates a
       connection close retains the socket in the TIME_WAIT state
       for some amount of time, possibly a few minutes. 
       It is generally preferable for clients to initiate the
       close of a TCP connection so that busy servers do not 
       accumulate many sockets in the TIME_WAIT state, which can
       cause performance problems or even denial of service.
       The edns-tcp-keepalive EDNS(0) option <span>[<a href="#RFC7828" class="xref">RFC7828</a>]</span>
       can be used to encourage clients to close connections.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">On systems where large numbers of sockets in TIME_WAIT
       are observed (as either a client or a server) and are affecting
       an application's performance, it may be tempting to tune local TCP
       parameters.  For example, the Linux kernel has
       a "sysctl" parameter named net.ipv4.tcp_tw_reuse, which allows
       connections in the TIME_WAIT state to be reused in specific
       circumstances.  Note, however, that this affects only outgoing (client)
       connections and has no impact on servers.  In most cases, it is <span class="bcp14">NOT RECOMMENDED</span> to change parameters related to the TIME_WAIT state.
       It should only be done by those with detailed knowledge of both TCP
       and the affected application.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
</section>
<section id="section-4.4">
        <h3 id="name-dns-over-tls">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-dns-over-tls" class="section-name selfRef">DNS over TLS</a>
        </h3>
<p id="section-4.4-1">DNS messages may be sent over TLS to provide privacy
       between stubs and recursive resolvers. <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>
       is a Standards Track document describing how this works.
       Although DNS over TLS utilizes TCP port 853 instead of port 53, this
       document applies equally well to DNS over TLS.  Note, however,
       that DNS over TLS is only defined between stubs and
       recursives at the time of this writing.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The use of TLS places even stronger operational burdens
       on DNS clients and servers.  Cryptographic functions for
       authentication and encryption require additional processing.
       Unoptimized connection setup with TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>
       takes one additional round trip compared to TCP.
       Connection setup
       times can be reduced with TCP Fast Open and TLS False Start <span>[<a href="#RFC7918" class="xref">RFC7918</a>]</span> for TLS 1.2.  TLS 1.3 session resumption does not
       reduce round-trip latency because no application profile for use of
       TLS 0-RTT data with DNS has been published at the time of this
       writing.  However, TLS session resumption can reduce the number of
       cryptographic operations, and in TLS 1.2, session resumption does
       reduce the number of additional round trips from two to one.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
</section>
<section id="section-4.5">
        <h3 id="name-defaults-and-recommended-li">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-defaults-and-recommended-li" class="section-name selfRef">Defaults and Recommended Limits</a>
        </h3>
<p id="section-4.5-1">A survey of features and defaults was conducted for popular
       open-source DNS server implementations at the time of writing.
       This section documents those defaults and makes recommendations
       for configurable limits that can be used in the absence of any
       other information.  Any recommended values in this document are
       only intended as a starting point for administrators that are
       unsure of what sorts of limits might be reasonable. Operators <span class="bcp14">SHOULD</span>
       use application-specific monitoring, system logs, and system
       monitoring tools to gauge whether their service is operating
       within or exceeding these limits and adjust accordingly.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">Most open-source DNS server implementations provide a
       configurable limit on the total number of established connections.
       Default values range from 20 to 150.  In most cases, where the
       majority of queries take place over UDP, 150 is a reasonable limit.
       For services or environments where most queries take place over
       TCP or TLS, 5000 is a more appropriate limit.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">Only some open-source implementations provide a way to limit
       the number of connections per source IP address or subnet, but
       the default is to have no limit.  For environments or situations
       where it may be necessary to enable this limit, 25 connections
       per source IP address is a reasonable starting point.  The limit
       should be increased when aggregated by subnet or for services
       where most queries take place over TCP or TLS.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">Most open-source implementations provide a configurable idle
       timeout on connections.  Default values range from 2 to 30 seconds.
       In most cases, 10 seconds is a reasonable default for this limit.
       Longer timeouts improve connection reuse, but busy servers may
       need to use a lower limit.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">Only some open-source implementations provide a way to limit
       the number of transactions per connection, but the default is to
       have no limit.  This document does not offer advice on particular
       values for such a limit.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<p id="section-4.5-6">Only some open-source implementations provide a way to limit
       the duration of connection, but the default is to have no limit.
       This document does not offer advice on particular values for such
       a limit.<a href="#section-4.5-6" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-5">
      <h2 id="name-dns-over-tcp-filtering-risk">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dns-over-tcp-filtering-risk" class="section-name selfRef">DNS-over-TCP Filtering Risks</a>
      </h2>
<p id="section-5-1">Networks that filter DNS over TCP risk losing access to
     significant or important pieces of the DNS namespace.  For a
     variety of reasons, a DNS answer may require a DNS-over-TCP query.
     This may include large message sizes, lack of EDNS(0) support, or DDoS
     mitigation techniques (including Response Rate Limiting <span>[<a href="#RRL" class="xref">RRL</a>]</span>); additionally, perhaps some future capability that is as
     yet unforeseen will also demand TCP transport.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">For example, <span>[<a href="#RFC7901" class="xref">RFC7901</a>]</span> describes a latency-avoiding
     technique that sends extra data in DNS responses.  This makes
     responses larger and potentially increases the effectiveness of DDoS reflection
     attacks.  The specification mandates the use of TCP or DNS
     cookies <span>[<a href="#RFC7873" class="xref">RFC7873</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Even if any or all particular answers have consistently been
     returned successfully with UDP in the past, this continued behavior
     cannot be guaranteed when DNS messages are exchanged between
     autonomous systems.  Therefore, filtering of DNS over TCP is
     considered harmful and contrary to the safe and successful operation
     of the Internet.  This section enumerates some of the known risks
     at the time of this writing when networks filter DNS over
     TCP.<a href="#section-5-3" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-truncation-retries-and-time">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-truncation-retries-and-time" class="section-name selfRef">Truncation, Retries, and Timeouts</a>
        </h3>
<p id="section-5.1-1">Networks that filter DNS over TCP may inadvertently cause
       problems for third-party resolvers as experienced by <span>[<a href="#TOYAMA" class="xref">TOYAMA</a>]</span>.  For example, a resolver receives queries
       for a moderately popular domain.  The resolver forwards the queries
       to the domain's authoritative name servers, but those servers
       respond with the TC bit set.  The resolver retries over TCP,
       but the authoritative server blocks DNS over TCP.  The pending
       connections consume resources on the resolver until they time out.
       If the number
       and frequency of these truncated-and-then-blocked queries are sufficiently high,
       the resolver wastes valuable resources on queries that can never be answered.
       This condition is generally not easily or completely mitigated by the
       affected DNS resolver operator.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-dns-root-zone-ksk-rollover">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-dns-root-zone-ksk-rollover" class="section-name selfRef">DNS Root Zone KSK Rollover</a>
        </h3>
<p id="section-5.2-1">The plans for deploying DNSSEC KSK for the root zone highlighted
       a potential problem in retrieving the root zone key set <span>[<a href="#LEWIS" class="xref">LEWIS</a>]</span>.  During some phases of the KSK rollover process,
       root zone DNSKEY responses were
       larger than 1280 bytes, the IPv6 minimum MTU for links
       carrying IPv6 traffic <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>.
       There was some concern
       that any DNS server unable to receive large
       DNS messages over UDP, or any DNS message over TCP, would experience
       disruption while performing DNSSEC validation <span>[<a href="#KSK_ROLLOVER_ARCHIVES" class="xref">KSK_ROLLOVER_ARCHIVES</a>]</span>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">However, during the
       year-long postponement of the KSK rollover, there were no reported problems
       that could be attributed to the 1414 octet DNSKEY response when both
       the old and new keys were published in the zone.  Additionally, there
       were no reported problems during the two-month period when the old key was
       published as revoked and the DNSKEY response was 1425 octets in size <span>[<a href="#ROLL_YOUR_ROOT" class="xref">ROLL_YOUR_ROOT</a>]</span>.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</section>
<div id="logging-monitoring">
<section id="section-6">
      <h2 id="name-logging-and-monitoring">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-logging-and-monitoring" class="section-name selfRef">Logging and Monitoring</a>
      </h2>
<p id="section-6-1">Developers of applications that log or monitor DNS
     <span class="bcp14">SHOULD NOT</span> ignore TCP due to the perception that it is rarely used or
     is hard to process.  Operators <span class="bcp14">SHOULD</span> ensure that
     their monitoring and logging applications properly capture
     DNS messages over TCP.  Otherwise, attacks, exfiltration
     attempts, and normal traffic may go undetected.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">DNS messages over TCP are in no way guaranteed to arrive
     in single segments.  In fact, a clever attacker might attempt
     to hide certain messages by forcing them over very small TCP
     segments.  Applications that capture network packets (e.g.,
     with libpcap <span>[<a href="#libpcap" class="xref">libpcap</a>]</span>) <span class="bcp14">SHOULD</span> implement and perform full
     TCP stream reassembly and analyze the reassembled stream instead of the individual packets.
     Otherwise, they are vulnerable to network evasion attacks <span>[<a href="#phrack" class="xref">phrack</a>]</span>.
     
     Furthermore, such applications need to protect
     themselves from resource exhaustion attacks by limiting the amount
     of memory allocated to tracking unacknowledged connection state data.
     dnscap <span>[<a href="#dnscap" class="xref">dnscap</a>]</span> is an
     open-source example of a DNS logging program that implements
     TCP stream reassembly.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Developers <span class="bcp14">SHOULD</span> also keep in mind connection reuse,
     query pipelining, and out-of-order responses when building and testing
     DNS monitoring applications.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">As an alternative to packet capture, some DNS server software
     supports dnstap <span>[<a href="#dnstap" class="xref">dnstap</a>]</span> as an integrated monitoring
     protocol intended to facilitate wide-scale DNS monitoring.<a href="#section-6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no IANA actions.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">This document, providing operational requirements, is the
     companion to the implementation requirements of DNS over TCP
     provided in <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span>.  The security considerations
     from <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span> still apply.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Ironically, returning truncated DNS-over-UDP answers in order
     to induce a client query to switch to DNS over TCP has become
     a common response to source-address-spoofed, DNS denial-of-service
     attacks <span>[<a href="#RRL" class="xref">RRL</a>]</span>.  Historically, operators have
     been wary of TCP-based attacks, but in recent years, UDP-based
     flooding attacks have proven to be the most common protocol attack
     on the DNS.  Nevertheless, a high rate of short-lived DNS
     transactions over TCP may pose challenges.  In fact, <span>[<a href="#DAI21" class="xref">DAI21</a>]</span> details a class of IP fragmentation attacks
     on DNS transactions if the IP Identifier field (16 bits in IPv4 and 32 bits in IPv6) can be predicted and a
     system is coerced to fragment rather than retransmit messages.
     While many operators have provided DNS-over-TCP service for many
     years without duress, past experience is no guarantee of future
     success.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">DNS over TCP is similar to many other Internet TCP services.
     TCP threats and many mitigation strategies have been
     well documented in a series of documents such as <span>[<a href="#RFC4953" class="xref">RFC4953</a>]</span>, <span>[<a href="#RFC4987" class="xref">RFC4987</a>]</span>, <span>[<a href="#RFC5927" class="xref">RFC5927</a>]</span>, and <span>[<a href="#RFC5961" class="xref">RFC5961</a>]</span>.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">As mentioned in <a href="#logging-monitoring" class="xref">Section 6</a>, applications
     that implement TCP stream reassembly need to limit the amount of
     memory allocated to connection tracking.  A failure to do so could
     lead to a total failure of the logging or monitoring application.
     Imposition of resource limits creates a trade-off between allowing
     some stream reassembly to continue and allowing some evasion attacks
     to succeed.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">This document recommends that DNS servers enable TFO when possible.  <span>[<a href="#RFC7413" class="xref">RFC7413</a>]</span>
     recommends that a pool of servers behind a load balancer with a shared
     server IP address also share the key used to generate Fast Open cookies
     to prevent inordinate fallback to the three-way handshake (3WHS).  This guidance remains
     accurate but comes with a caveat: compromise of one server would reveal
     this group-shared key and allow for attacks involving the other servers
     in the pool by forging invalid Fast Open cookies.<a href="#section-8-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Privacy">
<section id="section-9">
      <h2 id="name-privacy-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-9-1">Since DNS over both UDP and TCP uses the same underlying message
     format, the use of one transport instead of the other does not change
     the privacy characteristics of the message content (i.e., the name
     being queried). A number of protocols have recently been developed to 
     provide DNS privacy, including DNS over TLS <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>,
     DNS over DTLS <span>[<a href="#RFC8094" class="xref">RFC8094</a>]</span>, DNS over HTTPS
     <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>, with even more on the way.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Because TCP is somewhat more complex than UDP, some
     characteristics of a TCP conversation may enable DNS client fingerprinting and
     tracking that is not possible with UDP.  For example, the choice of
     initial sequence numbers, window size, and options might be able
     to identify a particular TCP implementation or even individual
     hosts behind shared resources such as NATs.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2181">[RFC2181]</dt>
        <dd>
<span class="refAuthor">Elz, R.</span> and <span class="refAuthor">R. Bush</span>, <span class="refTitle">"Clarifications to the DNS Specification"</span>, <span class="seriesInfo">RFC 2181</span>, <span class="seriesInfo">DOI 10.17487/RFC2181</span>, <time datetime="1997-07" class="refDate">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2181">https://www.rfc-editor.org/info/rfc2181</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6891">[RFC6891]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Graff, M.</span>, and <span class="refAuthor">P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6891">https://www.rfc-editor.org/info/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7766">[RFC7766]</dt>
        <dd>
<span class="refAuthor">Dickinson, J.</span>, <span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Bellis, R.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">D. Wessels</span>, <span class="refTitle">"DNS Transport over TCP - Implementation Requirements"</span>, <span class="seriesInfo">RFC 7766</span>, <span class="seriesInfo">DOI 10.17487/RFC7766</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7766">https://www.rfc-editor.org/info/rfc7766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7828">[RFC7828]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span>, <span class="refAuthor">Abley, J.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">R. Bellis</span>, <span class="refTitle">"The edns-tcp-keepalive EDNS0 Option"</span>, <span class="seriesInfo">RFC 7828</span>, <span class="seriesInfo">DOI 10.17487/RFC7828</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7828">https://www.rfc-editor.org/info/rfc7828</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7873">[RFC7873]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">M. Andrews</span>, <span class="refTitle">"Domain Name System (DNS) Cookies"</span>, <span class="seriesInfo">RFC 7873</span>, <span class="seriesInfo">DOI 10.17487/RFC7873</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7873">https://www.rfc-editor.org/info/rfc7873</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="accept_filter">[accept_filter]</dt>
        <dd>
<span class="refAuthor">FreeBSD</span>, <span class="refTitle">"FreeBSD accept_filter(9)"</span>, <time datetime="2000-06" class="refDate">June 2000</time>, <span>&lt;<a href="https://www.freebsd.org/cgi/man.cgi?query=accept_filter">https://www.freebsd.org/cgi/man.cgi?query=accept_filter</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="APNIC">[APNIC]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refTitle">"DNS XL"</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://labs.apnic.net/?p=1380">https://labs.apnic.net/?p=1380</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dnsop-avoid-fragmentation">[AVOID_FRAGS]</dt>
        <dd>
<span class="refAuthor">Fujiwara, K.</span> and <span class="refAuthor">P. Vixie</span>, <span class="refTitle">"Fragmentation Avoidance in DNS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dnsop-avoid-fragmentation-06</span>, <time datetime="2021-12-23" class="refDate">23 December 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-avoid-fragmentation-06">https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-avoid-fragmentation-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BIND">[BIND]</dt>
        <dd>
<span class="refAuthor">Internet Systems Consortium</span>, <span class="refTitle">"BIND 9"</span>, <span>&lt;<a href="https://www.isc.org/bind/">https://www.isc.org/bind/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CASTRO2010">[CASTRO2010]</dt>
        <dd>
<span class="refAuthor">Castro, S.</span>, <span class="refAuthor">Zhang, M.</span>, <span class="refAuthor">John, W.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">K. claffy</span>, <span class="refTitle">"Understanding and Preparing for DNS Evolution"</span>, <span class="seriesInfo">DOI 10.1007/978-3-642-12365-8_1</span>, <time datetime="2010-04" class="refDate">April 2010</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-642-12365-8_1">https://doi.org/10.1007/978-3-642-12365-8_1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHES94">[CHES94]</dt>
        <dd>
<span class="refAuthor">Cheswick, W.</span> and <span class="refAuthor">S. Bellovin</span>, <span class="refTitle">"Firewalls and Internet Security: Repelling the Wily Hacker"</span>, <span class="refContent">First Edition</span>, <time datetime="1994" class="refDate">1994</time>. </dd>
<dd class="break"></dd>
<dt id="CLOUDFLARE">[CLOUDFLARE]</dt>
        <dd>
<span class="refAuthor">Grant, D.</span>, <span class="refTitle">"Economical With The Truth: Making DNSSEC Answers Cheap"</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://blog.cloudflare.com/black-lies/">https://blog.cloudflare.com/black-lies/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DAI21">[DAI21]</dt>
        <dd>
<span class="refAuthor">Dai, T.</span>, <span class="refAuthor">Shulman, H.</span>, and <span class="refAuthor">M. Waidner</span>, <span class="refTitle">"DNS-over-TCP Considered Vulnerable"</span>, <span class="seriesInfo">DOI 10.1145/3472305.3472884</span>, <time datetime="2021-07" class="refDate">July 2021</time>, <span>&lt;<a href="https://doi.org/10.1145/3472305.3472884">https://doi.org/10.1145/3472305.3472884</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DESIGNTEAM">[DESIGNTEAM]</dt>
        <dd>
<span class="refAuthor">ICANN</span>, <span class="refTitle">"Root Zone KSK Rollover Plan"</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.iana.org/reports/2016/root-ksk-rollover-design-20160307.pdf">https://www.iana.org/reports/2016/root-ksk-rollover-design-20160307.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DJBDNS">[DJBDNS]</dt>
        <dd>
<span class="refAuthor">Bernstein, D.</span>, <span class="refTitle">"When are TCP queries sent?"</span>, <time datetime="2002-11" class="refDate">November 2002</time>, <span>&lt;<a href="https://cr.yp.to/djbdns/tcp.html#why">https://cr.yp.to/djbdns/tcp.html#why</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="dnscap">[dnscap]</dt>
        <dd>
<span class="refAuthor">DNS-OARC</span>, <span class="refTitle">"DNSCAP"</span>, <time datetime="2014-02" class="refDate">February 2014</time>, <span>&lt;<a href="https://www.dns-oarc.net/tools/dnscap">https://www.dns-oarc.net/tools/dnscap</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="dnstap">[dnstap]</dt>
        <dd>
<span class="refTitle">"dnstap"</span>, <span>&lt;<a href="https://dnstap.info">https://dnstap.info</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ECDSA">[ECDSA]</dt>
        <dd>
<span class="refAuthor">van Rijswijk-Deij, R.</span>, <span class="refAuthor">Sperotto, A.</span>, and <span class="refAuthor">A. Pras</span>, <span class="refTitle">"Making the Case for Elliptic Curves in DNSSEC"</span>, <span class="seriesInfo">DOI 10.1145/2831347.2831350</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/2831347.2831350">https://dl.acm.org/doi/10.1145/2831347.2831350</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FLAGDAY2020">[FLAGDAY2020]</dt>
        <dd>
<span class="refAuthor">DNS Software and Service Providers</span>, <span class="refTitle">"DNS Flag Day 2020"</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://dnsflagday.net/2020/">https://dnsflagday.net/2020/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FRAG_POISON">[FRAG_POISON]</dt>
        <dd>
<span class="refAuthor">Herzberg, A.</span> and <span class="refAuthor">H. Shulman</span>, <span class="refTitle">"Fragmentation Considered Poisonous"</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://arxiv.org/pdf/1205.4011.pdf">https://arxiv.org/pdf/1205.4011.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HUSTON">[HUSTON]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refTitle">"Dealing with IPv6 fragmentation in the DNS"</span>, <time datetime="2017-08" class="refDate">August 2017</time>, <span>&lt;<a href="https://blog.apnic.net/2017/08/22/dealing-ipv6-fragmentation-dns/">https://blog.apnic.net/2017/08/22/dealing-ipv6-fragmentation-dns/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KSK_ROLLOVER_ARCHIVES">[KSK_ROLLOVER_ARCHIVES]</dt>
        <dd>
<span class="refAuthor">ICANN</span>, <span class="refTitle">"KSK Rollover List Archives"</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://mm.icann.org/pipermail/ksk-rollover/2019-January/date.html">https://mm.icann.org/pipermail/ksk-rollover/2019-January/date.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LEWIS">[LEWIS]</dt>
        <dd>
<span class="refAuthor">Lewis, E.</span>, <span class="refTitle">"2017 DNSSEC KSK Rollover"</span>, <span class="refContent">RIPE 74</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://ripe74.ripe.net/presentations/25-RIPE74-lewis-submission.pdf">https://ripe74.ripe.net/presentations/25-RIPE74-lewis-submission.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="libpcap">[libpcap]</dt>
        <dd>
<span class="refAuthor">The Tcpdump Group</span>, <span class="refTitle">"Tcpdump and Libpcap"</span>, <span>&lt;<a href="https://www.tcpdump.org">https://www.tcpdump.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NETALYZR">[NETALYZR]</dt>
        <dd>
<span class="refAuthor">Kreibich, C.</span>, <span class="refAuthor">Weaver, N.</span>, <span class="refAuthor">Nechaev, B.</span>, and <span class="refAuthor">V. Paxson</span>, <span class="refTitle">"Netalyzr: Illuminating The Edge Network"</span>, <span class="seriesInfo">DOI 10.1145/1879141.1879173</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://doi.org/10.1145/1879141.1879173">https://doi.org/10.1145/1879141.1879173</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="phrack">[phrack]</dt>
        <dd>
<span class="refAuthor">horizon</span>, <span class="refTitle">"Defeating Sniffers and Intrusion Detection Systems"</span>, <span class="refContent">Phrack Magazine</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="http://phrack.org/issues/54/10.html">http://phrack.org/issues/54/10.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0883">[RFC0883]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names: Implementation specification"</span>, <span class="seriesInfo">RFC 883</span>, <span class="seriesInfo">DOI 10.17487/RFC0883</span>, <time datetime="1983-11" class="refDate">November 1983</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc883">https://www.rfc-editor.org/info/rfc883</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1123">[RFC1123]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Application and Support"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1123</span>, <span class="seriesInfo">DOI 10.17487/RFC1123</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1123">https://www.rfc-editor.org/info/rfc1123</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1536">[RFC1536]</dt>
        <dd>
<span class="refAuthor">Kumar, A.</span>, <span class="refAuthor">Postel, J.</span>, <span class="refAuthor">Neuman, C.</span>, <span class="refAuthor">Danzig, P.</span>, and <span class="refAuthor">S. Miller</span>, <span class="refTitle">"Common DNS Implementation Errors and Suggested Fixes"</span>, <span class="seriesInfo">RFC 1536</span>, <span class="seriesInfo">DOI 10.17487/RFC1536</span>, <time datetime="1993-10" class="refDate">October 1993</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1536">https://www.rfc-editor.org/info/rfc1536</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1995">[RFC1995]</dt>
        <dd>
<span class="refAuthor">Ohta, M.</span>, <span class="refTitle">"Incremental Zone Transfer in DNS"</span>, <span class="seriesInfo">RFC 1995</span>, <span class="seriesInfo">DOI 10.17487/RFC1995</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1995">https://www.rfc-editor.org/info/rfc1995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1996">[RFC1996]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span>, <span class="refTitle">"A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"</span>, <span class="seriesInfo">RFC 1996</span>, <span class="seriesInfo">DOI 10.17487/RFC1996</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1996">https://www.rfc-editor.org/info/rfc1996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2136">[RFC2136]</dt>
        <dd>
<span class="refAuthor">Vixie, P., Ed.</span>, <span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Rekhter, Y.</span>, and <span class="refAuthor">J. Bound</span>, <span class="refTitle">"Dynamic Updates in the Domain Name System (DNS UPDATE)"</span>, <span class="seriesInfo">RFC 2136</span>, <span class="seriesInfo">DOI 10.17487/RFC2136</span>, <time datetime="1997-04" class="refDate">April 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2136">https://www.rfc-editor.org/info/rfc2136</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2541">[RFC2541]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"DNS Security Operational Considerations"</span>, <span class="seriesInfo">RFC 2541</span>, <span class="seriesInfo">DOI 10.17487/RFC2541</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2541">https://www.rfc-editor.org/info/rfc2541</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2671">[RFC2671]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS0)"</span>, <span class="seriesInfo">RFC 2671</span>, <span class="seriesInfo">DOI 10.17487/RFC2671</span>, <time datetime="1999-08" class="refDate">August 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2671">https://www.rfc-editor.org/info/rfc2671</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2694">[RFC2694]</dt>
        <dd>
<span class="refAuthor">Srisuresh, P.</span>, <span class="refAuthor">Tsirtsis, G.</span>, <span class="refAuthor">Akkiraju, P.</span>, and <span class="refAuthor">A. Heffernan</span>, <span class="refTitle">"DNS extensions to Network Address Translators (DNS_ALG)"</span>, <span class="seriesInfo">RFC 2694</span>, <span class="seriesInfo">DOI 10.17487/RFC2694</span>, <time datetime="1999-09" class="refDate">September 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2694">https://www.rfc-editor.org/info/rfc2694</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3022">[RFC3022]</dt>
        <dd>
<span class="refAuthor">Srisuresh, P.</span> and <span class="refAuthor">K. Egevang</span>, <span class="refTitle">"Traditional IP Network Address Translator (Traditional NAT)"</span>, <span class="seriesInfo">RFC 3022</span>, <span class="seriesInfo">DOI 10.17487/RFC3022</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3022">https://www.rfc-editor.org/info/rfc3022</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3225">[RFC3225]</dt>
        <dd>
<span class="refAuthor">Conrad, D.</span>, <span class="refTitle">"Indicating Resolver Support of DNSSEC"</span>, <span class="seriesInfo">RFC 3225</span>, <span class="seriesInfo">DOI 10.17487/RFC3225</span>, <time datetime="2001-12" class="refDate">December 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3225">https://www.rfc-editor.org/info/rfc3225</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3226">[RFC3226]</dt>
        <dd>
<span class="refAuthor">Gudmundsson, O.</span>, <span class="refTitle">"DNSSEC and IPv6 A6 aware server/resolver message size requirements"</span>, <span class="seriesInfo">RFC 3226</span>, <span class="seriesInfo">DOI 10.17487/RFC3226</span>, <time datetime="2001-12" class="refDate">December 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3226">https://www.rfc-editor.org/info/rfc3226</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4472">[RFC4472]</dt>
        <dd>
<span class="refAuthor">Durand, A.</span>, <span class="refAuthor">Ihren, J.</span>, and <span class="refAuthor">P. Savola</span>, <span class="refTitle">"Operational Considerations and Issues with IPv6 DNS"</span>, <span class="seriesInfo">RFC 4472</span>, <span class="seriesInfo">DOI 10.17487/RFC4472</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4472">https://www.rfc-editor.org/info/rfc4472</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4953">[RFC4953]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Defending TCP Against Spoofing Attacks"</span>, <span class="seriesInfo">RFC 4953</span>, <span class="seriesInfo">DOI 10.17487/RFC4953</span>, <time datetime="2007-07" class="refDate">July 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4953">https://www.rfc-editor.org/info/rfc4953</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4987">[RFC4987]</dt>
        <dd>
<span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"TCP SYN Flooding Attacks and Common Mitigations"</span>, <span class="seriesInfo">RFC 4987</span>, <span class="seriesInfo">DOI 10.17487/RFC4987</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4987">https://www.rfc-editor.org/info/rfc4987</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5358">[RFC5358]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span> and <span class="refAuthor">F. Neves</span>, <span class="refTitle">"Preventing Use of Recursive Nameservers in Reflector Attacks"</span>, <span class="seriesInfo">BCP 140</span>, <span class="seriesInfo">RFC 5358</span>, <span class="seriesInfo">DOI 10.17487/RFC5358</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5358">https://www.rfc-editor.org/info/rfc5358</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5452">[RFC5452]</dt>
        <dd>
<span class="refAuthor">Hubert, A.</span> and <span class="refAuthor">R. van Mook</span>, <span class="refTitle">"Measures for Making DNS More Resilient against Forged Answers"</span>, <span class="seriesInfo">RFC 5452</span>, <span class="seriesInfo">DOI 10.17487/RFC5452</span>, <time datetime="2009-01" class="refDate">January 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5452">https://www.rfc-editor.org/info/rfc5452</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5507">[RFC5507]</dt>
        <dd>
<span class="refAuthor">IAB</span>, <span class="refAuthor">Faltstrom, P., Ed.</span>, <span class="refAuthor">Austein, R., Ed.</span>, and <span class="refAuthor">P. Koch, Ed.</span>, <span class="refTitle">"Design Choices When Expanding the DNS"</span>, <span class="seriesInfo">RFC 5507</span>, <span class="seriesInfo">DOI 10.17487/RFC5507</span>, <time datetime="2009-04" class="refDate">April 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5507">https://www.rfc-editor.org/info/rfc5507</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5625">[RFC5625]</dt>
        <dd>
<span class="refAuthor">Bellis, R.</span>, <span class="refTitle">"DNS Proxy Implementation Guidelines"</span>, <span class="seriesInfo">BCP 152</span>, <span class="seriesInfo">RFC 5625</span>, <span class="seriesInfo">DOI 10.17487/RFC5625</span>, <time datetime="2009-08" class="refDate">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5625">https://www.rfc-editor.org/info/rfc5625</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5927">[RFC5927]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"ICMP Attacks against TCP"</span>, <span class="seriesInfo">RFC 5927</span>, <span class="seriesInfo">DOI 10.17487/RFC5927</span>, <time datetime="2010-07" class="refDate">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5927">https://www.rfc-editor.org/info/rfc5927</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5936">[RFC5936]</dt>
        <dd>
<span class="refAuthor">Lewis, E.</span> and <span class="refAuthor">A. Hoenes, Ed.</span>, <span class="refTitle">"DNS Zone Transfer Protocol (AXFR)"</span>, <span class="seriesInfo">RFC 5936</span>, <span class="seriesInfo">DOI 10.17487/RFC5936</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5936">https://www.rfc-editor.org/info/rfc5936</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5961">[RFC5961]</dt>
        <dd>
<span class="refAuthor">Ramaiah, A.</span>, <span class="refAuthor">Stewart, R.</span>, and <span class="refAuthor">M. Dalal</span>, <span class="refTitle">"Improving TCP's Robustness to Blind In-Window Attacks"</span>, <span class="seriesInfo">RFC 5961</span>, <span class="seriesInfo">DOI 10.17487/RFC5961</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5961">https://www.rfc-editor.org/info/rfc5961</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5966">[RFC5966]</dt>
        <dd>
<span class="refAuthor">Bellis, R.</span>, <span class="refTitle">"DNS Transport over TCP - Implementation Requirements"</span>, <span class="seriesInfo">RFC 5966</span>, <span class="seriesInfo">DOI 10.17487/RFC5966</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5966">https://www.rfc-editor.org/info/rfc5966</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6298">[RFC6298]</dt>
        <dd>
<span class="refAuthor">Paxson, V.</span>, <span class="refAuthor">Allman, M.</span>, <span class="refAuthor">Chu, J.</span>, and <span class="refAuthor">M. Sargent</span>, <span class="refTitle">"Computing TCP's Retransmission Timer"</span>, <span class="seriesInfo">RFC 6298</span>, <span class="seriesInfo">DOI 10.17487/RFC6298</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6298">https://www.rfc-editor.org/info/rfc6298</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6762">https://www.rfc-editor.org/info/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6781">[RFC6781]</dt>
        <dd>
<span class="refAuthor">Kolkman, O.</span>, <span class="refAuthor">Mekking, W.</span>, and <span class="refAuthor">R. Gieben</span>, <span class="refTitle">"DNSSEC Operational Practices, Version 2"</span>, <span class="seriesInfo">RFC 6781</span>, <span class="seriesInfo">DOI 10.17487/RFC6781</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6781">https://www.rfc-editor.org/info/rfc6781</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6950">[RFC6950]</dt>
        <dd>
<span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Kolkman, O.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">B. Aboba</span>, <span class="refTitle">"Architectural Considerations on Application Features in the DNS"</span>, <span class="seriesInfo">RFC 6950</span>, <span class="seriesInfo">DOI 10.17487/RFC6950</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6950">https://www.rfc-editor.org/info/rfc6950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7413">[RFC7413]</dt>
        <dd>
<span class="refAuthor">Cheng, Y.</span>, <span class="refAuthor">Chu, J.</span>, <span class="refAuthor">Radhakrishnan, S.</span>, and <span class="refAuthor">A. Jain</span>, <span class="refTitle">"TCP Fast Open"</span>, <span class="seriesInfo">RFC 7413</span>, <span class="seriesInfo">DOI 10.17487/RFC7413</span>, <time datetime="2014-12" class="refDate">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7413">https://www.rfc-editor.org/info/rfc7413</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7477">[RFC7477]</dt>
        <dd>
<span class="refAuthor">Hardaker, W.</span>, <span class="refTitle">"Child-to-Parent Synchronization in DNS"</span>, <span class="seriesInfo">RFC 7477</span>, <span class="seriesInfo">DOI 10.17487/RFC7477</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7477">https://www.rfc-editor.org/info/rfc7477</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7534">[RFC7534]</dt>
        <dd>
<span class="refAuthor">Abley, J.</span> and <span class="refAuthor">W. Sotomayor</span>, <span class="refTitle">"AS112 Nameserver Operations"</span>, <span class="seriesInfo">RFC 7534</span>, <span class="seriesInfo">DOI 10.17487/RFC7534</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7534">https://www.rfc-editor.org/info/rfc7534</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7720">[RFC7720]</dt>
        <dd>
<span class="refAuthor">Blanchet, M.</span> and <span class="refAuthor">L-J. Liman</span>, <span class="refTitle">"DNS Root Name Service Protocol and Deployment Requirements"</span>, <span class="seriesInfo">BCP 40</span>, <span class="seriesInfo">RFC 7720</span>, <span class="seriesInfo">DOI 10.17487/RFC7720</span>, <time datetime="2015-12" class="refDate">December 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7720">https://www.rfc-editor.org/info/rfc7720</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7901">[RFC7901]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span>, <span class="refTitle">"CHAIN Query Requests in DNS"</span>, <span class="seriesInfo">RFC 7901</span>, <span class="seriesInfo">DOI 10.17487/RFC7901</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7901">https://www.rfc-editor.org/info/rfc7901</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7918">[RFC7918]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Modadugu, N.</span>, and <span class="refAuthor">B. Moeller</span>, <span class="refTitle">"Transport Layer Security (TLS) False Start"</span>, <span class="seriesInfo">RFC 7918</span>, <span class="seriesInfo">DOI 10.17487/RFC7918</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7918">https://www.rfc-editor.org/info/rfc7918</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8027">[RFC8027]</dt>
        <dd>
<span class="refAuthor">Hardaker, W.</span>, <span class="refAuthor">Gudmundsson, O.</span>, and <span class="refAuthor">S. Krishnaswamy</span>, <span class="refTitle">"DNSSEC Roadblock Avoidance"</span>, <span class="seriesInfo">BCP 207</span>, <span class="seriesInfo">RFC 8027</span>, <span class="seriesInfo">DOI 10.17487/RFC8027</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8027">https://www.rfc-editor.org/info/rfc8027</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8094">[RFC8094]</dt>
        <dd>
<span class="refAuthor">Reddy, T.</span>, <span class="refAuthor">Wing, D.</span>, and <span class="refAuthor">P. Patil</span>, <span class="refTitle">"DNS over Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 8094</span>, <span class="seriesInfo">DOI 10.17487/RFC8094</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8094">https://www.rfc-editor.org/info/rfc8094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8162">[RFC8162]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schlyter</span>, <span class="refTitle">"Using Secure DNS to Associate Certificates with Domain Names for S/MIME"</span>, <span class="seriesInfo">RFC 8162</span>, <span class="seriesInfo">DOI 10.17487/RFC8162</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8162">https://www.rfc-editor.org/info/rfc8162</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8324">[RFC8324]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?"</span>, <span class="seriesInfo">RFC 8324</span>, <span class="seriesInfo">DOI 10.17487/RFC8324</span>, <time datetime="2018-02" class="refDate">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8324">https://www.rfc-editor.org/info/rfc8324</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8467">[RFC8467]</dt>
        <dd>
<span class="refAuthor">Mayrhofer, A.</span>, <span class="refTitle">"Padding Policies for Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">RFC 8467</span>, <span class="seriesInfo">DOI 10.17487/RFC8467</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8467">https://www.rfc-editor.org/info/rfc8467</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8482">[RFC8482]</dt>
        <dd>
<span class="refAuthor">Abley, J.</span>, <span class="refAuthor">Gudmundsson, O.</span>, <span class="refAuthor">Majkowski, M.</span>, and <span class="refAuthor">E. Hunt</span>, <span class="refTitle">"Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY"</span>, <span class="seriesInfo">RFC 8482</span>, <span class="seriesInfo">DOI 10.17487/RFC8482</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8482">https://www.rfc-editor.org/info/rfc8482</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8483">[RFC8483]</dt>
        <dd>
<span class="refAuthor">Song, L., Ed.</span>, <span class="refAuthor">Liu, D.</span>, <span class="refAuthor">Vixie, P.</span>, <span class="refAuthor">Kato, A.</span>, and <span class="refAuthor">S. Kerr</span>, <span class="refTitle">"Yeti DNS Testbed"</span>, <span class="seriesInfo">RFC 8483</span>, <span class="seriesInfo">DOI 10.17487/RFC8483</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8483">https://www.rfc-editor.org/info/rfc8483</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8490">[RFC8490]</dt>
        <dd>
<span class="refAuthor">Bellis, R.</span>, <span class="refAuthor">Cheshire, S.</span>, <span class="refAuthor">Dickinson, J.</span>, <span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Lemon, T.</span>, and <span class="refAuthor">T. Pusateri</span>, <span class="refTitle">"DNS Stateful Operations"</span>, <span class="seriesInfo">RFC 8490</span>, <span class="seriesInfo">DOI 10.17487/RFC8490</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8490">https://www.rfc-editor.org/info/rfc8490</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8501">[RFC8501]</dt>
        <dd>
<span class="refAuthor">Howard, L.</span>, <span class="refTitle">"Reverse DNS in IPv6 for Internet Service Providers"</span>, <span class="seriesInfo">RFC 8501</span>, <span class="seriesInfo">DOI 10.17487/RFC8501</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8501">https://www.rfc-editor.org/info/rfc8501</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8806">[RFC8806]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Running a Root Server Local to a Resolver"</span>, <span class="seriesInfo">RFC 8806</span>, <span class="seriesInfo">DOI 10.17487/RFC8806</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8806">https://www.rfc-editor.org/info/rfc8806</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8906">[RFC8906]</dt>
        <dd>
<span class="refAuthor">Andrews, M.</span> and <span class="refAuthor">R. Bellis</span>, <span class="refTitle">"A Common Operational Problem in DNS Servers: Failure to Communicate"</span>, <span class="seriesInfo">BCP 231</span>, <span class="seriesInfo">RFC 8906</span>, <span class="seriesInfo">DOI 10.17487/RFC8906</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8906">https://www.rfc-editor.org/info/rfc8906</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8932">[RFC8932]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Overeinder, B.</span>, <span class="refAuthor">van Rijswijk-Deij, R.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"Recommendations for DNS Privacy Service Operators"</span>, <span class="seriesInfo">BCP 232</span>, <span class="seriesInfo">RFC 8932</span>, <span class="seriesInfo">DOI 10.17487/RFC8932</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8932">https://www.rfc-editor.org/info/rfc8932</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8945">[RFC8945]</dt>
        <dd>
<span class="refAuthor">Dupont, F.</span>, <span class="refAuthor">Morris, S.</span>, <span class="refAuthor">Vixie, P.</span>, <span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Gudmundsson, O.</span>, and <span class="refAuthor">B. Wellington</span>, <span class="refTitle">"Secret Key Transaction Authentication for DNS (TSIG)"</span>, <span class="seriesInfo">STD 93</span>, <span class="seriesInfo">RFC 8945</span>, <span class="seriesInfo">DOI 10.17487/RFC8945</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8945">https://www.rfc-editor.org/info/rfc8945</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ROLL_YOUR_ROOT">[ROLL_YOUR_ROOT]</dt>
        <dd>
<span class="refAuthor">Müller, M.</span>, <span class="refAuthor">Thomas, M.</span>, <span class="refAuthor">Wessels, D.</span>, <span class="refAuthor">Hardaker, W.</span>, <span class="refAuthor">Chung, T.</span>, <span class="refAuthor">Toorop, W.</span>, and <span class="refAuthor">R. van Rijswijk-Deij</span>, <span class="refTitle">"Roll, Roll, Roll Your Root: A Comprehensive Analysis of the First Ever DNSSEC Root KSK Rollover"</span>, <span class="seriesInfo">DOI 10.1145/3355369.3355570</span>, <time datetime="2019-10" class="refDate">October 2019</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3355369.3355570">https://dl.acm.org/doi/10.1145/3355369.3355570</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RRL">[RRL]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span> and <span class="refAuthor">V. Schryver</span>, <span class="refTitle">"DNS Response Rate Limiting (DNS RRL)"</span>, <span class="refContent">ISC-TN-2012-1-Draft1</span>, <time datetime="2012-04" class="refDate">April 2012</time>. </dd>
<dd class="break"></dd>
<dt id="TDNS">[TDNS]</dt>
        <dd>
<span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Wessels, D.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">N. Somaiya</span>, <span class="refTitle">"Connection-Oriented DNS to Improve Privacy and Security"</span>, <span class="seriesInfo">DOI 10.1109/SP.2015.18</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://doi.org/10.1109/SP.2015.18">https://doi.org/10.1109/SP.2015.18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TOYAMA">[TOYAMA]</dt>
        <dd>
<span class="refAuthor">Toyama, K.</span>, <span class="refAuthor">Ishibashi, K.</span>, <span class="refAuthor">Toyono, T.</span>, <span class="refAuthor">Ishino, M.</span>, <span class="refAuthor">Yoshimura, C.</span>, and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Anomalies and Their Impacts on DNS Cache Servers"</span>, <span class="refContent">NANOG 32</span>, <time datetime="2004-10" class="refDate">October 2004</time>. </dd>
<dd class="break"></dd>
<dt id="VERISIGN">[VERISIGN]</dt>
        <dd>
<span class="refAuthor">Thomas, M.</span> and <span class="refAuthor">D. Wessels</span>, <span class="refTitle">"An Analysis of TCP Traffic in Root Server DITL Data"</span>, <span class="refContent">DNS-OARC 2014 Fall Workshop</span>, <time datetime="2014-10" class="refDate">October 2014</time>. </dd>
<dd class="break"></dd>
<dt id="WIKIPEDIA_TFO">[WIKIPEDIA_TFO]</dt>
      <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"TCP Fast Open"</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=TCP_Fast_Open&amp;oldid=1071397204">https://en.wikipedia.org/w/index.php?title=TCP_Fast_Open&amp;oldid=1071397204</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="dnsrfcs">
<section id="appendix-A">
      <h2 id="name-rfcs-related-to-dns-transpo">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-rfcs-related-to-dns-transpo" class="section-name selfRef">RFCs Related to DNS Transport over TCP</a>
      </h2>
<p id="appendix-A-1">This section enumerates all known RFCs with a status of
     Internet Standard, Proposed Standard,
     Informational, Best Current Practice,
     or Experimental that either implicitly or explicitly make
     assumptions or statements about the use of TCP as a transport for
     the DNS germane to this document.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<section id="appendix-A.1">
        <h3 id="name-rfc-1035-domain-names-imple">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-rfc-1035-domain-names-imple" class="section-name selfRef">RFC 1035 - DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION</a>
        </h3>
<p id="appendix-A.1-1">The Internet Standard <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> is the
       base DNS specification that explicitly defines support for DNS
       over TCP.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.2">
        <h3 id="name-rfc-1536-common-dns-impleme">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-rfc-1536-common-dns-impleme" class="section-name selfRef">RFC 1536 - Common DNS Implementation Errors and Suggested Fixes</a>
        </h3>
<p id="appendix-A.2-1">The Informational document <span>[<a href="#RFC1536" class="xref">RFC1536</a>]</span>
       states that UDP is "the chosen protocol for communication though TCP
       is used for zone transfers."  That statement should now be
       considered in its historical context and is no longer a proper
       reflection of modern expectations.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.3">
        <h3 id="name-rfc-1995-incremental-zone-t">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-rfc-1995-incremental-zone-t" class="section-name selfRef">RFC 1995 - Incremental Zone Transfer in DNS</a>
        </h3>
<p id="appendix-A.3-1">The Proposed Standard <span>[<a href="#RFC1995" class="xref">RFC1995</a>]</span>
       documents the use of TCP as the fallback transport when Incremental Zone Transfer (IXFR)
       responses do not fit into a single UDP response.  As with Authoritative Transfer (AXFR),
       IXFR messages are typically delivered over TCP by default in
       practice.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.4">
        <h3 id="name-rfc-1996-a-mechanism-for-pr">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-rfc-1996-a-mechanism-for-pr" class="section-name selfRef">RFC 1996 - A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)</a>
        </h3>
<p id="appendix-A.4-1">The Proposed Standard <span>[<a href="#RFC1996" class="xref">RFC1996</a>]</span>
       suggests that a primary server may decide to issue NOTIFY messages over
       TCP.  In practice, NOTIFY messages are generally sent over UDP,
       but this specification leaves open the possibility that the
       choice of transport protocol is up to the primary server; therefore,
       a secondary server ought to be able to operate over both UDP and TCP.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.5">
        <h3 id="name-rfc-2181-clarifications-to-">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-rfc-2181-clarifications-to-" class="section-name selfRef">RFC 2181 - Clarifications to the DNS Specification</a>
        </h3>
<p id="appendix-A.5-1">The Proposed Standard <span>[<a href="#RFC2181" class="xref">RFC2181</a>]</span>
       includes clarifying text on how a client should react to the TC
       bit set on responses.  It is advised that the response be
       discarded and the query resent using TCP.<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.6">
        <h3 id="name-rfc-2694-dns-extensions-to-">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-rfc-2694-dns-extensions-to-" class="section-name selfRef">RFC 2694 - DNS extensions to Network Address Translators (DNS_ALG)</a>
        </h3>
<p id="appendix-A.6-1">The Informational document <span>[<a href="#RFC2694" class="xref">RFC2694</a>]</span>
       enumerates considerations for NAT
       devices to properly handle DNS traffic.  This document is
       noteworthy in its suggestion that
       "[t]ypically, TCP is used for AXFR requests,"
       as further evidence that helps
       explain why DNS over TCP may have often been treated very
       differently than DNS over UDP in operational networks.<a href="#appendix-A.6-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.7">
        <h3 id="name-rfc-3225-indicating-resolve">
<a href="#appendix-A.7" class="section-number selfRef">A.7. </a><a href="#name-rfc-3225-indicating-resolve" class="section-name selfRef">RFC 3225 - Indicating Resolver Support of DNSSEC</a>
        </h3>
<p id="appendix-A.7-1">The Proposed Standard <span>[<a href="#RFC3225" class="xref">RFC3225</a>]</span>
       makes statements indicating that DNS over TCP is "detrimental" as a
       result of increased traffic, latency, and server load.  This
       document is a companion to the next document in the RFC
       Series that describes the requirement for EDNS(0) support for DNSSEC.<a href="#appendix-A.7-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.8">
        <h3 id="name-rfc-3226-dnssec-and-ipv6-a6">
<a href="#appendix-A.8" class="section-number selfRef">A.8. </a><a href="#name-rfc-3226-dnssec-and-ipv6-a6" class="section-name selfRef">RFC 3226 - DNSSEC and IPv6 A6 aware server/resolver message size requirements</a>
        </h3>
<p id="appendix-A.8-1">Although updated by later DNSSEC RFCs,
       the Proposed Standard <span>[<a href="#RFC3226" class="xref">RFC3226</a>]</span>
       strongly argues in favor of
       UDP messages instead of TCP, largely for performance reasons.
       The document declares EDNS(0) a requirement for DNSSEC servers and
       advocates that packet fragmentation may be preferable to TCP in
       certain situations.<a href="#appendix-A.8-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.9">
        <h3 id="name-rfc-4472-operational-consid">
<a href="#appendix-A.9" class="section-number selfRef">A.9. </a><a href="#name-rfc-4472-operational-consid" class="section-name selfRef">RFC 4472 - Operational Considerations and Issues with IPv6 DNS</a>
        </h3>
<p id="appendix-A.9-1">The Informational document <span>[<a href="#RFC4472" class="xref">RFC4472</a>]</span> notes
       that IPv6 data may increase DNS responses beyond what would fit in
       a UDP message.  What is particularly noteworthy, but perhaps less common today
       than when this document was written, is that it refers to implementations that
       truncate data without setting the TC bit to encourage the client to
       resend the query using TCP.<a href="#appendix-A.9-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.10">
        <h3 id="name-rfc-5452-measures-for-makin">
<a href="#appendix-A.10" class="section-number selfRef">A.10. </a><a href="#name-rfc-5452-measures-for-makin" class="section-name selfRef">RFC 5452 - Measures for Making DNS More Resilient against Forged Answers</a>
        </h3>
<p id="appendix-A.10-1">The Proposed Standard <span>[<a href="#RFC5452" class="xref">RFC5452</a>]</span> arose
       as public DNS systems began to experience widespread abuse from spoofed
       queries, resulting in amplification and reflection attacks against
       unwitting victims.  One of the leading justifications for supporting
       DNS over TCP to thwart these attacks is briefly described in <span><a href="https://www.rfc-editor.org/rfc/rfc5452#section-9.3" class="relref">Section 9.3</a> of [<a href="#RFC5452" class="xref">RFC5452</a>]</span> ("Spoof Detection and Countermeasure").<a href="#appendix-A.10-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.11">
        <h3 id="name-rfc-5507-design-choices-whe">
<a href="#appendix-A.11" class="section-number selfRef">A.11. </a><a href="#name-rfc-5507-design-choices-whe" class="section-name selfRef">RFC 5507 - Design Choices When Expanding the DNS</a>
        </h3>
<p id="appendix-A.11-1">The Informational document <span>[<a href="#RFC5507" class="xref">RFC5507</a>]</span> was
       largely an attempt to dissuade new DNS data types from overloading the
       TXT resource record type.  In so doing, it summarizes the conventional
       wisdom of DNS design and implementation practices.  The authors
       suggest TCP overhead and stateful properties pose challenges compared
       to UDP and imply that UDP is generally preferred for performance and
       robustness.<a href="#appendix-A.11-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.12">
        <h3 id="name-rfc-5625-dns-proxy-implemen">
<a href="#appendix-A.12" class="section-number selfRef">A.12. </a><a href="#name-rfc-5625-dns-proxy-implemen" class="section-name selfRef">RFC 5625 - DNS Proxy Implementation Guidelines</a>
        </h3>
<p id="appendix-A.12-1">The Best Current Practice document <span>[<a href="#RFC5625" class="xref">RFC5625</a>]</span>
       provides DNS proxy implementation guidance including the mandate that a
       proxy "<span class="bcp14">MUST</span> [...] be prepared to receive and forward queries over TCP"
       even though it suggests that, historically, TCP transport has not been strictly
       mandatory in stub resolvers or recursive servers.<a href="#appendix-A.12-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.13">
        <h3 id="name-rfc-5936-dns-zone-transfer-">
<a href="#appendix-A.13" class="section-number selfRef">A.13. </a><a href="#name-rfc-5936-dns-zone-transfer-" class="section-name selfRef">RFC 5936 - DNS Zone Transfer Protocol (AXFR)</a>
        </h3>
<p id="appendix-A.13-1">The Proposed Standard <span>[<a href="#RFC5936" class="xref">RFC5936</a>]</span>
       provides a detailed specification for the zone transfer protocol,
       as originally outlined in the early DNS standards.  AXFR operation
       is limited to TCP and not specified for UDP.  This document
       discusses TCP usage at length.<a href="#appendix-A.13-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.14">
        <h3 id="name-rfc-7534-as112-nameserver-o">
<a href="#appendix-A.14" class="section-number selfRef">A.14. </a><a href="#name-rfc-7534-as112-nameserver-o" class="section-name selfRef">RFC 7534 - AS112 Nameserver Operations</a>
        </h3>
<p id="appendix-A.14-1">The Informational document <span>[<a href="#RFC7534" class="xref">RFC7534</a>]</span>
       enumerates the requirements for operation of AS112 project DNS
       servers.  New AS112 nodes are tested for their ability to provide
       service on both UDP and TCP transports, with the implication that
       TCP service is an expected part of normal operations.<a href="#appendix-A.14-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.15">
        <h3 id="name-rfc-6762-multicast-dns">
<a href="#appendix-A.15" class="section-number selfRef">A.15. </a><a href="#name-rfc-6762-multicast-dns" class="section-name selfRef">RFC 6762 - Multicast DNS</a>
        </h3>
<p id="appendix-A.15-1">In the Proposed Standard <span>[<a href="#RFC6762" class="xref">RFC6762</a>]</span>, the
       TC bit is deemed to have essentially the same meaning as described
       in the original DNS specifications.  That is, if a response with the
       TC bit set is received, "[...] the querier <span class="bcp14">SHOULD</span> reissue its query
       using TCP in order to receive the larger response."<a href="#appendix-A.15-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.16">
        <h3 id="name-rfc-6891-extension-mechanis">
<a href="#appendix-A.16" class="section-number selfRef">A.16. </a><a href="#name-rfc-6891-extension-mechanis" class="section-name selfRef">RFC 6891 - Extension Mechanisms for DNS (EDNS(0))</a>
        </h3>
<p id="appendix-A.16-1">The Internet Standard <span>[<a href="#RFC6891" class="xref">RFC6891</a>]</span>
       helped slow the use of and need for DNS-over-TCP messages.  This
       document highlights concerns over server load and scalability in
       widespread use of DNS over TCP.<a href="#appendix-A.16-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.17">
        <h3 id="name-iab-rfc-6950-architectural-">
<a href="#appendix-A.17" class="section-number selfRef">A.17. </a><a href="#name-iab-rfc-6950-architectural-" class="section-name selfRef">IAB RFC 6950 - Architectural Considerations on Application Features in the DNS</a>
        </h3>
<p id="appendix-A.17-1">The Informational document <span>[<a href="#RFC6950" class="xref">RFC6950</a>]</span> draws
       attention to large data in the DNS.  TCP is referenced in the
       context as a common fallback mechanism and counter to some spoofing
       attacks.<a href="#appendix-A.17-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.18">
        <h3 id="name-rfc-7477-child-to-parent-sy">
<a href="#appendix-A.18" class="section-number selfRef">A.18. </a><a href="#name-rfc-7477-child-to-parent-sy" class="section-name selfRef">RFC 7477 - Child-to-Parent Synchronization in DNS</a>
        </h3>
<p id="appendix-A.18-1">The Proposed Standard <span>[<a href="#RFC7477" class="xref">RFC7477</a>]</span>
 specifies an RRType and a protocol to signal and synchronize NS, A,
       and AAAA resource record changes from a child-to-parent zone.
       Since this protocol may require multiple requests and responses,
       it recommends utilizing DNS over TCP to ensure the conversation
       takes place between a consistent pair of end nodes.<a href="#appendix-A.18-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.19">
        <h3 id="name-rfc-7720-dns-root-name-serv">
<a href="#appendix-A.19" class="section-number selfRef">A.19. </a><a href="#name-rfc-7720-dns-root-name-serv" class="section-name selfRef">RFC 7720 - DNS Root Name Service Protocol and Deployment Requirements</a>
        </h3>
<p id="appendix-A.19-1">The Best Current Practice document <span>[<a href="#RFC7720" class="xref">RFC7720</a>]</span>
       declares that root name service "<span class="bcp14">MUST</span> support UDP <span>[<a href="#RFC0768" class="xref">RFC0768</a>]</span> and TCP <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span>
       transport of DNS queries and responses."<a href="#appendix-A.19-1" class="pilcrow">¶</a></p>
</section>
<div id="app-rfc7766">
<section id="appendix-A.20">
        <h3 id="name-rfc-7766-dns-transport-over">
<a href="#appendix-A.20" class="section-number selfRef">A.20. </a><a href="#name-rfc-7766-dns-transport-over" class="section-name selfRef">RFC 7766 - DNS Transport over TCP - Implementation Requirements</a>
        </h3>
<p id="appendix-A.20-1">The Proposed Standard <span>[<a href="#RFC7766" class="xref">RFC7766</a>]</span>
       instructs DNS implementors to provide support for carrying DNS-over-TCP messages in their software and 
       might be considered the direct ancestor of this operational
       requirements document.
       The implementation requirements document
       codifies mandatory support for DNS-over-TCP in compliant DNS
       software but
       makes no recommendations to operators, which we seek to address
       here.<a href="#appendix-A.20-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="appendix-A.21">
        <h3 id="name-rfc-7828-the-edns-tcp-keepa">
<a href="#appendix-A.21" class="section-number selfRef">A.21. </a><a href="#name-rfc-7828-the-edns-tcp-keepa" class="section-name selfRef">RFC 7828 - The edns-tcp-keepalive EDNS(0) Option</a>
        </h3>
<p id="appendix-A.21-1">The Proposed Standard <span>[<a href="#RFC7828" class="xref">RFC7828</a>]</span>
       defines an EDNS(0) option to negotiate an idle timeout value for
       long-lived DNS-over-TCP connections.  Consequently, this document
       is only applicable and relevant to DNS-over-TCP sessions and
       between implementations that support this option.<a href="#appendix-A.21-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.22">
        <h3 id="name-rfc-7858-specification-for-">
<a href="#appendix-A.22" class="section-number selfRef">A.22. </a><a href="#name-rfc-7858-specification-for-" class="section-name selfRef">RFC 7858 - Specification for DNS over Transport Layer Security (TLS)</a>
        </h3>
<p id="appendix-A.22-1">The Proposed Standard <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>
       defines a method for putting DNS messages into a TCP-based
       encrypted channel using TLS.  This specification is noteworthy
       for explicitly targeting the stub-to-recursive traffic but
       does not preclude its application from recursive-to-authoritative
       traffic.<a href="#appendix-A.22-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.23">
        <h3 id="name-rfc-7873-domain-name-system">
<a href="#appendix-A.23" class="section-number selfRef">A.23. </a><a href="#name-rfc-7873-domain-name-system" class="section-name selfRef">RFC 7873 - Domain Name System (DNS) Cookies</a>
        </h3>
<p id="appendix-A.23-1">The Proposed Standard <span>[<a href="#RFC7873" class="xref">RFC7873</a>]</span>
       describes an EDNS(0) option to provide additional protection
       against query and answer forgery.  This specification mentions
       DNS over TCP as an alternative mechanism when DNS cookies
       are not available.  The specification does make mention of DNS-over-TCP processing in two specific situations.  In one, when a
       server receives only a client cookie in a request, the server
       should consider whether the request arrived over TCP, and if so,
       it should consider accepting TCP as sufficient to authenticate
       the request and respond accordingly.  In another, when a client
       receives a BADCOOKIE reply using a fresh server cookie, the
       client should retry using TCP as the transport.<a href="#appendix-A.23-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.24">
        <h3 id="name-rfc-7901-chain-query-reques">
<a href="#appendix-A.24" class="section-number selfRef">A.24. </a><a href="#name-rfc-7901-chain-query-reques" class="section-name selfRef">RFC 7901 - CHAIN Query Requests in DNS</a>
        </h3>
<p id="appendix-A.24-1">The Experimental specification <span>[<a href="#RFC7901" class="xref">RFC7901</a>]</span>
       describes an EDNS(0) option that can be used by a security-aware
       validating resolver to request and obtain a complete DNSSEC
       validation path for any single query.  This document requires the
       use of DNS over TCP or a transport
       mechanism verified by a source IP address such as EDNS-COOKIE <span>[<a href="#RFC7873" class="xref">RFC7873</a>]</span>.<a href="#appendix-A.24-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.25">
        <h3 id="name-rfc-8027-dnssec-roadblock-a">
<a href="#appendix-A.25" class="section-number selfRef">A.25. </a><a href="#name-rfc-8027-dnssec-roadblock-a" class="section-name selfRef">RFC 8027 - DNSSEC Roadblock Avoidance</a>
        </h3>
<p id="appendix-A.25-1">The Best Current Practice document <span>[<a href="#RFC8027" class="xref">RFC8027</a>]</span> details observed
       problems with DNSSEC deployment and mitigation techniques.
       Network traffic blocking and restrictions, including DNS-over-TCP
       messages, are highlighted as one reason for DNSSEC deployment
       issues.  While this document suggests these sorts of problems are
       due to "non-compliant infrastructure", the
       scope of the document is limited to detection and mitigation
       techniques to avoid so-called DNSSEC roadblocks.<a href="#appendix-A.25-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.26">
        <h3 id="name-rfc-8094-dns-over-datagram-">
<a href="#appendix-A.26" class="section-number selfRef">A.26. </a><a href="#name-rfc-8094-dns-over-datagram-" class="section-name selfRef">RFC 8094 - DNS over Datagram Transport Layer Security (DTLS)</a>
        </h3>
<p id="appendix-A.26-1">The Experimental specification <span>[<a href="#RFC8094" class="xref">RFC8094</a>]</span>
       details a protocol that uses a datagram transport (UDP) but
       stipulates that "DNS clients and servers that implement DNS over
       DTLS <span class="bcp14">MUST</span> also implement DNS over TLS in order to provide privacy
       for clients that desire Strict Privacy [...]."  This requirement
       implies DNS over TCP must be supported in case the message size
       is larger than the path MTU.<a href="#appendix-A.26-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.27">
        <h3 id="name-rfc-8162-using-secure-dns-t">
<a href="#appendix-A.27" class="section-number selfRef">A.27. </a><a href="#name-rfc-8162-using-secure-dns-t" class="section-name selfRef">RFC 8162 - Using Secure DNS to Associate Certificates with Domain Names for S/MIME</a>
        </h3>
<p id="appendix-A.27-1">The Experimental specification <span>[<a href="#RFC8162" class="xref">RFC8162</a>]</span>
       describes a technique to authenticate user X.509 certificates
       in an S/MIME system via the DNS.  The document points out that
       the new experimental resource record types are expected to carry
       large payloads, resulting in the suggestion that "applications
       <span class="bcp14">SHOULD</span> use TCP -- not UDP -- to perform queries for the SMIMEA
       resource record."<a href="#appendix-A.27-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.28">
        <h3 id="name-rfc-8324-dns-privacy-author">
<a href="#appendix-A.28" class="section-number selfRef">A.28. </a><a href="#name-rfc-8324-dns-privacy-author" class="section-name selfRef">RFC 8324 - DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?</a>
        </h3>
<p id="appendix-A.28-1"> The Informational document <span>[<a href="#RFC8324" class="xref">RFC8324</a>]</span>
       briefly discusses the common role and challenges of DNS over TCP
       throughout the history of DNS.<a href="#appendix-A.28-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.29">
        <h3 id="name-rfc-8467-padding-policies-f">
<a href="#appendix-A.29" class="section-number selfRef">A.29. </a><a href="#name-rfc-8467-padding-policies-f" class="section-name selfRef">RFC 8467 - Padding Policies for Extension Mechanisms for DNS (EDNS(0))</a>
        </h3>
<p id="appendix-A.29-1">The Experimental document <span>[<a href="#RFC8467" class="xref">RFC8467</a>]</span>
       reminds implementors to consider the underlying transport
       protocol (e.g., TCP) when calculating the padding length when
       artificially increasing the DNS message size with an EDNS(0)
       padding option.<a href="#appendix-A.29-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.30">
        <h3 id="name-rfc-8482-providing-minimal-">
<a href="#appendix-A.30" class="section-number selfRef">A.30. </a><a href="#name-rfc-8482-providing-minimal-" class="section-name selfRef">RFC 8482 - Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY</a>
        </h3>
<p id="appendix-A.30-1">The Proposed Standard <span>[<a href="#RFC8482" class="xref">RFC8482</a>]</span>
       describes alternative ways that DNS servers can respond to queries
       of type ANY, which are sometimes used to provide amplification
       in DDoS attacks.  The specification notes that responders may
       behave differently, depending on the transport.  For example,
       minimal-sized responses may be used over UDP transport, while
       full responses may be given over TCP.<a href="#appendix-A.30-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.31">
        <h3 id="name-rfc-8483-yeti-dns-testbed">
<a href="#appendix-A.31" class="section-number selfRef">A.31. </a><a href="#name-rfc-8483-yeti-dns-testbed" class="section-name selfRef">RFC 8483 - Yeti DNS Testbed</a>
        </h3>
<p id="appendix-A.31-1">The Informational document <span>[<a href="#RFC8483" class="xref">RFC8483</a>]</span>
       describes a testbed environment that highlights some DNS-over-TCP
       behaviors, including issues involving packet fragmentation and
       operational requirements for TCP stream assembly in order to
       conduct DNS measurement and analysis.<a href="#appendix-A.31-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.32">
        <h3 id="name-rfc-8484-dns-queries-over-h">
<a href="#appendix-A.32" class="section-number selfRef">A.32. </a><a href="#name-rfc-8484-dns-queries-over-h" class="section-name selfRef">RFC 8484 - DNS Queries over HTTPS (DoH)</a>
        </h3>
<p id="appendix-A.32-1">The Proposed Standard <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>
       defines a protocol for sending DNS queries and responses over
       HTTPS.  This specification assumes TLS and TCP for the underlying
       security and transport layers, respectively.  Self-described as a
       technique that more closely resembles a tunneling mechanism,
       DoH nevertheless likely implies DNS over TCP in some sense, if not
       directly.<a href="#appendix-A.32-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.33">
        <h3 id="name-rfc-8490-dns-stateful-opera">
<a href="#appendix-A.33" class="section-number selfRef">A.33. </a><a href="#name-rfc-8490-dns-stateful-opera" class="section-name selfRef">RFC 8490 - DNS Stateful Operations</a>
        </h3>
<p id="appendix-A.33-1">The Proposed Standard <span>[<a href="#RFC8490" class="xref">RFC8490</a>]</span>
       updates the base protocol specification with a new OPCODE to
       help manage stateful operations in persistent sessions, such
       as those that might be used by DNS over TCP.<a href="#appendix-A.33-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.34">
        <h3 id="name-rfc-8501-reverse-dns-in-ipv">
<a href="#appendix-A.34" class="section-number selfRef">A.34. </a><a href="#name-rfc-8501-reverse-dns-in-ipv" class="section-name selfRef">RFC 8501 - Reverse DNS in IPv6 for Internet Service Providers</a>
        </h3>
<p id="appendix-A.34-1">The Informational document <span>[<a href="#RFC8501" class="xref">RFC8501</a>]</span>
       identifies potential operational challenges with dynamic DNS,
       including denial-of-service threats.  The document suggests TCP
       may provide some advantages but that updating hosts would need
       to be explicitly configured to use TCP instead of UDP.<a href="#appendix-A.34-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.35">
        <h3 id="name-rfc-8806-running-a-root-ser">
<a href="#appendix-A.35" class="section-number selfRef">A.35. </a><a href="#name-rfc-8806-running-a-root-ser" class="section-name selfRef">RFC 8806 - Running a Root Server Local to a Resolver</a>
        </h3>
<p id="appendix-A.35-1">The Informational document <span>[<a href="#RFC8806" class="xref">RFC8806</a>]</span>
       describes how to obtain and operate a local copy of the root zone
       with examples showing how to pull from authoritative sources using
       a DNS-over-TCP zone transfer.<a href="#appendix-A.35-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.36">
        <h3 id="name-rfc-8906-a-common-operation">
<a href="#appendix-A.36" class="section-number selfRef">A.36. </a><a href="#name-rfc-8906-a-common-operation" class="section-name selfRef">RFC 8906 - A Common Operational Problem in DNS Servers: Failure to Communicate</a>
        </h3>
<p id="appendix-A.36-1">The Best Current Practice document <span>[<a href="#RFC8906" class="xref">RFC8906</a>]</span>
       discusses a number of DNS operational failure scenarios and how to
       avoid them.  This includes discussions involving DNS-over-TCP queries,
       EDNS over TCP, and a testing methodology that includes a section on
       verifying DNS-over-TCP functionality.<a href="#appendix-A.36-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.37">
        <h3 id="name-rfc-8932-recommendations-fo">
<a href="#appendix-A.37" class="section-number selfRef">A.37. </a><a href="#name-rfc-8932-recommendations-fo" class="section-name selfRef">RFC 8932 - Recommendations for DNS Privacy Service Operators</a>
        </h3>
<p id="appendix-A.37-1">The Best Current Practice document <span>[<a href="#RFC8932" class="xref">RFC8932</a>]</span>
       presents privacy considerations to DNS privacy service operators.
       These mechanisms sometimes include the use of TCP and are therefore
       susceptible to information leakage such as TCP-based fingerprinting.
       This document also references an earlier draft version of this document.<a href="#appendix-A.37-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.38">
        <h3 id="name-rfc-8945-secret-key-transac">
<a href="#appendix-A.38" class="section-number selfRef">A.38. </a><a href="#name-rfc-8945-secret-key-transac" class="section-name selfRef">RFC 8945 - Secret Key Transaction Authentication for DNS (TSIG)</a>
        </h3>
<p id="appendix-A.38-1">The Internet Standard <span>[<a href="#RFC8945" class="xref">RFC8945</a>]</span>
       recommends that a client use TCP if truncated TSIG messages are
       received.<a href="#appendix-A.38-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="Acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This document was initially motivated by feedback from students
     who pointed out that they were hearing contradictory information
     about filtering DNS-over-TCP messages. Thanks in particular to a
     teaching colleague, JPL, who perhaps unknowingly encouraged the
     initial research into the differences between what the community has
     historically said and did.  Thanks to all the NANOG 63 attendees
     who provided feedback for an early talk on this subject.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The following individuals provided an array of feedback to help
     improve this document: <span class="contact-name">Joe Abley</span>, <span class="contact-name">Piet Barber</span>, <span class="contact-name">Sara Dickinson</span>, <span class="contact-name">Tony Finch</span>, <span class="contact-name">Bob Harold</span>, <span class="contact-name">Paul Hoffman</span>, <span class="contact-name">Geoff Huston</span>, <span class="contact-name">Tatuya Jinmei</span>,
     <span class="contact-name">Puneet Sood</span>, and <span class="contact-name">Richard Wilhelm</span>.  The authors are also indebted to the contributions
     stemming from discussion in the TCPM Working Group meeting at
     IETF 104.  Any remaining errors or imperfections are the sole
     responsibility of the document authors.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Kristoff</span></div>
<div dir="auto" class="left"><span class="org">Dataplane.org</span></div>
<div dir="auto" class="left">
<span class="locality">Chicago</span>, <span class="region">IL</span> <span class="postal-code">60605</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20312%20493%200305" class="tel">+1 312 493 0305</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:jtk@dataplane.org" class="email">jtk@dataplane.org</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://dataplane.org/jtk/" class="url">https://dataplane.org/jtk/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Duane Wessels</span></div>
<div dir="auto" class="left"><span class="org">Verisign</span></div>
<div dir="auto" class="left"><span class="street-address">12061 Bluemont Way</span></div>
<div dir="auto" class="left">
<span class="locality">Reston</span>, <span class="region">VA</span> <span class="postal-code">20190</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20703%20948%203200" class="tel">+1 703 948 3200</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:dwessels@verisign.com" class="email">dwessels@verisign.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://verisign.com" class="url">https://verisign.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
