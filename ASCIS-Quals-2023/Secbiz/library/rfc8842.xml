<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-mmusic-dtls-sdp-32" indexInclude="true" ipr="trust200902" number="8842" prepTime="2021-01-17T18:52:55" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" updates="5763, 7345" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-mmusic-dtls-sdp-32" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc8842" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="SDP Offer/Answer Considerations for DTLS and TLS">Session Description Protocol (SDP) Offer/Answer Considerations for Datagram Transport Layer Security (DTLS) and Transport Layer Security (TLS)</title>
    <seriesInfo name="RFC" value="8842" stream="IETF"/>
    <author fullname="Christer Holmberg" initials="C." surname="Holmberg">
      <organization abbrev="Ericsson" showOnFrontPage="true">Ericsson</organization>
      <address>
        <postal>
          <street>Hirsalantie 11</street>
          <city>Jorvas</city>
          <region/>
          <code>02420</code>
          <country>Finland</country>
        </postal>
        <phone/>
        <email>christer.holmberg@ericsson.com</email>
      </address>
    </author>
    <author fullname="Roman Shpount" initials="R." surname="Shpount">
      <organization abbrev="TurboBridge" showOnFrontPage="true">TurboBridge</organization>
      <address>
        <postal>
          <street>4905 Del Ray Avenue, Suite 300</street>
          <city>Bethesda</city>
          <region>MD</region>
          <code>20814</code>
          <country>United States of America</country>
        </postal>
        <email>rshpount@turbobridge.com</email>
      </address>
    </author>
    <date month="01" year="2021"/>
    <area>RAI</area>
    <keyword>SDP</keyword>
    <keyword>DTLS</keyword>
    <keyword>tls-id</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
        This document defines the Session Description Protocol (SDP)
        offer/answer procedures for negotiating and establishing a Datagram
        Transport Layer Security (DTLS) association.  The document also
        defines the criteria for when a new DTLS association must be
        established.  The document updates RFCs 5763 and 7345 by replacing
        common SDP offer/answer procedures with a reference to this
        specification.
      </t>
      <t indent="0" pn="section-abstract-2">
            This document defines a new SDP media-level attribute, "tls-id".
      </t>
      <t indent="0" pn="section-abstract-3">
         This document also defines how the "tls-id" attribute can be used
         for negotiating and establishing a Transport Layer Security (TLS)
         connection, in conjunction with the procedures in RFCs 4145 and 
         8122.
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc8842" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-conventions">Conventions</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-establishing-a-new-dtls-ass">Establishing a New DTLS Association</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2">
              <li pn="section-toc.1-1.3.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.3.2.1.1"><xref derivedContent="3.1" format="counter" sectionFormat="of" target="section-3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-general">General</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.2">
                <t indent="0" pn="section-toc.1-1.3.2.2.1"><xref derivedContent="3.2" format="counter" sectionFormat="of" target="section-3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-change-of-local-transport-p">Change of Local Transport Parameters</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.3">
                <t indent="0" pn="section-toc.1-1.3.2.3.1"><xref derivedContent="3.3" format="counter" sectionFormat="of" target="section-3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-change-of-ice-ufrag-value">Change of ICE ufrag Value</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-sdp-tls-id-attribute">SDP "tls-id" Attribute</xref></t>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-sdp-offer-answer-procedures">SDP Offer/Answer Procedures</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-general-2">General</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-generating-the-initial-sdp-">Generating the Initial SDP Offer</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t indent="0" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-generating-the-answer">Generating the Answer</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.4">
                <t indent="0" pn="section-toc.1-1.5.2.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-offerer-processing-of-the-s">Offerer Processing of the SDP Answer</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.5">
                <t indent="0" pn="section-toc.1-1.5.2.5.1"><xref derivedContent="5.5" format="counter" sectionFormat="of" target="section-5.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-modifying-the-session">Modifying the Session</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ice-considerations">ICE Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tls-considerations">TLS Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-sip-considerations">SIP Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-updates">RFC Updates</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2">
              <li pn="section-toc.1-1.9.2.1">
                <t indent="0" pn="section-toc.1-1.9.2.1.1"><xref derivedContent="9.1" format="counter" sectionFormat="of" target="section-9.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-general-3">General</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.2">
                <t indent="0" pn="section-toc.1-1.9.2.2.1"><xref derivedContent="9.2" format="counter" sectionFormat="of" target="section-9.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-rfc-5763">Update to RFC 5763</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2.2.2">
                  <li pn="section-toc.1-1.9.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.9.2.2.2.1.1"><xref derivedContent="9.2.1" format="counter" sectionFormat="of" target="section-9.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-section-1">Update to Section 1</xref></t>
                  </li>
                  <li pn="section-toc.1-1.9.2.2.2.2">
                    <t indent="0" pn="section-toc.1-1.9.2.2.2.2.1"><xref derivedContent="9.2.2" format="counter" sectionFormat="of" target="section-9.2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-section-5">Update to Section 5</xref></t>
                  </li>
                  <li pn="section-toc.1-1.9.2.2.2.3">
                    <t indent="0" pn="section-toc.1-1.9.2.2.2.3.1"><xref derivedContent="9.2.3" format="counter" sectionFormat="of" target="section-9.2.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-section-66">Update to Section 6.6</xref></t>
                  </li>
                  <li pn="section-toc.1-1.9.2.2.2.4">
                    <t indent="0" pn="section-toc.1-1.9.2.2.2.4.1"><xref derivedContent="9.2.4" format="counter" sectionFormat="of" target="section-9.2.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-section-671">Update to Section 6.7.1</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.9.2.3">
                <t indent="0" pn="section-toc.1-1.9.2.3.1"><xref derivedContent="9.3" format="counter" sectionFormat="of" target="section-9.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-rfc-7345">Update to RFC 7345</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2.3.2">
                  <li pn="section-toc.1-1.9.2.3.2.1">
                    <t indent="0" pn="section-toc.1-1.9.2.3.2.1.1"><xref derivedContent="9.3.1" format="counter" sectionFormat="of" target="section-9.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-section-4">Update to Section 4</xref></t>
                  </li>
                  <li pn="section-toc.1-1.9.2.3.2.2">
                    <t indent="0" pn="section-toc.1-1.9.2.3.2.2.1"><xref derivedContent="9.3.2" format="counter" sectionFormat="of" target="section-9.3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-section-521">Update to Section 5.2.1</xref></t>
                  </li>
                  <li pn="section-toc.1-1.9.2.3.2.3">
                    <t indent="0" pn="section-toc.1-1.9.2.3.2.3.1"><xref derivedContent="9.3.3" format="counter" sectionFormat="of" target="section-9.3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-update-to-section-91">Update to Section 9.1</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="12" format="counter" sectionFormat="of" target="section-12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.2">
              <li pn="section-toc.1-1.12.2.1">
                <t indent="0" pn="section-toc.1-1.12.2.1.1"><xref derivedContent="12.1" format="counter" sectionFormat="of" target="section-12.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.12.2.2">
                <t indent="0" pn="section-toc.1-1.12.2.2.1"><xref derivedContent="12.2" format="counter" sectionFormat="of" target="section-12.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.14">
            <t indent="0" pn="section-toc.1-1.14.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">
                <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/> defines Session
		Description Protocol (SDP)
                offer/answer procedures for Secure Real-time Transport
		Protocol using Datagram Transport Layer Security (DTLS-SRTP).
                <xref format="default" target="RFC7345" sectionFormat="of" derivedContent="RFC7345"/> defines SDP
		offer/answer procedures for
                UDP Transport Layer over Datagram Transport Layer Security
		(UDPTL-DTLS). This specification
                defines general offer/answer procedures for DTLS, based on the
		procedures in <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/>.
                Other specifications, defining specific DTLS usages, can then
		reference this specification,
                in order to ensure that the DTLS aspects are common among all
		usages. Having common
                procedures is essential when multiple usages share the same
                DTLS association <xref target="RFC8843" format="default" sectionFormat="of" derivedContent="RFC8843"/>.
                This document updates <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/>
                and <xref format="default" target="RFC7345" sectionFormat="of" derivedContent="RFC7345"/> by replacing common
                SDP offer/answer procedures with a reference to this specification.
      </t>
      <aside pn="section-1-2">
        <t indent="0" pn="section-1-2.1">
                NOTE: Since the publication of <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/>,
                <xref format="default" target="RFC4474" sectionFormat="of" derivedContent="RFC4474"/> has been obsoleted by
                <xref format="default" target="RFC8224" sectionFormat="of" derivedContent="RFC8224"/>. The updating
                of the references (and the associated procedures) within <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/> is outside the scope of
		this document. However, implementers of
                <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/> applications are encouraged to
                implement <xref format="default" target="RFC8224" sectionFormat="of" derivedContent="RFC8224"/> instead
                of <xref format="default" target="RFC4474" sectionFormat="of" derivedContent="RFC4474"/>.
        </t>
      </aside>
      <t indent="0" pn="section-1-3">
        As defined in <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/>, a new DTLS association
        <bcp14>MUST</bcp14> be established when transport parameters are
	changed. Transport parameter change is not
        well defined when Interactive Connectivity Establishment (ICE)
	<xref format="default" target="RFC8445" sectionFormat="of" derivedContent="RFC8445"/> is
	used. One possible way to determine a transport change is
        based on ufrag <xref format="default" target="RFC8445" sectionFormat="of" derivedContent="RFC8445"/> change,
        but the ufrag value is changed both when ICE is negotiated
        and when ICE restart <xref format="default" target="RFC8445" sectionFormat="of" derivedContent="RFC8445"/> occurs. These events
        do not always require a new DTLS association to be established, but
	previously there was no way
        to explicitly indicate in an SDP offer or answer whether a new DTLS
	association was required.
        To solve that problem, this document defines a new SDP attribute,
	"tls-id". The pair of
        SDP "tls-id" attribute values (the attribute values of the offerer and the answerer)
        uniquely identifies the DTLS association. Providing a new value of the
	"tls-id" attribute in an SDP offer
        or answer can be used to indicate whether a new DTLS association is
	to be established.
      </t>
      <t indent="0" pn="section-1-4">
        The SDP "tls-id" attribute can be specified when negotiating a
	Transport Layer Security (TLS) connection, using
        the procedures in this document in conjunction with the procedures in
	<xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/> and <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>.
        The unique combination of SDP "tls-id" attribute values can be used to
	identify the negotiated
        TLS connection. The unique value can be used, for example, within TLS
	protocol extensions to
        differentiate between multiple TLS connections and correlate those
	connections with specific
        offer/answer exchanges.  The TLS-specific considerations are described
	in <xref format="default" target="sec-tls-cons" sectionFormat="of" derivedContent="Section 7"/>.
      </t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-conventions">Conventions</name>
      <t indent="0" pn="section-2-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
    "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>",
    "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are
    to be interpreted as described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/>
        <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> when, and only when, they appear in all capitals,
    as shown here.
      </t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-establishing-a-new-dtls-ass">Establishing a New DTLS Association</name>
      <section anchor="sec-dtls-gen" numbered="true" toc="include" removeInRFC="false" pn="section-3.1">
        <name slugifiedName="name-general">General</name>
        <t indent="0" pn="section-3.1-1">
                A new DTLS association must be established between two endpoints after a
                successful SDP offer/answer exchange in the following cases:
        </t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-3.1-2">
          <li pn="section-3.1-2.1">
            The negotiated DTLS setup roles change; or
          </li>
          <li pn="section-3.1-2.2">
            One or more fingerprint values are modified, added,
            or removed in either an SDP offer or answer; or
          </li>
          <li pn="section-3.1-2.3">
            The intent to establish a new DTLS association is
            explicitly signaled using SDP, by changing the value of the
            SDP "tls-id" attribute defined in this document;
          </li>
        </ul>
        <aside pn="section-3.1-3">
          <t indent="0" pn="section-3.1-3.1">
          NOTE: The first two items above are based on the procedures
          in <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/>.
          This specification adds the support for explicit signaling using the
	  SDP "tls-id" attribute.
          </t>
        </aside>
        <t indent="0" pn="section-3.1-4">
          A new DTLS association can only be established as a result of the
	  successful SDP offer/answer exchange.
          Whenever an entity determines that a new DTLS association is
	  required, the entity <bcp14>MUST</bcp14> initiate an
          SDP offer/answer exchange, following the procedures in <xref target="sec-oa" format="default" sectionFormat="of" derivedContent="Section 5"/>.
        </t>
        <t indent="0" pn="section-3.1-5">
          The sections below describe typical cases where a new DTLS
	  association needs to be established.
        </t>
        <t indent="0" pn="section-3.1-6">
          In this document, a "new DTLS association" between two endpoints refers to either
          an initial DTLS association (when no DTLS association is currently
	  established between
          the endpoints) or a DTLS association replacing a previously
	  established one.
        </t>
      </section>
      <section anchor="sec-dtls-transport" numbered="true" toc="include" removeInRFC="false" pn="section-3.2">
        <name slugifiedName="name-change-of-local-transport-p">Change of Local Transport Parameters</name>
        <t indent="0" pn="section-3.2-1">
                If an endpoint modifies its local transport parameters
		(address and/or port), and if the modification
                requires a new DTLS association, the endpoint
		<bcp14>MUST</bcp14> change its local SDP "tls-id"
                attribute value (see <xref target="sec-dcon-attr" format="default" sectionFormat="of" derivedContent="Section 4"/>).
        </t>
        <t indent="0" pn="section-3.2-2">
                If the underlying transport protocol prohibits a DTLS association from spanning multiple 5-tuples
                (transport/source address/source port/destination address/destination port),
                and if the 5-tuple is changed, the endpoint <bcp14>MUST</bcp14> change its local SDP "tls-id" attribute value (see <xref target="sec-dcon-attr" format="default" sectionFormat="of" derivedContent="Section 4"/>).
                An example of such a case is when DTLS is carried over the Stream Control Transmission Protocol (SCTP),
                as described in <xref format="default" target="RFC6083" sectionFormat="of" derivedContent="RFC6083"/>.
        </t>
      </section>
      <section anchor="sec-dtls-ufrag" numbered="true" toc="include" removeInRFC="false" pn="section-3.3">
        <name slugifiedName="name-change-of-ice-ufrag-value">Change of ICE ufrag Value</name>
        <t indent="0" pn="section-3.3-1">
          If an endpoint uses ICE and modifies a local ufrag value, and if the modification
          requires a new DTLS association, the endpoint
	  <bcp14>MUST</bcp14> change its local SDP "tls-id"
          attribute value (see <xref target="sec-dcon-attr" format="default" sectionFormat="of" derivedContent="Section 4"/>).
        </t>
      </section>
    </section>
    <section anchor="sec-dcon-attr" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-sdp-tls-id-attribute">SDP "tls-id" Attribute</name>
      <t indent="0" pn="section-4-1">
        The pair of SDP "tls-id" attribute values (the attribute values of the
	offerer and the answerer)
        uniquely identifies the DTLS association or TLS connection.
      </t>
      <dl newline="false" indent="3" spacing="normal" pn="section-4-2">
        <dt pn="section-4-2.1">Name:</dt>
        <dd pn="section-4-2.2">tls-id</dd>
        <dt pn="section-4-2.3">Value:</dt>
        <dd pn="section-4-2.4">tls-id-value</dd>
        <dt pn="section-4-2.5">Usage Level:</dt>
        <dd pn="section-4-2.6">media</dd>
        <dt pn="section-4-2.7">Charset Dependent:</dt>
        <dd pn="section-4-2.8">no</dd>
        <dt pn="section-4-2.9">Default Value:</dt>
        <dd pn="section-4-2.10">N/A</dd>
        <dt pn="section-4-2.11">Syntax:</dt>
        <dd pn="section-4-2.12">
          <sourcecode type="abnf" markers="false" pn="section-4-2.12.1">
tls-id-value = 20*255(tls-id-char)
tls-id-char = ALPHA / DIGIT / "+" / "/" / "-" / "_"
</sourcecode>
          <t indent="0" pn="section-4-2.12.2">&lt;ALPHA and DIGIT defined in RFC 4566&gt;</t>
        </dd>
        <dt pn="section-4-2.13">Example:</dt>
        <dd pn="section-4-2.14">
          <sourcecode type="sdp" markers="false" pn="section-4-2.14.1">
a=tls-id:abc3de65cddef001be82
</sourcecode>
        </dd>
      </dl>
      <t indent="0" pn="section-4-3">
            Every time an endpoint requests to establish a new DTLS
	    association, the endpoint <bcp14>MUST</bcp14>
            generate a new local "tls-id" attribute value. An unchanged local
	    "tls-id" attribute
            value, in combination with non-changed fingerprints, indicates
	    that the endpoint
            intends to reuse the existing DTLS association.
      </t>
      <t indent="0" pn="section-4-4">
            The "tls-id" attribute value <bcp14>MUST</bcp14> be generated using a strong random function
            and include at least 120 bits of randomness.
      </t>
      <t indent="0" pn="section-4-5">
            No default value is defined for the SDP "tls-id" attribute.
            Implementations that wish to use the attribute <bcp14>MUST</bcp14> explicitly
            include it in SDP offers and answers. If an offer or answer does not
            contain a "tls-id" attribute (this could happen if the offerer or
            answerer represents an existing implementation that has not been
            updated to support the "tls-id" attribute), a modification of one
	    or more of the following characteristics <bcp14>MUST</bcp14> be
	    treated as an indication that an endpoint
            wants to establish a new DTLS association, unless there is
            another mechanism to explicitly indicate that a new DTLS association
            is to be established:
      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4-6">
        <li pn="section-4-6.1">
          DTLS setup role; or
        </li>
        <li pn="section-4-6.2">
          fingerprint set; or
        </li>
        <li pn="section-4-6.3">
          local transport parameters
        </li>
      </ul>
      <aside pn="section-4-7">
        <t indent="0" pn="section-4-7.1">
            NOTE: A modification of the ufrag value is not treated as an indication
            that an endpoint wants to establish a new DTLS association. In order to
            indicate that a new DTLS association is to be established, one or more
            of the characteristics listed above have to be modified.
        </t>
      </aside>
      <t indent="0" pn="section-4-8">
            The mux category <xref target="RFC8859" format="default" sectionFormat="of" derivedContent="RFC8859"/>
            for the "tls-id" attribute is "IDENTICAL", which means that
            the attribute value applies to all media descriptions
            being multiplexed <xref target="RFC8843" format="default" sectionFormat="of" derivedContent="RFC8843"/>.
            However, as described in <xref target="RFC8843" format="default" sectionFormat="of" derivedContent="RFC8843"/>,
            in order to avoid duplication, the attribute is only associated with the "m=" line
            representing the offerer/answerer BUNDLE tag.
      </t>
      <t indent="0" pn="section-4-9">
            For RTP-based media, the "tls-id" attribute applies to the whole associated
            media description. The attribute <bcp14>MUST NOT</bcp14> be defined per source (using the
            SDP "ssrc" attribute <xref format="default" target="RFC5576" sectionFormat="of" derivedContent="RFC5576"/>).
      </t>
      <t indent="0" pn="section-4-10">
            The SDP offer/answer procedures <xref format="default" target="RFC3264" sectionFormat="of" derivedContent="RFC3264"/>
            associated with the attribute are defined in <xref target="sec-oa" format="default" sectionFormat="of" derivedContent="Section 5"/>.
      </t>
    </section>
    <section anchor="sec-oa" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-sdp-offer-answer-procedures">SDP Offer/Answer Procedures</name>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-general-2">General</name>
        <t indent="0" pn="section-5.1-1">
                This section defines the generic SDP offer/answer procedures
		for negotiating
                a DTLS association. Additional procedures (e.g., regarding
		usage of specific SDP
                attributes) for individual DTLS usages (e.g., DTLS-SRTP)
		are outside the scope
                of this specification and need to be specified in a
		usage-specific document.
        </t>
        <aside pn="section-5.1-2">
          <t indent="0" pn="section-5.1-2.1">
          NOTE: The procedures in this section are generalizations of procedures first
          specified in the DTLS-SRTP document <xref format="default" target="RFC5763" sectionFormat="of" derivedContent="RFC5763"/>,
          with the addition of usage of the SDP "tls-id" attribute. That document is
          herein updated to make use of these new procedures.
          </t>
        </aside>
        <t indent="0" pn="section-5.1-3">
          The procedures in this section apply to an SDP media description
	  ("m=" line) associated
          with DTLS-protected media/data.
        </t>
        <t indent="0" pn="section-5.1-4">
          When an offerer or answerer indicates that it wants to establish a
	  new DTLS association, it needs to make sure that
          media packets associated with any previously established DTLS
	  association and the new DTLS association can be demultiplexed. In
	  the case
          of an ordered transport (e.g., SCTP), this can be done simply by
	  sending packets for the new DTLS association
          after all packets associated with a previously established DTLS
	  association have been sent. In the case of an unordered transport, such
	  as
          UDP, packets associated with a previously established DTLS
	  association can arrive after the answer SDP and
	  the first packets associated with the new DTLS association have been
	  received. The
	  only way to demultiplex packets associated with
          a previously established DTLS association and the new DTLS
	  association is on the basis of the 5-tuple. Because of this, if an
	  unordered transport
          is used for the DTLS association, a new 3-tuple (transport/source
	  address/source port) <bcp14>MUST</bcp14> be allocated by at least
	  one of the endpoints so that DTLS packets can be demultiplexed.
        </t>
        <t indent="0" pn="section-5.1-5">
          When an offerer needs to establish a new DTLS association, and if an
	  unordered transport (e.g., UDP)
          is used, the offerer <bcp14>MUST</bcp14> allocate a new 3-tuple for
	  the offer in such a way that the offerer can
          disambiguate any packets associated with the new DTLS association
	  from any packets associated with
          any other DTLS association. This typically means using a local
	  address and/or port, or a set of
          ICE candidates (see <xref format="default" target="sec-dtls-reest-ice" sectionFormat="of" derivedContent="Section 6"/>), which were
          not recently used for any other DTLS association.
        </t>
        <t indent="0" pn="section-5.1-6">
          When an answerer needs to establish a new DTLS association, if an
	  unordered transport is used, and
          the offerer did not allocate a new 3-tuple, the answerer
	  <bcp14>MUST</bcp14> allocate a new 3-tuple for the
          answer in such a way that it can disambiguate any packets associated
	  with the new DTLS association from any
          packets associated with any other DTLS association. This typically
	  means using a local address and/or
          port, or a set of ICE candidates (see <xref format="default" target="sec-dtls-reest-ice" sectionFormat="of" derivedContent="Section 6"/>),
          which were not recently used for any other DTLS association.
        </t>
        <t indent="0" pn="section-5.1-7">
                In order to negotiate a DTLS association, the following SDP attributes are used:
        </t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5.1-8">
          <li pn="section-5.1-8.1">
                        The SDP "setup" attribute, defined in <xref target="RFC4145" format="default" sectionFormat="of" derivedContent="RFC4145"/>, is used to negotiate the DTLS roles;
                    </li>
          <li pn="section-5.1-8.2">
                        The SDP "fingerprint" attribute, defined in <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>, is used to
                        provide one or more fingerprint values; and
                    </li>
          <li pn="section-5.1-8.3">
                        The SDP "tls-id" attribute, defined in this specification, is used to identity
                        the DTLS association.
                    </li>
        </ul>
        <t indent="0" pn="section-5.1-9">
                This specification does not define the usage of the SDP "connection" attribute
                <xref target="RFC4145" format="default" sectionFormat="of" derivedContent="RFC4145"/> for negotiating a DTLS
                association. However, the attribute <bcp14>MAY</bcp14> be used if the DTLS association is used
                together with another protocol (e.g., SCTP or TCP) for which the usage of the
                attribute has been defined.
        </t>
        <t indent="0" pn="section-5.1-10">
                Unlike for TCP and TLS connections, endpoints <bcp14>MUST NOT</bcp14> use the
                SDP "setup" attribute "holdconn" value when negotiating a DTLS association.
        </t>
        <t indent="0" pn="section-5.1-11">
                Endpoints <bcp14>MUST</bcp14> support the hash functions as defined in
                <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>.
        </t>
        <t indent="0" pn="section-5.1-12">
                The certificate received during the DTLS handshake <xref format="default" target="RFC6347" sectionFormat="of" derivedContent="RFC6347"/> <bcp14>MUST</bcp14> match a certificate
                fingerprint received in SDP "fingerprint" attributes according to the procedures
                defined in <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>.
                If fingerprints do not match the hashed certificate, then an endpoint <bcp14>MUST</bcp14> tear
                down the media session immediately (see <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>).
        </t>
        <t indent="0" pn="section-5.1-13">
                SDP offerers and answerers might reuse certificates across multiple DTLS
                associations, and provide identical fingerprint values for each DTLS
                association. The combination of the SDP "tls-id" attribute values of the SDP
                offerer and answerer identifies each individual DTLS association.
        </t>
        <aside pn="section-5.1-14">
          <t indent="0" pn="section-5.1-14.1">
          NOTE: There are cases where the SDP "tls-id" attribute value generated by the
          offerer will end up being used for multiple DTLS associations. For that reason,
          the combination of the attribute values of the offerer and answerer is needed
          in order to identity a DTLS association. An example of such a case is where the
          offerer sends an updated offer (<xref target="sec-oa-mod" format="default" sectionFormat="of" derivedContent="Section 5.5"/>) without modifying its
          attribute value, but the answerer determines that a new DTLS association is to
          be created. The answerer will generate a new local attribute value for the new
          DTLS association (<xref target="sec-oa-answer" format="default" sectionFormat="of" derivedContent="Section 5.3"/>), while the offerer will use the
          same attribute value that it used for the current association. Another example is
          when the Session Initiation Protocol (SIP) <xref format="default" target="RFC3261" sectionFormat="of" derivedContent="RFC3261"/> is used for signaling, and an offer is forked to
	  multiple answerers.
          The attribute value generated by the offerer will be used for DTLS associations
          established by each answerer.
          </t>
        </aside>
      </section>
      <section anchor="sec-oa-offer" numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-generating-the-initial-sdp-">Generating the Initial SDP Offer</name>
        <t indent="0" pn="section-5.2-1">
          When an offerer sends the initial offer, the offerer
	  <bcp14>MUST</bcp14> insert an SDP "setup" attribute
          <xref format="default" target="RFC4145" sectionFormat="of" derivedContent="RFC4145"/> with an "actpass"
	  attribute value, as well as
          one or more SDP "fingerprint" attributes according to the procedures
	  in <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>. In addition, the
	  offerer <bcp14>MUST</bcp14> insert in the offer an SDP
          "tls-id" attribute with a unique attribute value.
        </t>
        <t indent="0" pn="section-5.2-2">
          As the offerer inserts the SDP "setup" attribute with an
	  "actpass" attribute value, the
          offerer <bcp14>MUST</bcp14> be prepared to receive a DTLS
	  ClientHello message <xref format="default" target="RFC6347" sectionFormat="of" derivedContent="RFC6347"/>
	  from the answerer
	  (if a new DTLS association is established by the answerer)
	  before the offerer receives the SDP answer.
        </t>
        <t indent="0" pn="section-5.2-3">
          If the offerer receives a DTLS ClientHello message, and a DTLS
	  association is established
          before the offerer receives the SDP answer carrying the
	  fingerprint associated with the DTLS
          association, any data received on the DTLS association before
	  the fingerprint <bcp14>MUST</bcp14> be
          considered to be coming from an unverified source. The processing of
	  such data and sending of data
          by the offerer to the unverified source is outside the scope
	  of this document.
        </t>
      </section>
      <section anchor="sec-oa-answer" numbered="true" toc="include" removeInRFC="false" pn="section-5.3">
        <name slugifiedName="name-generating-the-answer">Generating the Answer</name>
        <t indent="0" pn="section-5.3-1">
                When an answerer sends an answer, the answerer
		<bcp14>MUST</bcp14> insert in the answer an SDP "setup"
		attribute
                according to the procedures in <xref format="default" target="RFC4145" sectionFormat="of" derivedContent="RFC4145"/> and one
                or more SDP "fingerprint" attributes according to the
		procedures in <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>.
                If the answerer determines, based on the criteria specified in
		<xref target="sec-dtls-gen" format="default" sectionFormat="of" derivedContent="Section 3.1"/>,
                that a new DTLS association is to be established, the answerer
		<bcp14>MUST</bcp14> insert in the associated answer
                an SDP "tls-id" attribute with a new unique attribute
		value. Note that the offerer and answerer generate
                their own local "tls-id" attribute values, and the combination
		of both values identifies the
                DTLS association.
        </t>
        <t indent="0" pn="section-5.3-2">
                If the answerer receives an offer that requires establishment of a new DTLS association, and if the
                answerer does not accept the establishment of a new DTLS association, the answerer <bcp14>MUST</bcp14> reject
                the "m=" lines associated with the suggested DTLS association
                <xref format="default" target="RFC3264" sectionFormat="of" derivedContent="RFC3264"/>.
        </t>
        <t indent="0" pn="section-5.3-3">
                If an answerer receives an offer that does not require the establishment of a new DTLS association,
                and if the answerer determines that a new DTLS association is not to be established,
                the answerer <bcp14>MUST</bcp14> insert in the associated
		answer an SDP "tls-id"
		attribute with the previously assigned attribute value. In
		addition, the answerer
		<bcp14>MUST</bcp14> insert an SDP "setup" attribute with an
                attribute value that does not change the previously negotiated
		DTLS roles, as well as one or more SDP "fingerprint"
                attributes values that do not change the previously sent
		fingerprint set, in the associated answer.
        </t>
        <t indent="0" pn="section-5.3-4">
          If the answerer receives an offer that does not contain an SDP "tls-id" attribute,
          the answerer <bcp14>MUST NOT</bcp14> insert a "tls-id" attribute in the answer.
        </t>
        <t indent="0" pn="section-5.3-5">
          If a new DTLS association is to be established, and if the
	  answerer inserts an SDP "setup"
          attribute with an "active" attribute value in the answer, the
	  answerer <bcp14>MUST</bcp14> initiate a DTLS handshake
          <xref format="default" target="RFC6347" sectionFormat="of" derivedContent="RFC6347"/> by sending a DTLS
	  ClientHello message towards the offerer.
        </t>
        <t indent="0" pn="section-5.3-6">
                Even though an offerer is required to insert an "SDP" setup attribute with an "actpass" attribute value
                in initial offers (<xref target="sec-oa-offer" format="default" sectionFormat="of" derivedContent="Section 5.2"/>) and subsequent offers (<xref target="sec-oa-mod" format="default" sectionFormat="of" derivedContent="Section 5.5"/>),
                the answerer <bcp14>MUST</bcp14> be able to receive initial and subsequent offers with other attribute values, in order
                to be backward compatible with older implementations that might insert other attribute values in initial and
                subsequent offers.
        </t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.4">
        <name slugifiedName="name-offerer-processing-of-the-s">Offerer Processing of the SDP Answer</name>
        <t indent="0" pn="section-5.4-1">
                When an offerer receives an answer that establishes a new DTLS
		association based on
                criteria defined in <xref target="sec-dtls-gen" format="default" sectionFormat="of" derivedContent="Section 3.1"/>, if the offerer
                becomes DTLS client (based on the value of the SDP "setup" attribute value
                <xref format="default" target="RFC4145" sectionFormat="of" derivedContent="RFC4145"/>), the offerer <bcp14>MUST</bcp14>
                establish a DTLS association. If the offerer becomes DTLS server, it <bcp14>MUST</bcp14> wait for the answerer
                to establish the DTLS association.
        </t>
        <t indent="0" pn="section-5.4-2">
                If the offerer indicated a desire to reuse an existing DTLS
		association, and the
                answerer does not request the establishment of a new DTLS
		association, the offerer will
                continue to use the previously established DTLS association.
        </t>
        <t indent="0" pn="section-5.4-3">
          A new DTLS association can be established based on changes in either
	  an SDP offer or answer.
          When communicating with legacy endpoints, an offerer can receive an
	  answer that includes the same
          fingerprint set and setup role. A new DTLS association will still be
	  established if such an answer
          is received as a response to an offer that requested the
	  establishment of a new DTLS association,
          as the transport parameters would have been changed in the offer.
        </t>
      </section>
      <section anchor="sec-oa-mod" numbered="true" toc="include" removeInRFC="false" pn="section-5.5">
        <name slugifiedName="name-modifying-the-session">Modifying the Session</name>
        <t indent="0" pn="section-5.5-1">
                When an offerer sends a subsequent offer, if the offerer
		wants to establish a new
                DTLS association, the offerer <bcp14>MUST</bcp14> insert an
		SDP "setup" attribute <xref format="default" target="RFC4145" sectionFormat="of" derivedContent="RFC4145"/> with an "actpass" attribute value, as well as
		or more SDP "fingerprint"
                attributes according to the procedures in <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>.
                In addition, the offerer <bcp14>MUST</bcp14> insert in the offer an SDP "tls-id" attribute with a new unique
                attribute value.
        </t>
        <t indent="0" pn="section-5.5-2">
                When an offerer sends a subsequent offer and does
		not want to establish
                a new DTLS association, if a previously established DTLS
		association exists,
                the offerer <bcp14>MUST</bcp14> insert in the offer an SDP "setup"
		attribute with an "actpass" attribute value, and
                one or more SDP "fingerprint" attributes with attribute values
		that do not change the previously
                sent fingerprint set. In addition, the offerer
		<bcp14>MUST</bcp14> insert an SDP "tls-id"
                attribute with the previously assigned attribute value in the offer.
        </t>
        <aside pn="section-5.5-3">
          <t indent="0" pn="section-5.5-3.1">
          NOTE: When a new DTLS association is being established, each
	  endpoint needs to be prepared to receive
          data on both the new and old DTLS associations as long as both are
	  alive.
          </t>
        </aside>
      </section>
    </section>
    <section anchor="sec-dtls-reest-ice" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-ice-considerations">ICE Considerations</name>
      <t indent="0" pn="section-6-1">
            When the Interactive Connectivity Establishment (ICE) mechanism
            <xref format="default" target="RFC8445" sectionFormat="of" derivedContent="RFC8445"/> is used, the
            ICE connectivity checks are performed before the DTLS
            handshake begins. Note that if aggressive nomination mode is used,
            multiple candidate pairs may be marked valid before ICE finally
            converges on a single candidate pair.
      </t>
      <aside pn="section-6-2">
        <t indent="0" pn="section-6-2.1">
        NOTE: Aggressive nomination has been deprecated from ICE but must still be
        supported for backwards compatibility reasons <xref format="default" target="RFC8445" sectionFormat="of" derivedContent="RFC8445"/>.
        </t>
      </aside>
      <t indent="0" pn="section-6-3">
            When a new DTLS association is established over an unordered
	    transport, in order to
            disambiguate any packets associated with the newly established
	    DTLS association, at least
            one of the endpoints <bcp14>MUST</bcp14> allocate a completely new
	    set of ICE candidates that
            were not recently used for any other DTLS association. This means the answerer
            cannot initiate a new DTLS association unless the offerer initiated ICE restart
            <xref format="default" target="RFC8445" sectionFormat="of" derivedContent="RFC8445"/>. If the answerer wants
            to initiate a new DTLS association, it needs to initiate an ICE restart
            and a new offer/answer exchange on its own. However, an ICE restart does not by
            default require a new DTLS association
            to be established.
      </t>
      <aside pn="section-6-4">
        <t indent="0" pn="section-6-4.1">
        NOTE: Simple Traversal of the UDP Protocol through NAT (STUN) packets
	are sent directly
        over UDP, not over DTLS. <xref format="default" target="RFC7983" sectionFormat="of" derivedContent="RFC7983"/> describes
        how to demultiplex STUN packets from DTLS packets and SRTP packets.
        </t>
      </aside>
      <t indent="0" pn="section-6-5">
            Each ICE candidate associated with a component is treated as being part of the
            same DTLS association. Therefore, from a DTLS perspective, it is not considered
            a change of local transport parameters when an endpoint switches between those
            ICE candidates.
      </t>
    </section>
    <section anchor="sec-tls-cons" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-tls-considerations">TLS Considerations</name>
      <t indent="0" pn="section-7-1">
            The procedures in this document can also be used for negotiating and
            establishing a TLS connection, with the restriction described below.
      </t>
      <t indent="0" pn="section-7-2">
            As specified in <xref format="default" target="RFC4145" sectionFormat="of" derivedContent="RFC4145"/>,
            the SDP "connection" attribute is used to indicate whether to establish a new
            TLS connection. An offerer and answerer <bcp14>MUST</bcp14> ensure
	    that the "connection"
            attribute value and the "tls-id" attribute value do not cause a conflict
            regarding whether a new TLS connection is to be established or not.
      </t>
      <aside pn="section-7-3">
        <t indent="0" pn="section-7-3.1">
            NOTE: Even though the SDP "connection" attribute can be used to indicate
            whether a new TLS connection is to be established, the unique combination
            of SDP "tls-id" attribute values can be used to identity a TLS connection.
            The unique value can be used e.g., within TLS protocol extensions to differentiate
            between multiple TLS connections and correlate those connections with specific
            offer/answer exchanges. One such extension is defined in
            <xref format="default" target="RFC8844" sectionFormat="of" derivedContent="RFC8844"/>.
        </t>
      </aside>
      <t indent="0" pn="section-7-4">
            If an offerer or answerer inserts an SDP "connection" attribute with a "new"
            value in the offer/answer and also inserts an SDP "tls-id" attribute,
            the value of the "tls-id" attribute <bcp14>MUST</bcp14> be new and unique.
      </t>
      <t indent="0" pn="section-7-5">
        If an offerer or answerer inserts an SDP "connection" attribute with an "existing"
        value in the offer/answer, if a previously established TLS connection exists, and
        if the offerer/answerer previously inserted an SDP "tls-id" attribute associated with
        the same TLS connection in an offer/answer, the offerer/answerer
	<bcp14>MUST</bcp14> also insert
        an SDP "tls-id" attribute with the previously assigned value in the offer/answer.
      </t>
      <t indent="0" pn="section-7-6">
            If an offerer or answerer receives an offer/answer with conflicting attribute values,
            the offerer/answerer <bcp14>MUST</bcp14> process the offer/answer as misformed.
      </t>
      <t indent="0" pn="section-7-7">
            An endpoint <bcp14>MUST NOT</bcp14> make assumptions regarding the
	    support of the SDP "tls-id"
            attribute by the peer. Therefore, to avoid ambiguity, both
	    offerers and answerers
            <bcp14>MUST</bcp14> always use the "connection" attribute in
	    conjunction with the "tls-id" attribute.
      </t>
      <aside pn="section-7-8">
        <t indent="0" pn="section-7-8.1">
            NOTE: As defined in <xref format="default" target="RFC4145" sectionFormat="of" derivedContent="RFC4145"/>, if the
            SDP "connection" attribute is not explicitly present, the implicit
	    default value is "new".
        </t>
      </aside>
      <t indent="0" pn="section-7-9">
        The SDP example below is based on the example in
        <xref format="default" target="RFC8122" sectionFormat="of" section="3.4" derivedLink="https://rfc-editor.org/rfc/rfc8122#section-3.4" derivedContent="RFC8122"/>, with the addition of
        the SDP "tls-id" attribute.
      </t>
      <sourcecode type="sdp" markers="false" pn="section-7-10">
m=image 54111 TCP/TLS t38
c=IN IP4 192.0.2.2
a=tls-id:abc3de65cddef001be82
a=setup:passive
a=connection:new
a=fingerprint:SHA-256 \
 12:DF:3E:5D:49:6B:19:E5:7C:AB:4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF: \
 3E:5D:49:6B:19:E5:7C:AB:4A:AD
a=fingerprint:SHA-1 \
 4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB
</sourcecode>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-sip-considerations">SIP Considerations</name>
      <t indent="0" pn="section-8-1">
        When the Session Initiation Protocol (SIP) <xref format="default" target="RFC3261" sectionFormat="of" derivedContent="RFC3261"/> is used as the signal protocol for establishing
	a multimedia
        session, dialogs <xref format="default" target="RFC3261" sectionFormat="of" derivedContent="RFC3261"/> might be
        established between the caller and multiple callees. This is referred to as forking.
        If forking occurs, separate DTLS associations will be established between the caller
        and each callee.
      </t>
      <t indent="0" pn="section-8-2">
        When forking occurs, an SDP offerer can receive DTLS ClientHello
	messages and SDP
        answers from multiple remote locations. Because of this, the
	offerer might have to
        wait for multiple SDP answers (from different remote locations)
	until it receives
        a certificate fingerprint that matches the certificate associated
	with a specific
        DTLS handshake. The offerer <bcp14>MUST NOT</bcp14> declare a
	fingerprint mismatch until it
        determines that it will not receive SDP answers from any
	additional remote locations.
      </t>
      <t indent="0" pn="section-8-3">
            It is possible to send an INVITE request that does not contain an SDP offer. Such
            an INVITE request is often referred to as an "empty INVITE" or an
	    "offerless INVITE".
            The receiving endpoint will include the SDP offer in a response to the request.
            When the endpoint generates such an SDP offer, if a previously established
            DTLS association exists, the offerer <bcp14>MUST</bcp14> insert an SDP "tls-id"
            attribute and one or more SDP "fingerprint" attributes, with previously assigned
            attribute values. If a previously established DTLS association does not exist,
            the offer <bcp14>MUST</bcp14> be generated based on the same rules as a new offer (see <xref target="sec-oa-offer" format="default" sectionFormat="of" derivedContent="Section 5.2"/>).
            Regardless of the previous existence of a DTLS association, the
	    SDP "setup" attribute 
            <bcp14>MUST</bcp14> be included according to the rules defined in
	    <xref format="default" target="RFC4145" sectionFormat="of" derivedContent="RFC4145"/>. Furthermore, if ICE is
	    used, ICE restart <bcp14>MUST</bcp14> be initiated, according to
	    the third-party call-control
            considerations described in <xref target="RFC8839" format="default" sectionFormat="of" derivedContent="RFC8839"/>.
      </t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-9">
      <name slugifiedName="name-rfc-updates">RFC Updates</name>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-9.1">
        <name slugifiedName="name-general-3">General</name>
        <t indent="0" pn="section-9.1-1">
                This section updates specifications that use DTLS-protected media, in
                order to reflect the procedures defined in this specification.
        </t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-9.2">
        <name slugifiedName="name-update-to-rfc-5763">Update to RFC 5763</name>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-9.2.1">
          <name slugifiedName="name-update-to-section-1">Update to Section 1</name>
          <t indent="0" pn="section-9.2.1-1">The reference to <xref format="default" target="RFC4572" sectionFormat="of" derivedContent="RFC4572"/> is replaced
            with a reference to <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/>.</t>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-9.2.2">
          <name slugifiedName="name-update-to-section-5">Update to Section 5</name>
          <t indent="0" pn="section-9.2.2-1">The text in <xref target="RFC5763" section="5" sectionFormat="comma" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5763#section-5" derivedContent="RFC5763"/> ("Establishing a Secure Channel") is modified
	  by replacing generic
          SDP offer/answer procedures for DTLS with a reference to this
	  specification:
          </t>
          <t indent="0" pn="section-9.2.2-2">NEW TEXT:</t>
          <blockquote pn="section-9.2.2-3">
            <t indent="0" pn="section-9.2.2-3.1">
   The two endpoints in the exchange present their identities as part of
   the DTLS handshake procedure using certificates. This document uses
   certificates in the same style as described in "Connection-Oriented
   Media Transport over the Transport Layer Security (TLS) Protocol in
   the Session Description Protocol (SDP)" <xref target="RFC8122" format="default" sectionFormat="of" derivedContent="RFC8122"/>.
</t>
            <t indent="0" pn="section-9.2.2-3.2">
   If self-signed certificates are used, the content of the
   "subjectAltName" attribute inside the certificate <bcp14>MAY</bcp14> use the uniform
   resource identifier (URI) of the user. This is useful for debugging
   purposes only and is not required to bind the certificate to one of
   the communication endpoints.  The integrity of the certificate is
   ensured through the "fingerprint" attribute in the SDP.
</t>
            <t indent="0" pn="section-9.2.2-3.3">
   The generation of public/private key pairs is relatively expensive.
   Endpoints are not required to generate certificates for each session.
</t>
            <t indent="0" pn="section-9.2.2-3.4">
   The offer/answer model, defined in <xref target="RFC3264" format="default" sectionFormat="of" derivedContent="RFC3264"/>, is used by protocols
   like the Session Initiation Protocol (SIP) <xref target="RFC3261" format="default" sectionFormat="of" derivedContent="RFC3261"/> to set up
   multimedia sessions.
</t>
            <t indent="0" pn="section-9.2.2-3.5">
   When an endpoint wishes to set up a secure media session with another
   endpoint, it sends an offer in a SIP message to the other endpoint.
   This offer includes, as part of the SDP payload, a fingerprint of
   a certificate that the endpoint wants to use. The endpoint <bcp14>SHOULD</bcp14>
   send the SIP message containing the offer to the offerer's SIP proxy
   over an integrity-protected channel. The proxy <bcp14>SHOULD</bcp14> add an
   Identity header field according to the procedures outlined in
   <xref target="RFC4474" format="default" sectionFormat="of" derivedContent="RFC4474"/>. When the far endpoint receives the SIP message, it can
   verify the identity of the sender using the Identity header field.
   Since the Identity header field is a digital signature across several
   SIP header fields, in addition to the body of the SIP message, the
   receiver can also be certain that the message has not been tampered
   with after the digital signature was applied and added to the SIP
   message.
</t>
            <t indent="0" pn="section-9.2.2-3.6">
   The far endpoint (answerer) may now establish a DTLS association with
   the offerer. Alternately, it can indicate in its answer that the
   offerer is to initiate the DTLS association. In either case, mutual
   DTLS certificate-based authentication will be used. After completing
   the DTLS handshake, information about the authenticated identities,
   including the certificates, is made available to the endpoint
   application. The answerer is then able to verify that the offerer's
   certificate used for authentication in the DTLS handshake can be
   associated with a certificate fingerprint contained in the offer in
   the SDP. At this point, the answerer may indicate to the end user
   that the media is secured. The offerer may only tentatively accept
   the answerer's certificate, since it may not yet have the answerer's
   certificate fingerprint
</t>
            <t indent="0" pn="section-9.2.2-3.7">
   When the answerer accepts the offer, it provides an answer back to
   the offerer containing the answerer's certificate fingerprint. At
   this point, the offerer can accept or reject the peer's certificate,
   and the offerer can indicate to the end user that the media is
   secured.
</t>
            <t indent="0" pn="section-9.2.2-3.8">
   Note that the entire authentication and key exchange for securing
   the media traffic is handled in the media path through DTLS. The
   signaling path is only used to verify the peers' certificate
   fingerprints.
</t>
            <t indent="0" pn="section-9.2.2-3.9">
   The offerer and answerer <bcp14>MUST</bcp14> follow the SDP offer/answer procedures
   defined in RFC 8842.
</t>
          </blockquote>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-9.2.3">
          <name slugifiedName="name-update-to-section-66">Update to Section 6.6</name>
          <t indent="0" pn="section-9.2.3-1">The text in <xref target="RFC5763" section="6.6" sectionFormat="comma" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5763#section-6.6" derivedContent="RFC5763"/> ("Session Modification") is modified by replacing generic
            SDP offer/answer procedures for DTLS with a reference to this specification:
          </t>
          <t indent="0" pn="section-9.2.3-2">
NEW TEXT:
</t>
          <blockquote pn="section-9.2.3-3">
            <t indent="0" pn="section-9.2.3-3.1">
   Once an answer is provided to the offerer, either endpoint <bcp14>MAY</bcp14>
   request a session modification that <bcp14>MAY</bcp14> include an updated offer.
   This session modification can be carried in either an INVITE or
   UPDATE request. The peers can reuse an existing DTLS association
   or establish a new one, following the procedures in RFC 8842.
</t>
          </blockquote>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-9.2.4">
          <name slugifiedName="name-update-to-section-671">Update to Section 6.7.1</name>
          <t indent="0" pn="section-9.2.4-1">The text in <xref target="RFC5763" section="6.7.1" sectionFormat="comma" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5763#section-6.7.1" derivedContent="RFC5763"/> ("ICE Interaction") is modified by
	  replacing the ICE procedures with
	  a reference to this specification:
          </t>
          <t indent="0" pn="section-9.2.4-2">
NEW TEXT:
</t>
          <blockquote pn="section-9.2.4-3">
   The Interactive Connectivity Establishment (ICE)
   <xref target="RFC8445" format="default" sectionFormat="of" derivedContent="RFC8445"/> considerations for DTLS-protected media
   are described in RFC 8842.
</blockquote>
        </section>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-9.3">
        <name slugifiedName="name-update-to-rfc-7345">Update to RFC 7345</name>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-9.3.1">
          <name slugifiedName="name-update-to-section-4">Update to Section 4</name>
          <t indent="0" pn="section-9.3.1-1">The subsections (4.1 - 4.5) in <xref target="RFC7345" section="4" sectionFormat="comma" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7345#section-4" derivedContent="RFC7345"/> ("SDP Offerer/Answerer
	  Procedures") are removed and replaced with the new text below:</t>
          <t indent="0" pn="section-9.3.1-2">NEW TEXT:</t>
          <blockquote pn="section-9.3.1-3">
            <t indent="0" pn="section-9.3.1-3.1">
   An endpoint (i.e., both the offerer and the answerer) <bcp14>MUST</bcp14> create an
   SDP media description ("m=" line) for each UDPTL-over-DTLS media
   stream and <bcp14>MUST</bcp14> assign a UDP/TLS/UDPTL value (see Table 1) to the
   "proto" field of the "m=" line.
</t>
            <t indent="0" pn="section-9.3.1-3.2">
   The offerer and answerer <bcp14>MUST</bcp14> follow the SDP offer/answer procedures
   defined in RFC 8842 in order to negotiate the DTLS association
   associated with the UDPTL-over-DTLS media stream. In addition,
   the offerer and answerer <bcp14>MUST</bcp14> use the SDP attributes defined for
   UDPTL over UDP, as defined in <xref target="ITU.T38" format="default" sectionFormat="of" derivedContent="ITU.T38"/>.
</t>
          </blockquote>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-9.3.2">
          <name slugifiedName="name-update-to-section-521">Update to Section 5.2.1</name>
          <t indent="0" pn="section-9.3.2-1">The text in <xref target="RFC7345" section="5.2.1" sectionFormat="comma" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7345#section-5.2.1" derivedContent="RFC7345"/> ("ICE Usage") is modified by replacing the
          ICE procedures with a reference to this specification:
          </t>
          <t indent="0" pn="section-9.3.2-2">
NEW TEXT:
</t>
          <blockquote pn="section-9.3.2-3">
   The Interactive Connectivity Establishment (ICE)
   <xref target="RFC8445" format="default" sectionFormat="of" derivedContent="RFC8445"/> considerations for DTLS-protected media
   are described in RFC 8842.
</blockquote>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-9.3.3">
          <name slugifiedName="name-update-to-section-91">Update to Section 9.1</name>
          <t indent="0" pn="section-9.3.3-1">A reference to <xref format="default" target="RFC8122" sectionFormat="of" derivedContent="RFC8122"/> is added
	  to <xref target="RFC7345" section="9.1" sectionFormat="comma" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7345#section-9.1" derivedContent="RFC7345"/> ("Normative References"):</t>
          <t indent="0" pn="section-9.3.3-2">
NEW TEXT:
</t>
          <blockquote pn="section-9.3.3-3">
            <dl indent="12" newline="false" spacing="normal" pn="section-9.3.3-3.1">
              <dt pn="section-9.3.3-3.1.1">[RFC8122]</dt>
              <dd pn="section-9.3.3-3.1.2">Lennox, J. and C. Holmberg, "Connection-Oriented Media
Transport over the Transport Layer Security (TLS) 
Protocol in the Session Description Protocol (SDP)", 
RFC 8122, DOI 10.17487/RFC8122, March 2017,
<eref brackets="angle" target="https://www.rfc-editor.org/info/rfc8122"/>.
</dd>
            </dl>
          </blockquote>
        </section>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-10">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-10-1">
            This specification does not modify the security considerations
	    associated with DTLS or
            the SDP offer/answer mechanism. In addition to the introduction of the SDP
            "tls-id" attribute, this document simply clarifies the procedures for
            negotiating and establishing a DTLS association.
      </t>
      <t indent="0" pn="section-10-2">
            This specification does not modify the actual TLS connection setup procedures. The
            SDP "tls-is" attribute as such cannot be used to correlate an SDP
	    offer/answer exchange with a
            TLS connection setup. Thus, this document does not introduce new
	    security considerations
            related to correlating an SDP offer/answer exchange with a TLS connection setup.
      </t>
    </section>
    <section anchor="section.iana" numbered="true" toc="include" removeInRFC="false" pn="section-11">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-11-1">
            This document updates the "Session Description Protocol Parameters" registry
            as specified in <xref target="RFC4566" format="default" sectionFormat="of" section="8.2.2" derivedLink="https://rfc-editor.org/rfc/rfc4566#section-8.2.2" derivedContent="RFC4566"/>.
            Specifically, it adds the SDP "tls-id" attribute to the table for SDP
            media-level attributes as follows.
      </t>
      <dl indent="3" newline="false" spacing="normal" pn="section-11-2">
        <dt pn="section-11-2.1">Attribute name:</dt>
        <dd pn="section-11-2.2">tls-id</dd>
        <dt pn="section-11-2.3">Type of attribute:</dt>
        <dd pn="section-11-2.4">Media-level</dd>
        <dt pn="section-11-2.5">Subject to charset:</dt>
        <dd pn="section-11-2.6">No</dd>
        <dt pn="section-11-2.7">Purpose:</dt>
        <dd pn="section-11-2.8">Indicates whether a new DTLS association or TLS connection is to be
      established/re-established.</dd>
        <dt pn="section-11-2.9">Appropriate Values:</dt>
        <dd pn="section-11-2.10">See <xref target="sec-dcon-attr" format="default" sectionFormat="of" derivedContent="Section 4"/></dd>
        <dt pn="section-11-2.11">Contact name:</dt>
        <dd pn="section-11-2.12">Christer Holmberg</dd>
        <dt pn="section-11-2.13">Mux Category:</dt>
        <dd pn="section-11-2.14">IDENTICAL</dd>
      </dl>
    </section>
  </middle>
  <back>
    <references pn="section-12">
      <name slugifiedName="name-references">References</name>
      <references pn="section-12.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC3261" target="https://www.rfc-editor.org/info/rfc3261" quoteTitle="true" derivedAnchor="RFC3261">
          <front>
            <title>SIP: Session Initiation Protocol</title>
            <author initials="J." surname="Rosenberg" fullname="J. Rosenberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Schulzrinne" fullname="H. Schulzrinne">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Camarillo" fullname="G. Camarillo">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Johnston" fullname="A. Johnston">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Peterson" fullname="J. Peterson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Sparks" fullname="R. Sparks">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Handley" fullname="M. Handley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Schooler" fullname="E. Schooler">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2002" month="June"/>
            <abstract>
              <t indent="0">This document describes Session Initiation Protocol (SIP), an application-layer control (signaling) protocol for creating, modifying, and terminating sessions with one or more participants.  These sessions include Internet telephone calls, multimedia distribution, and multimedia conferences.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3261"/>
          <seriesInfo name="DOI" value="10.17487/RFC3261"/>
        </reference>
        <reference anchor="RFC3264" target="https://www.rfc-editor.org/info/rfc3264" quoteTitle="true" derivedAnchor="RFC3264">
          <front>
            <title>An Offer/Answer Model with Session Description Protocol (SDP)</title>
            <author initials="J." surname="Rosenberg" fullname="J. Rosenberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Schulzrinne" fullname="H. Schulzrinne">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2002" month="June"/>
            <abstract>
              <t indent="0">This document defines a mechanism by which two entities can make use of the Session Description Protocol (SDP) to arrive at a common view of a multimedia session between them.  In the model, one participant offers the other a description of the desired session from their perspective, and the other participant answers with the desired session from their perspective.  This offer/answer model is most useful in unicast sessions where information from both participants is needed for the complete view of the session.  The offer/answer model is used by protocols like the Session Initiation Protocol (SIP).  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3264"/>
          <seriesInfo name="DOI" value="10.17487/RFC3264"/>
        </reference>
        <reference anchor="RFC4145" target="https://www.rfc-editor.org/info/rfc4145" quoteTitle="true" derivedAnchor="RFC4145">
          <front>
            <title>TCP-Based Media Transport in the Session Description Protocol (SDP)</title>
            <author initials="D." surname="Yon" fullname="D. Yon">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Camarillo" fullname="G. Camarillo">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="September"/>
            <abstract>
              <t indent="0">This document describes how to express media transport over TCP using the Session Description Protocol (SDP).  It defines the SDP 'TCP' protocol identifier, the SDP 'setup' attribute, which describes the connection setup procedure, and the SDP 'connection' attribute, which handles connection reestablishment.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4145"/>
          <seriesInfo name="DOI" value="10.17487/RFC4145"/>
        </reference>
        <reference anchor="RFC4566" target="https://www.rfc-editor.org/info/rfc4566" quoteTitle="true" derivedAnchor="RFC4566">
          <front>
            <title>SDP: Session Description Protocol</title>
            <author initials="M." surname="Handley" fullname="M. Handley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="V." surname="Jacobson" fullname="V. Jacobson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Perkins" fullname="C. Perkins">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="July"/>
            <abstract>
              <t indent="0">This memo defines the Session Description Protocol (SDP).  SDP is intended for describing multimedia sessions for the purposes of session announcement, session invitation, and other forms of multimedia session initiation.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4566"/>
          <seriesInfo name="DOI" value="10.17487/RFC4566"/>
        </reference>
        <reference anchor="RFC5763" target="https://www.rfc-editor.org/info/rfc5763" quoteTitle="true" derivedAnchor="RFC5763">
          <front>
            <title>Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)</title>
            <author initials="J." surname="Fischl" fullname="J. Fischl">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Tschofenig" fullname="H. Tschofenig">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="May"/>
            <abstract>
              <t indent="0">This document specifies how to use the Session Initiation Protocol (SIP) to establish a Secure Real-time Transport Protocol (SRTP) security context using the Datagram Transport Layer Security (DTLS) protocol.  It describes a mechanism of transporting a fingerprint attribute in the Session Description Protocol (SDP) that identifies the key that will be presented during the DTLS handshake.  The key exchange travels along the media path as opposed to the signaling path.  The SIP Identity mechanism can be used to protect the integrity of the fingerprint attribute from modification by intermediate proxies.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5763"/>
          <seriesInfo name="DOI" value="10.17487/RFC5763"/>
        </reference>
        <reference anchor="RFC6347" target="https://www.rfc-editor.org/info/rfc6347" quoteTitle="true" derivedAnchor="RFC6347">
          <front>
            <title>Datagram Transport Layer Security Version 1.2</title>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="N." surname="Modadugu" fullname="N. Modadugu">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="January"/>
            <abstract>
              <t indent="0">This document specifies version 1.2 of the Datagram Transport Layer Security (DTLS) protocol.  The DTLS protocol provides communications privacy for datagram protocols.  The protocol allows client/server applications to communicate in a way that is designed to prevent eavesdropping, tampering, or message forgery.  The DTLS protocol is based on the Transport Layer Security (TLS) protocol and provides equivalent security guarantees.  Datagram semantics of the underlying transport are preserved by the DTLS protocol.  This document updates DTLS 1.0 to work with TLS version 1.2.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6347"/>
          <seriesInfo name="DOI" value="10.17487/RFC6347"/>
        </reference>
        <reference anchor="RFC7345" target="https://www.rfc-editor.org/info/rfc7345" quoteTitle="true" derivedAnchor="RFC7345">
          <front>
            <title>UDP Transport Layer (UDPTL) over Datagram Transport Layer Security (DTLS)</title>
            <author initials="C." surname="Holmberg" fullname="C. Holmberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="I." surname="Sedlacek" fullname="I. Sedlacek">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Salgueiro" fullname="G. Salgueiro">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="August"/>
            <abstract>
              <t indent="0">This document specifies how the UDP Transport Layer (UDPTL) protocol, the predominant transport protocol for T.38 fax, can be transported over the Datagram Transport Layer Security (DTLS) protocol, how the usage of UDPTL over DTLS is indicated in the Session Description Protocol (SDP), and how UDPTL over DTLS is negotiated in a session established using the Session Initiation Protocol (SIP).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7345"/>
          <seriesInfo name="DOI" value="10.17487/RFC7345"/>
        </reference>
        <reference anchor="RFC8122" target="https://www.rfc-editor.org/info/rfc8122" quoteTitle="true" derivedAnchor="RFC8122">
          <front>
            <title>Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)</title>
            <author initials="J." surname="Lennox" fullname="J. Lennox">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Holmberg" fullname="C. Holmberg">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="March"/>
            <abstract>
              <t indent="0">This document specifies how to establish secure connection-oriented media transport sessions over the Transport Layer Security (TLS) protocol using the Session Description Protocol (SDP).  It defines the SDP protocol identifier, 'TCP/TLS'.  It also defines the syntax and semantics for an SDP 'fingerprint' attribute that identifies the certificate that will be presented for the TLS session.  This mechanism allows media transport over TLS connections to be established securely, so long as the integrity of session descriptions is assured.</t>
              <t indent="0">This document obsoletes RFC 4572 by clarifying the usage of multiple fingerprints.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8122"/>
          <seriesInfo name="DOI" value="10.17487/RFC8122"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8445" target="https://www.rfc-editor.org/info/rfc8445" quoteTitle="true" derivedAnchor="RFC8445">
          <front>
            <title>Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal</title>
            <author initials="A." surname="Keranen" fullname="A. Keranen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Holmberg" fullname="C. Holmberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Rosenberg" fullname="J. Rosenberg">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="July"/>
            <abstract>
              <t indent="0">This document describes a protocol for Network Address Translator (NAT) traversal for UDP-based communication.  This protocol is called Interactive Connectivity Establishment (ICE).  ICE makes use of the Session Traversal Utilities for NAT (STUN) protocol and its extension, Traversal Using Relay NAT (TURN).</t>
              <t indent="0">This document obsoletes RFC 5245.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8445"/>
          <seriesInfo name="DOI" value="10.17487/RFC8445"/>
        </reference>
        <reference anchor="RFC8843" target="https://www.rfc-editor.org/info/rfc8843" quoteTitle="true" derivedAnchor="RFC8843">
          <front>
            <title>Negotiating Media Multiplexing Using the Session Description Protocol (SDP)</title>
            <author initials="C" surname="Holmberg" fullname="Christer Holmberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H" surname="Alvestrand" fullname="Harald Alvestrand">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C" surname="Jennings" fullname="Cullen Jennings">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="January" year="2021"/>
          </front>
          <seriesInfo name="RFC" value="8843"/>
          <seriesInfo name="DOI" value="10.17487/RFC8843"/>
        </reference>
        <reference anchor="RFC8859" target="https://www.rfc-editor.org/info/rfc8859" quoteTitle="true" derivedAnchor="RFC8859">
          <front>
            <title>A Framework for Session Description Protocol (SDP) Attributes When Multiplexing</title>
            <author initials="S" surname="Nandakumar" fullname="Suhas Nandakumar">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="January" year="2021"/>
          </front>
          <seriesInfo name="RFC" value="8859"/>
          <seriesInfo name="DOI" value="10.17487/RFC8859"/>
        </reference>
      </references>
      <references pn="section-12.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="ITU.T38" target="https://www.itu.int/rec/T-REC-T.38/en" quoteTitle="true" derivedAnchor="ITU.T38">
          <front>
            <title>Procedures for real-time Group 3 facsimile communication over IP networks</title>
            <seriesInfo name="Recommendation" value="T.38"/>
            <author>
              <organization showOnFrontPage="true">ITU-T</organization>
            </author>
            <date year="2010" month="September"/>
          </front>
        </reference>
        <reference anchor="RFC4474" target="https://www.rfc-editor.org/info/rfc4474" quoteTitle="true" derivedAnchor="RFC4474">
          <front>
            <title>Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</title>
            <author initials="J." surname="Peterson" fullname="J. Peterson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Jennings" fullname="C. Jennings">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="August"/>
            <abstract>
              <t indent="0">The existing security mechanisms in the Session Initiation Protocol (SIP) are inadequate for cryptographically assuring the identity of the end users that originate SIP requests, especially in an interdomain context.  This document defines a mechanism for securely identifying originators of SIP messages.  It does so by defining two new SIP header fields, Identity, for conveying a signature used for validating the identity, and Identity-Info, for conveying a reference to the certificate of the signer.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4474"/>
          <seriesInfo name="DOI" value="10.17487/RFC4474"/>
        </reference>
        <reference anchor="RFC4572" target="https://www.rfc-editor.org/info/rfc4572" quoteTitle="true" derivedAnchor="RFC4572">
          <front>
            <title>Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)</title>
            <author initials="J." surname="Lennox" fullname="J. Lennox">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="July"/>
            <abstract>
              <t indent="0">This document specifies how to establish secure connection-oriented media transport sessions over the Transport Layer Security (TLS) protocol using the Session Description Protocol (SDP).  It defines a new SDP protocol identifier, 'TCP/TLS'.  It also defines the syntax and semantics for an SDP 'fingerprint' attribute that identifies the certificate that will be presented for the TLS session.  This mechanism allows media transport over TLS connections to be established securely, so long as the integrity of session descriptions is assured.</t>
              <t indent="0">This document extends and updates RFC 4145.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4572"/>
          <seriesInfo name="DOI" value="10.17487/RFC4572"/>
        </reference>
        <reference anchor="RFC5576" target="https://www.rfc-editor.org/info/rfc5576" quoteTitle="true" derivedAnchor="RFC5576">
          <front>
            <title>Source-Specific Media Attributes in the Session Description Protocol (SDP)</title>
            <author initials="J." surname="Lennox" fullname="J. Lennox">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Ott" fullname="J. Ott">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Schierl" fullname="T. Schierl">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="June"/>
            <abstract>
              <t indent="0">The Session Description Protocol (SDP) provides mechanisms to describe attributes of multimedia sessions and of individual media streams (e.g., Real-time Transport Protocol (RTP) sessions) within a multimedia session, but does not provide any mechanism to describe individual media sources within a media stream.  This document defines a mechanism to describe RTP media sources, which are identified by their synchronization source (SSRC) identifiers, in SDP, to associate attributes with these sources, and to express relationships among sources.  It also defines several source-level attributes that can be used to describe properties of media sources.   [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5576"/>
          <seriesInfo name="DOI" value="10.17487/RFC5576"/>
        </reference>
        <reference anchor="RFC6083" target="https://www.rfc-editor.org/info/rfc6083" quoteTitle="true" derivedAnchor="RFC6083">
          <front>
            <title>Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)</title>
            <author initials="M." surname="Tuexen" fullname="M. Tuexen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Seggelmann" fullname="R. Seggelmann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="January"/>
            <abstract>
              <t indent="0">This document describes the usage of the Datagram Transport Layer Security (DTLS) protocol over the Stream Control Transmission Protocol (SCTP).</t>
              <t indent="0">DTLS over SCTP provides communications privacy for applications that use SCTP as their transport protocol and allows client/server applications to communicate in a way that is designed to prevent eavesdropping and detect tampering or message forgery.</t>
              <t indent="0">Applications using DTLS over SCTP can use almost all transport features provided by SCTP and its extensions.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6083"/>
          <seriesInfo name="DOI" value="10.17487/RFC6083"/>
        </reference>
        <reference anchor="RFC7983" target="https://www.rfc-editor.org/info/rfc7983" quoteTitle="true" derivedAnchor="RFC7983">
          <front>
            <title>Multiplexing Scheme Updates for Secure Real-time Transport Protocol (SRTP) Extension for Datagram Transport Layer Security (DTLS)</title>
            <author initials="M." surname="Petit-Huguenin" fullname="M. Petit-Huguenin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Salgueiro" fullname="G. Salgueiro">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="September"/>
            <abstract>
              <t indent="0">This document defines how Datagram Transport Layer Security (DTLS), Real-time Transport Protocol (RTP), RTP Control Protocol (RTCP), Session Traversal Utilities for NAT (STUN), Traversal Using Relays around NAT (TURN), and ZRTP packets are multiplexed on a single receiving socket.  It overrides the guidance from RFC 5764 ("SRTP                Extension for DTLS"), which suffered from four issues described and fixed in this document.</t>
              <t indent="0">This document updates RFC 5764.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7983"/>
          <seriesInfo name="DOI" value="10.17487/RFC7983"/>
        </reference>
        <reference anchor="RFC8224" target="https://www.rfc-editor.org/info/rfc8224" quoteTitle="true" derivedAnchor="RFC8224">
          <front>
            <title>Authenticated Identity Management in the Session Initiation Protocol (SIP)</title>
            <author initials="J." surname="Peterson" fullname="J. Peterson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Jennings" fullname="C. Jennings">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Wendt" fullname="C. Wendt">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="February"/>
            <abstract>
              <t indent="0">The baseline security mechanisms in the Session Initiation Protocol (SIP) are inadequate for cryptographically assuring the identity of the end users that originate SIP requests, especially in an interdomain context.  This document defines a mechanism for securely identifying originators of SIP requests.  It does so by defining a SIP header field for conveying a signature used for validating the identity and for conveying a reference to the credentials of the signer.</t>
              <t indent="0">This document obsoletes RFC 4474.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8224"/>
          <seriesInfo name="DOI" value="10.17487/RFC8224"/>
        </reference>
        <reference anchor="RFC8839" target="https://www.rfc-editor.org/info/rfc8839" quoteTitle="true" derivedAnchor="RFC8839">
          <front>
            <title>Session Description Protocol (SDP) Offer/Answer Procedures for Interactive Connectivity Establishment (ICE)</title>
            <author initials="M" surname="Petit-Huguenin" fullname="Marc Petit-Huguenin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S" surname="Nandakumar" fullname="Suhas Nandakumar">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C" surname="Holmberg" fullname="Christer Holmberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A" surname="Keränen" fullname="Ari Keränen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R" surname="Shpount" fullname="Roman Shpount">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="January" year="2021"/>
          </front>
          <seriesInfo name="RFC" value="8839"/>
          <seriesInfo name="DOI" value="10.17487/RFC8839"/>
        </reference>
        <reference anchor="RFC8844" target="https://www.rfc-editor.org/info/rfc8844" quoteTitle="true" derivedAnchor="RFC8844">
          <front>
            <title>Unknown Key-Share Attacks on Uses of TLS with the Session Description Protocol (SDP)</title>
            <author initials="M" surname="Thomson" fullname="Martin Thomson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E" surname="Rescorla" fullname="Eric Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="January" year="2021"/>
          </front>
          <seriesInfo name="RFC" value="8844"/>
          <seriesInfo name="DOI" value="10.17487/RFC8844"/>
        </reference>
      </references>
    </references>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.a-1">
            Thanks to <contact fullname="Justin Uberti"/>, <contact fullname="Martin Thomson"/>, <contact fullname="Paul Kyzivat"/>,
            <contact fullname="Jens Guballa"/>, <contact fullname="Charles             Eckel"/>, <contact fullname="Gonzalo Salgueiro"/>, and <contact fullname="Paul Jones"/> for providing comments and suggestions on
            the document. <contact fullname="Ben Campbell"/> performed an Area
            Director review. <contact fullname="Paul Kyzivat"/> performed a
            Gen-ART review.
      </t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author fullname="Christer Holmberg" initials="C." surname="Holmberg">
        <organization abbrev="Ericsson" showOnFrontPage="true">Ericsson</organization>
        <address>
          <postal>
            <street>Hirsalantie 11</street>
            <city>Jorvas</city>
            <region/>
            <code>02420</code>
            <country>Finland</country>
          </postal>
          <phone/>
          <email>christer.holmberg@ericsson.com</email>
        </address>
      </author>
      <author fullname="Roman Shpount" initials="R." surname="Shpount">
        <organization abbrev="TurboBridge" showOnFrontPage="true">TurboBridge</organization>
        <address>
          <postal>
            <street>4905 Del Ray Avenue, Suite 300</street>
            <city>Bethesda</city>
            <region>MD</region>
            <code>20814</code>
            <country>United States of America</country>
          </postal>
          <email>rshpount@turbobridge.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
