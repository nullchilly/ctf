<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="bcp" consensus="true" docName="draft-ietf-dnsop-dns-tcp-requirements-15" indexInclude="true" ipr="trust200902" number="9210" prepTime="2022-03-22T11:48:37" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="4" tocInclude="true" updates="1123,1536" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-dns-tcp-requirements-15" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9210" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="DNS Transport over TCP">DNS Transport over TCP - Operational Requirements</title>
    <seriesInfo name="RFC" value="9210" stream="IETF"/>
    <seriesInfo name="BCP" value="235" stream="IETF"/>
    <author fullname="John Kristoff" initials="J." surname="Kristoff">
      <organization showOnFrontPage="true">Dataplane.org</organization>
      <address>
        <postal>
          <street/>
          <city>Chicago</city>
          <region>IL</region>
          <code>60605</code>
          <country>United States of America</country>
        </postal>
        <phone>+1 312 493 0305</phone>
        <email>jtk@dataplane.org</email>
        <uri>https://dataplane.org/jtk/</uri>
      </address>
    </author>
    <author fullname="Duane Wessels" initials="D." surname="Wessels">
      <organization showOnFrontPage="true">Verisign</organization>
      <address>
        <postal>
          <street>12061 Bluemont Way</street>
          <city>Reston</city>
          <region>VA</region>
          <code>20190</code>
          <country>United States of America</country>
        </postal>
        <phone>+1 703 948 3200</phone>
        <email>dwessels@verisign.com</email>
        <uri>https://verisign.com</uri>
      </address>
    </author>
    <date month="03" year="2022"/>
    <area>Operations and Management</area>
    <workgroup>Domain Name System Operations</workgroup>
    <keyword>DNS</keyword>
    <keyword>TCP</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">This document updates RFCs 1123 and 1536.  This
     document requires the operational practice of permitting
     DNS messages to be carried over TCP on the Internet as a Best
     Current Practice.  This operational requirement is aligned with the
     implementation requirements in RFC 7766.  The use of TCP includes
     both DNS over unencrypted TCP as well as over an encrypted TLS
     session.  The document also considers the consequences of this
     form of DNS communication and the potential operational issues that
     can arise when this Best Current Practice is not upheld.</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This memo documents an Internet Best Current Practice.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further information
            on BCPs is available in Section 2 of RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9210" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-language">Requirements Language</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-history-of-dns-over-tcp">History of DNS over TCP</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2">
              <li pn="section-toc.1-1.2.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.1.1"><xref derivedContent="2.1" format="counter" sectionFormat="of" target="section-2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-uneven-transport-usage-and-">Uneven Transport Usage and Preference</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.2">
                <t indent="0" pn="section-toc.1-1.2.2.2.1"><xref derivedContent="2.2" format="counter" sectionFormat="of" target="section-2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-waiting-for-large-messages-">Waiting for Large Messages and Reliability</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.3">
                <t indent="0" pn="section-toc.1-1.2.2.3.1"><xref derivedContent="2.3" format="counter" sectionFormat="of" target="section-2.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-edns0">EDNS(0)</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.4">
                <t indent="0" pn="section-toc.1-1.2.2.4.1"><xref derivedContent="2.4" format="counter" sectionFormat="of" target="section-2.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-fragmentation-and-truncatio">Fragmentation and Truncation</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.5">
                <t indent="0" pn="section-toc.1-1.2.2.5.1"><xref derivedContent="2.5" format="counter" sectionFormat="of" target="section-2.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-only-zone-transfers-use-tcp">"Only Zone Transfers Use TCP"</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.6">
                <t indent="0" pn="section-toc.1-1.2.2.6.1"><xref derivedContent="2.6" format="counter" sectionFormat="of" target="section-2.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-reuse-pipelining-and-out-of">Reuse, Pipelining, and Out-of-Order Processing</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-dns-over-tcp-requirements">DNS-over-TCP Requirements</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-network-and-system-consider">Network and System Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-connection-establishment-an">Connection Establishment and Admission</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-connection-management">Connection Management</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-connection-termination">Connection Termination</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.4">
                <t indent="0" pn="section-toc.1-1.4.2.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-dns-over-tls">DNS over TLS</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.5">
                <t indent="0" pn="section-toc.1-1.4.2.5.1"><xref derivedContent="4.5" format="counter" sectionFormat="of" target="section-4.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-defaults-and-recommended-li">Defaults and Recommended Limits</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-dns-over-tcp-filtering-risk">DNS-over-TCP Filtering Risks</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-truncation-retries-and-time">Truncation, Retries, and Timeouts</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-dns-root-zone-ksk-rollover">DNS Root Zone KSK Rollover</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-logging-and-monitoring">Logging and Monitoring</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy-considerations">Privacy Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.10.2">
              <li pn="section-toc.1-1.10.2.1">
                <t indent="0" pn="section-toc.1-1.10.2.1.1"><xref derivedContent="10.1" format="counter" sectionFormat="of" target="section-10.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.10.2.2">
                <t indent="0" pn="section-toc.1-1.10.2.2.1"><xref derivedContent="10.2" format="counter" sectionFormat="of" target="section-10.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfcs-related-to-dns-transpo">RFCs Related to DNS Transport over TCP</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.11.2">
              <li pn="section-toc.1-1.11.2.1">
                <t indent="0" pn="section-toc.1-1.11.2.1.1"><xref derivedContent="A.1" format="counter" sectionFormat="of" target="section-appendix.a.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-1035-domain-names-imple">RFC 1035 - DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.2">
                <t indent="0" pn="section-toc.1-1.11.2.2.1"><xref derivedContent="A.2" format="counter" sectionFormat="of" target="section-appendix.a.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-1536-common-dns-impleme">RFC 1536 - Common DNS Implementation Errors and Suggested Fixes</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.3">
                <t indent="0" pn="section-toc.1-1.11.2.3.1"><xref derivedContent="A.3" format="counter" sectionFormat="of" target="section-appendix.a.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-1995-incremental-zone-t">RFC 1995 - Incremental Zone Transfer in DNS</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.4">
                <t indent="0" pn="section-toc.1-1.11.2.4.1"><xref derivedContent="A.4" format="counter" sectionFormat="of" target="section-appendix.a.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-1996-a-mechanism-for-pr">RFC 1996 - A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.5">
                <t indent="0" pn="section-toc.1-1.11.2.5.1"><xref derivedContent="A.5" format="counter" sectionFormat="of" target="section-appendix.a.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-2181-clarifications-to-">RFC 2181 - Clarifications to the DNS Specification</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.6">
                <t indent="0" pn="section-toc.1-1.11.2.6.1"><xref derivedContent="A.6" format="counter" sectionFormat="of" target="section-appendix.a.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-2694-dns-extensions-to-">RFC 2694 - DNS extensions to Network Address Translators (DNS_ALG)</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.7">
                <t indent="0" pn="section-toc.1-1.11.2.7.1"><xref derivedContent="A.7" format="counter" sectionFormat="of" target="section-appendix.a.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-3225-indicating-resolve">RFC 3225 - Indicating Resolver Support of DNSSEC</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.8">
                <t indent="0" pn="section-toc.1-1.11.2.8.1"><xref derivedContent="A.8" format="counter" sectionFormat="of" target="section-appendix.a.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-3226-dnssec-and-ipv6-a6">RFC 3226 - DNSSEC and IPv6 A6 aware server/resolver message size requirements</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.9">
                <t indent="0" pn="section-toc.1-1.11.2.9.1"><xref derivedContent="A.9" format="counter" sectionFormat="of" target="section-appendix.a.9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-4472-operational-consid">RFC 4472 - Operational Considerations and Issues with IPv6 DNS</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.10">
                <t indent="0" pn="section-toc.1-1.11.2.10.1"><xref derivedContent="A.10" format="counter" sectionFormat="of" target="section-appendix.a.10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-5452-measures-for-makin">RFC 5452 - Measures for Making DNS More Resilient against Forged Answers</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.11">
                <t indent="0" pn="section-toc.1-1.11.2.11.1"><xref derivedContent="A.11" format="counter" sectionFormat="of" target="section-appendix.a.11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-5507-design-choices-whe">RFC 5507 - Design Choices When Expanding the DNS</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.12">
                <t indent="0" pn="section-toc.1-1.11.2.12.1"><xref derivedContent="A.12" format="counter" sectionFormat="of" target="section-appendix.a.12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-5625-dns-proxy-implemen">RFC 5625 - DNS Proxy Implementation Guidelines</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.13">
                <t indent="0" pn="section-toc.1-1.11.2.13.1"><xref derivedContent="A.13" format="counter" sectionFormat="of" target="section-appendix.a.13"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-5936-dns-zone-transfer-">RFC 5936 - DNS Zone Transfer Protocol (AXFR)</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.14">
                <t indent="0" pn="section-toc.1-1.11.2.14.1"><xref derivedContent="A.14" format="counter" sectionFormat="of" target="section-appendix.a.14"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-7534-as112-nameserver-o">RFC 7534 - AS112 Nameserver Operations</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.15">
                <t indent="0" pn="section-toc.1-1.11.2.15.1"><xref derivedContent="A.15" format="counter" sectionFormat="of" target="section-appendix.a.15"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-6762-multicast-dns">RFC 6762 - Multicast DNS</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.16">
                <t indent="0" pn="section-toc.1-1.11.2.16.1"><xref derivedContent="A.16" format="counter" sectionFormat="of" target="section-appendix.a.16"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-6891-extension-mechanis">RFC 6891 - Extension Mechanisms for DNS (EDNS(0))</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.17">
                <t indent="0" pn="section-toc.1-1.11.2.17.1"><xref derivedContent="A.17" format="counter" sectionFormat="of" target="section-appendix.a.17"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-iab-rfc-6950-architectural-">IAB RFC 6950 - Architectural Considerations on Application Features in the DNS</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.18">
                <t indent="0" pn="section-toc.1-1.11.2.18.1"><xref derivedContent="A.18" format="counter" sectionFormat="of" target="section-appendix.a.18"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-7477-child-to-parent-sy">RFC 7477 - Child-to-Parent Synchronization in DNS</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.19">
                <t indent="0" pn="section-toc.1-1.11.2.19.1"><xref derivedContent="A.19" format="counter" sectionFormat="of" target="section-appendix.a.19"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-7720-dns-root-name-serv">RFC 7720 - DNS Root Name Service Protocol and Deployment Requirements</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.20">
                <t indent="0" pn="section-toc.1-1.11.2.20.1"><xref derivedContent="A.20" format="counter" sectionFormat="of" target="section-appendix.a.20"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-7766-dns-transport-over">RFC 7766 - DNS Transport over TCP - Implementation Requirements</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.21">
                <t indent="0" pn="section-toc.1-1.11.2.21.1"><xref derivedContent="A.21" format="counter" sectionFormat="of" target="section-appendix.a.21"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-7828-the-edns-tcp-keepa">RFC 7828 - The edns-tcp-keepalive EDNS(0) Option</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.22">
                <t indent="0" pn="section-toc.1-1.11.2.22.1"><xref derivedContent="A.22" format="counter" sectionFormat="of" target="section-appendix.a.22"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-7858-specification-for-">RFC 7858 - Specification for DNS over Transport Layer Security (TLS)</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.23">
                <t indent="0" pn="section-toc.1-1.11.2.23.1"><xref derivedContent="A.23" format="counter" sectionFormat="of" target="section-appendix.a.23"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-7873-domain-name-system">RFC 7873 - Domain Name System (DNS) Cookies</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.24">
                <t indent="0" pn="section-toc.1-1.11.2.24.1"><xref derivedContent="A.24" format="counter" sectionFormat="of" target="section-appendix.a.24"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-7901-chain-query-reques">RFC 7901 - CHAIN Query Requests in DNS</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.25">
                <t indent="0" pn="section-toc.1-1.11.2.25.1"><xref derivedContent="A.25" format="counter" sectionFormat="of" target="section-appendix.a.25"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8027-dnssec-roadblock-a">RFC 8027 - DNSSEC Roadblock Avoidance</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.26">
                <t indent="0" pn="section-toc.1-1.11.2.26.1"><xref derivedContent="A.26" format="counter" sectionFormat="of" target="section-appendix.a.26"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8094-dns-over-datagram-">RFC 8094 - DNS over Datagram Transport Layer Security (DTLS)</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.27">
                <t indent="0" pn="section-toc.1-1.11.2.27.1"><xref derivedContent="A.27" format="counter" sectionFormat="of" target="section-appendix.a.27"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8162-using-secure-dns-t">RFC 8162 - Using Secure DNS to Associate Certificates with Domain Names for S/MIME</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.28">
                <t indent="0" pn="section-toc.1-1.11.2.28.1"><xref derivedContent="A.28" format="counter" sectionFormat="of" target="section-appendix.a.28"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8324-dns-privacy-author">RFC 8324 - DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.29">
                <t indent="0" pn="section-toc.1-1.11.2.29.1"><xref derivedContent="A.29" format="counter" sectionFormat="of" target="section-appendix.a.29"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8467-padding-policies-f">RFC 8467 - Padding Policies for Extension Mechanisms for DNS (EDNS(0))</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.30">
                <t indent="0" pn="section-toc.1-1.11.2.30.1"><xref derivedContent="A.30" format="counter" sectionFormat="of" target="section-appendix.a.30"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8482-providing-minimal-">RFC 8482 - Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.31">
                <t indent="0" pn="section-toc.1-1.11.2.31.1"><xref derivedContent="A.31" format="counter" sectionFormat="of" target="section-appendix.a.31"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8483-yeti-dns-testbed">RFC 8483 - Yeti DNS Testbed</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.32">
                <t indent="0" pn="section-toc.1-1.11.2.32.1"><xref derivedContent="A.32" format="counter" sectionFormat="of" target="section-appendix.a.32"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8484-dns-queries-over-h">RFC 8484 - DNS Queries over HTTPS (DoH)</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.33">
                <t indent="0" pn="section-toc.1-1.11.2.33.1"><xref derivedContent="A.33" format="counter" sectionFormat="of" target="section-appendix.a.33"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8490-dns-stateful-opera">RFC 8490 - DNS Stateful Operations</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.34">
                <t indent="0" pn="section-toc.1-1.11.2.34.1"><xref derivedContent="A.34" format="counter" sectionFormat="of" target="section-appendix.a.34"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8501-reverse-dns-in-ipv">RFC 8501 - Reverse DNS in IPv6 for Internet Service Providers</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.35">
                <t indent="0" pn="section-toc.1-1.11.2.35.1"><xref derivedContent="A.35" format="counter" sectionFormat="of" target="section-appendix.a.35"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8806-running-a-root-ser">RFC 8806 - Running a Root Server Local to a Resolver</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.36">
                <t indent="0" pn="section-toc.1-1.11.2.36.1"><xref derivedContent="A.36" format="counter" sectionFormat="of" target="section-appendix.a.36"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8906-a-common-operation">RFC 8906 - A Common Operational Problem in DNS Servers: Failure to Communicate</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.37">
                <t indent="0" pn="section-toc.1-1.11.2.37.1"><xref derivedContent="A.37" format="counter" sectionFormat="of" target="section-appendix.a.37"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8932-recommendations-fo">RFC 8932 - Recommendations for DNS Privacy Service Operators</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.38">
                <t indent="0" pn="section-toc.1-1.11.2.38.1"><xref derivedContent="A.38" format="counter" sectionFormat="of" target="section-appendix.a.38"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-rfc-8945-secret-key-transac">RFC 8945 - Secret Key Transaction Authentication for DNS (TSIG)</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.c"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">DNS messages are delivered using UDP or TCP communications.
     While most DNS transactions are carried over UDP, some operators
     have been led to believe that any DNS-over-TCP traffic is unwanted
     or unnecessary for general DNS operation.  When DNS over TCP has
     been restricted, a variety of communication failures and debugging
     challenges often arise.  As DNS and new naming system features have
     evolved, TCP as a transport has become increasingly important for
     the correct and safe operation of an Internet DNS.  Reflecting
     modern usage, the DNS standards declare that
     support for TCP is a required part of the DNS implementation
     specifications <xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/>.  This document is the
     equivalent of formal requirements for the operational community,
     encouraging system administrators, network engineers, and security
     staff to ensure DNS-over-TCP communications support is on par with
     DNS-over-UDP communications. It updates <xref target="RFC1123" sectionFormat="comma" section="6.1.3.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc1123#section-6.1.3.2" derivedContent="RFC1123"/> to clarify that all DNS resolvers and recursive
     servers
     <bcp14>MUST</bcp14> support and service both TCP and UDP queries and also
     updates <xref target="RFC1536" format="default" sectionFormat="of" derivedContent="RFC1536"/> to remove the misconception
     that TCP is only useful for zone transfers.
      </t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-1.1">
        <name slugifiedName="name-requirements-language">Requirements Language</name>
        <t indent="0" pn="section-1.1-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-history-of-dns-over-tcp">History of DNS over TCP</name>
      <t indent="0" pn="section-2-1">The curious state of disagreement between operational best practices
     and guidance for DNS transport protocols derives from conflicting
     messages operators have received from other operators, implementors,
     and even the IETF.  Sometimes these mixed signals have been
     explicit; on other occasions, conflicting messages have been implicit.  This
     section presents an interpretation of the storied and conflicting
     history that led to this document.  This section is included for
     informational purposes only.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1">
        <name slugifiedName="name-uneven-transport-usage-and-">Uneven Transport Usage and Preference</name>
        <t indent="0" pn="section-2.1-1">In the original suite of DNS specifications, <xref target="RFC1034" format="default" sectionFormat="of" derivedContent="RFC1034"/> and <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/> clearly specify
       that DNS messages could be carried in either
       UDP or TCP, but they also state that there is a preference for UDP as the
       best transport for queries in the general case.  As stated in
       <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>:
        </t>
        <blockquote pn="section-2.1-2">
          While virtual circuits can be used for any DNS activity,
         datagrams are preferred for queries due to their lower overhead
         and better performance.
        </blockquote>
        <t indent="0" pn="section-2.1-3">Another early, important, and influential document, <xref target="RFC1123" format="default" sectionFormat="of" derivedContent="RFC1123"/>, marks the preference for a transport protocol more explicitly:</t>
        <blockquote pn="section-2.1-4">
DNS resolvers and recursive servers <bcp14>MUST</bcp14> support UDP, and
         <bcp14>SHOULD</bcp14> support TCP, for sending (non-zone-transfer) queries.
</blockquote>
        <t indent="0" pn="section-2.1-5">
       and it further stipulates that:</t>
        <blockquote pn="section-2.1-6">
A name server <bcp14>MAY</bcp14> limit the resources it devotes to TCP
         queries, but it <bcp14>SHOULD NOT</bcp14> refuse to service a TCP query just
         because it would have succeeded with UDP.
	 </blockquote>
        <t indent="0" pn="section-2.1-7">Culminating in <xref target="RFC1536" format="default" sectionFormat="of" derivedContent="RFC1536"/>, DNS over TCP
       came to be associated primarily with the zone transfer mechanism,
       while most DNS queries and responses were seen as the dominion of
       UDP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.2">
        <name slugifiedName="name-waiting-for-large-messages-">Waiting for Large Messages and Reliability</name>
        <t indent="0" pn="section-2.2-1">In the original specifications, the maximum DNS-over-UDP
       message size was enshrined at 512 bytes.  However, even while
        <xref target="RFC1123" format="default" sectionFormat="of" derivedContent="RFC1123"/> prefers UDP for non-zone transfer
       queries, it foresaw that DNS over TCP would become more popular in the future to overcome this limitation:</t>
        <blockquote pn="section-2.2-2">
[...] it is also clear that some new DNS record types
         defined in the future will contain information exceeding the
         512 byte limit that applies to UDP, and hence will require
         TCP.
        </blockquote>
        <t indent="0" pn="section-2.2-3">At least two new, widely anticipated developments were set to
	elevate the need for DNS-over-TCP transactions. The first was
       dynamic updates defined in <xref target="RFC2136" format="default" sectionFormat="of" derivedContent="RFC2136"/>, and the
       second was the set of extensions collectively known as "DNSSEC",
       whose operational considerations were originally given in <xref target="RFC2541" format="default" sectionFormat="of" derivedContent="RFC2541"/>
       (note that <xref target="RFC2541" format="default" sectionFormat="of" derivedContent="RFC2541"/> has been obsoleted by <xref target="RFC6781" format="default" sectionFormat="of" derivedContent="RFC6781"/>).  The
       former suggests that</t>
        <blockquote pn="section-2.2-4">
       ...requestors who require an accurate response
code must use TCP.</blockquote>
        <t indent="0" pn="section-2.2-5">
       while the latter warns that </t>
        <blockquote pn="section-2.2-6">... larger keys
       increase the size of the KEY and SIG RRs.  This increases the chance
       of DNS UDP packet overflow and the possible necessity for using
       higher overhead TCP in responses.</blockquote>
        <t indent="0" pn="section-2.2-7">Yet, defying some expectations, DNS over TCP remained little used
       in real traffic across the Internet in the late 1990s.  Dynamic updates saw
       little deployment between autonomous networks.  Around the time
       DNSSEC was first defined, another new feature helped solidify
       UDP transport dominance for message transactions.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.3">
        <name slugifiedName="name-edns0">EDNS(0)</name>
        <t indent="0" pn="section-2.3-1">In 1999, the IETF published the Extension Mechanisms for DNS (EDNS(0)) in <xref target="RFC2671" format="default" sectionFormat="of" derivedContent="RFC2671"/> (which was obsoleted by <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/> in 2013).  That document
       standardized a way for communicating DNS nodes to perform
       rudimentary capabilities negotiation.  One such capability
       written into the base specification and present in every EDNS(0)-compatible
       message is the value of the maximum UDP payload size
       the sender can support.  This unsigned 16-bit field specifies,
       in bytes, the maximum (possibly fragmented) DNS message size a
       node is capable of receiving over UDP.  In practice, typical values are
       a subset of the 512- to 4096-byte range.  EDNS(0) became
       widely deployed over the next several years, and numerous surveys
       (see <xref target="CASTRO2010" format="default" sectionFormat="of" derivedContent="CASTRO2010"/> and <xref target="NETALYZR" format="default" sectionFormat="of" derivedContent="NETALYZR"/>)
       have shown that many systems support larger UDP MTUs
       with EDNS(0).</t>
        <t indent="0" pn="section-2.3-2">The natural effect of EDNS(0) deployment meant DNS messages
       larger than 512 bytes would be less reliant on TCP than they
       might otherwise have been.  While a non-negligible population of
       DNS systems lacked EDNS(0) or fell back to TCP when necessary,
       DNS clients still strongly prefer UDP to TCP.
       For example, as of 2014,
       DNS-over-TCP transactions remained a very small fraction of
       overall DNS traffic received by root name servers <xref target="VERISIGN" format="default" sectionFormat="of" derivedContent="VERISIGN"/>.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.4">
        <name slugifiedName="name-fragmentation-and-truncatio">Fragmentation and Truncation</name>
        <t indent="0" pn="section-2.4-1">Although EDNS(0) provides a way for endpoints to signal support for
       DNS messages exceeding 512 bytes, the realities of a diverse and
       inconsistently deployed Internet may result in some large messages
       being unable to reach their destination.  Any IP datagram whose size
       exceeds the MTU of a link it transits will be fragmented and then
       reassembled by the receiving host.  Unfortunately, it is not uncommon
       for middleboxes and firewalls to block IP fragments.  If one or more
       fragments do not arrive, the application does not receive the message,
       and the request times out.</t>
        <t indent="0" pn="section-2.4-2">For IPv4-connected hosts, the MTU is often an Ethernet
       payload size of 1500 bytes.  This means that the largest unfragmented
       UDP DNS message that can be sent over IPv4 is likely 1472 bytes,
       although tunnel encapsulation may reduce that maximum message
       size in some cases.</t>
        <t indent="0" pn="section-2.4-3">For
       IPv6, the situation is a little more complicated.  First, IPv6 headers
       are 40 bytes (versus 20 without options in IPv4).  Second, approximately
       one-third of DNS recursive resolvers
       use the minimum MTU of 1280 bytes <xref target="APNIC" format="default" sectionFormat="of" derivedContent="APNIC"/>.
       Third, fragmentation in IPv6 can only be
       done by the host originating the datagram.  The need to fragment is
       conveyed in an ICMPv6 "Packet Too Big" message.  The originating host
       indicates a fragmented datagram with IPv6 extension headers.
       Unfortunately, it is quite common for both ICMPv6 and IPv6 extension
       headers to be blocked by middleboxes.  According to
       <xref target="HUSTON" format="default" sectionFormat="of" derivedContent="HUSTON"/>, some 35% of IPv6-capable
       recursive resolvers were unable to receive a fragmented IPv6 packet.
       When the originating host receives a signal that
       fragmentation is required, it is expected to populate its path
       MTU cache for that destination.  The application will then retry
       the query after a timeout since the host does not generally retain
       copies of messages sent over UDP for potential retransmission.</t>
        <t indent="0" pn="section-2.4-4">The practical consequence of all this is that DNS requestors
       must be prepared to retry queries with different EDNS(0) maximum
       message size values. Administrators of <xref target="BIND" format="default" sectionFormat="of" derivedContent="BIND"/> are likely to be 
       familiar with seeing the following message in their system logs: "success resolving ... after reducing the
       advertised EDNS(0) UDP packet size to 512 octets".</t>
        <t indent="0" pn="section-2.4-5">Often, reducing the EDNS(0) UDP packet size leads to a
       successful response.  That is, the necessary data fits within the
       smaller message size.  However, when the data does not fit, the
       server sets the truncated flag in its response, indicating the
       client should retry over TCP to receive the whole response.  This
       is undesirable from the client's point of view because it adds
       more latency and is potentially undesirable from the server's point
       of view due to the increased resource requirements of TCP.</t>
        <t indent="0" pn="section-2.4-6">Note that a receiver is unable to differentiate between packets
       lost due to congestion and packets (fragments) intentionally
       dropped by firewalls or middleboxes.  Over network paths with
       non-trivial amounts of packet loss, larger, fragmented DNS responses
       are more likely to never arrive and time out compared to smaller,
       unfragmented responses.  Clients might be misled into retrying
       queries with different EDNS(0) UDP packet size values for the
       wrong reason.</t>
        <t indent="0" pn="section-2.4-7">The issues around fragmentation, truncation, and TCP are
       driving certain implementation and policy decisions in the DNS.
       Notably, Cloudflare implemented a technique that minimizes the number of DNSSEC denial-of-existence records (for its online signing platform)
       <xref target="CLOUDFLARE" format="default" sectionFormat="of" derivedContent="CLOUDFLARE"/> and uses an Elliptic Curve Digital
       Signature Algorithm (ECDSA) such that
       its signed responses fit easily in 512 bytes.  The Key Signing Key (KSK) Rollover
       Design Team <xref target="DESIGNTEAM" format="default" sectionFormat="of" derivedContent="DESIGNTEAM"/> spent a lot of time
       thinking and worrying about response sizes.  There is growing
       sentiment in the DNSSEC community that RSA key sizes beyond
       2048 bits are impractical and that critical infrastructure zones
       should transition to elliptic curve algorithms to keep response
       sizes manageable <xref target="ECDSA" format="default" sectionFormat="of" derivedContent="ECDSA"/>.</t>
        <t indent="0" pn="section-2.4-8">More recently, renewed security concerns about fragmented DNS
       messages (see <xref target="I-D.ietf-dnsop-avoid-fragmentation" format="default" sectionFormat="of" derivedContent="AVOID_FRAGS"/> and <xref target="FRAG_POISON" format="default" sectionFormat="of" derivedContent="FRAG_POISON"/>)
       are leading implementors to consider smaller responses and lower
       default EDNS(0) UDP payload size values for both queriers and
       responders <xref target="FLAGDAY2020" format="default" sectionFormat="of" derivedContent="FLAGDAY2020"/>.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.5">
        <name slugifiedName="name-only-zone-transfers-use-tcp">"Only Zone Transfers Use TCP"</name>
        <t indent="0" pn="section-2.5-1">Today, the majority of the DNS community expects, or at least
       has a desire, to see DNS-over-TCP transactions occur without
       interference <xref target="FLAGDAY2020" format="default" sectionFormat="of" derivedContent="FLAGDAY2020"/>.  However, there has also been a long-held belief by
       some operators, particularly for security-related reasons, that
       DNS-over-TCP services should be purposely limited or not provided
       at all <xref target="CHES94" format="default" sectionFormat="of" derivedContent="CHES94"/> <xref target="DJBDNS" format="default" sectionFormat="of" derivedContent="DJBDNS"/>.  A popular meme is
       that DNS over TCP is only ever used for zone
       transfers and is generally unnecessary otherwise, with filtering
       all DNS-over-TCP traffic even described as a best practice.</t>
        <t indent="0" pn="section-2.5-2">The position on restricting DNS over TCP had some
       justification given that historical implementations of DNS
       name servers provided very little in the way of TCP connection
       management (for example, see <xref target="RFC7766" sectionFormat="of" section="6.1.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7766#section-6.1.2" derivedContent="RFC7766"/> for more details).  However, modern
       standards and implementations are nearing parity with the more
       sophisticated TCP management techniques employed by, for example,
       HTTP(S) servers and load balancers.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.6">
        <name slugifiedName="name-reuse-pipelining-and-out-of">Reuse, Pipelining, and Out-of-Order Processing</name>
        <t indent="0" pn="section-2.6-1">The idea that a TCP connection can support multiple transactions
       goes back as far as <xref target="RFC0883" format="default" sectionFormat="of" derivedContent="RFC0883"/>, which states:
       "Multiple messages may be sent over a virtual circuit." Although
       <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>, which updates the former, omits this
       particular detail, it has been generally accepted that a TCP connection
       can be used for more than one query and response.</t>
        <t indent="0" pn="section-2.6-2"><xref target="RFC5966" format="default" sectionFormat="of" derivedContent="RFC5966"/> clarifies that servers are not
       required to preserve the order of queries and responses over
       any transport.
       <xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/>, which updates the former, further
       encourages query pipelining over TCP to achieve performance on
       par with UDP.
       A server that sends out-of-order responses to pipelined queries
       avoids head-of-line blocking when the response for a later
       query is ready before the response to an earlier query.</t>
        <t indent="0" pn="section-2.6-3">However, TCP can potentially suffer from a different
       head-of-line blocking problem due to packet loss.
       Since TCP itself enforces ordering, a single lost segment
       delays delivery of data in any following segments until
       the lost segment is retransmitted and successfully received.</t>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-dns-over-tcp-requirements">DNS-over-TCP Requirements</name>
      <t indent="0" pn="section-3-1">An average increase in DNS message size (e.g., due to DNSSEC),
     the continued development of new DNS features (<xref target="dnsrfcs" format="default" sectionFormat="of" derivedContent="Appendix A"/>), and a denial-of-service mitigation
     technique (<xref target="Security" format="default" sectionFormat="of" derivedContent="Section 8"/>) all show that
     DNS-over-TCP transactions are as important to the correct and safe
     operation of the Internet DNS as ever, if not more so.
     Furthermore, there has been research that argues
     connection-oriented DNS transactions may provide security and
     privacy advantages over UDP transport <xref target="TDNS" format="default" sectionFormat="of" derivedContent="TDNS"/>.
     In fact, the standard for DNS over TLS <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>
     is just this sort of specification.  Therefore, this document makes
     explicit that it is undesirable for network operators to
      artificially inhibit DNS-over-TCP transport.</t>
      <t indent="0" pn="section-3-2"><xref target="RFC1123" sectionFormat="of" section="6.1.3.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc1123#section-6.1.3.2" derivedContent="RFC1123"/> is updated as follows:</t>
      <t indent="0" pn="section-3-3">OLD:
      </t>
      <blockquote pn="section-3-4">
        DNS resolvers and recursive servers <bcp14>MUST</bcp14> support UDP, and
        <bcp14>SHOULD</bcp14> support TCP, for sending (non-zone-transfer) queries.
      </blockquote>
      <t indent="0" pn="section-3-5">NEW:
      </t>
      <blockquote pn="section-3-6">
          All DNS resolvers and servers <bcp14>MUST</bcp14> support and service 
          both UDP and TCP queries.
        </blockquote>
      <t indent="0" pn="section-3-7">Note that:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-3-8">
        <li pn="section-3-8.1">DNS servers (including forwarders) <bcp14>MUST</bcp14> support and service
         TCP for receiving queries so that clients can reliably receive
         responses that are larger than what either side considers too large
         for UDP.</li>
        <li pn="section-3-8.2">DNS clients <bcp14>MUST</bcp14> support TCP for sending
         queries so that they can retry truncated UDP responses as necessary.</li>
      </ul>
      <t indent="0" pn="section-3-9">
     Furthermore, the requirement in <xref target="RFC1123" sectionFormat="of" section="6.1.3.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc1123#section-6.1.3.2" derivedContent="RFC1123"/> around limiting the resources a server devotes
     to queries is hereby updated:</t>
      <t indent="0" pn="section-3-10">OLD:
      </t>
      <blockquote pn="section-3-11">
          A name server <bcp14>MAY</bcp14> limit the resources it devotes to TCP queries,
          but it <bcp14>SHOULD NOT</bcp14> refuse to service a TCP query just
          because it would have succeeded with UDP.
      </blockquote>
      <t indent="0" pn="section-3-12">

     NEW:
      </t>
      <blockquote pn="section-3-13">
           A name server <bcp14>MAY</bcp14> limit the resources it devotes to queries, but
           it <bcp14>MUST NOT</bcp14> refuse to service a query just because it would have
           succeeded with another transport protocol.</blockquote>
      <t indent="0" pn="section-3-14">Lastly, <xref target="RFC1536" sectionFormat="of" section="1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc1536#section-1" derivedContent="RFC1536"/> is updated to eliminate
     the misconception that TCP is only useful for zone transfers:</t>
      <t indent="0" pn="section-3-15">OLD:
      </t>
      <blockquote pn="section-3-16">
         DNS implements the classic request-response scheme of
         client-server interaction. UDP is, therefore, the chosen protocol
         for communication though TCP is used for zone transfers.
	</blockquote>
      <t indent="0" pn="section-3-17">

     NEW:
      </t>
      <blockquote pn="section-3-18">
          DNS implements the classic request-response scheme of
          client-server interaction.
	 </blockquote>
      <t indent="0" pn="section-3-19">The filtering of DNS over TCP is harmful in the general
     case.  DNS resolver and server operators <bcp14>MUST</bcp14> support and provide
     DNS service over both UDP and TCP transports.  Likewise, network
     operators <bcp14>MUST</bcp14> allow DNS service over both UDP and TCP transports.
     It is acknowledged that DNS-over-TCP service can pose operational
     challenges that are not present when running DNS over UDP alone,
     and vice versa.  However,
     the potential damage incurred by prohibiting DNS-over-TCP
     service is more detrimental to the continued utility and success of
     the DNS than when its usage is allowed.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-network-and-system-consider">Network and System Considerations</name>
      <t indent="0" pn="section-4-1">This section describes measures that systems and applications
   can take to optimize performance over TCP and to protect themselves
   from TCP-based resource exhaustion and attacks.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-connection-establishment-an">Connection Establishment and Admission</name>
        <t indent="0" pn="section-4.1-1">Resolvers and other DNS clients should be aware that some
       servers might not be reachable over TCP.  For this reason, clients
       <bcp14>MAY</bcp14> track and limit the number of TCP connections and
       connection attempts to a single server.  Reachability problems
       can be caused by network elements close to the server, close
       to the client, or anywhere along the path between them.  Mobile
       clients that cache connection failures <bcp14>MAY</bcp14> do so on a per-network
       basis or <bcp14>MAY</bcp14> clear such a cache upon change of network.</t>
        <t indent="0" pn="section-4.1-2">Additionally, DNS clients
       <bcp14>MAY</bcp14> enforce a short timeout on unestablished connections
       rather than rely on the host operating system's TCP connection
       timeout, which is often around 60-120 seconds (i.e., due to an
       initial retransmission timeout of 1 second, the exponential
       back-off rules of <xref target="RFC6298" format="default" sectionFormat="of" derivedContent="RFC6298"/>, and a limit of six
       retries as is the default in Linux).</t>
        <t indent="0" pn="section-4.1-3">The SYN flooding attack is a denial-of-service method
       affecting hosts that run TCP server processes <xref target="RFC4987" format="default" sectionFormat="of" derivedContent="RFC4987"/>.  This attack can be very effective if
       not mitigated.  One of the most effective mitigation techniques
       is SYN cookies, described in <xref target="RFC4987" sectionFormat="of" section="3.6" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4987#section-3.6" derivedContent="RFC4987"/>, which allows the server to avoid allocating
       any state until the successful completion of the three-way
       handshake.</t>
        <t indent="0" pn="section-4.1-4">Services not intended for use by the public Internet,
       such as most recursive name servers, <bcp14>SHOULD</bcp14> be protected
       with access controls.  Ideally, these controls are placed in
       the network, well before any unwanted TCP packets can
       reach the DNS server host or application.  If this is not
       possible, the controls can be placed in the application
       itself.  In some situations (e.g., attacks), it may be necessary
       to deploy access controls for DNS services that should
       otherwise be globally reachable.  See also <xref target="RFC5358" format="default" sectionFormat="of" derivedContent="RFC5358"/>.</t>
        <t indent="0" pn="section-4.1-5">The FreeBSD and NetBSD operating systems have an "accept filter" feature
       (<xref target="accept_filter" format="default" sectionFormat="of" derivedContent="accept_filter"/>)
       that postpones delivery of TCP connections to applications
       until a complete, valid request has been received.  The
       dns_accf(9) filter ensures that a valid DNS message is
       received.  If not, the bogus connection never reaches the
       application.
       The Linux TCP_DEFER_ACCEPT feature, while more limited in scope,
       can provide some of the same benefits as the BSD accept filter
       feature.
       These features are implemented as low-level socket options
       and are not activated automatically. If applications wish to
       use these features, they need to make specific calls to set the
       right options, and administrators may also need to configure the
       applications to appropriately use the features.</t>
        <t indent="0" pn="section-4.1-6">Per <xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/>, applications and administrators
       are advised to remember that TCP <bcp14>MAY</bcp14> be used before sending
       any UDP queries.  Networks and applications <bcp14>MUST NOT</bcp14> be configured
       to refuse TCP queries that were not preceded by a UDP query.</t>
        <t indent="0" pn="section-4.1-7">TCP Fast Open (TFO) <xref target="RFC7413" format="default" sectionFormat="of" derivedContent="RFC7413"/> allows TCP
       clients to shorten the handshake for subsequent connections
       to the same server.  TFO saves one round-trip time in the
       connection setup.  DNS servers <bcp14>SHOULD</bcp14> enable TFO when possible.
       Furthermore, DNS servers clustered behind a single service
       address (e.g., anycast or load balancing) <bcp14>SHOULD</bcp14> either use the
       same TFO server key on all instances or disable TFO for all members of the cluster.</t>
        <t indent="0" pn="section-4.1-8">DNS clients <bcp14>MAY</bcp14> also enable TFO.  At the time of this writing, it is not implemented or is disabled by default on some operating systems.
       <xref target="WIKIPEDIA_TFO" format="default" sectionFormat="of" derivedContent="WIKIPEDIA_TFO"/> describes applications and operating systems
       that support TFO.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-connection-management">Connection Management</name>
        <t indent="0" pn="section-4.2-1">Since host memory for TCP state is a finite resource, DNS
       clients and
       servers <bcp14>SHOULD</bcp14> actively manage their connections.  Applications
       that do not actively manage their connections
       can encounter resource exhaustion leading to denial of
       service.  For DNS, as in other protocols, there is a trade-off
       between keeping connections open for potential future use and
       the need to free up resources for new connections that will arrive.</t>
        <t indent="0" pn="section-4.2-2">Operators of DNS server software <bcp14>SHOULD</bcp14> be aware that operating
       system and application vendors <bcp14>MAY</bcp14> impose a limit on the total
       number of established connections.  These limits may be designed
       to protect against DDoS attacks or performance degradation.
       Operators <bcp14>SHOULD</bcp14> understand how to increase these limits if
       necessary and the consequences of doing so.  Limits imposed by
       the application <bcp14>SHOULD</bcp14> be lower than limits imposed by the
       operating system so that the application can apply its own
       policy to connection management, such as closing the oldest
       idle connections first.</t>
        <t indent="0" pn="section-4.2-3">DNS server software <bcp14>MAY</bcp14> provide a configurable limit on
       the number of established connections per source IP address
       or subnet.  This can be used to ensure that a single or small
       set of users cannot consume all TCP resources and deny
       service to other users.  Note, however, that if this limit
       is enabled, it possibly limits client performance while leaving
       some TCP resources unutilized. Operators <bcp14>SHOULD</bcp14> be aware of
       these trade-offs and ensure this limit, if configured, 
       is set appropriately based on the number and diversity
       of their users and  whether users connect from unique IP addresses or
       through a shared Network Address Translator (NAT) <xref target="RFC3022" format="default" sectionFormat="of" derivedContent="RFC3022"/>.</t>
        <t indent="0" pn="section-4.2-4">DNS server software <bcp14>SHOULD</bcp14> provide a configurable timeout
       for idle TCP connections.  This can be used to free up resources
       for new connections and to ensure that idle
       connections are eventually closed.  At the same time, it possibly
       limits client performance while leaving some TCP resources unutilized.
       For very busy name servers, this
       might be set to a low value, such as a few seconds.  For
       less busy servers, it might be set to a higher value, such
       as tens of seconds. DNS clients and servers <bcp14>SHOULD</bcp14> signal
       their timeout values using the edns-tcp-keepalive EDNS(0)
       option <xref target="RFC7828" format="default" sectionFormat="of" derivedContent="RFC7828"/>.</t>
        <t indent="0" pn="section-4.2-5">DNS server software <bcp14>MAY</bcp14> provide a configurable limit on
       the number of transactions per TCP connection.
       This can help protect against unfair connection use (e.g., not releasing
       connection slots to other clients) and network evasion attacks.</t>
        <t indent="0" pn="section-4.2-6">Similarly, DNS server software <bcp14>MAY</bcp14> provide a configurable
       limit on the total duration of a TCP connection.
       This can help protect against unfair connection use, slow read attacks, 
       and network evasion attacks.</t>
        <t indent="0" pn="section-4.2-7">Since clients may not be aware of server-imposed limits,
       clients utilizing TCP for DNS need to always be prepared to
       re-establish connections or otherwise retry outstanding
       queries.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.3">
        <name slugifiedName="name-connection-termination">Connection Termination</name>
        <t indent="0" pn="section-4.3-1">The TCP peer that initiates a
       connection close retains the socket in the TIME_WAIT state
       for some amount of time, possibly a few minutes. 
       It is generally preferable for clients to initiate the
       close of a TCP connection so that busy servers do not 
       accumulate many sockets in the TIME_WAIT state, which can
       cause performance problems or even denial of service.
       The edns-tcp-keepalive EDNS(0) option <xref target="RFC7828" format="default" sectionFormat="of" derivedContent="RFC7828"/>
       can be used to encourage clients to close connections.</t>
        <t indent="0" pn="section-4.3-2">On systems where large numbers of sockets in TIME_WAIT
       are observed (as either a client or a server) and are affecting
       an application's performance, it may be tempting to tune local TCP
       parameters.  For example, the Linux kernel has
       a "sysctl" parameter named net.ipv4.tcp_tw_reuse, which allows
       connections in the TIME_WAIT state to be reused in specific
       circumstances.  Note, however, that this affects only outgoing (client)
       connections and has no impact on servers.  In most cases, it is <bcp14>NOT RECOMMENDED</bcp14> to change parameters related to the TIME_WAIT state.
       It should only be done by those with detailed knowledge of both TCP
       and the affected application.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.4">
        <name slugifiedName="name-dns-over-tls">DNS over TLS</name>
        <t indent="0" pn="section-4.4-1">DNS messages may be sent over TLS to provide privacy
       between stubs and recursive resolvers. <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>
       is a Standards Track document describing how this works.
       Although DNS over TLS utilizes TCP port 853 instead of port 53, this
       document applies equally well to DNS over TLS.  Note, however,
       that DNS over TLS is only defined between stubs and
       recursives at the time of this writing.</t>
        <t indent="0" pn="section-4.4-2">The use of TLS places even stronger operational burdens
       on DNS clients and servers.  Cryptographic functions for
       authentication and encryption require additional processing.
       Unoptimized connection setup with TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>
       takes one additional round trip compared to TCP.
       Connection setup
       times can be reduced with TCP Fast Open and TLS False Start <xref target="RFC7918" format="default" sectionFormat="of" derivedContent="RFC7918"/> for TLS 1.2.  TLS 1.3 session resumption does not
       reduce round-trip latency because no application profile for use of
       TLS 0-RTT data with DNS has been published at the time of this
       writing.  However, TLS session resumption can reduce the number of
       cryptographic operations, and in TLS 1.2, session resumption does
       reduce the number of additional round trips from two to one.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.5">
        <name slugifiedName="name-defaults-and-recommended-li">Defaults and Recommended Limits</name>
        <t indent="0" pn="section-4.5-1">A survey of features and defaults was conducted for popular
       open-source DNS server implementations at the time of writing.
       This section documents those defaults and makes recommendations
       for configurable limits that can be used in the absence of any
       other information.  Any recommended values in this document are
       only intended as a starting point for administrators that are
       unsure of what sorts of limits might be reasonable. Operators <bcp14>SHOULD</bcp14>
       use application-specific monitoring, system logs, and system
       monitoring tools to gauge whether their service is operating
       within or exceeding these limits and adjust accordingly.</t>
        <t indent="0" pn="section-4.5-2">Most open-source DNS server implementations provide a
       configurable limit on the total number of established connections.
       Default values range from 20 to 150.  In most cases, where the
       majority of queries take place over UDP, 150 is a reasonable limit.
       For services or environments where most queries take place over
       TCP or TLS, 5000 is a more appropriate limit.</t>
        <t indent="0" pn="section-4.5-3">Only some open-source implementations provide a way to limit
       the number of connections per source IP address or subnet, but
       the default is to have no limit.  For environments or situations
       where it may be necessary to enable this limit, 25 connections
       per source IP address is a reasonable starting point.  The limit
       should be increased when aggregated by subnet or for services
       where most queries take place over TCP or TLS.</t>
        <t indent="0" pn="section-4.5-4">Most open-source implementations provide a configurable idle
       timeout on connections.  Default values range from 2 to 30 seconds.
       In most cases, 10 seconds is a reasonable default for this limit.
       Longer timeouts improve connection reuse, but busy servers may
       need to use a lower limit.</t>
        <t indent="0" pn="section-4.5-5">Only some open-source implementations provide a way to limit
       the number of transactions per connection, but the default is to
       have no limit.  This document does not offer advice on particular
       values for such a limit.</t>
        <t indent="0" pn="section-4.5-6">Only some open-source implementations provide a way to limit
       the duration of connection, but the default is to have no limit.
       This document does not offer advice on particular values for such
       a limit.</t>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-dns-over-tcp-filtering-risk">DNS-over-TCP Filtering Risks</name>
      <t indent="0" pn="section-5-1">Networks that filter DNS over TCP risk losing access to
     significant or important pieces of the DNS namespace.  For a
     variety of reasons, a DNS answer may require a DNS-over-TCP query.
     This may include large message sizes, lack of EDNS(0) support, or DDoS
     mitigation techniques (including Response Rate Limiting <xref target="RRL" format="default" sectionFormat="of" derivedContent="RRL"/>); additionally, perhaps some future capability that is as
     yet unforeseen will also demand TCP transport.</t>
      <t indent="0" pn="section-5-2">For example, <xref target="RFC7901" format="default" sectionFormat="of" derivedContent="RFC7901"/> describes a latency-avoiding
     technique that sends extra data in DNS responses.  This makes
     responses larger and potentially increases the effectiveness of DDoS reflection
     attacks.  The specification mandates the use of TCP or DNS
     cookies <xref target="RFC7873" format="default" sectionFormat="of" derivedContent="RFC7873"/>.</t>
      <t indent="0" pn="section-5-3">Even if any or all particular answers have consistently been
     returned successfully with UDP in the past, this continued behavior
     cannot be guaranteed when DNS messages are exchanged between
     autonomous systems.  Therefore, filtering of DNS over TCP is
     considered harmful and contrary to the safe and successful operation
     of the Internet.  This section enumerates some of the known risks
     at the time of this writing when networks filter DNS over
     TCP.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-truncation-retries-and-time">Truncation, Retries, and Timeouts</name>
        <t indent="0" pn="section-5.1-1">Networks that filter DNS over TCP may inadvertently cause
       problems for third-party resolvers as experienced by <xref target="TOYAMA" format="default" sectionFormat="of" derivedContent="TOYAMA"/>.  For example, a resolver receives queries
       for a moderately popular domain.  The resolver forwards the queries
       to the domain's authoritative name servers, but those servers
       respond with the TC bit set.  The resolver retries over TCP,
       but the authoritative server blocks DNS over TCP.  The pending
       connections consume resources on the resolver until they time out.
       If the number
       and frequency of these truncated-and-then-blocked queries are sufficiently high,
       the resolver wastes valuable resources on queries that can never be answered.
       This condition is generally not easily or completely mitigated by the
       affected DNS resolver operator.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-dns-root-zone-ksk-rollover">DNS Root Zone KSK Rollover</name>
        <t indent="0" pn="section-5.2-1">The plans for deploying DNSSEC KSK for the root zone highlighted
       a potential problem in retrieving the root zone key set <xref target="LEWIS" format="default" sectionFormat="of" derivedContent="LEWIS"/>.  During some phases of the KSK rollover process,
       root zone DNSKEY responses were
       larger than 1280 bytes, the IPv6 minimum MTU for links
       carrying IPv6 traffic <xref target="RFC8200" format="default" sectionFormat="of" derivedContent="RFC8200"/>.
       There was some concern
       that any DNS server unable to receive large
       DNS messages over UDP, or any DNS message over TCP, would experience
       disruption while performing DNSSEC validation <xref target="KSK_ROLLOVER_ARCHIVES" format="default" sectionFormat="of" derivedContent="KSK_ROLLOVER_ARCHIVES"/>.</t>
        <t indent="0" pn="section-5.2-2">However, during the
       year-long postponement of the KSK rollover, there were no reported problems
       that could be attributed to the 1414 octet DNSKEY response when both
       the old and new keys were published in the zone.  Additionally, there
       were no reported problems during the two-month period when the old key was
       published as revoked and the DNSKEY response was 1425 octets in size <xref target="ROLL_YOUR_ROOT" format="default" sectionFormat="of" derivedContent="ROLL_YOUR_ROOT"/>.</t>
      </section>
    </section>
    <section anchor="logging-monitoring" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-logging-and-monitoring">Logging and Monitoring</name>
      <t indent="0" pn="section-6-1">Developers of applications that log or monitor DNS
     <bcp14>SHOULD NOT</bcp14> ignore TCP due to the perception that it is rarely used or
     is hard to process.  Operators <bcp14>SHOULD</bcp14> ensure that
     their monitoring and logging applications properly capture
     DNS messages over TCP.  Otherwise, attacks, exfiltration
     attempts, and normal traffic may go undetected.</t>
      <t indent="0" pn="section-6-2">DNS messages over TCP are in no way guaranteed to arrive
     in single segments.  In fact, a clever attacker might attempt
     to hide certain messages by forcing them over very small TCP
     segments.  Applications that capture network packets (e.g.,
     with libpcap <xref target="libpcap" format="default" sectionFormat="of" derivedContent="libpcap"/>) <bcp14>SHOULD</bcp14> implement and perform full
     TCP stream reassembly and analyze the reassembled stream instead of the individual packets.
     Otherwise, they are vulnerable to network evasion attacks <xref target="phrack" format="default" sectionFormat="of" derivedContent="phrack"/>.
     
     Furthermore, such applications need to protect
     themselves from resource exhaustion attacks by limiting the amount
     of memory allocated to tracking unacknowledged connection state data.
     dnscap <xref target="dnscap" format="default" sectionFormat="of" derivedContent="dnscap"/> is an
     open-source example of a DNS logging program that implements
     TCP stream reassembly.</t>
      <t indent="0" pn="section-6-3">Developers <bcp14>SHOULD</bcp14> also keep in mind connection reuse,
     query pipelining, and out-of-order responses when building and testing
     DNS monitoring applications.</t>
      <t indent="0" pn="section-6-4">As an alternative to packet capture, some DNS server software
     supports dnstap <xref target="dnstap" format="default" sectionFormat="of" derivedContent="dnstap"/> as an integrated monitoring
     protocol intended to facilitate wide-scale DNS monitoring.</t>
    </section>
    <section anchor="IANA" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-7-1">This document has no IANA actions.</t>
    </section>
    <section anchor="Security" numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-8-1">This document, providing operational requirements, is the
     companion to the implementation requirements of DNS over TCP
     provided in <xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/>.  The security considerations
     from <xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/> still apply.</t>
      <t indent="0" pn="section-8-2">Ironically, returning truncated DNS-over-UDP answers in order
     to induce a client query to switch to DNS over TCP has become
     a common response to source-address-spoofed, DNS denial-of-service
     attacks <xref target="RRL" format="default" sectionFormat="of" derivedContent="RRL"/>.  Historically, operators have
     been wary of TCP-based attacks, but in recent years, UDP-based
     flooding attacks have proven to be the most common protocol attack
     on the DNS.  Nevertheless, a high rate of short-lived DNS
     transactions over TCP may pose challenges.  In fact, <xref target="DAI21" format="default" sectionFormat="of" derivedContent="DAI21"/> details a class of IP fragmentation attacks
     on DNS transactions if the IP Identifier field (16 bits in IPv4 and 32 bits in IPv6) can be predicted and a
     system is coerced to fragment rather than retransmit messages.
     While many operators have provided DNS-over-TCP service for many
     years without duress, past experience is no guarantee of future
     success.</t>
      <t indent="0" pn="section-8-3">DNS over TCP is similar to many other Internet TCP services.
     TCP threats and many mitigation strategies have been
     well documented in a series of documents such as <xref target="RFC4953" format="default" sectionFormat="of" derivedContent="RFC4953"/>, <xref target="RFC4987" format="default" sectionFormat="of" derivedContent="RFC4987"/>, <xref target="RFC5927" format="default" sectionFormat="of" derivedContent="RFC5927"/>, and <xref target="RFC5961" format="default" sectionFormat="of" derivedContent="RFC5961"/>.</t>
      <t indent="0" pn="section-8-4">As mentioned in <xref target="logging-monitoring" format="default" sectionFormat="of" derivedContent="Section 6"/>, applications
     that implement TCP stream reassembly need to limit the amount of
     memory allocated to connection tracking.  A failure to do so could
     lead to a total failure of the logging or monitoring application.
     Imposition of resource limits creates a trade-off between allowing
     some stream reassembly to continue and allowing some evasion attacks
     to succeed.</t>
      <t indent="0" pn="section-8-5">This document recommends that DNS servers enable TFO when possible.  <xref target="RFC7413" format="default" sectionFormat="of" derivedContent="RFC7413"/>
     recommends that a pool of servers behind a load balancer with a shared
     server IP address also share the key used to generate Fast Open cookies
     to prevent inordinate fallback to the three-way handshake (3WHS).  This guidance remains
     accurate but comes with a caveat: compromise of one server would reveal
     this group-shared key and allow for attacks involving the other servers
     in the pool by forging invalid Fast Open cookies.</t>
    </section>
    <section anchor="Privacy" numbered="true" toc="include" removeInRFC="false" pn="section-9">
      <name slugifiedName="name-privacy-considerations">Privacy Considerations</name>
      <t indent="0" pn="section-9-1">Since DNS over both UDP and TCP uses the same underlying message
     format, the use of one transport instead of the other does not change
     the privacy characteristics of the message content (i.e., the name
     being queried). A number of protocols have recently been developed to 
     provide DNS privacy, including DNS over TLS <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>,
     DNS over DTLS <xref target="RFC8094" format="default" sectionFormat="of" derivedContent="RFC8094"/>, DNS over HTTPS
     <xref target="RFC8484" format="default" sectionFormat="of" derivedContent="RFC8484"/>, with even more on the way.</t>
      <t indent="0" pn="section-9-2">Because TCP is somewhat more complex than UDP, some
     characteristics of a TCP conversation may enable DNS client fingerprinting and
     tracking that is not possible with UDP.  For example, the choice of
     initial sequence numbers, window size, and options might be able
     to identify a particular TCP implementation or even individual
     hosts behind shared resources such as NATs.</t>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-dnsop-avoid-fragmentation" to="AVOID_FRAGS"/>
    <references pn="section-10">
      <name slugifiedName="name-references">References</name>
      <references pn="section-10.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC1035" target="https://www.rfc-editor.org/info/rfc1035" quoteTitle="true" derivedAnchor="RFC1035">
          <front>
            <title>Domain names - implementation and specification</title>
            <author initials="P.V." surname="Mockapetris" fullname="P.V. Mockapetris">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1987" month="November"/>
            <abstract>
              <t indent="0">This RFC is the revised specification of the protocol and format used in the implementation of the Domain Name System.  It obsoletes RFC-883. This memo documents the details of the domain name client - server communication.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="13"/>
          <seriesInfo name="RFC" value="1035"/>
          <seriesInfo name="DOI" value="10.17487/RFC1035"/>
        </reference>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC2181" target="https://www.rfc-editor.org/info/rfc2181" quoteTitle="true" derivedAnchor="RFC2181">
          <front>
            <title>Clarifications to the DNS Specification</title>
            <author initials="R." surname="Elz" fullname="R. Elz">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Bush" fullname="R. Bush">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="July"/>
            <abstract>
              <t indent="0">This document considers some areas that have been identified as problems with the specification of the Domain Name System, and proposes remedies for the defects identified. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2181"/>
          <seriesInfo name="DOI" value="10.17487/RFC2181"/>
        </reference>
        <reference anchor="RFC6891" target="https://www.rfc-editor.org/info/rfc6891" quoteTitle="true" derivedAnchor="RFC6891">
          <front>
            <title>Extension Mechanisms for DNS (EDNS(0))</title>
            <author initials="J." surname="Damas" fullname="J. Damas">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Graff" fullname="M. Graff">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="April"/>
            <abstract>
              <t indent="0">The Domain Name System's wire protocol includes a number of fixed fields whose range has been or soon will be exhausted and does not allow requestors to advertise their capabilities to responders.  This document describes backward-compatible mechanisms for allowing the protocol to grow.</t>
              <t indent="0">This document updates the Extension Mechanisms for DNS (EDNS(0)) specification (and obsoletes RFC 2671) based on feedback from deployment experience in several implementations.  It also obsoletes RFC 2673 ("Binary Labels in the Domain Name System") and adds considerations on the use of extended labels in the DNS.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="75"/>
          <seriesInfo name="RFC" value="6891"/>
          <seriesInfo name="DOI" value="10.17487/RFC6891"/>
        </reference>
        <reference anchor="RFC7766" target="https://www.rfc-editor.org/info/rfc7766" quoteTitle="true" derivedAnchor="RFC7766">
          <front>
            <title>DNS Transport over TCP - Implementation Requirements</title>
            <author initials="J." surname="Dickinson" fullname="J. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Mankin" fullname="A. Mankin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Wessels" fullname="D. Wessels">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="March"/>
            <abstract>
              <t indent="0">This document specifies the requirement for support of TCP as a transport protocol for DNS implementations and provides guidelines towards DNS-over-TCP performance on par with that of DNS-over-UDP. This document obsoletes RFC 5966 and therefore updates RFC 1035 and RFC 1123.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7766"/>
          <seriesInfo name="DOI" value="10.17487/RFC7766"/>
        </reference>
        <reference anchor="RFC7828" target="https://www.rfc-editor.org/info/rfc7828" quoteTitle="true" derivedAnchor="RFC7828">
          <front>
            <title>The edns-tcp-keepalive EDNS0 Option</title>
            <author initials="P." surname="Wouters" fullname="P. Wouters">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Abley" fullname="J. Abley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="April"/>
            <abstract>
              <t indent="0">DNS messages between clients and servers may be received over either UDP or TCP.  UDP transport involves keeping less state on a busy server, but can cause truncation and retries over TCP.  Additionally, UDP can be exploited for reflection attacks.  Using TCP would reduce retransmits and amplification.  However, clients commonly use TCP only for retries and servers typically use idle timeouts on the order of seconds.</t>
              <t indent="0">This document defines an EDNS0 option ("edns-tcp-keepalive") that allows DNS servers to signal a variable idle timeout.  This signalling encourages the use of long-lived TCP connections by allowing the state associated with TCP transport to be managed effectively with minimal impact on the DNS transaction time.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7828"/>
          <seriesInfo name="DOI" value="10.17487/RFC7828"/>
        </reference>
        <reference anchor="RFC7873" target="https://www.rfc-editor.org/info/rfc7873" quoteTitle="true" derivedAnchor="RFC7873">
          <front>
            <title>Domain Name System (DNS) Cookies</title>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Andrews" fullname="M. Andrews">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="May"/>
            <abstract>
              <t indent="0">DNS Cookies are a lightweight DNS transaction security mechanism that provides limited protection to DNS servers and clients against a variety of increasingly common denial-of-service and amplification/ forgery or cache poisoning attacks by off-path attackers.  DNS Cookies are tolerant of NAT, NAT-PT (Network Address Translation - Protocol Translation), and anycast and can be incrementally deployed. (Since DNS Cookies are only returned to the IP address from which they were originally received, they cannot be used to generally track Internet users.)</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7873"/>
          <seriesInfo name="DOI" value="10.17487/RFC7873"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
      </references>
      <references pn="section-10.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="accept_filter" target="https://www.freebsd.org/cgi/man.cgi?query=accept_filter" quoteTitle="true" derivedAnchor="accept_filter">
          <front>
            <title>FreeBSD accept_filter(9)</title>
            <author>
              <organization showOnFrontPage="true">FreeBSD</organization>
            </author>
            <date month="June" year="2000"/>
          </front>
        </reference>
        <reference anchor="APNIC" target="https://labs.apnic.net/?p=1380" quoteTitle="true" derivedAnchor="APNIC">
          <front>
            <title>DNS XL</title>
            <author fullname="Geoff Huston" initials="G." surname="Huston"/>
            <date year="2020" month="October"/>
          </front>
        </reference>
        <reference anchor="I-D.ietf-dnsop-avoid-fragmentation" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-avoid-fragmentation-06" derivedAnchor="AVOID_FRAGS">
          <front>
            <title>Fragmentation Avoidance in DNS</title>
            <author fullname="Kazunori Fujiwara">
              <organization showOnFrontPage="true">Japan Registry Services Co., Ltd.</organization>
            </author>
            <author fullname="Paul Vixie">
              <organization showOnFrontPage="true">none</organization>
            </author>
            <date month="December" day="23" year="2021"/>
            <abstract>
              <t indent="0">   EDNS0 enables a DNS server to send large responses using UDP and is
   widely deployed.  Path MTU discovery remains widely undeployed due to
   security issues, and IP fragmentation has exposed weaknesses in
   application protocols.  Currently, DNS is known to be the largest
   user of IP fragmentation.  It is possible to avoid IP fragmentation
   in DNS by limiting response size where possible, and signaling the
   need to upgrade from UDP to TCP transport where necessary.  This
   document proposes to avoid IP fragmentation in DNS.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-dnsop-avoid-fragmentation-06"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-dnsop-avoid-fragmentation-06.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="BIND" target="https://www.isc.org/bind/" quoteTitle="true" derivedAnchor="BIND">
          <front>
            <title>BIND 9</title>
            <author>
              <organization showOnFrontPage="true">Internet Systems Consortium</organization>
            </author>
            <date/>
          </front>
        </reference>
        <reference anchor="CASTRO2010" quoteTitle="true" target="https://doi.org/10.1007/978-3-642-12365-8_1" derivedAnchor="CASTRO2010">
          <front>
            <title>Understanding and Preparing for DNS Evolution</title>
            <author fullname="Sebastian Castro" initials="S." surname="Castro"/>
            <author fullname="Min Zhang" initials="M." surname="Zhang"/>
            <author fullname="Wolfgang John" initials="W." surname="John"/>
            <author fullname="Duane Wessels" initials="D." surname="Wessels"/>
            <author fullname="Kimberly claffy" initials="K." surname="claffy"/>
            <date month="April" year="2010"/>
          </front>
          <seriesInfo name="DOI" value="10.1007/978-3-642-12365-8_1"/>
        </reference>
        <reference anchor="CHES94" quoteTitle="true" derivedAnchor="CHES94">
          <front>
            <title>Firewalls and Internet Security: Repelling the Wily Hacker</title>
            <author fullname="William R. Cheswick" initials="W." surname="Cheswick"/>
            <author fullname="Steven M. Bellovin" initials="S." surname="Bellovin"/>
            <date year="1994"/>
          </front>
          <refcontent>First Edition</refcontent>
        </reference>
        <reference anchor="CLOUDFLARE" target="https://blog.cloudflare.com/black-lies/" quoteTitle="true" derivedAnchor="CLOUDFLARE">
          <front>
            <title>Economical With The Truth: Making DNSSEC Answers Cheap</title>
            <author fullname="Dani Grant" initials="D." surname="Grant">
              <organization showOnFrontPage="true">Cloudflare</organization>
            </author>
            <date year="2016" month="June"/>
          </front>
        </reference>
        <reference anchor="DAI21" quoteTitle="true" target="https://doi.org/10.1145/3472305.3472884" derivedAnchor="DAI21">
          <front>
            <title>DNS-over-TCP Considered Vulnerable</title>
            <author fullname="Tianxiang Dai" initials="T." surname="Dai"/>
            <author fullname="Haya Shulman" initials="H." surname="Shulman"/>
            <author fullname="Michael Waidner" initials="M." surname="Waidner"/>
            <date year="2021" month="July"/>
          </front>
          <seriesInfo name="DOI" value="10.1145/3472305.3472884"/>
        </reference>
        <reference anchor="DESIGNTEAM" target="https://www.iana.org/reports/2016/root-ksk-rollover-design-20160307.pdf" quoteTitle="true" derivedAnchor="DESIGNTEAM">
          <front>
            <title>Root Zone KSK Rollover Plan</title>
            <author>
              <organization showOnFrontPage="true">ICANN</organization>
            </author>
            <date year="2016" month="March"/>
          </front>
        </reference>
        <reference anchor="DJBDNS" target="https://cr.yp.to/djbdns/tcp.html#why" quoteTitle="true" derivedAnchor="DJBDNS">
          <front>
            <title>When are TCP queries sent?</title>
            <author surname="Bernstein" initials="D.">
            </author>
            <date month="November" year="2002"/>
          </front>
        </reference>
        <reference anchor="dnscap" target="https://www.dns-oarc.net/tools/dnscap" quoteTitle="true" derivedAnchor="dnscap">
          <front>
            <title>DNSCAP</title>
            <author>
              <organization showOnFrontPage="true">DNS-OARC</organization>
            </author>
            <date year="2014" month="February"/>
          </front>
        </reference>
        <reference anchor="dnstap" target="https://dnstap.info" quoteTitle="true" derivedAnchor="dnstap">
          <front>
            <title>dnstap</title>
            <author/>
            <date/>
          </front>
        </reference>
        <reference anchor="ECDSA" target="https://dl.acm.org/doi/10.1145/2831347.2831350" quoteTitle="true" derivedAnchor="ECDSA">
          <front>
            <title>Making the Case for Elliptic Curves in DNSSEC</title>
            <author fullname="Roland van Rijswijk-Deij" initials="R." surname="van Rijswijk-Deij"/>
            <author fullname="Anna Sperotto" initials="A." surname="Sperotto"/>
            <author fullname="Aiko Pras" initials="A." surname="Pras"/>
            <date year="2015" month="October"/>
          </front>
          <seriesInfo name="DOI" value="10.1145/2831347.2831350"/>
        </reference>
        <reference anchor="FLAGDAY2020" target="https://dnsflagday.net/2020/" quoteTitle="true" derivedAnchor="FLAGDAY2020">
          <front>
            <title>DNS Flag Day 2020</title>
            <author>
              <organization showOnFrontPage="true">DNS Software and Service Providers</organization>
            </author>
            <date month="October" year="2020"/>
          </front>
        </reference>
        <reference anchor="FRAG_POISON" target="https://arxiv.org/pdf/1205.4011.pdf" quoteTitle="true" derivedAnchor="FRAG_POISON">
          <front>
            <title>Fragmentation Considered Poisonous</title>
            <author fullname="Amir Herzberg" initials="A." surname="Herzberg"/>
            <author fullname="Haya Shulman" initials="H." surname="Shulman"/>
            <date year="2012" month="May"/>
          </front>
        </reference>
        <reference anchor="HUSTON" target="https://blog.apnic.net/2017/08/22/dealing-ipv6-fragmentation-dns/" quoteTitle="true" derivedAnchor="HUSTON">
          <front>
            <title>Dealing with IPv6 fragmentation in the DNS</title>
            <author fullname="Geoff Huston" initials="G." surname="Huston"/>
            <date year="2017" month="August"/>
          </front>
        </reference>
        <reference anchor="KSK_ROLLOVER_ARCHIVES" target="https://mm.icann.org/pipermail/ksk-rollover/2019-January/date.html" quoteTitle="true" derivedAnchor="KSK_ROLLOVER_ARCHIVES">
          <front>
            <title>KSK Rollover List Archives</title>
            <author>
              <organization showOnFrontPage="true">ICANN</organization>
            </author>
            <date year="2019" month="January"/>
          </front>
        </reference>
        <reference anchor="LEWIS" target="https://ripe74.ripe.net/presentations/25-RIPE74-lewis-submission.pdf" quoteTitle="true" derivedAnchor="LEWIS">
          <front>
            <title>2017 DNSSEC KSK Rollover</title>
            <author fullname="Edward Lewis" initials="E." surname="Lewis"/>
            <date year="2017" month="May"/>
          </front>
          <refcontent>RIPE 74</refcontent>
        </reference>
        <reference anchor="libpcap" target="https://www.tcpdump.org" quoteTitle="true" derivedAnchor="libpcap">
          <front>
            <title>Tcpdump and Libpcap</title>
            <author>
              <organization showOnFrontPage="true">The Tcpdump Group</organization>
            </author>
          </front>
        </reference>
        <reference anchor="NETALYZR" quoteTitle="true" target="https://doi.org/10.1145/1879141.1879173" derivedAnchor="NETALYZR">
          <front>
            <title>Netalyzr: Illuminating The Edge Network</title>
            <author fullname="Christian Kreibich" initials="C." surname="Kreibich"/>
            <author fullname="Nicholas Weaver" initials="N." surname="Weaver"/>
            <author fullname="Boris Nechaev" initials="B." surname="Nechaev"/>
            <author fullname="Vern Paxson" initials="V." surname="Paxson"/>
            <date year="2010" month="November"/>
          </front>
          <seriesInfo name="DOI" value="10.1145/1879141.1879173"/>
        </reference>
        <reference anchor="phrack" target="http://phrack.org/issues/54/10.html" quoteTitle="true" derivedAnchor="phrack">
          <front>
            <title>Defeating Sniffers and Intrusion Detection Systems</title>
            <author fullname="horizon"/>
            <date year="1998" month="December"/>
          </front>
          <refcontent>Phrack Magazine</refcontent>
        </reference>
        <reference anchor="RFC0768" target="https://www.rfc-editor.org/info/rfc768" quoteTitle="true" derivedAnchor="RFC0768">
          <front>
            <title>User Datagram Protocol</title>
            <author initials="J." surname="Postel" fullname="J. Postel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1980" month="August"/>
          </front>
          <seriesInfo name="STD" value="6"/>
          <seriesInfo name="RFC" value="768"/>
          <seriesInfo name="DOI" value="10.17487/RFC0768"/>
        </reference>
        <reference anchor="RFC0793" target="https://www.rfc-editor.org/info/rfc793" quoteTitle="true" derivedAnchor="RFC0793">
          <front>
            <title>Transmission Control Protocol</title>
            <author initials="J." surname="Postel" fullname="J. Postel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1981" month="September"/>
          </front>
          <seriesInfo name="STD" value="7"/>
          <seriesInfo name="RFC" value="793"/>
          <seriesInfo name="DOI" value="10.17487/RFC0793"/>
        </reference>
        <reference anchor="RFC0883" target="https://www.rfc-editor.org/info/rfc883" quoteTitle="true" derivedAnchor="RFC0883">
          <front>
            <title>Domain names: Implementation specification</title>
            <author initials="P.V." surname="Mockapetris" fullname="P.V. Mockapetris">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1983" month="November"/>
            <abstract>
              <t indent="0">This RFC discusses the implementation of domain name servers and    resolvers, specifies the format of transactions, and discusses the    use of domain names in the context of existing mail systems and other    network software.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="883"/>
          <seriesInfo name="DOI" value="10.17487/RFC0883"/>
        </reference>
        <reference anchor="RFC1034" target="https://www.rfc-editor.org/info/rfc1034" quoteTitle="true" derivedAnchor="RFC1034">
          <front>
            <title>Domain names - concepts and facilities</title>
            <author initials="P.V." surname="Mockapetris" fullname="P.V. Mockapetris">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1987" month="November"/>
            <abstract>
              <t indent="0">This RFC is the revised basic definition of The Domain Name System.  It obsoletes RFC-882.  This memo describes the domain style names and their used for host address look up and electronic mail forwarding.  It discusses the clients and servers in the domain name system and the protocol used between them.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="13"/>
          <seriesInfo name="RFC" value="1034"/>
          <seriesInfo name="DOI" value="10.17487/RFC1034"/>
        </reference>
        <reference anchor="RFC1123" target="https://www.rfc-editor.org/info/rfc1123" quoteTitle="true" derivedAnchor="RFC1123">
          <front>
            <title>Requirements for Internet Hosts - Application and Support</title>
            <author initials="R." surname="Braden" fullname="R. Braden" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1989" month="October"/>
            <abstract>
              <t indent="0">This RFC is an official specification for the Internet community.  It incorporates by reference, amends, corrects, and supplements the primary protocol standards documents relating to hosts.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="3"/>
          <seriesInfo name="RFC" value="1123"/>
          <seriesInfo name="DOI" value="10.17487/RFC1123"/>
        </reference>
        <reference anchor="RFC1536" target="https://www.rfc-editor.org/info/rfc1536" quoteTitle="true" derivedAnchor="RFC1536">
          <front>
            <title>Common DNS Implementation Errors and Suggested Fixes</title>
            <author initials="A." surname="Kumar" fullname="A. Kumar">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Postel" fullname="J. Postel">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Neuman" fullname="C. Neuman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Danzig" fullname="P. Danzig">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Miller" fullname="S. Miller">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1993" month="October"/>
            <abstract>
              <t indent="0">This memo describes common errors seen in DNS implementations and suggests some fixes.  This memo provides information for the Internet community.  It does not specify an Internet standard.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="1536"/>
          <seriesInfo name="DOI" value="10.17487/RFC1536"/>
        </reference>
        <reference anchor="RFC1995" target="https://www.rfc-editor.org/info/rfc1995" quoteTitle="true" derivedAnchor="RFC1995">
          <front>
            <title>Incremental Zone Transfer in DNS</title>
            <author initials="M." surname="Ohta" fullname="M. Ohta">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1996" month="August"/>
            <abstract>
              <t indent="0">This document proposes extensions to the DNS protocols to provide an incremental zone transfer (IXFR) mechanism.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="1995"/>
          <seriesInfo name="DOI" value="10.17487/RFC1995"/>
        </reference>
        <reference anchor="RFC1996" target="https://www.rfc-editor.org/info/rfc1996" quoteTitle="true" derivedAnchor="RFC1996">
          <front>
            <title>A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)</title>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1996" month="August"/>
            <abstract>
              <t indent="0">This memo describes the NOTIFY opcode for DNS, by which a master server advises a set of slave servers that the master's data has been changed and that a query should be initiated to discover the new data. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="1996"/>
          <seriesInfo name="DOI" value="10.17487/RFC1996"/>
        </reference>
        <reference anchor="RFC2136" target="https://www.rfc-editor.org/info/rfc2136" quoteTitle="true" derivedAnchor="RFC2136">
          <front>
            <title>Dynamic Updates in the Domain Name System (DNS UPDATE)</title>
            <author initials="P." surname="Vixie" fullname="P. Vixie" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Thomson" fullname="S. Thomson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Rekhter" fullname="Y. Rekhter">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Bound" fullname="J. Bound">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="April"/>
            <abstract>
              <t indent="0">Using this specification of the UPDATE opcode, it is possible to add or delete RRs or RRsets from a specified zone.  Prerequisites are specified separately from update operations, and can specify a dependency upon either the previous existence or nonexistence of an RRset, or the existence of a single RR.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2136"/>
          <seriesInfo name="DOI" value="10.17487/RFC2136"/>
        </reference>
        <reference anchor="RFC2541" target="https://www.rfc-editor.org/info/rfc2541" quoteTitle="true" derivedAnchor="RFC2541">
          <front>
            <title>DNS Security Operational Considerations</title>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1999" month="March"/>
            <abstract>
              <t indent="0">This document discusses these operational aspects for keys and signatures used in connection with the KEY and SIG DNS resource records. This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2541"/>
          <seriesInfo name="DOI" value="10.17487/RFC2541"/>
        </reference>
        <reference anchor="RFC2671" target="https://www.rfc-editor.org/info/rfc2671" quoteTitle="true" derivedAnchor="RFC2671">
          <front>
            <title>Extension Mechanisms for DNS (EDNS0)</title>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1999" month="August"/>
            <abstract>
              <t indent="0">The Domain Name System's wire protocol includes a number of fixed fields whose range has been or soon will be exhausted and does not allow clients to advertise their capabilities to servers.  This document describes backward compatible mechanisms for allowing the protocol to grow.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2671"/>
          <seriesInfo name="DOI" value="10.17487/RFC2671"/>
        </reference>
        <reference anchor="RFC2694" target="https://www.rfc-editor.org/info/rfc2694" quoteTitle="true" derivedAnchor="RFC2694">
          <front>
            <title>DNS extensions to Network Address Translators (DNS_ALG)</title>
            <author initials="P." surname="Srisuresh" fullname="P. Srisuresh">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Tsirtsis" fullname="G. Tsirtsis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Akkiraju" fullname="P. Akkiraju">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Heffernan" fullname="A. Heffernan">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1999" month="September"/>
            <abstract>
              <t indent="0">This document identifies the need for DNS extensions to NATs and outlines how a DNS Application Level Gateway (DNS_ALG) can meet the need.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2694"/>
          <seriesInfo name="DOI" value="10.17487/RFC2694"/>
        </reference>
        <reference anchor="RFC3022" target="https://www.rfc-editor.org/info/rfc3022" quoteTitle="true" derivedAnchor="RFC3022">
          <front>
            <title>Traditional IP Network Address Translator (Traditional NAT)</title>
            <author initials="P." surname="Srisuresh" fullname="P. Srisuresh">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Egevang" fullname="K. Egevang">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2001" month="January"/>
            <abstract>
              <t indent="0">The NAT operation described in this document extends address translation introduced in RFC 1631 and includes a new type of network address and TCP/UDP port translation.  In addition, this document corrects the Checksum adjustment algorithm published in RFC 1631 and attempts to discuss NAT operation and limitations in detail.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3022"/>
          <seriesInfo name="DOI" value="10.17487/RFC3022"/>
        </reference>
        <reference anchor="RFC3225" target="https://www.rfc-editor.org/info/rfc3225" quoteTitle="true" derivedAnchor="RFC3225">
          <front>
            <title>Indicating Resolver Support of DNSSEC</title>
            <author initials="D." surname="Conrad" fullname="D. Conrad">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2001" month="December"/>
            <abstract>
              <t indent="0">In order to deploy DNSSEC (Domain Name System Security Extensions) operationally, DNSSEC aware servers should only perform automatic inclusion of DNSSEC RRs when there is an explicit indication that the resolver can understand those RRs.  This document proposes the use of a bit in the EDNS0 header to provide that explicit indication and describes the necessary protocol changes to implement that notification. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3225"/>
          <seriesInfo name="DOI" value="10.17487/RFC3225"/>
        </reference>
        <reference anchor="RFC3226" target="https://www.rfc-editor.org/info/rfc3226" quoteTitle="true" derivedAnchor="RFC3226">
          <front>
            <title>DNSSEC and IPv6 A6 aware server/resolver message size requirements</title>
            <author initials="O." surname="Gudmundsson" fullname="O. Gudmundsson">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2001" month="December"/>
            <abstract>
              <t indent="0">This document mandates support for EDNS0 (Extension Mechanisms for DNS) in DNS entities claiming to support either DNS Security Extensions or A6 records.  This requirement is necessary because these new features increase the size of DNS messages.  If EDNS0 is not supported fall back to TCP will happen, having a detrimental impact on query latency and DNS server load.  This document updates RFC 2535 and RFC 2874, by adding new requirements.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3226"/>
          <seriesInfo name="DOI" value="10.17487/RFC3226"/>
        </reference>
        <reference anchor="RFC4472" target="https://www.rfc-editor.org/info/rfc4472" quoteTitle="true" derivedAnchor="RFC4472">
          <front>
            <title>Operational Considerations and Issues with IPv6 DNS</title>
            <author initials="A." surname="Durand" fullname="A. Durand">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Ihren" fullname="J. Ihren">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Savola" fullname="P. Savola">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="April"/>
            <abstract>
              <t indent="0">This memo presents operational considerations and issues with IPv6 Domain Name System (DNS), including a summary of special IPv6 addresses, documentation of known DNS implementation misbehavior, recommendations and considerations on how to perform DNS naming for service provisioning and for DNS resolver IPv6 support, considerations for DNS updates for both the forward and reverse trees, and miscellaneous issues.  This memo is aimed to include a summary of information about IPv6 DNS considerations for those who have experience with IPv4 DNS.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4472"/>
          <seriesInfo name="DOI" value="10.17487/RFC4472"/>
        </reference>
        <reference anchor="RFC4953" target="https://www.rfc-editor.org/info/rfc4953" quoteTitle="true" derivedAnchor="RFC4953">
          <front>
            <title>Defending TCP Against Spoofing Attacks</title>
            <author initials="J." surname="Touch" fullname="J. Touch">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="July"/>
            <abstract>
              <t indent="0">Recent analysis of potential attacks on core Internet infrastructure indicates an increased vulnerability of TCP connections to spurious resets (RSTs), sent with forged IP source addresses (spoofing).  TCP has always been susceptible to such RST spoofing attacks, which were indirectly protected by checking that the RST sequence number was inside the current receive window, as well as via the obfuscation of TCP endpoint and port numbers.  For pairs of well-known endpoints often over predictable port pairs, such as BGP or between web servers and well-known large-scale caches, increases in the path bandwidth-delay product of a connection have sufficiently increased the receive window space that off-path third parties can brute-force generate a viable RST sequence number.  The susceptibility to attack increases with the square of the bandwidth, and thus presents a significant vulnerability for recent high-speed networks.  This document addresses this vulnerability, discussing proposed solutions at the transport level and their inherent challenges, as well as existing network level solutions and the feasibility of their deployment.  This document focuses on vulnerabilities due to spoofed TCP segments, and includes a discussion of related ICMP spoofing attacks on TCP connections.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4953"/>
          <seriesInfo name="DOI" value="10.17487/RFC4953"/>
        </reference>
        <reference anchor="RFC4987" target="https://www.rfc-editor.org/info/rfc4987" quoteTitle="true" derivedAnchor="RFC4987">
          <front>
            <title>TCP SYN Flooding Attacks and Common Mitigations</title>
            <author initials="W." surname="Eddy" fullname="W. Eddy">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="August"/>
            <abstract>
              <t indent="0">This document describes TCP SYN flooding attacks, which have been well-known to the community for several years.  Various countermeasures against these attacks, and the trade-offs of each, are described.  This document archives explanations of the attack and common defense techniques for the benefit of TCP implementers and administrators of TCP servers or networks, but does not make any standards-level recommendations.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4987"/>
          <seriesInfo name="DOI" value="10.17487/RFC4987"/>
        </reference>
        <reference anchor="RFC5358" target="https://www.rfc-editor.org/info/rfc5358" quoteTitle="true" derivedAnchor="RFC5358">
          <front>
            <title>Preventing Use of Recursive Nameservers in Reflector Attacks</title>
            <author initials="J." surname="Damas" fullname="J. Damas">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Neves" fullname="F. Neves">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="October"/>
            <abstract>
              <t indent="0">This document describes ways to prevent the use of default configured recursive nameservers as reflectors in Denial of Service (DoS) attacks.  It provides recommended configuration as measures to mitigate the attack.  This document specifies an Internet Best Current  Practices for the Internet Community, and requests discussion and  suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="140"/>
          <seriesInfo name="RFC" value="5358"/>
          <seriesInfo name="DOI" value="10.17487/RFC5358"/>
        </reference>
        <reference anchor="RFC5452" target="https://www.rfc-editor.org/info/rfc5452" quoteTitle="true" derivedAnchor="RFC5452">
          <front>
            <title>Measures for Making DNS More Resilient against Forged Answers</title>
            <author initials="A." surname="Hubert" fullname="A. Hubert">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="van Mook" fullname="R. van Mook">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="January"/>
            <abstract>
              <t indent="0">The current Internet climate poses serious threats to the Domain Name System.  In the interim period before the DNS protocol can be secured more fully, measures can already be taken to harden the DNS to make 'spoofing' a recursing nameserver many orders of magnitude harder.</t>
              <t indent="0">Even a cryptographically secured DNS benefits from having the ability to discard bogus responses quickly, as this potentially saves large amounts of computation.</t>
              <t indent="0">By describing certain behavior that has previously not been standardized, this document sets out how to make the DNS more resilient against accepting incorrect responses.  This document updates RFC 2181.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5452"/>
          <seriesInfo name="DOI" value="10.17487/RFC5452"/>
        </reference>
        <reference anchor="RFC5507" target="https://www.rfc-editor.org/info/rfc5507" quoteTitle="true" derivedAnchor="RFC5507">
          <front>
            <title>Design Choices When Expanding the DNS</title>
            <author>
              <organization showOnFrontPage="true">IAB</organization>
            </author>
            <author initials="P." surname="Faltstrom" fullname="P. Faltstrom" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Austein" fullname="R. Austein" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Koch" fullname="P. Koch" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="April"/>
            <abstract>
              <t indent="0">This note discusses how to extend the DNS with new data for a new application.  DNS extension discussions too often focus on reuse of the TXT Resource Record Type.  This document lists different mechanisms to extend the DNS, and concludes that the use of a new DNS Resource Record Type is the best solution.  This memo provides information  for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5507"/>
          <seriesInfo name="DOI" value="10.17487/RFC5507"/>
        </reference>
        <reference anchor="RFC5625" target="https://www.rfc-editor.org/info/rfc5625" quoteTitle="true" derivedAnchor="RFC5625">
          <front>
            <title>DNS Proxy Implementation Guidelines</title>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="August"/>
            <abstract>
              <t indent="0">This document provides guidelines for the implementation of DNS proxies, as found in broadband gateways and other similar network devices.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="152"/>
          <seriesInfo name="RFC" value="5625"/>
          <seriesInfo name="DOI" value="10.17487/RFC5625"/>
        </reference>
        <reference anchor="RFC5927" target="https://www.rfc-editor.org/info/rfc5927" quoteTitle="true" derivedAnchor="RFC5927">
          <front>
            <title>ICMP Attacks against TCP</title>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="July"/>
            <abstract>
              <t indent="0">This document discusses the use of the Internet Control Message Protocol (ICMP) to perform a variety of attacks against the Transmission Control Protocol (TCP).  Additionally, this document describes a number of widely implemented modifications to TCP's handling of ICMP error messages that help to mitigate these issues.  This document is not an Internet Standards Track specification; it is published for informational purposes.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5927"/>
          <seriesInfo name="DOI" value="10.17487/RFC5927"/>
        </reference>
        <reference anchor="RFC5936" target="https://www.rfc-editor.org/info/rfc5936" quoteTitle="true" derivedAnchor="RFC5936">
          <front>
            <title>DNS Zone Transfer Protocol (AXFR)</title>
            <author initials="E." surname="Lewis" fullname="E. Lewis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Hoenes" fullname="A. Hoenes" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="June"/>
            <abstract>
              <t indent="0">The standard means within the Domain Name System protocol for maintaining coherence among a zone's authoritative name servers consists of three mechanisms.  Authoritative Transfer (AXFR) is one of the mechanisms and is defined in RFC 1034 and RFC 1035.</t>
              <t indent="0">The definition of AXFR has proven insufficient in detail, thereby forcing implementations intended to be compliant to make assumptions, impeding interoperability.  Yet today we have a satisfactory set of implementations that do interoperate.  This document is a new definition of AXFR -- new in the sense that it records an accurate definition of an interoperable AXFR mechanism.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5936"/>
          <seriesInfo name="DOI" value="10.17487/RFC5936"/>
        </reference>
        <reference anchor="RFC5961" target="https://www.rfc-editor.org/info/rfc5961" quoteTitle="true" derivedAnchor="RFC5961">
          <front>
            <title>Improving TCP's Robustness to Blind In-Window Attacks</title>
            <author initials="A." surname="Ramaiah" fullname="A. Ramaiah">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Stewart" fullname="R. Stewart">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Dalal" fullname="M. Dalal">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="August"/>
            <abstract>
              <t indent="0">TCP has historically been considered to be protected against spoofed off-path packet injection attacks by relying on the fact that it is difficult to guess the 4-tuple (the source and destination IP addresses and the source and destination ports) in combination with the 32-bit sequence number(s).  A combination of increasing window sizes and applications using longer-term connections (e.g., H-323 or Border Gateway Protocol (BGP) [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5961"/>
          <seriesInfo name="DOI" value="10.17487/RFC5961"/>
        </reference>
        <reference anchor="RFC5966" target="https://www.rfc-editor.org/info/rfc5966" quoteTitle="true" derivedAnchor="RFC5966">
          <front>
            <title>DNS Transport over TCP - Implementation Requirements</title>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="August"/>
            <abstract>
              <t indent="0">This document updates the requirements for the support of TCP as a transport protocol for DNS implementations.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5966"/>
          <seriesInfo name="DOI" value="10.17487/RFC5966"/>
        </reference>
        <reference anchor="RFC6298" target="https://www.rfc-editor.org/info/rfc6298" quoteTitle="true" derivedAnchor="RFC6298">
          <front>
            <title>Computing TCP's Retransmission Timer</title>
            <author initials="V." surname="Paxson" fullname="V. Paxson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Allman" fullname="M. Allman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Chu" fullname="J. Chu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Sargent" fullname="M. Sargent">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="June"/>
            <abstract>
              <t indent="0">This document defines the standard algorithm that Transmission Control Protocol (TCP) senders are required to use to compute and manage their retransmission timer.  It expands on the discussion in Section 4.2.3.1 of RFC 1122 and upgrades the requirement of supporting the algorithm from a SHOULD to a MUST.  This document obsoletes RFC 2988.   [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6298"/>
          <seriesInfo name="DOI" value="10.17487/RFC6298"/>
        </reference>
        <reference anchor="RFC6762" target="https://www.rfc-editor.org/info/rfc6762" quoteTitle="true" derivedAnchor="RFC6762">
          <front>
            <title>Multicast DNS</title>
            <author initials="S." surname="Cheshire" fullname="S. Cheshire">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Krochmal" fullname="M. Krochmal">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="February"/>
            <abstract>
              <t indent="0">As networked devices become smaller, more portable, and more ubiquitous, the ability to operate with less configured infrastructure is increasingly important.  In particular, the ability to look up DNS resource record data types (including, but not limited to, host names) in the absence of a conventional managed DNS server is useful.</t>
              <t indent="0">Multicast DNS (mDNS) provides the ability to perform DNS-like operations on the local link in the absence of any conventional Unicast DNS server.  In addition, Multicast DNS designates a portion of the DNS namespace to be free for local use, without the need to pay any annual fee, and without the need to set up delegations or otherwise configure a conventional DNS server to answer for those names.</t>
              <t indent="0">The primary benefits of Multicast DNS names are that (i) they require little or no administration or configuration to set them up, (ii) they work when no infrastructure is present, and (iii) they work during infrastructure failures.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6762"/>
          <seriesInfo name="DOI" value="10.17487/RFC6762"/>
        </reference>
        <reference anchor="RFC6781" target="https://www.rfc-editor.org/info/rfc6781" quoteTitle="true" derivedAnchor="RFC6781">
          <front>
            <title>DNSSEC Operational Practices, Version 2</title>
            <author initials="O." surname="Kolkman" fullname="O. Kolkman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Mekking" fullname="W. Mekking">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Gieben" fullname="R. Gieben">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="December"/>
            <abstract>
              <t indent="0">This document describes a set of practices for operating the DNS with security extensions (DNSSEC).  The target audience is zone administrators deploying DNSSEC.</t>
              <t indent="0">The document discusses operational aspects of using keys and signatures in the DNS.  It discusses issues of key generation, key storage, signature generation, key rollover, and related policies.</t>
              <t indent="0">This document obsoletes RFC 4641, as it covers more operational ground and gives more up-to-date requirements with respect to key sizes and the DNSSEC operations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6781"/>
          <seriesInfo name="DOI" value="10.17487/RFC6781"/>
        </reference>
        <reference anchor="RFC6950" target="https://www.rfc-editor.org/info/rfc6950" quoteTitle="true" derivedAnchor="RFC6950">
          <front>
            <title>Architectural Considerations on Application Features in the DNS</title>
            <author initials="J." surname="Peterson" fullname="J. Peterson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Kolkman" fullname="O. Kolkman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Tschofenig" fullname="H. Tschofenig">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Aboba" fullname="B. Aboba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="October"/>
            <abstract>
              <t indent="0">A number of Internet applications rely on the Domain Name System (DNS) to support their operations.  Many applications use the DNS to locate services for a domain; some, for example, transform identifiers other than domain names into formats that the DNS can process, and then fetch application data or service location data from the DNS. Proposals incorporating sophisticated application behavior using DNS as a substrate have raised questions about the role of the DNS as an application platform.  This document explores the architectural consequences of using the DNS to implement certain application features, and it provides guidance to future application designers as to the limitations of the DNS as a substrate and the situations in which alternative designs should be considered.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6950"/>
          <seriesInfo name="DOI" value="10.17487/RFC6950"/>
        </reference>
        <reference anchor="RFC7413" target="https://www.rfc-editor.org/info/rfc7413" quoteTitle="true" derivedAnchor="RFC7413">
          <front>
            <title>TCP Fast Open</title>
            <author initials="Y." surname="Cheng" fullname="Y. Cheng">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Chu" fullname="J. Chu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Radhakrishnan" fullname="S. Radhakrishnan">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Jain" fullname="A. Jain">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="December"/>
            <abstract>
              <t indent="0">This document describes an experimental TCP mechanism called TCP Fast Open (TFO).  TFO allows data to be carried in the SYN and SYN-ACK packets and consumed by the receiving end during the initial connection handshake, and saves up to one full round-trip time (RTT) compared to the standard TCP, which requires a three-way handshake (3WHS) to complete before data can be exchanged.  However, TFO deviates from the standard TCP semantics, since the data in the SYN could be replayed to an application in some rare circumstances.  Applications should not use TFO unless they can tolerate this issue, as detailed in the Applicability section.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7413"/>
          <seriesInfo name="DOI" value="10.17487/RFC7413"/>
        </reference>
        <reference anchor="RFC7477" target="https://www.rfc-editor.org/info/rfc7477" quoteTitle="true" derivedAnchor="RFC7477">
          <front>
            <title>Child-to-Parent Synchronization in DNS</title>
            <author initials="W." surname="Hardaker" fullname="W. Hardaker">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="March"/>
            <abstract>
              <t indent="0">This document specifies how a child zone in the DNS can publish a record to indicate to a parental agent that the parental agent may copy and process certain records from the child zone.  The existence of the record and any change in its value can be monitored by a parental agent and acted on depending on local policy.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7477"/>
          <seriesInfo name="DOI" value="10.17487/RFC7477"/>
        </reference>
        <reference anchor="RFC7534" target="https://www.rfc-editor.org/info/rfc7534" quoteTitle="true" derivedAnchor="RFC7534">
          <front>
            <title>AS112 Nameserver Operations</title>
            <author initials="J." surname="Abley" fullname="J. Abley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Sotomayor" fullname="W. Sotomayor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="May"/>
            <abstract>
              <t indent="0">Many sites connected to the Internet make use of IPv4 addresses that are not globally unique.  Examples are the addresses designated in RFC 1918 for private use within individual sites.</t>
              <t indent="0">Devices in such environments may occasionally originate Domain Name System (DNS) queries (so-called "reverse lookups") corresponding to those private-use addresses.  Since the addresses concerned have only local significance, it is good practice for site administrators to ensure that such queries are answered locally.  However, it is not uncommon for such queries to follow the normal delegation path in the public DNS instead of being answered within the site.</t>
              <t indent="0">It is not possible for public DNS servers to give useful answers to such queries.  In addition, due to the wide deployment of private-use addresses and the continuing growth of the Internet, the volume of such queries is large and growing.  The AS112 project aims to provide a distributed sink for such queries in order to reduce the load on the corresponding authoritative servers.  The AS112 project is named after the Autonomous System Number (ASN) that was assigned to it.</t>
              <t indent="0">This document describes the steps required to install a new AS112 node and offers advice relating to such a node's operation.</t>
              <t indent="0">This document obsoletes RFC 6304.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7534"/>
          <seriesInfo name="DOI" value="10.17487/RFC7534"/>
        </reference>
        <reference anchor="RFC7720" target="https://www.rfc-editor.org/info/rfc7720" quoteTitle="true" derivedAnchor="RFC7720">
          <front>
            <title>DNS Root Name Service Protocol and Deployment Requirements</title>
            <author initials="M." surname="Blanchet" fullname="M. Blanchet">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L-J." surname="Liman" fullname="L-J. Liman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="December"/>
            <abstract>
              <t indent="0">The DNS root name service is a critical part of the Internet architecture.  The protocol and deployment requirements for the DNS root name service are defined in this document.  Operational requirements are out of scope.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="40"/>
          <seriesInfo name="RFC" value="7720"/>
          <seriesInfo name="DOI" value="10.17487/RFC7720"/>
        </reference>
        <reference anchor="RFC7858" target="https://www.rfc-editor.org/info/rfc7858" quoteTitle="true" derivedAnchor="RFC7858">
          <front>
            <title>Specification for DNS over Transport Layer Security (TLS)</title>
            <author initials="Z." surname="Hu" fullname="Z. Hu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Zhu" fullname="L. Zhu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Heidemann" fullname="J. Heidemann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Mankin" fullname="A. Mankin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Wessels" fullname="D. Wessels">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="May"/>
            <abstract>
              <t indent="0">This document describes the use of Transport Layer Security (TLS) to provide privacy for DNS.  Encryption provided by TLS eliminates opportunities for eavesdropping and on-path tampering with DNS queries in the network, such as discussed in RFC 7626.  In addition, this document specifies two usage profiles for DNS over TLS and provides advice on performance considerations to minimize overhead from using TCP and TLS with DNS.</t>
              <t indent="0">This document focuses on securing stub-to-recursive traffic, as per the charter of the DPRIVE Working Group.  It does not prevent future applications of the protocol to recursive-to-authoritative traffic.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7858"/>
          <seriesInfo name="DOI" value="10.17487/RFC7858"/>
        </reference>
        <reference anchor="RFC7901" target="https://www.rfc-editor.org/info/rfc7901" quoteTitle="true" derivedAnchor="RFC7901">
          <front>
            <title>CHAIN Query Requests in DNS</title>
            <author initials="P." surname="Wouters" fullname="P. Wouters">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="June"/>
            <abstract>
              <t indent="0">This document defines an EDNS0 extension that can be used by a security-aware validating resolver configured to use a forwarding resolver to send a single query, requesting a complete validation path along with the regular query answer.  The reduction in queries potentially lowers the latency and reduces the need to send multiple queries at once.  This extension mandates the use of source-IP- verified transport such as TCP or UDP with EDNS-COOKIE, so it cannot be abused in amplification attacks.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7901"/>
          <seriesInfo name="DOI" value="10.17487/RFC7901"/>
        </reference>
        <reference anchor="RFC7918" target="https://www.rfc-editor.org/info/rfc7918" quoteTitle="true" derivedAnchor="RFC7918">
          <front>
            <title>Transport Layer Security (TLS) False Start</title>
            <author initials="A." surname="Langley" fullname="A. Langley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="N." surname="Modadugu" fullname="N. Modadugu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Moeller" fullname="B. Moeller">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="August"/>
            <abstract>
              <t indent="0">This document specifies an optional behavior of Transport Layer Security (TLS) client implementations, dubbed "False Start".  It affects only protocol timing, not on-the-wire protocol data, and can be implemented unilaterally.  A TLS False Start reduces handshake latency to one round trip.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7918"/>
          <seriesInfo name="DOI" value="10.17487/RFC7918"/>
        </reference>
        <reference anchor="RFC8027" target="https://www.rfc-editor.org/info/rfc8027" quoteTitle="true" derivedAnchor="RFC8027">
          <front>
            <title>DNSSEC Roadblock Avoidance</title>
            <author initials="W." surname="Hardaker" fullname="W. Hardaker">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Gudmundsson" fullname="O. Gudmundsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Krishnaswamy" fullname="S. Krishnaswamy">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="November"/>
            <abstract>
              <t indent="0">This document describes problems that a Validating DNS resolver, stub-resolver, or application might run into within a non-compliant infrastructure.  It outlines potential detection and mitigation techniques.  The scope of the document is to create a shared approach to detect and overcome network issues that a DNSSEC software/system may face.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="207"/>
          <seriesInfo name="RFC" value="8027"/>
          <seriesInfo name="DOI" value="10.17487/RFC8027"/>
        </reference>
        <reference anchor="RFC8094" target="https://www.rfc-editor.org/info/rfc8094" quoteTitle="true" derivedAnchor="RFC8094">
          <front>
            <title>DNS over Datagram Transport Layer Security (DTLS)</title>
            <author initials="T." surname="Reddy" fullname="T. Reddy">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Wing" fullname="D. Wing">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Patil" fullname="P. Patil">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="February"/>
            <abstract>
              <t indent="0">DNS queries and responses are visible to network elements on the path between the DNS client and its server.  These queries and responses can contain privacy-sensitive information, which is valuable to protect.</t>
              <t indent="0">This document proposes the use of Datagram Transport Layer Security (DTLS) for DNS, to protect against passive listeners and certain active attacks.  As latency is critical for DNS, this proposal also discusses mechanisms to reduce DTLS round trips and reduce the DTLS handshake size.  The proposed mechanism runs over port 853.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8094"/>
          <seriesInfo name="DOI" value="10.17487/RFC8094"/>
        </reference>
        <reference anchor="RFC8162" target="https://www.rfc-editor.org/info/rfc8162" quoteTitle="true" derivedAnchor="RFC8162">
          <front>
            <title>Using Secure DNS to Associate Certificates with Domain Names for S/MIME</title>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Schlyter" fullname="J. Schlyter">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">This document describes how to use secure DNS to associate an S/MIME user's certificate with the intended domain name, similar to the way that DNS-Based Authentication of Named Entities (DANE), RFC 6698, does for TLS.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8162"/>
          <seriesInfo name="DOI" value="10.17487/RFC8162"/>
        </reference>
        <reference anchor="RFC8200" target="https://www.rfc-editor.org/info/rfc8200" quoteTitle="true" derivedAnchor="RFC8200">
          <front>
            <title>Internet Protocol, Version 6 (IPv6) Specification</title>
            <author initials="S." surname="Deering" fullname="S. Deering">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Hinden" fullname="R. Hinden">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="July"/>
            <abstract>
              <t indent="0">This document specifies version 6 of the Internet Protocol (IPv6). It obsoletes RFC 2460.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="86"/>
          <seriesInfo name="RFC" value="8200"/>
          <seriesInfo name="DOI" value="10.17487/RFC8200"/>
        </reference>
        <reference anchor="RFC8324" target="https://www.rfc-editor.org/info/rfc8324" quoteTitle="true" derivedAnchor="RFC8324">
          <front>
            <title>DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?</title>
            <author initials="J." surname="Klensin" fullname="J. Klensin">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="February"/>
            <abstract>
              <t indent="0">The basic design of the Domain Name System was completed almost 30 years ago.  The last half of that period has been characterized by significant changes in requirements and expectations, some of which either require changes to how the DNS is used or can be accommodated only poorly or not at all.  This document asks the question of whether it is time to either redesign and replace the DNS to match contemporary requirements and expectations (rather than continuing to try to design and implement incremental patches that are not fully satisfactory) or draw some clear lines about functionality that is not really needed or that should be performed in some other way.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8324"/>
          <seriesInfo name="DOI" value="10.17487/RFC8324"/>
        </reference>
        <reference anchor="RFC8446" target="https://www.rfc-editor.org/info/rfc8446" quoteTitle="true" derivedAnchor="RFC8446">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="August"/>
            <abstract>
              <t indent="0">This document specifies version 1.3 of the Transport Layer Security (TLS) protocol.  TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t>
              <t indent="0">This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961.  This document also specifies new requirements for TLS 1.2 implementations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8446"/>
          <seriesInfo name="DOI" value="10.17487/RFC8446"/>
        </reference>
        <reference anchor="RFC8467" target="https://www.rfc-editor.org/info/rfc8467" quoteTitle="true" derivedAnchor="RFC8467">
          <front>
            <title>Padding Policies for Extension Mechanisms for DNS (EDNS(0))</title>
            <author initials="A." surname="Mayrhofer" fullname="A. Mayrhofer">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="October"/>
            <abstract>
              <t indent="0">RFC 7830 specifies the "Padding" option for Extension Mechanisms for DNS (EDNS(0)) but does not specify the actual padding length for specific applications.  This memo lists the possible options ("padding policies"), discusses the implications of each option, and provides a recommended (experimental) option.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8467"/>
          <seriesInfo name="DOI" value="10.17487/RFC8467"/>
        </reference>
        <reference anchor="RFC8482" target="https://www.rfc-editor.org/info/rfc8482" quoteTitle="true" derivedAnchor="RFC8482">
          <front>
            <title>Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY</title>
            <author initials="J." surname="Abley" fullname="J. Abley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Gudmundsson" fullname="O. Gudmundsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Majkowski" fullname="M. Majkowski">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Hunt" fullname="E. Hunt">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="January"/>
            <abstract>
              <t indent="0">The Domain Name System (DNS) specifies a query type (QTYPE) "ANY". The operator of an authoritative DNS server might choose not to respond to such queries for reasons of local policy, motivated by security, performance, or other reasons.</t>
              <t indent="0">The DNS specification does not include specific guidance for the behavior of DNS servers or clients in this situation.  This document aims to provide such guidance.</t>
              <t indent="0">This document updates RFCs 1034 and 1035.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8482"/>
          <seriesInfo name="DOI" value="10.17487/RFC8482"/>
        </reference>
        <reference anchor="RFC8483" target="https://www.rfc-editor.org/info/rfc8483" quoteTitle="true" derivedAnchor="RFC8483">
          <front>
            <title>Yeti DNS Testbed</title>
            <author initials="L." surname="Song" fullname="L. Song" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Liu" fullname="D. Liu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Kato" fullname="A. Kato">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Kerr" fullname="S. Kerr">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="October"/>
            <abstract>
              <t indent="0">Yeti DNS is an experimental, non-production root server testbed that provides an environment where technical and operational experiments can safely be performed without risk to production root server infrastructure.  This document aims solely to document the technical and operational experience of deploying a system that is similar to but different from the Root Server system (on which the Internet's Domain Name System is designed and built).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8483"/>
          <seriesInfo name="DOI" value="10.17487/RFC8483"/>
        </reference>
        <reference anchor="RFC8484" target="https://www.rfc-editor.org/info/rfc8484" quoteTitle="true" derivedAnchor="RFC8484">
          <front>
            <title>DNS Queries over HTTPS (DoH)</title>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="McManus" fullname="P. McManus">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="October"/>
            <abstract>
              <t indent="0">This document defines a protocol for sending DNS queries and getting DNS responses over HTTPS.  Each DNS query-response pair is mapped into an HTTP exchange.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8484"/>
          <seriesInfo name="DOI" value="10.17487/RFC8484"/>
        </reference>
        <reference anchor="RFC8490" target="https://www.rfc-editor.org/info/rfc8490" quoteTitle="true" derivedAnchor="RFC8490">
          <front>
            <title>DNS Stateful Operations</title>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Cheshire" fullname="S. Cheshire">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Dickinson" fullname="J. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Lemon" fullname="T. Lemon">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Pusateri" fullname="T. Pusateri">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="March"/>
            <abstract>
              <t indent="0">This document defines a new DNS OPCODE for DNS Stateful Operations (DSO).  DSO messages communicate operations within persistent stateful sessions using Type Length Value (TLV) syntax.  Three TLVs are defined that manage session timeouts, termination, and encryption padding, and a framework is defined for extensions to enable new stateful operations.  This document updates RFC 1035 by adding a new DNS header OPCODE that has both different message semantics and a new result code.  This document updates RFC 7766 by redefining a session, providing new guidance on connection reuse, and providing a new mechanism for handling session idle timeouts.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8490"/>
          <seriesInfo name="DOI" value="10.17487/RFC8490"/>
        </reference>
        <reference anchor="RFC8501" target="https://www.rfc-editor.org/info/rfc8501" quoteTitle="true" derivedAnchor="RFC8501">
          <front>
            <title>Reverse DNS in IPv6 for Internet Service Providers</title>
            <author initials="L." surname="Howard" fullname="L. Howard">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="November"/>
            <abstract>
              <t indent="0">In IPv4, Internet Service Providers (ISPs) commonly provide IN-ADDR.ARPA information for their customers by prepopulating the zone with one PTR record for every available address.  This practice does not scale in IPv6.  This document analyzes different approaches and considerations for ISPs in managing the IP6.ARPA zone.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8501"/>
          <seriesInfo name="DOI" value="10.17487/RFC8501"/>
        </reference>
        <reference anchor="RFC8806" target="https://www.rfc-editor.org/info/rfc8806" quoteTitle="true" derivedAnchor="RFC8806">
          <front>
            <title>Running a Root Server Local to a Resolver</title>
            <author initials="W." surname="Kumari" fullname="W. Kumari">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="June"/>
            <abstract>
              <t indent="0">Some DNS recursive resolvers have longer-than-desired round-trip times to the closest DNS root server; those resolvers may have difficulty getting responses from the root servers, such as during a network attack. Some DNS recursive resolver operators want to prevent snooping by third parties of requests sent to DNS root servers. In both cases, resolvers can greatly decrease the round-trip time and prevent observation of requests by serving a copy of the full root zone on the same server, such as on a loopback address or in the resolver software. This document shows how to start and maintain such a copy of the root zone that does not cause problems for other users of the DNS, at the cost of adding some operational fragility for the operator.</t>
              <t indent="0">This document obsoletes RFC 7706.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8806"/>
          <seriesInfo name="DOI" value="10.17487/RFC8806"/>
        </reference>
        <reference anchor="RFC8906" target="https://www.rfc-editor.org/info/rfc8906" quoteTitle="true" derivedAnchor="RFC8906">
          <front>
            <title>A Common Operational Problem in DNS Servers: Failure to Communicate</title>
            <author initials="M." surname="Andrews" fullname="M. Andrews">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="September"/>
            <abstract>
              <t indent="0">The DNS is a query/response protocol.  Failing to respond to queries, or responding incorrectly, causes both immediate operational problems and long-term problems with protocol development. </t>
              <t indent="0">This document identifies a number of common kinds of queries to which some servers either fail to respond or respond incorrectly.  This document also suggests procedures for zone operators to apply to identify and remediate the problem. </t>
              <t indent="0">The document does not look at the DNS data itself, just the structure of the responses.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="231"/>
          <seriesInfo name="RFC" value="8906"/>
          <seriesInfo name="DOI" value="10.17487/RFC8906"/>
        </reference>
        <reference anchor="RFC8932" target="https://www.rfc-editor.org/info/rfc8932" quoteTitle="true" derivedAnchor="RFC8932">
          <front>
            <title>Recommendations for DNS Privacy Service Operators</title>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Overeinder" fullname="B. Overeinder">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="van Rijswijk-Deij" fullname="R. van Rijswijk-Deij">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Mankin" fullname="A. Mankin">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="October"/>
            <abstract>
              <t indent="0">This document presents operational, policy, and security considerations for DNS recursive resolver operators who choose to offer DNS privacy services.  With these recommendations, the operator can make deliberate decisions regarding which services to provide, as well as understanding how those decisions and the alternatives impact the privacy of users. </t>
              <t indent="0">This document also presents a non-normative framework to assist writers of a Recursive operator Privacy Statement, analogous to DNS Security Extensions (DNSSEC) Policies and DNSSEC Practice Statements described in RFC 6841.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="232"/>
          <seriesInfo name="RFC" value="8932"/>
          <seriesInfo name="DOI" value="10.17487/RFC8932"/>
        </reference>
        <reference anchor="RFC8945" target="https://www.rfc-editor.org/info/rfc8945" quoteTitle="true" derivedAnchor="RFC8945">
          <front>
            <title>Secret Key Transaction Authentication for DNS (TSIG)</title>
            <author initials="F." surname="Dupont" fullname="F. Dupont">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Morris" fullname="S. Morris">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Gudmundsson" fullname="O. Gudmundsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Wellington" fullname="B. Wellington">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="November"/>
            <abstract>
              <t indent="0">This document describes a protocol for transaction-level authentication using shared secrets and one-way hashing.  It can be used to authenticate dynamic updates to a DNS zone as coming from an approved client or to authenticate responses as coming from an approved name server.</t>
              <t indent="0">No recommendation is made here for distributing the shared secrets; it is expected that a network administrator will statically configure name servers and clients using some out-of-band mechanism.</t>
              <t indent="0">This document obsoletes RFCs 2845 and 4635.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="93"/>
          <seriesInfo name="RFC" value="8945"/>
          <seriesInfo name="DOI" value="10.17487/RFC8945"/>
        </reference>
        <reference anchor="ROLL_YOUR_ROOT" target="https://dl.acm.org/doi/10.1145/3355369.3355570" quoteTitle="true" derivedAnchor="ROLL_YOUR_ROOT">
          <front>
            <title>Roll, Roll, Roll Your Root: A Comprehensive Analysis of the First Ever DNSSEC Root KSK Rollover</title>
            <author fullname="Moritz Müller" initials="M." surname="Müller"/>
            <author fullname="Matthew Thomas" initials="M." surname="Thomas"/>
            <author fullname="Duane Wessels" initials="D." surname="Wessels"/>
            <author fullname="Wes Hardaker" initials="W." surname="Hardaker"/>
            <author fullname="Taejoong Chung" initials="T." surname="Chung"/>
            <author fullname="Willem Toorop" initials="W." surname="Toorop"/>
            <author fullname="Roland van Rijswijk-Deij" initials="R." surname="van Rijswijk-Deij"/>
            <date year="2019" month="October"/>
          </front>
          <seriesInfo name="DOI" value="10.1145/3355369.3355570"/>
        </reference>
        <reference anchor="RRL" quoteTitle="true" derivedAnchor="RRL">
          <front>
            <title>DNS Response Rate Limiting (DNS RRL)</title>
            <author fullname="Paul Vixie" initials="P." surname="Vixie"/>
            <author fullname="Vernon Schryver" initials="V." surname="Schryver"/>
            <date year="2012" month="April"/>
          </front>
          <refcontent>ISC-TN-2012-1-Draft1</refcontent>
        </reference>
        <reference anchor="TDNS" quoteTitle="true" target="https://doi.org/10.1109/SP.2015.18" derivedAnchor="TDNS">
          <front>
            <title>Connection-Oriented DNS to Improve Privacy and Security</title>
            <author fullname="Liang Zhu" initials="L." surname="Zhu"/>
            <author fullname="John Heidemann" initials="J." surname="Heidemann"/>
            <author fullname="Duane Wessels" initials="D." surname="Wessels"/>
            <author fullname="Allison Mankin" initials="A." surname="Mankin"/>
            <author fullname="Nikita Somaiya" initials="N." surname="Somaiya"/>
            <date year="2015" month="May"/>
          </front>
          <seriesInfo name="DOI" value="10.1109/SP.2015.18"/>
        </reference>
        <reference anchor="TOYAMA" quoteTitle="true" derivedAnchor="TOYAMA">
          <front>
            <title>DNS Anomalies and Their Impacts on DNS Cache Servers</title>
            <author fullname="Katsuyasu Toyama" initials="K." surname="Toyama"/>
            <author fullname="Keisuke Ishibashi" initials="K." surname="Ishibashi"/>
            <author fullname="Tsuyoshi Toyono" initials="T." surname="Toyono"/>
            <author fullname="Masahiro Ishino" initials="M." surname="Ishino"/>
            <author fullname="Chika Yoshimura" initials="C." surname="Yoshimura"/>
            <author fullname="Kazunori Fujiwara" initials="K." surname="Fujiwara"/>
            <date year="2004" month="October"/>
          </front>
          <refcontent>NANOG 32</refcontent>
        </reference>
        <reference anchor="VERISIGN" quoteTitle="true" derivedAnchor="VERISIGN">
          <front>
            <title>An Analysis of TCP Traffic in Root Server DITL Data</title>
            <author fullname="Matt Thomas" initials="M." surname="Thomas"/>
            <author fullname="Duane Wessels" initials="D." surname="Wessels"/>
            <date year="2014" month="October"/>
          </front>
          <refcontent>DNS-OARC 2014 Fall Workshop</refcontent>
        </reference>
        <reference anchor="WIKIPEDIA_TFO" target="https://en.wikipedia.org/w/index.php?title=TCP_Fast_Open&amp;oldid=1071397204" quoteTitle="true" derivedAnchor="WIKIPEDIA_TFO">
          <front>
            <title>TCP Fast Open</title>
            <author>
              <organization showOnFrontPage="true">Wikipedia</organization>
            </author>
            <date year="2022" month="February"/>
          </front>
        </reference>
      </references>
    </references>
    <section anchor="dnsrfcs" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-rfcs-related-to-dns-transpo">RFCs Related to DNS Transport over TCP</name>
      <t indent="0" pn="section-appendix.a-1">This section enumerates all known RFCs with a status of
     Internet Standard, Proposed Standard,
     Informational, Best Current Practice,
     or Experimental that either implicitly or explicitly make
     assumptions or statements about the use of TCP as a transport for
     the DNS germane to this document.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.1">
        <name slugifiedName="name-rfc-1035-domain-names-imple">RFC 1035 - DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION</name>
        <t indent="0" pn="section-appendix.a.1-1">The Internet Standard <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/> is the
       base DNS specification that explicitly defines support for DNS
       over TCP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.2">
        <name slugifiedName="name-rfc-1536-common-dns-impleme">RFC 1536 - Common DNS Implementation Errors and Suggested Fixes</name>
        <t indent="0" pn="section-appendix.a.2-1">The Informational document <xref target="RFC1536" format="default" sectionFormat="of" derivedContent="RFC1536"/>
       states that UDP is "the chosen protocol for communication though TCP
       is used for zone transfers."  That statement should now be
       considered in its historical context and is no longer a proper
       reflection of modern expectations.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.3">
        <name slugifiedName="name-rfc-1995-incremental-zone-t">RFC 1995 - Incremental Zone Transfer in DNS</name>
        <t indent="0" pn="section-appendix.a.3-1">The Proposed Standard <xref target="RFC1995" format="default" sectionFormat="of" derivedContent="RFC1995"/>
       documents the use of TCP as the fallback transport when Incremental Zone Transfer (IXFR)
       responses do not fit into a single UDP response.  As with Authoritative Transfer (AXFR),
       IXFR messages are typically delivered over TCP by default in
       practice.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.4">
        <name slugifiedName="name-rfc-1996-a-mechanism-for-pr">RFC 1996 - A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)</name>
        <t indent="0" pn="section-appendix.a.4-1">The Proposed Standard <xref target="RFC1996" format="default" sectionFormat="of" derivedContent="RFC1996"/>
       suggests that a primary server may decide to issue NOTIFY messages over
       TCP.  In practice, NOTIFY messages are generally sent over UDP,
       but this specification leaves open the possibility that the
       choice of transport protocol is up to the primary server; therefore,
       a secondary server ought to be able to operate over both UDP and TCP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.5">
        <name slugifiedName="name-rfc-2181-clarifications-to-">RFC 2181 - Clarifications to the DNS Specification</name>
        <t indent="0" pn="section-appendix.a.5-1">The Proposed Standard <xref target="RFC2181" format="default" sectionFormat="of" derivedContent="RFC2181"/>
       includes clarifying text on how a client should react to the TC
       bit set on responses.  It is advised that the response be
       discarded and the query resent using TCP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.6">
        <name slugifiedName="name-rfc-2694-dns-extensions-to-">RFC 2694 - DNS extensions to Network Address Translators (DNS_ALG)</name>
        <t indent="0" pn="section-appendix.a.6-1">The Informational document <xref target="RFC2694" format="default" sectionFormat="of" derivedContent="RFC2694"/>
       enumerates considerations for NAT
       devices to properly handle DNS traffic.  This document is
       noteworthy in its suggestion that
       "[t]ypically, TCP is used for AXFR requests,"
       as further evidence that helps
       explain why DNS over TCP may have often been treated very
       differently than DNS over UDP in operational networks.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.7">
        <name slugifiedName="name-rfc-3225-indicating-resolve">RFC 3225 - Indicating Resolver Support of DNSSEC</name>
        <t indent="0" pn="section-appendix.a.7-1">The Proposed Standard <xref target="RFC3225" format="default" sectionFormat="of" derivedContent="RFC3225"/>
       makes statements indicating that DNS over TCP is "detrimental" as a
       result of increased traffic, latency, and server load.  This
       document is a companion to the next document in the RFC
       Series that describes the requirement for EDNS(0) support for DNSSEC.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.8">
        <name slugifiedName="name-rfc-3226-dnssec-and-ipv6-a6">RFC 3226 - DNSSEC and IPv6 A6 aware server/resolver message size requirements</name>
        <t indent="0" pn="section-appendix.a.8-1">Although updated by later DNSSEC RFCs,
       the Proposed Standard <xref target="RFC3226" format="default" sectionFormat="of" derivedContent="RFC3226"/>
       strongly argues in favor of
       UDP messages instead of TCP, largely for performance reasons.
       The document declares EDNS(0) a requirement for DNSSEC servers and
       advocates that packet fragmentation may be preferable to TCP in
       certain situations.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.9">
        <name slugifiedName="name-rfc-4472-operational-consid">RFC 4472 - Operational Considerations and Issues with IPv6 DNS</name>
        <t indent="0" pn="section-appendix.a.9-1">The Informational document <xref target="RFC4472" format="default" sectionFormat="of" derivedContent="RFC4472"/> notes
       that IPv6 data may increase DNS responses beyond what would fit in
       a UDP message.  What is particularly noteworthy, but perhaps less common today
       than when this document was written, is that it refers to implementations that
       truncate data without setting the TC bit to encourage the client to
       resend the query using TCP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.10">
        <name slugifiedName="name-rfc-5452-measures-for-makin">RFC 5452 - Measures for Making DNS More Resilient against Forged Answers</name>
        <t indent="0" pn="section-appendix.a.10-1">The Proposed Standard <xref target="RFC5452" format="default" sectionFormat="of" derivedContent="RFC5452"/> arose
       as public DNS systems began to experience widespread abuse from spoofed
       queries, resulting in amplification and reflection attacks against
       unwitting victims.  One of the leading justifications for supporting
       DNS over TCP to thwart these attacks is briefly described in <xref target="RFC5452" sectionFormat="of" section="9.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5452#section-9.3" derivedContent="RFC5452"/> ("Spoof Detection and Countermeasure").</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.11">
        <name slugifiedName="name-rfc-5507-design-choices-whe">RFC 5507 - Design Choices When Expanding the DNS</name>
        <t indent="0" pn="section-appendix.a.11-1">The Informational document <xref target="RFC5507" format="default" sectionFormat="of" derivedContent="RFC5507"/> was
       largely an attempt to dissuade new DNS data types from overloading the
       TXT resource record type.  In so doing, it summarizes the conventional
       wisdom of DNS design and implementation practices.  The authors
       suggest TCP overhead and stateful properties pose challenges compared
       to UDP and imply that UDP is generally preferred for performance and
       robustness.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.12">
        <name slugifiedName="name-rfc-5625-dns-proxy-implemen">RFC 5625 - DNS Proxy Implementation Guidelines</name>
        <t indent="0" pn="section-appendix.a.12-1">The Best Current Practice document <xref target="RFC5625" format="default" sectionFormat="of" derivedContent="RFC5625"/>
       provides DNS proxy implementation guidance including the mandate that a
       proxy "<bcp14>MUST</bcp14> [...] be prepared to receive and forward queries over TCP"
       even though it suggests that, historically, TCP transport has not been strictly
       mandatory in stub resolvers or recursive servers.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.13">
        <name slugifiedName="name-rfc-5936-dns-zone-transfer-">RFC 5936 - DNS Zone Transfer Protocol (AXFR)</name>
        <t indent="0" pn="section-appendix.a.13-1">The Proposed Standard <xref target="RFC5936" format="default" sectionFormat="of" derivedContent="RFC5936"/>
       provides a detailed specification for the zone transfer protocol,
       as originally outlined in the early DNS standards.  AXFR operation
       is limited to TCP and not specified for UDP.  This document
       discusses TCP usage at length.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.14">
        <name slugifiedName="name-rfc-7534-as112-nameserver-o">RFC 7534 - AS112 Nameserver Operations</name>
        <t indent="0" pn="section-appendix.a.14-1">The Informational document <xref target="RFC7534" format="default" sectionFormat="of" derivedContent="RFC7534"/>
       enumerates the requirements for operation of AS112 project DNS
       servers.  New AS112 nodes are tested for their ability to provide
       service on both UDP and TCP transports, with the implication that
       TCP service is an expected part of normal operations.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.15">
        <name slugifiedName="name-rfc-6762-multicast-dns">RFC 6762 - Multicast DNS</name>
        <t indent="0" pn="section-appendix.a.15-1">In the Proposed Standard <xref target="RFC6762" format="default" sectionFormat="of" derivedContent="RFC6762"/>, the
       TC bit is deemed to have essentially the same meaning as described
       in the original DNS specifications.  That is, if a response with the
       TC bit set is received, "[...] the querier <bcp14>SHOULD</bcp14> reissue its query
       using TCP in order to receive the larger response."</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.16">
        <name slugifiedName="name-rfc-6891-extension-mechanis">RFC 6891 - Extension Mechanisms for DNS (EDNS(0))</name>
        <t indent="0" pn="section-appendix.a.16-1">The Internet Standard <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/>
       helped slow the use of and need for DNS-over-TCP messages.  This
       document highlights concerns over server load and scalability in
       widespread use of DNS over TCP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.17">
        <name slugifiedName="name-iab-rfc-6950-architectural-">IAB RFC 6950 - Architectural Considerations on Application Features in the DNS</name>
        <t indent="0" pn="section-appendix.a.17-1">The Informational document <xref target="RFC6950" format="default" sectionFormat="of" derivedContent="RFC6950"/> draws
       attention to large data in the DNS.  TCP is referenced in the
       context as a common fallback mechanism and counter to some spoofing
       attacks.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.18">
        <name slugifiedName="name-rfc-7477-child-to-parent-sy">RFC 7477 - Child-to-Parent Synchronization in DNS</name>
        <t indent="0" pn="section-appendix.a.18-1">The Proposed Standard <xref target="RFC7477" format="default" sectionFormat="of" derivedContent="RFC7477"/>
	specifies an RRType and a protocol to signal and synchronize NS, A,
       and AAAA resource record changes from a child-to-parent zone.
       Since this protocol may require multiple requests and responses,
       it recommends utilizing DNS over TCP to ensure the conversation
       takes place between a consistent pair of end nodes.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.19">
        <name slugifiedName="name-rfc-7720-dns-root-name-serv">RFC 7720 - DNS Root Name Service Protocol and Deployment Requirements</name>
        <t indent="0" pn="section-appendix.a.19-1">The Best Current Practice document <xref target="RFC7720" format="default" sectionFormat="of" derivedContent="RFC7720"/>
       declares that root name service "<bcp14>MUST</bcp14> support UDP <xref target="RFC0768" format="default" sectionFormat="of" derivedContent="RFC0768"/> and TCP <xref target="RFC0793" format="default" sectionFormat="of" derivedContent="RFC0793"/>
       transport of DNS queries and responses."</t>
      </section>
      <section anchor="app-rfc7766" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.20">
        <name slugifiedName="name-rfc-7766-dns-transport-over">RFC 7766 - DNS Transport over TCP - Implementation Requirements</name>
        <t indent="0" pn="section-appendix.a.20-1">The Proposed Standard <xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/>
       instructs DNS implementors to provide support for carrying DNS-over-TCP messages in their software and 
       might be considered the direct ancestor of this operational
       requirements document.
       The implementation requirements document
       codifies mandatory support for DNS-over-TCP in compliant DNS
       software but
       makes no recommendations to operators, which we seek to address
       here.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.21">
        <name slugifiedName="name-rfc-7828-the-edns-tcp-keepa">RFC 7828 - The edns-tcp-keepalive EDNS(0) Option</name>
        <t indent="0" pn="section-appendix.a.21-1">The Proposed Standard <xref target="RFC7828" format="default" sectionFormat="of" derivedContent="RFC7828"/>
       defines an EDNS(0) option to negotiate an idle timeout value for
       long-lived DNS-over-TCP connections.  Consequently, this document
       is only applicable and relevant to DNS-over-TCP sessions and
       between implementations that support this option.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.22">
        <name slugifiedName="name-rfc-7858-specification-for-">RFC 7858 - Specification for DNS over Transport Layer Security (TLS)</name>
        <t indent="0" pn="section-appendix.a.22-1">The Proposed Standard <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>
       defines a method for putting DNS messages into a TCP-based
       encrypted channel using TLS.  This specification is noteworthy
       for explicitly targeting the stub-to-recursive traffic but
       does not preclude its application from recursive-to-authoritative
       traffic.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.23">
        <name slugifiedName="name-rfc-7873-domain-name-system">RFC 7873 - Domain Name System (DNS) Cookies</name>
        <t indent="0" pn="section-appendix.a.23-1">The Proposed Standard <xref target="RFC7873" format="default" sectionFormat="of" derivedContent="RFC7873"/>
       describes an EDNS(0) option to provide additional protection
       against query and answer forgery.  This specification mentions
       DNS over TCP as an alternative mechanism when DNS cookies
       are not available.  The specification does make mention of DNS-over-TCP processing in two specific situations.  In one, when a
       server receives only a client cookie in a request, the server
       should consider whether the request arrived over TCP, and if so,
       it should consider accepting TCP as sufficient to authenticate
       the request and respond accordingly.  In another, when a client
       receives a BADCOOKIE reply using a fresh server cookie, the
       client should retry using TCP as the transport.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.24">
        <name slugifiedName="name-rfc-7901-chain-query-reques">RFC 7901 - CHAIN Query Requests in DNS</name>
        <t indent="0" pn="section-appendix.a.24-1">The Experimental specification <xref target="RFC7901" format="default" sectionFormat="of" derivedContent="RFC7901"/>
       describes an EDNS(0) option that can be used by a security-aware
       validating resolver to request and obtain a complete DNSSEC
       validation path for any single query.  This document requires the
       use of DNS over TCP or a transport
       mechanism verified by a source IP address such as EDNS-COOKIE <xref target="RFC7873" format="default" sectionFormat="of" derivedContent="RFC7873"/>.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.25">
        <name slugifiedName="name-rfc-8027-dnssec-roadblock-a">RFC 8027 - DNSSEC Roadblock Avoidance</name>
        <t indent="0" pn="section-appendix.a.25-1">The Best Current Practice document <xref target="RFC8027" format="default" sectionFormat="of" derivedContent="RFC8027"/> details observed
       problems with DNSSEC deployment and mitigation techniques.
       Network traffic blocking and restrictions, including DNS-over-TCP
       messages, are highlighted as one reason for DNSSEC deployment
       issues.  While this document suggests these sorts of problems are
       due to "non-compliant infrastructure", the
       scope of the document is limited to detection and mitigation
       techniques to avoid so-called DNSSEC roadblocks.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.26">
        <name slugifiedName="name-rfc-8094-dns-over-datagram-">RFC 8094 - DNS over Datagram Transport Layer Security (DTLS)</name>
        <t indent="0" pn="section-appendix.a.26-1">The Experimental specification <xref target="RFC8094" format="default" sectionFormat="of" derivedContent="RFC8094"/>
       details a protocol that uses a datagram transport (UDP) but
       stipulates that "DNS clients and servers that implement DNS over
       DTLS <bcp14>MUST</bcp14> also implement DNS over TLS in order to provide privacy
       for clients that desire Strict Privacy [...]."  This requirement
       implies DNS over TCP must be supported in case the message size
       is larger than the path MTU.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.27">
        <name slugifiedName="name-rfc-8162-using-secure-dns-t">RFC 8162 - Using Secure DNS to Associate Certificates with Domain Names for S/MIME</name>
        <t indent="0" pn="section-appendix.a.27-1">The Experimental specification <xref target="RFC8162" format="default" sectionFormat="of" derivedContent="RFC8162"/>
       describes a technique to authenticate user X.509 certificates
       in an S/MIME system via the DNS.  The document points out that
       the new experimental resource record types are expected to carry
       large payloads, resulting in the suggestion that "applications
       <bcp14>SHOULD</bcp14> use TCP -- not UDP -- to perform queries for the SMIMEA
       resource record."</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.28">
        <name slugifiedName="name-rfc-8324-dns-privacy-author">RFC 8324 - DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?</name>
        <t indent="0" pn="section-appendix.a.28-1"> The Informational document <xref target="RFC8324" format="default" sectionFormat="of" derivedContent="RFC8324"/>
       briefly discusses the common role and challenges of DNS over TCP
       throughout the history of DNS.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.29">
        <name slugifiedName="name-rfc-8467-padding-policies-f">RFC 8467 - Padding Policies for Extension Mechanisms for DNS (EDNS(0))</name>
        <t indent="0" pn="section-appendix.a.29-1">The Experimental document <xref target="RFC8467" format="default" sectionFormat="of" derivedContent="RFC8467"/>
       reminds implementors to consider the underlying transport
       protocol (e.g., TCP) when calculating the padding length when
       artificially increasing the DNS message size with an EDNS(0)
       padding option.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.30">
        <name slugifiedName="name-rfc-8482-providing-minimal-">RFC 8482 - Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY</name>
        <t indent="0" pn="section-appendix.a.30-1">The Proposed Standard <xref target="RFC8482" format="default" sectionFormat="of" derivedContent="RFC8482"/>
       describes alternative ways that DNS servers can respond to queries
       of type ANY, which are sometimes used to provide amplification
       in DDoS attacks.  The specification notes that responders may
       behave differently, depending on the transport.  For example,
       minimal-sized responses may be used over UDP transport, while
       full responses may be given over TCP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.31">
        <name slugifiedName="name-rfc-8483-yeti-dns-testbed">RFC 8483 - Yeti DNS Testbed</name>
        <t indent="0" pn="section-appendix.a.31-1">The Informational document <xref target="RFC8483" format="default" sectionFormat="of" derivedContent="RFC8483"/>
       describes a testbed environment that highlights some DNS-over-TCP
       behaviors, including issues involving packet fragmentation and
       operational requirements for TCP stream assembly in order to
       conduct DNS measurement and analysis.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.32">
        <name slugifiedName="name-rfc-8484-dns-queries-over-h">RFC 8484 - DNS Queries over HTTPS (DoH)</name>
        <t indent="0" pn="section-appendix.a.32-1">The Proposed Standard <xref target="RFC8484" format="default" sectionFormat="of" derivedContent="RFC8484"/>
       defines a protocol for sending DNS queries and responses over
       HTTPS.  This specification assumes TLS and TCP for the underlying
       security and transport layers, respectively.  Self-described as a
       technique that more closely resembles a tunneling mechanism,
       DoH nevertheless likely implies DNS over TCP in some sense, if not
       directly.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.33">
        <name slugifiedName="name-rfc-8490-dns-stateful-opera">RFC 8490 - DNS Stateful Operations</name>
        <t indent="0" pn="section-appendix.a.33-1">The Proposed Standard <xref target="RFC8490" format="default" sectionFormat="of" derivedContent="RFC8490"/>
       updates the base protocol specification with a new OPCODE to
       help manage stateful operations in persistent sessions, such
       as those that might be used by DNS over TCP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.34">
        <name slugifiedName="name-rfc-8501-reverse-dns-in-ipv">RFC 8501 - Reverse DNS in IPv6 for Internet Service Providers</name>
        <t indent="0" pn="section-appendix.a.34-1">The Informational document <xref target="RFC8501" format="default" sectionFormat="of" derivedContent="RFC8501"/>
       identifies potential operational challenges with dynamic DNS,
       including denial-of-service threats.  The document suggests TCP
       may provide some advantages but that updating hosts would need
       to be explicitly configured to use TCP instead of UDP.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.35">
        <name slugifiedName="name-rfc-8806-running-a-root-ser">RFC 8806 - Running a Root Server Local to a Resolver</name>
        <t indent="0" pn="section-appendix.a.35-1">The Informational document <xref target="RFC8806" format="default" sectionFormat="of" derivedContent="RFC8806"/>
       describes how to obtain and operate a local copy of the root zone
       with examples showing how to pull from authoritative sources using
       a DNS-over-TCP zone transfer.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.36">
        <name slugifiedName="name-rfc-8906-a-common-operation">RFC 8906 - A Common Operational Problem in DNS Servers: Failure to Communicate</name>
        <t indent="0" pn="section-appendix.a.36-1">The Best Current Practice document <xref target="RFC8906" format="default" sectionFormat="of" derivedContent="RFC8906"/>
       discusses a number of DNS operational failure scenarios and how to
       avoid them.  This includes discussions involving DNS-over-TCP queries,
       EDNS over TCP, and a testing methodology that includes a section on
       verifying DNS-over-TCP functionality.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.37">
        <name slugifiedName="name-rfc-8932-recommendations-fo">RFC 8932 - Recommendations for DNS Privacy Service Operators</name>
        <t indent="0" pn="section-appendix.a.37-1">The Best Current Practice document <xref target="RFC8932" format="default" sectionFormat="of" derivedContent="RFC8932"/>
       presents privacy considerations to DNS privacy service operators.
       These mechanisms sometimes include the use of TCP and are therefore
       susceptible to information leakage such as TCP-based fingerprinting.
       This document also references an earlier draft version of this document.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a.38">
        <name slugifiedName="name-rfc-8945-secret-key-transac">RFC 8945 - Secret Key Transaction Authentication for DNS (TSIG)</name>
        <t indent="0" pn="section-appendix.a.38-1">The Internet Standard <xref target="RFC8945" format="default" sectionFormat="of" derivedContent="RFC8945"/>
       recommends that a client use TCP if truncated TSIG messages are
       received.</t>
      </section>
    </section>
    <section anchor="Acknowledgments" numbered="false" toc="include" removeInRFC="false" pn="section-appendix.b">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.b-1">This document was initially motivated by feedback from students
     who pointed out that they were hearing contradictory information
     about filtering DNS-over-TCP messages. Thanks in particular to a
     teaching colleague, JPL, who perhaps unknowingly encouraged the
     initial research into the differences between what the community has
     historically said and did.  Thanks to all the NANOG 63 attendees
     who provided feedback for an early talk on this subject.</t>
      <t indent="0" pn="section-appendix.b-2">The following individuals provided an array of feedback to help
     improve this document: <contact fullname="Joe Abley"/>, <contact fullname="Piet Barber"/>, <contact fullname="Sara Dickinson"/>, <contact fullname="Tony Finch"/>, <contact fullname="Bob Harold"/>, <contact fullname="Paul Hoffman"/>, <contact fullname="Geoff Huston"/>, <contact fullname="Tatuya Jinmei"/>,
     <contact fullname="Puneet Sood"/>, and <contact fullname="Richard Wilhelm"/>.  The authors are also indebted to the contributions
     stemming from discussion in the TCPM Working Group meeting at
     IETF 104.  Any remaining errors or imperfections are the sole
     responsibility of the document authors.</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.c">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author fullname="John Kristoff" initials="J." surname="Kristoff">
        <organization showOnFrontPage="true">Dataplane.org</organization>
        <address>
          <postal>
            <street/>
            <city>Chicago</city>
            <region>IL</region>
            <code>60605</code>
            <country>United States of America</country>
          </postal>
          <phone>+1 312 493 0305</phone>
          <email>jtk@dataplane.org</email>
          <uri>https://dataplane.org/jtk/</uri>
        </address>
      </author>
      <author fullname="Duane Wessels" initials="D." surname="Wessels">
        <organization showOnFrontPage="true">Verisign</organization>
        <address>
          <postal>
            <street>12061 Bluemont Way</street>
            <city>Reston</city>
            <region>VA</region>
            <code>20190</code>
            <country>United States of America</country>
          </postal>
          <phone>+1 703 948 3200</phone>
          <email>dwessels@verisign.com</email>
          <uri>https://verisign.com</uri>
        </address>
      </author>
    </section>
  </back>
</rfc>
