<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-jmap-websocket-07" indexInclude="true" ipr="trust200902" number="8887" prepTime="2020-08-27T16:52:05" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-jmap-websocket-07" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc8887" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="JMAP over WebSocket">A JSON Meta Application Protocol (JMAP) Subprotocol for WebSocket</title>
    <seriesInfo name="RFC" value="8887" stream="IETF"/>
    <author initials="K." surname="Murchison" fullname="Kenneth Murchison">
      <organization abbrev="Fastmail" showOnFrontPage="true">Fastmail US LLC</organization>
      <address>
        <postal>
          <street>1429 Walnut Street, Suite 1201</street>
          <city>Philadelphia</city>
          <region>PA</region>
          <code>19102</code>
          <country>United States of America</country>
        </postal>
        <email>murch@fastmailteam.com</email>
        <uri>http://www.fastmail.com/</uri>
      </address>
    </author>
    <date month="08" year="2020"/>
    <area>ART</area>
    <workgroup>JMAP</workgroup>
    <keyword>jmap</keyword>
    <keyword>websocket</keyword>
    <abstract pn="section-abstract">
      <t pn="section-abstract-1">This document defines a binding for the JSON Meta Application
      Protocol (JMAP) over a WebSocket transport layer.  The WebSocket
      binding for JMAP provides higher performance than the current
      HTTP binding for JMAP.
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc8887" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t pn="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-conventions-used-in-this-do">Conventions Used in This Document</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t keepWithNext="true" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-discovering-support-for-jma">Discovering Support for JMAP over WebSocket</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-jmap-subprotocol">JMAP Subprotocol</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-authentication">Authentication</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-handshake">Handshake</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-websocket-messages">WebSocket Messages</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.3.2">
                  <li pn="section-toc.1-1.4.2.3.2.1">
                    <t pn="section-toc.1-1.4.2.3.2.1.1"><xref derivedContent="4.3.1" format="counter" sectionFormat="of" target="section-4.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-handling-invalid-data">Handling Invalid Data</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.3.2.2">
                    <t pn="section-toc.1-1.4.2.3.2.2.1"><xref derivedContent="4.3.2" format="counter" sectionFormat="of" target="section-4.3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-jmap-requests">JMAP Requests</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.3.2.3">
                    <t pn="section-toc.1-1.4.2.3.2.3.1"><xref derivedContent="4.3.3" format="counter" sectionFormat="of" target="section-4.3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-jmap-responses">JMAP Responses</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.3.2.4">
                    <t pn="section-toc.1-1.4.2.3.2.4.1"><xref derivedContent="4.3.4" format="counter" sectionFormat="of" target="section-4.3.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-jmap-request-level-errors">JMAP Request-Level Errors</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.3.2.5">
                    <t pn="section-toc.1-1.4.2.3.2.5.1"><xref derivedContent="4.3.5" format="counter" sectionFormat="of" target="section-4.3.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-jmap-push-notifications">JMAP Push Notifications</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.4.2.4">
                <t pn="section-toc.1-1.4.2.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples">Examples</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-connection-confidentiality-">Connection Confidentiality and Integrity</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-non-browser-clients">Non-browser Clients</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-registration-of-the-websock">Registration of the WebSocket JMAP Subprotocol</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.2">
                <t pn="section-toc.1-1.7.2.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t pn="section-toc.1-1.8.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t pn="section-toc.1-1.9.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-address">Author's Address</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t pn="section-1-1"><xref target="RFC8620" format="default" sectionFormat="of" derivedContent="RFC8620">JMAP</xref>
      over <xref target="RFC7235" format="default" sectionFormat="of" derivedContent="RFC7235">HTTP</xref> requires that 
      every JMAP API request be authenticated.
      Depending on the type of authentication used by
      the JMAP client and the configuration of the JMAP server,
      authentication could be an expensive operation both in time and
      resources.  In such circumstances, reauthenticating for every
      JMAP API request may harm performance.</t>
      <t pn="section-1-2">The <xref target="RFC6455" format="default" sectionFormat="of" derivedContent="RFC6455">WebSocket</xref>
      binding for JMAP eliminates this performance
      hit by authenticating just the WebSocket handshake request and
      having those credentials remain in effect for the duration of
      the WebSocket connection.  This binding supports JMAP API
      requests and responses, with optional support for push
      notifications.</t>
      <t pn="section-1-3">Furthermore, the WebSocket binding for JMAP can optionally
      <xref target="RFC7692" format="default" sectionFormat="of" derivedContent="RFC7692">compress</xref> both JMAP API
      requests and responses.
      Although compression of HTTP responses is ubiquitous,
      compression of HTTP requests has very low, if any, deployment
      and therefore isn't a viable option for JMAP API requests
      over HTTP.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-conventions-used-in-this-do">Conventions Used in This Document</name>
      <t pn="section-2-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
    "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>",
    "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>", 
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are
    to be interpreted as 
    described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
      </t>
      <t pn="section-2-2">This document uses the terminology defined in the core JMAP
	specification <xref target="RFC8620" format="default" sectionFormat="of" derivedContent="RFC8620"/>.</t>
    </section>
    <section anchor="discovery" numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-discovering-support-for-jma">Discovering Support for JMAP over WebSocket</name>
      <t pn="section-3-1">The JMAP capabilities object is returned as part of the
      standard JMAP Session object (see
      <xref target="RFC8620" sectionFormat="of" section="2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-2" derivedContent="RFC8620"/>).
      Servers supporting this specification <bcp14>MUST</bcp14> add a property named
      "urn:ietf:params:jmap:websocket" to the capabilities object.
      The value of this property is an object that <bcp14>MUST</bcp14> contain the
      following information on server capabilities:

      </t>
      <ul spacing="normal" bare="false" empty="false" pn="section-3-2">
        <li pn="section-3-2.1">
          <t pn="section-3-2.1.1">url:  "String"</t>
          <t pn="section-3-2.1.2">The wss-URI (see <xref target="RFC6455" sectionFormat="of" section="3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-3" derivedContent="RFC6455"/>) to use for initiating a JMAP-over-WebSocket 
	  handshake (the "WebSocket URL endpoint" colloquially).</t>
        </li>
        <li pn="section-3-2.2">
          <t pn="section-3-2.2.1">supportsPush:  "Boolean"</t>
          <t pn="section-3-2.2.2">This is true if the server supports push notifications over the
	  WebSocket, as described in <xref target="push" format="default" sectionFormat="of" derivedContent="Section 4.3.5"/>.</t>
        </li>
      </ul>
      <t keepWithNext="true" pn="section-3-3"> Example:</t>
      <artwork name="" type="" align="left" alt="" pn="section-3-4">
"urn:ietf:params:jmap:websocket": {
  "url": "wss://server.example.com/jmap/ws/",
  "supportsPush": true
}
</artwork>
    </section>
    <section anchor="jmap" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-jmap-subprotocol">JMAP Subprotocol</name>
      <t pn="section-4-1">The term WebSocket subprotocol refers to an application-level
      protocol layered on top of a WebSocket connection.  This
      document specifies the WebSocket JMAP subprotocol for carrying
      JMAP API requests, responses, and optional push notifications
      through a WebSocket connection.
      Binary data is handled per <xref target="RFC8620" sectionFormat="of" section="6" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-6" derivedContent="RFC8620"/> (via a separate HTTP connection or stream)
      or per a future extension to JMAP or this specification.</t>
      <section anchor="authentication" numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-authentication">Authentication</name>
        <t pn="section-4.1-1">A JMAP WebSocket connection is authenticated by presenting
        a user's <xref target="RFC7235" format="default" sectionFormat="of" derivedContent="RFC7235">credentials in the
        HTTP request</xref> that initiates the WebSocket handshake.
        See <xref target="RFC8620" sectionFormat="of" section="8.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-8.2" derivedContent="RFC8620"/> for
        recommendations regarding the selection of HTTP authentication
        schemes.</t>
      </section>
      <section anchor="handshake" numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-handshake">Handshake</name>
        <t pn="section-4.2-1">The JMAP WebSocket client and JMAP WebSocket server
        negotiate the use of the WebSocket JMAP subprotocol during
        the WebSocket handshake, either via an HTTP/1.1 Upgrade request
        (see <xref target="RFC6455" sectionFormat="of" section="4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-4" derivedContent="RFC6455"/>)
        or an HTTP/2 Extended CONNECT request (see
        <xref target="RFC8441" sectionFormat="of" section="5" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8441#section-5" derivedContent="RFC8441"/>).
        The WebSocket JMAP subprotocol is also intended to run
        over future bindings of HTTP (e.g., HTTP/3) provided that there
        is a defined mechanism for performing a WebSocket handshake
        over that binding.</t>
        <t pn="section-4.2-2">Regardless of the method used for the WebSocket handshake,
        the client <bcp14>MUST</bcp14> first perform a TLS handshake on a
        JMAP <xref target="discovery" format="default" sectionFormat="of" derivedContent="Section 3">WebSocket URL endpoint</xref>
        having the "wss://" scheme (WebSocket over TLS) in
        accordance with the requirements of running the particular
        binding of HTTP over TLS (see <xref target="RFC2818" format="default" sectionFormat="of" derivedContent="RFC2818"/>
        and <xref target="RFC6455" sectionFormat="of" section="4.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-4.1" derivedContent="RFC6455"/> for HTTP/1.1
        and <xref target="RFC7540" sectionFormat="of" section="9.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7540#section-9.2" derivedContent="RFC7540"/> for HTTP/2).
        If the TLS handshake fails, the client <bcp14>MUST</bcp14> close the
        connection. Otherwise, the client <bcp14>MUST</bcp14> make an 
        <xref target="RFC7235" format="default" sectionFormat="of" derivedContent="RFC7235">authenticated HTTP request</xref>
        on the encrypted connection and <bcp14>MUST</bcp14> include the value "jmap"
        in the list of protocols for the "Sec-WebSocket-Protocol"
        header field.</t>
        <t pn="section-4.2-3">The reply from the server <bcp14>MUST</bcp14> also contain a
        corresponding "Sec-WebSocket-Protocol" header field with a
        value of "jmap" in order
        for a JMAP subprotocol connection to be established.</t>
        <t pn="section-4.2-4">Once the handshake has successfully completed, the
        WebSocket connection is established and can be used for JMAP
        API requests, responses, and optional push notifications.
        Other message types <bcp14>MUST NOT</bcp14> be transmitted over this
        connection.</t>
        <t pn="section-4.2-5">The credentials used for authenticating the HTTP request
        to initiate the handshake remain in effect for the duration
        of the WebSocket connection.  If the authentication
        credentials for the user expire, the server can either treat
        subsequent requests as if they are unauthenticated or close
        the WebSocket connection.
        In the latter case, the server <bcp14>MAY</bcp14> send a Close frame with a
        status code of 1008 (Policy Violation), as defined in
        <xref target="RFC6455" sectionFormat="of" section="7.4.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-7.4.1" derivedContent="RFC6455"/>.</t>
      </section>
      <section anchor="messages" numbered="true" toc="include" removeInRFC="false" pn="section-4.3">
        <name slugifiedName="name-websocket-messages">WebSocket Messages</name>
        <t pn="section-4.3-1">Data frame messages in the JMAP subprotocol <bcp14>MUST</bcp14> be
        text frames and contain UTF-8 encoded data.  The messages <bcp14>MUST</bcp14>
        be in the form of a single JMAP Request object (see
        <xref target="RFC8620" sectionFormat="of" section="3.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-3.3" derivedContent="RFC8620"/>),
        JMAP WebSocketPushEnable object (see <xref target="pushenable" format="default" sectionFormat="of" derivedContent="Section 4.3.5.2"/>),
        or JMAP WebSocketPushDisable object (see <xref target="pushdisable" format="default" sectionFormat="of" derivedContent="Section 4.3.5.3"/>)
        when sent from
        the client to the server, and MUST be in the form of a single JMAP
        Response object, JSON Problem Details object, or JMAP StateChange
        object (see Sections <xref target="RFC8620" section="3.4" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-3.4" derivedContent="RFC8620"/>, <xref target="RFC8620" section="3.6.1" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-3.6.1" derivedContent="RFC8620"/>, and <xref target="RFC8620" section="7.1" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-7.1" derivedContent="RFC8620"/> of <xref target="RFC8620" format="default" sectionFormat="of" derivedContent="RFC8620"/>,
	respectively) when sent from the server to the client.</t>
        <t pn="section-4.3-2">Note that fragmented WebSocket messages (split over
        multiple text frames) <bcp14>MUST</bcp14> be coalesced prior to parsing them
        as JSON objects.</t>
        <section anchor="invalid" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.1">
          <name slugifiedName="name-handling-invalid-data">Handling Invalid Data</name>
          <t pn="section-4.3.1-1">If a client or server receives a binary frame, the endpoint
          can either ignore the frame or close the WebSocket connection.
          In the latter case, the endpoint <bcp14>MAY</bcp14> send a Close frame with a
          status code of 1003 (Unsupported Data), as defined in 
          <xref target="RFC6455" sectionFormat="of" section="7.4.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-7.4.1" derivedContent="RFC6455"/>.</t>
          <t pn="section-4.3.1-2">If a client receives a message that is not in the form of
          a JSON Problem Details object, a JMAP Response
          object, or a JMAP StateChange object, the client can either
          ignore the message or close the WebSocket connection.
          In the latter case, the endpoint <bcp14>MAY</bcp14> send a Close frame with a
          status code of 1007 (Invalid frame payload data), as
          defined in <xref target="RFC6455" sectionFormat="of" section="7.4.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-7.4.1" derivedContent="RFC6455"/>.</t>
          <t pn="section-4.3.1-3">A server <bcp14>MUST</bcp14> return an appropriate
          <xref target="errors" format="default" sectionFormat="of" derivedContent="Section 4.3.4">JSON Problem Details object</xref>
          for any request-level errors
          (e.g., an invalid JMAP object, an unsupported capability or
          method call, or exceeding a server request limit).</t>
        </section>
        <section anchor="requests" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.2">
          <name slugifiedName="name-jmap-requests">JMAP Requests</name>
          <t pn="section-4.3.2-1">The specification extends the Request object with two
          additional arguments when used over a WebSocket:
          </t>
          <ul spacing="normal" bare="false" empty="false" pn="section-4.3.2-2">
            <li pn="section-4.3.2-2.1">
              <t pn="section-4.3.2-2.1.1">@type:  "String"</t>
              <t pn="section-4.3.2-2.1.2">This <bcp14>MUST</bcp14> be the string "Request".</t>
            </li>
            <li pn="section-4.3.2-2.2">
              <t pn="section-4.3.2-2.2.1">id:  "String" (optional)</t>
              <t pn="section-4.3.2-2.2.2">A client-specified identifier for the request to be echoed
	      back in the response to this request.</t>
            </li>
          </ul>
          <t pn="section-4.3.2-3">JMAP over WebSocket allows the server to process requests
          out of order.  The client-specified identifier is used as a
          mechanism for the client to correlate requests and
          responses.</t>
          <t pn="section-4.3.2-4">Additionally, the "maxConcurrentRequests" limit in the
          "capabilities" object (see <xref target="RFC8620" sectionFormat="of" section="2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-2" derivedContent="RFC8620"/>) also applies to requests made on 
          the WebSocket connection.  When using the WebSocket JMAP
          subprotocol over a binding of HTTP that allows multiplexing
          of requests (e.g., HTTP/2), this limit applies to the sum
          of requests made on both the JMAP API endpoint and the
          WebSocket connection.</t>
        </section>
        <section anchor="responses" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.3">
          <name slugifiedName="name-jmap-responses">JMAP Responses</name>
          <t pn="section-4.3.3-1">The specification extends the Response object with two
          additional arguments when used over a WebSocket:

          </t>
          <ul spacing="normal" bare="false" empty="false" pn="section-4.3.3-2">
            <li pn="section-4.3.3-2.1">
              <t pn="section-4.3.3-2.1.1">@type:  "String"</t>
              <t pn="section-4.3.3-2.1.2">This <bcp14>MUST</bcp14> be the string "Response".</t>
            </li>
            <li pn="section-4.3.3-2.2">
              <t pn="section-4.3.3-2.2.1">requestId:  "String" (optional; <bcp14>MUST</bcp14> be
	      returned if an identifier is included in the request)</t>
              <t pn="section-4.3.3-2.2.2">The client-specified identifier in the corresponding
	      request.</t>
            </li>
          </ul>
        </section>
        <section anchor="errors" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.4">
          <name slugifiedName="name-jmap-request-level-errors">JMAP Request-Level Errors</name>
          <t pn="section-4.3.4-1">The specification extends the Problem Details object
          for request-level errors (see <xref target="RFC8620" sectionFormat="of" section="3.6.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-3.6.1" derivedContent="RFC8620"/>) with two additional arguments
	  when used over a WebSocket:</t>
          <ul spacing="normal" bare="false" empty="false" pn="section-4.3.4-2">
            <li pn="section-4.3.4-2.1">
              <t pn="section-4.3.4-2.1.1">@type:  "String"</t>
              <t pn="section-4.3.4-2.1.2">This <bcp14>MUST</bcp14> be the string "RequestError".</t>
            </li>
            <li pn="section-4.3.4-2.2">
              <t pn="section-4.3.4-2.2.1">requestId:  "String" (optional; <bcp14>MUST</bcp14> be
	      returned if given in the request)</t>
              <t pn="section-4.3.4-2.2.2">The client-specified identifier in the corresponding
	      request.</t>
            </li>
          </ul>
        </section>
        <section anchor="push" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.5">
          <name slugifiedName="name-jmap-push-notifications">JMAP Push Notifications</name>
          <t pn="section-4.3.5-1">JMAP-over-WebSocket servers that support push
          notifications on the WebSocket will advertise a
          "supportsPush" property with a value of true in
          the "urn:ietf:params:jmap:websocket" server capabilities
          object.</t>
          <section anchor="pushformat" numbered="true" toc="exclude" removeInRFC="false" pn="section-4.3.5.1">
            <name slugifiedName="name-notification-format">Notification Format</name>
            <t pn="section-4.3.5.1-1">All push notifications take the form of a standard
            StateChange object (see <xref target="RFC8620" sectionFormat="of" section="7.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-7.1" derivedContent="RFC8620"/>).</t>
            <t pn="section-4.3.5.1-2">The specification extends the StateChange object with one
            additional argument when used over a WebSocket:
            </t>
            <ul spacing="normal" bare="false" empty="false" pn="section-4.3.5.1-3">
              <li pn="section-4.3.5.1-3.1">
                <t pn="section-4.3.5.1-3.1.1">pushState:  "String" (optional)</t>
                <t pn="section-4.3.5.1-3.1.2">A (preferably short) string that encodes the entire server
		state visible to the user (not just the objects returned in
		this call).</t>
                <t pn="section-4.3.5.1-3.1.3">The purpose of the "pushState" token is to allow a client
		to immediately get any changes that occurred while it was
		disconnected (see <xref target="pushenable" format="default" sectionFormat="of" derivedContent="Section 4.3.5.2"/>). If the server does not support
		"pushState" tokens, the client will have to issue a series of
		"/changes" requests (see <xref target="RFC8620" sectionFormat="of" section="5.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-5.2" derivedContent="RFC8620"/>) upon reconnection to
		update its state to match that of the server.</t>
              </li>
            </ul>
          </section>
          <section anchor="pushenable" numbered="true" toc="exclude" removeInRFC="false" pn="section-4.3.5.2">
            <name slugifiedName="name-enabling-notifications">Enabling Notifications</name>
            <t pn="section-4.3.5.2-1">A client enables push notifications from the server for
            the current connection by
            sending a WebSocketPushEnable object to the server.  A
            WebSocketPushEnable object has the following properties:

            </t>
            <ul spacing="normal" bare="false" empty="false" pn="section-4.3.5.2-2">
              <li pn="section-4.3.5.2-2.1">
                <t pn="section-4.3.5.2-2.1.1">@type:  "String"</t>
                <t pn="section-4.3.5.2-2.1.2">This <bcp14>MUST</bcp14> be the string
		"WebSocketPushEnable".</t>
              </li>
              <li pn="section-4.3.5.2-2.2">
                <t pn="section-4.3.5.2-2.2.1">dataTypes:  "String[]|null"</t>
                <t pn="section-4.3.5.2-2.2.2">A list of data type names (e.g., "Mailbox" or "Email") that
		the client is interested in. A StateChange notification will
		only be sent if the data for one of these types changes.
		Other types are omitted from the TypeState object.  If null,
		changes will be pushed for all supported data types.</t>
              </li>
              <li pn="section-4.3.5.2-2.3">
                <t pn="section-4.3.5.2-2.3.1">pushState:  "String" (optional)</t>
                <t pn="section-4.3.5.2-2.3.2">The last "pushState" token that the client received from
		the server. Upon receipt of a "pushState" token, the server
		<bcp14>SHOULD</bcp14> immediately send all changes since that
		state token.</t>
              </li>
            </ul>
          </section>
          <section anchor="pushdisable" numbered="true" toc="exclude" removeInRFC="false" pn="section-4.3.5.3">
            <name slugifiedName="name-disabling-notifications">Disabling Notifications</name>
            <t pn="section-4.3.5.3-1">A client disables push notifications from the server
            for the current connection by
            sending a WebSocketPushDisable object to the server.  A
            WebSocketPushDisable object has the following property:

            </t>
            <ul spacing="normal" bare="false" empty="false" pn="section-4.3.5.3-2">
              <li pn="section-4.3.5.3-2.1">
                <t pn="section-4.3.5.3-2.1.1">@type:  "String"</t>
                <t pn="section-4.3.5.3-2.1.2">This <bcp14>MUST</bcp14> be the string "WebSocketPushDisable".</t>
              </li>
            </ul>
          </section>
        </section>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.4">
        <name slugifiedName="name-examples">Examples</name>
        <t pn="section-4.4-1">The following examples show WebSocket JMAP opening
        handshakes, a JMAP Core/echo request and response, and a
        subsequent closing handshake.
        The examples assume that the JMAP WebSocket URL endpoint has been
        advertised in the JMAP Session object as having a path of
        "/jmap/ws/" and that TLS negotiation has already succeeded. 
        Note that folding of header fields is for editorial purposes
        only.</t>
        <t keepWithNext="true" pn="section-4.4-2">
            WebSocket JMAP connection via HTTP/1.1 with push
            notifications for mail <xref target="RFC8621" format="default" sectionFormat="of" derivedContent="RFC8621"/>
	    is enabled. This example assumes that the client has cached
	    pushState "aaa" from a previous connection.
        </t>
        <artwork name="" type="" align="left" alt="" pn="section-4.4-3">
[[ From Client ]]                [[ From Server ]]

GET /jmap/ws/ HTTP/1.1
Host: server.example.com
Upgrade: websocket
Connection: Upgrade
Authorization: Basic Zm9vOmJhcg==
Sec-WebSocket-Key:
  dGhlIHNhbXBsZSBub25jZQ==
Sec-WebSocket-Protocol: jmap
Sec-WebSocket-Version: 13
Origin: https://www.example.com

                                 HTTP/1.1 101 Switching Protocols
                                 Upgrade: websocket
                                 Connection: Upgrade
                                 Sec-WebSocket-Accept:
                                   s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
                                 Sec-WebSocket-Protocol: jmap

[WebSocket connection established]

WS_DATA
{
  "@type": "WebSocketPushEnable",
  "dataTypes": [ "Mailbox", "Email" ],
  "pushState": "aaa"
}

                                 WS_DATA
                                 {
                                   "@type": "StateChange",
                                   "changed": {
                                     "a456": {
                                       "Mailbox": "d35ecb040aab"
                                     }
                                   },
                                   "pushState": "bbb"
                                 }

WS_DATA
{
  "@type": "Request",
  "id": "R1",
  "using": [ "urn:ietf:params:jmap:core" ],
  "methodCalls": [
    [
      "Core/echo", {
        "hello": true,
        "high": 5
      },
      "b3ff"
    ]
  ]
}

                                 WS_DATA
                                 {
                                   "@type": "Response",
                                   "requestId": "R1",
                                   "methodResponses": [
                                     [
                                       "Core/echo", {
                                         "hello": true,
                                         "high": 5
                                       },
                                       "b3ff"
                                     ]
                                   ]
                                 }

WS_DATA
The quick brown fox jumps
 over the lazy dog.

                                 WS_DATA
                                 {
                                   "@type": "RequestError",
                                   "requestId": null,
                                   "type":
                             "urn:ietf:params:jmap:error:notJSON",
                                   "status": 400,
                                   "detail":
                             "The request did not parse as I-JSON."
                                 }

[A new email is received]

                                 WS_DATA
                                 {
                                   "@type": "StateChange",
                                   "changed": {
                                     "a123": {
                                       "Email": "0af7a512ce70"
                                     }
                                   }
                                   "pushState": "ccc"
                                 }

WS_CLOSE

                                 WS_CLOSE

[WebSocket connection closed]
</artwork>
        <t keepWithNext="true" pn="section-4.4-4">
            WebSocket JMAP connection on an HTTP/2 stream that also
            negotiates <xref target="RFC7692" format="default" sectionFormat="of" derivedContent="RFC7692">compression</xref>:
        </t>
        <artwork name="" type="" align="left" alt="" pn="section-4.4-5">
[[ From Client ]]                [[ From Server ]]

                                 SETTINGS
                                 SETTINGS_ENABLE_CONNECT_PROTOCOL = 1

HEADERS + END_HEADERS
:method = CONNECT
:protocol = websocket
:scheme = https
:path = /jmap/ws/
:authority = server.example.com
origin: https://example.com
authorization = Basic Zm9vOmJhcg==
sec-websocket-protocol = jmap
sec-websocket-version = 13
sec-websocket-extensions =
  permessage-deflate
origin = https://www.example.com

                                 HEADERS + END_HEADERS
                                 :status = 200
                                 sec-websocket-protocol = jmap
                                 sec-websocket-extensions =
                                   permessage-deflate

[WebSocket connection established]

DATA
WS_DATA
[compressed text]

                                 DATA
                                 WS_DATA
                                 [compressed text]

...

DATA + END_STREAM
WS_CLOSE

                                 DATA + END_STREAM
                                 WS_CLOSE

[WebSocket connection closed]
[HTTP/2 stream closed]
</artwork>
      </section>
    </section>
    <section anchor="security" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t pn="section-5-1">The security considerations for both WebSocket (see <xref target="RFC6455" sectionFormat="of" section="10" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-10" derivedContent="RFC6455"/>) and JMAP (see <xref target="RFC8620" sectionFormat="of" section="8" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8620#section-8" derivedContent="RFC8620"/>) apply to the
      WebSocket JMAP subprotocol. Specific security considerations are
      described below.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-connection-confidentiality-">Connection Confidentiality and Integrity</name>
        <t pn="section-5.1-1">To ensure the confidentiality and integrity of
        data sent and received via JMAP over WebSocket, the WebSocket
        connection <bcp14>MUST</bcp14> use <xref target="RFC5246" format="default" sectionFormat="of" derivedContent="RFC5246">TLS 1.2</xref>
        or later, following the recommendations in <xref target="RFC7525" format="default" sectionFormat="of" derivedContent="RFC7525">BCP 195</xref>.
        Servers <bcp14>SHOULD</bcp14> support <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446">TLS 1.3</xref> or
        later.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-non-browser-clients">Non-browser Clients</name>
        <t pn="section-5.2-1">JMAP over WebSocket can be used by clients both running
        inside and outside of a web browser.  As such, the security
        considerations in Sections <xref target="RFC6455" section="10.2" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-10.2" derivedContent="RFC6455"/> and <xref target="RFC6455" section="10.1" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6455#section-10.1" derivedContent="RFC6455"/> of <xref target="RFC6455" format="default" sectionFormat="of" derivedContent="RFC6455"/>
	apply to those respective environments.</t>
      </section>
    </section>
    <section anchor="iana" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-6.1">
        <name slugifiedName="name-registration-of-the-websock">Registration of the WebSocket JMAP Subprotocol</name>
        <t pn="section-6.1-1">Per this specification, IANA has registered the following in the
	"WebSocket Subprotocol Name Registry" within the "WebSocket Protocol
	Registries".  

        </t>
        <dl newline="false" spacing="normal" pn="section-6.1-2">
          <dt pn="section-6.1-2.1">Subprotocol Identifier:</dt>
          <dd pn="section-6.1-2.2">jmap</dd>
          <dt pn="section-6.1-2.3">Subprotocol Common Name:</dt>
          <dd pn="section-6.1-2.4">WebSocket Transport for JMAP (JSON Meta Application
	  Protocol)</dd>
          <dt pn="section-6.1-2.5">Subprotocol Definition:</dt>
          <dd pn="section-6.1-2.6">RFC 8887</dd>
        </dl>
      </section>
    </section>
  </middle>
  <back>
    <references pn="section-7">
      <name slugifiedName="name-references">References</name>
      <references pn="section-7.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC2818" target="https://www.rfc-editor.org/info/rfc2818" quoteTitle="true" derivedAnchor="RFC2818">
          <front>
            <title>HTTP Over TLS</title>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2000" month="May"/>
            <abstract>
              <t>This memo describes how to use Transport Layer Security (TLS) to secure Hypertext Transfer Protocol (HTTP) connections over the Internet.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2818"/>
          <seriesInfo name="DOI" value="10.17487/RFC2818"/>
        </reference>
        <reference anchor="RFC5246" target="https://www.rfc-editor.org/info/rfc5246" quoteTitle="true" derivedAnchor="RFC5246">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.2</title>
            <author initials="T." surname="Dierks" fullname="T. Dierks">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="August"/>
            <abstract>
              <t>This document specifies Version 1.2 of the Transport Layer Security (TLS) protocol.  The TLS protocol provides communications security over the Internet.  The protocol allows client/server applications to communicate in a way that is designed to prevent eavesdropping, tampering, or message forgery.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5246"/>
          <seriesInfo name="DOI" value="10.17487/RFC5246"/>
        </reference>
        <reference anchor="RFC6455" target="https://www.rfc-editor.org/info/rfc6455" quoteTitle="true" derivedAnchor="RFC6455">
          <front>
            <title>The WebSocket Protocol</title>
            <author initials="I." surname="Fette" fullname="I. Fette">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Melnikov" fullname="A. Melnikov">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="December"/>
            <abstract>
              <t>The WebSocket Protocol enables two-way communication between a client running untrusted code in a controlled environment to a remote host that has opted-in to communications from that code.  The security model used for this is the origin-based security model commonly used by web browsers.  The protocol consists of an opening handshake followed by basic message framing, layered over TCP.  The goal of this technology is to provide a mechanism for browser-based applications that need two-way communication with servers that does not rely on opening multiple HTTP connections (e.g., using XMLHttpRequest or &lt;iframe&gt;s and long polling).  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6455"/>
          <seriesInfo name="DOI" value="10.17487/RFC6455"/>
        </reference>
        <reference anchor="RFC7235" target="https://www.rfc-editor.org/info/rfc7235" quoteTitle="true" derivedAnchor="RFC7235">
          <front>
            <title>Hypertext Transfer Protocol (HTTP/1.1): Authentication</title>
            <author initials="R." surname="Fielding" fullname="R. Fielding" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Reschke" fullname="J. Reschke" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="June"/>
            <abstract>
              <t>The Hypertext Transfer Protocol (HTTP) is a stateless application- level protocol for distributed, collaborative, hypermedia information systems.  This document defines the HTTP Authentication framework.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7235"/>
          <seriesInfo name="DOI" value="10.17487/RFC7235"/>
        </reference>
        <reference anchor="RFC7525" target="https://www.rfc-editor.org/info/rfc7525" quoteTitle="true" derivedAnchor="RFC7525">
          <front>
            <title>Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</title>
            <author initials="Y." surname="Sheffer" fullname="Y. Sheffer">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Holz" fullname="R. Holz">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Saint-Andre" fullname="P. Saint-Andre">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="May"/>
            <abstract>
              <t>Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS) are widely used to protect data exchanged over application protocols such as HTTP, SMTP, IMAP, POP, SIP, and XMPP.  Over the last few years, several serious attacks on TLS have emerged, including attacks on its most commonly used cipher suites and their modes of operation.  This document provides recommendations for improving the security of deployed services that use TLS and DTLS. The recommendations are applicable to the majority of use cases.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="195"/>
          <seriesInfo name="RFC" value="7525"/>
          <seriesInfo name="DOI" value="10.17487/RFC7525"/>
        </reference>
        <reference anchor="RFC7540" target="https://www.rfc-editor.org/info/rfc7540" quoteTitle="true" derivedAnchor="RFC7540">
          <front>
            <title>Hypertext Transfer Protocol Version 2 (HTTP/2)</title>
            <author initials="M." surname="Belshe" fullname="M. Belshe">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Peon" fullname="R. Peon">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Thomson" fullname="M. Thomson" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="May"/>
            <abstract>
              <t>This specification describes an optimized expression of the semantics of the Hypertext Transfer Protocol (HTTP), referred to as HTTP version 2 (HTTP/2).  HTTP/2 enables a more efficient use of network resources and a reduced perception of latency by introducing header field compression and allowing multiple concurrent exchanges on the same connection.  It also introduces unsolicited push of representations from servers to clients.</t>
              <t>This specification is an alternative to, but does not obsolete, the HTTP/1.1 message syntax.  HTTP's existing semantics remain unchanged.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7540"/>
          <seriesInfo name="DOI" value="10.17487/RFC7540"/>
        </reference>
        <reference anchor="RFC7692" target="https://www.rfc-editor.org/info/rfc7692" quoteTitle="true" derivedAnchor="RFC7692">
          <front>
            <title>Compression Extensions for WebSocket</title>
            <author initials="T." surname="Yoshino" fullname="T. Yoshino">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="December"/>
            <abstract>
              <t>This document defines a framework for creating WebSocket extensions that add compression functionality to the WebSocket Protocol.  An extension based on this framework compresses the payload data portion of WebSocket data messages on a per-message basis using parameters negotiated during the opening handshake.  This framework provides a general method for applying a compression algorithm to the contents of WebSocket messages.  Each compression algorithm has to be defined in a document defining the extension by specifying the parameter negotiation and the payload transformation algorithm in detail.  This document also specifies one specific compression extension using the DEFLATE algorithm.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7692"/>
          <seriesInfo name="DOI" value="10.17487/RFC7692"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t>RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8441" target="https://www.rfc-editor.org/info/rfc8441" quoteTitle="true" derivedAnchor="RFC8441">
          <front>
            <title>Bootstrapping WebSockets with HTTP/2</title>
            <author initials="P." surname="McManus" fullname="P. McManus">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="September"/>
            <abstract>
              <t>This document defines a mechanism for running the WebSocket Protocol (RFC 6455) over a single stream of an HTTP/2 connection.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8441"/>
          <seriesInfo name="DOI" value="10.17487/RFC8441"/>
        </reference>
        <reference anchor="RFC8446" target="https://www.rfc-editor.org/info/rfc8446" quoteTitle="true" derivedAnchor="RFC8446">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="August"/>
            <abstract>
              <t>This document specifies version 1.3 of the Transport Layer Security (TLS) protocol.  TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t>
              <t>This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961.  This document also specifies new requirements for TLS 1.2 implementations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8446"/>
          <seriesInfo name="DOI" value="10.17487/RFC8446"/>
        </reference>
        <reference anchor="RFC8620" target="https://www.rfc-editor.org/info/rfc8620" quoteTitle="true" derivedAnchor="RFC8620">
          <front>
            <title>The JSON Meta Application Protocol (JMAP)</title>
            <author initials="N." surname="Jenkins" fullname="N. Jenkins">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Newman" fullname="C. Newman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="July"/>
            <abstract>
              <t>This document specifies a protocol for clients to efficiently query, fetch, and modify JSON-based data objects, with support for push notification of changes and fast resynchronisation and for out-of- band binary data upload/download.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8620"/>
          <seriesInfo name="DOI" value="10.17487/RFC8620"/>
        </reference>
      </references>
      <references pn="section-7.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="RFC8621" target="https://www.rfc-editor.org/info/rfc8621" quoteTitle="true" derivedAnchor="RFC8621">
          <front>
            <title>The JSON Meta Application Protocol (JMAP) for Mail</title>
            <author initials="N." surname="Jenkins" fullname="N. Jenkins">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Newman" fullname="C. Newman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="August"/>
            <abstract>
              <t>This document specifies a data model for synchronising email data with a server using the JSON Meta Application Protocol (JMAP). Clients can use this to efficiently search, access, organise, and send messages, and to get push notifications for fast resynchronisation when new messages are delivered or a change is made in another client.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8621"/>
          <seriesInfo name="DOI" value="10.17487/RFC8621"/>
        </reference>
      </references>
    </references>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t pn="section-appendix.a-1">The author would like to thank the following individuals for
      contributing their ideas and support for writing this
      specification: <contact fullname="Neil Jenkins"/>, <contact fullname="Robert Mueller"/>, and <contact fullname="Chris Newman"/>.</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-address">Author's Address</name>
      <author initials="K." surname="Murchison" fullname="Kenneth Murchison">
        <organization abbrev="Fastmail" showOnFrontPage="true">Fastmail US LLC</organization>
        <address>
          <postal>
            <street>1429 Walnut Street, Suite 1201</street>
            <city>Philadelphia</city>
            <region>PA</region>
            <code>19102</code>
            <country>United States of America</country>
          </postal>
          <email>murch@fastmailteam.com</email>
          <uri>http://www.fastmail.com/</uri>
        </address>
      </author>
    </section>
  </back>
</rfc>
