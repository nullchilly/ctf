<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-dprive-dnsoquic-11" indexInclude="true" ipr="trust200902" number="9250" prepTime="2022-05-11T16:24:17" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dprive-dnsoquic-11" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9250" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="DNS over Dedicated QUIC">DNS over Dedicated QUIC Connections</title>
    <seriesInfo name="RFC" value="9250" stream="IETF"/>
    <author initials="C" surname="Huitema" fullname="Christian Huitema">
      <organization showOnFrontPage="true">Private Octopus Inc.</organization>
      <address>
        <postal>
          <street>427 Golfcourse Rd</street>
          <city>Friday Harbor</city>
          <code>WA 98250</code>
          <country>USA</country>
        </postal>
        <email>huitema@huitema.net</email>
      </address>
    </author>
    <author initials="S." surname="Dickinson" fullname="Sara Dickinson">
      <organization showOnFrontPage="true">Sinodun IT</organization>
      <address>
        <postal>
          <street>Oxford Science Park</street>
          <city>Oxford</city>
          <code>OX4 4GA</code>
          <country>United Kingdom</country>
        </postal>
        <email>sara@sinodun.com</email>
      </address>
    </author>
    <author initials="A." surname="Mankin" fullname="Allison Mankin">
      <organization showOnFrontPage="true">Salesforce</organization>
      <address>
        <email>allison.mankin@gmail.com</email>
      </address>
    </author>
    <date month="05" year="2022"/>
    <area>Internet</area>
    <workgroup>DNS PRIVate Exchange</workgroup>
    <keyword>DNS</keyword>
    <keyword>QUIC</keyword>
    <keyword>DNS over QUIC</keyword>
    <keyword>Encrypted DNS</keyword>
    <keyword>DoQ</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">This document describes the use of QUIC to provide transport confidentiality for DNS.
The encryption provided by QUIC has similar properties to those provided by TLS,
while QUIC transport eliminates the head-of-line blocking issues inherent with
TCP and provides more efficient packet-loss recovery than UDP. DNS over QUIC
(DoQ) has privacy properties similar to DNS over TLS (DoT) specified in
RFC 7858, and latency characteristics similar to classic DNS over UDP. This
specification describes the use of DoQ as a general-purpose transport
for DNS and includes the use of DoQ for stub to recursive,
recursive to authoritative, and zone transfer scenarios.</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9250" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-words">Key Words</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-design-considerations">Design Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2">
              <li pn="section-toc.1-1.3.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.3.2.1.1"><xref derivedContent="3.1" format="counter" sectionFormat="of" target="section-3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-provide-dns-privacy">Provide DNS Privacy</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.2">
                <t indent="0" pn="section-toc.1-1.3.2.2.1"><xref derivedContent="3.2" format="counter" sectionFormat="of" target="section-3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-design-for-minimum-latency">Design for Minimum Latency</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.3">
                <t indent="0" pn="section-toc.1-1.3.2.3.1"><xref derivedContent="3.3" format="counter" sectionFormat="of" target="section-3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-middlebox-considerations">Middlebox Considerations</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.4">
                <t indent="0" pn="section-toc.1-1.3.2.4.1"><xref derivedContent="3.4" format="counter" sectionFormat="of" target="section-3.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-no-server-initiated-transac">No Server-Initiated Transactions</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-specifications">Specifications</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-connection-establishment">Connection Establishment</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.1.2">
                  <li pn="section-toc.1-1.4.2.1.2.1">
                    <t indent="0" pn="section-toc.1-1.4.2.1.2.1.1"><xref derivedContent="4.1.1" format="counter" sectionFormat="of" target="section-4.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-port-selection">Port Selection</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stream-mapping-and-usage">Stream Mapping and Usage</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.2.2">
                  <li pn="section-toc.1-1.4.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.1.1"><xref derivedContent="4.2.1" format="counter" sectionFormat="of" target="section-4.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-dns-message-ids">DNS Message IDs</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-doq-error-codes">DoQ Error Codes</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.3.2">
                  <li pn="section-toc.1-1.4.2.3.2.1">
                    <t indent="0" pn="section-toc.1-1.4.2.3.2.1.1"><xref derivedContent="4.3.1" format="counter" sectionFormat="of" target="section-4.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-transaction-cancellation">Transaction Cancellation</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.3.2.2">
                    <t indent="0" pn="section-toc.1-1.4.2.3.2.2.1"><xref derivedContent="4.3.2" format="counter" sectionFormat="of" target="section-4.3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-transaction-errors">Transaction Errors</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.3.2.3">
                    <t indent="0" pn="section-toc.1-1.4.2.3.2.3.1"><xref derivedContent="4.3.3" format="counter" sectionFormat="of" target="section-4.3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-protocol-errors">Protocol Errors</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.3.2.4">
                    <t indent="0" pn="section-toc.1-1.4.2.3.2.4.1"><xref derivedContent="4.3.4" format="counter" sectionFormat="of" target="section-4.3.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-alternative-error-codes">Alternative Error Codes</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.4.2.4">
                <t indent="0" pn="section-toc.1-1.4.2.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-connection-management">Connection Management</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.5">
                <t indent="0" pn="section-toc.1-1.4.2.5.1"><xref derivedContent="4.5" format="counter" sectionFormat="of" target="section-4.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-session-resumption-and-0-rt">Session Resumption and 0-RTT</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.6">
                <t indent="0" pn="section-toc.1-1.4.2.6.1"><xref derivedContent="4.6" format="counter" sectionFormat="of" target="section-4.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-message-sizes">Message Sizes</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-implementation-requirements">Implementation Requirements</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-authentication">Authentication</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-fallback-to-other-protocols">Fallback to Other Protocols on Connection Failure</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t indent="0" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-address-validation">Address Validation</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.4">
                <t indent="0" pn="section-toc.1-1.5.2.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-padding">Padding</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.5">
                <t indent="0" pn="section-toc.1-1.5.2.5.1"><xref derivedContent="5.5" format="counter" sectionFormat="of" target="section-5.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-connection-handling">Connection Handling</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2.5.2">
                  <li pn="section-toc.1-1.5.2.5.2.1">
                    <t indent="0" pn="section-toc.1-1.5.2.5.2.1.1"><xref derivedContent="5.5.1" format="counter" sectionFormat="of" target="section-5.5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-connection-reuse">Connection Reuse</xref></t>
                  </li>
                  <li pn="section-toc.1-1.5.2.5.2.2">
                    <t indent="0" pn="section-toc.1-1.5.2.5.2.2.1"><xref derivedContent="5.5.2" format="counter" sectionFormat="of" target="section-5.5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-resource-management">Resource Management</xref></t>
                  </li>
                  <li pn="section-toc.1-1.5.2.5.2.3">
                    <t indent="0" pn="section-toc.1-1.5.2.5.2.3.1"><xref derivedContent="5.5.3" format="counter" sectionFormat="of" target="section-5.5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-using-0-rtt-and-session-res">Using 0-RTT and Session Resumption</xref></t>
                  </li>
                  <li pn="section-toc.1-1.5.2.5.2.4">
                    <t indent="0" pn="section-toc.1-1.5.2.5.2.4.1"><xref derivedContent="5.5.4" format="counter" sectionFormat="of" target="section-5.5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-controlling-connection-migr">Controlling Connection Migration for Privacy</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.5.2.6">
                <t indent="0" pn="section-toc.1-1.5.2.6.1"><xref derivedContent="5.6" format="counter" sectionFormat="of" target="section-5.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-processing-queries-in-paral">Processing Queries in Parallel</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.7">
                <t indent="0" pn="section-toc.1-1.5.2.7.1"><xref derivedContent="5.7" format="counter" sectionFormat="of" target="section-5.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-zone-transfer">Zone Transfer</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.8">
                <t indent="0" pn="section-toc.1-1.5.2.8.1"><xref derivedContent="5.8" format="counter" sectionFormat="of" target="section-5.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-flow-control-mechanisms">Flow Control Mechanisms</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy-considerations">Privacy Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t indent="0" pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy-issues-with-0-rtt-d">Privacy Issues with 0-RTT data</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.2">
                <t indent="0" pn="section-toc.1-1.7.2.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy-issues-with-session">Privacy Issues with Session Resumption</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.3">
                <t indent="0" pn="section-toc.1-1.7.2.3.1"><xref derivedContent="7.3" format="counter" sectionFormat="of" target="section-7.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy-issues-with-address">Privacy Issues with Address Validation Tokens</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.4">
                <t indent="0" pn="section-toc.1-1.7.2.4.1"><xref derivedContent="7.4" format="counter" sectionFormat="of" target="section-7.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy-issues-with-long-du">Privacy Issues with Long Duration Sessions</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.5">
                <t indent="0" pn="section-toc.1-1.7.2.5.1"><xref derivedContent="7.5" format="counter" sectionFormat="of" target="section-7.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-traffic-analysis">Traffic Analysis</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2">
              <li pn="section-toc.1-1.8.2.1">
                <t indent="0" pn="section-toc.1-1.8.2.1.1"><xref derivedContent="8.1" format="counter" sectionFormat="of" target="section-8.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-registration-of-a-doq-ident">Registration of a DoQ Identification String</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.2">
                <t indent="0" pn="section-toc.1-1.8.2.2.1"><xref derivedContent="8.2" format="counter" sectionFormat="of" target="section-8.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-reservation-of-a-dedicated-">Reservation of a Dedicated Port</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.3">
                <t indent="0" pn="section-toc.1-1.8.2.3.1"><xref derivedContent="8.3" format="counter" sectionFormat="of" target="section-8.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-reservation-of-an-extended-">Reservation of an Extended DNS Error Code: Too Early</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.4">
                <t indent="0" pn="section-toc.1-1.8.2.4.1"><xref derivedContent="8.4" format="counter" sectionFormat="of" target="section-8.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-dns-over-quic-error-codes-r">DNS-over-QUIC Error Codes Registry</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2">
              <li pn="section-toc.1-1.9.2.1">
                <t indent="0" pn="section-toc.1-1.9.2.1.1"><xref derivedContent="9.1" format="counter" sectionFormat="of" target="section-9.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.2">
                <t indent="0" pn="section-toc.1-1.9.2.2.1"><xref derivedContent="9.2" format="counter" sectionFormat="of" target="section-9.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-the-notify-service">The NOTIFY Service</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.c"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">Domain Name System (DNS) concepts are specified in "Domain names - concepts and
facilities" <xref target="RFC1034" format="default" sectionFormat="of" derivedContent="RFC1034"/>. The transmission of DNS queries and responses over
UDP and TCP is specified in "Domain names - implementation and specification"
<xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>.</t>
      <t indent="0" pn="section-1-2">This document presents a mapping of the DNS protocol over the
QUIC transport <xref target="RFC9000" format="default" sectionFormat="of" derivedContent="RFC9000"/> <xref target="RFC9001" format="default" sectionFormat="of" derivedContent="RFC9001"/>. DNS over QUIC is referred to here as DoQ,
in line with "DNS Terminology" <xref target="I-D.ietf-dnsop-rfc8499bis" format="default" sectionFormat="of" derivedContent="DNS-TERMS"/>.</t>
      <t indent="0" pn="section-1-3">The goals of the DoQ mapping are:</t>
      <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-1-4"><li pn="section-1-4.1" derivedCounter="1.">Provide the same DNS privacy protection as DoT
<xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>. This includes an option for the client to
authenticate the server by means of an authentication domain
name as specified in "Usage Profiles for DNS over TLS and DNS
over DTLS" <xref target="RFC8310" format="default" sectionFormat="of" derivedContent="RFC8310"/>.</li>
        <li pn="section-1-4.2" derivedCounter="2.">Provide an improved level of source address validation for DNS
servers compared to classic DNS over UDP.</li>
        <li pn="section-1-4.3" derivedCounter="3.">Provide a transport that does not impose path MTU limitations on the
size of DNS responses it can send.</li>
      </ol>
      <t indent="0" pn="section-1-5">In order to achieve these goals, and to support ongoing work on encryption of
DNS, the scope of this document includes:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-1-6">
        <li pn="section-1-6.1">the "stub to recursive resolver" scenario (also called the "stub to recursive" scenario in this document)</li>
        <li pn="section-1-6.2">the "recursive resolver to authoritative nameserver" scenario (also called the "recursive to authoritative" scenario in this document), and</li>
        <li pn="section-1-6.3">the "nameserver to nameserver" scenario (mainly used for zone transfers (XFR) <xref target="RFC1995" format="default" sectionFormat="of" derivedContent="RFC1995"/> <xref target="RFC5936" format="default" sectionFormat="of" derivedContent="RFC5936"/>).</li>
      </ul>
      <t indent="0" pn="section-1-7">In other words, this document specifies QUIC as a general-purpose
transport for DNS.</t>
      <t indent="0" pn="section-1-8">The specific non-goals of this document are:</t>
      <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-1-9"><li pn="section-1-9.1" derivedCounter="1.">No attempt is made to evade potential blocking of DoQ
traffic by middleboxes.</li>
        <li pn="section-1-9.2" derivedCounter="2.">No attempt to support server-initiated transactions, which are used only in
DNS Stateful Operations (DSO) <xref target="RFC8490" format="default" sectionFormat="of" derivedContent="RFC8490"/>.</li>
      </ol>
      <t indent="0" pn="section-1-10">Specifying the transmission of an application over QUIC requires specifying how
the application's messages are mapped to QUIC streams, and generally how the
application will use QUIC. This is done for HTTP in "Hypertext Transfer
Protocol Version 3 (HTTP/3)" <xref target="I-D.ietf-quic-http" format="default" sectionFormat="of" derivedContent="HTTP/3"/>. The purpose of this
document is to define the way DNS messages can be transmitted over QUIC.</t>
      <t indent="0" pn="section-1-11">DNS over HTTPS (DoH) <xref target="RFC8484" format="default" sectionFormat="of" derivedContent="RFC8484"/> can be used with HTTP/3 to get some of the
benefits of QUIC. However, a lightweight direct mapping for DoQ can
be regarded as a more natural fit for both the recursive to authoritative and
zone transfer scenarios, which rarely involve intermediaries. In these
scenarios, the additional overhead of HTTP is not offset by, for example, benefits of
HTTP proxying and caching behavior.</t>
      <t indent="0" pn="section-1-12">In this document, <xref target="design-considerations" format="default" sectionFormat="of" derivedContent="Section 3"/> presents the reasoning that guided
the proposed design. <xref target="specifications" format="default" sectionFormat="of" derivedContent="Section 4"/> specifies the actual mapping of DoQ.
<xref target="implementation-requirements" format="default" sectionFormat="of" derivedContent="Section 5"/> presents guidelines on the implementation,
usage, and deployment of DoQ.</t>
    </section>
    <section anchor="key-words" numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-key-words">Key Words</name>
      <t indent="0" pn="section-2-1">                                                                                                
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
    "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>",
    "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are
    to be interpreted as described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/>
        <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> when, and only when, they appear in all capitals,
    as shown here.
      </t>
    </section>
    <section anchor="design-considerations" numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-design-considerations">Design Considerations</name>
      <t indent="0" pn="section-3-1">This section and its subsections present the design guidelines that were used
for DoQ. While all other sections in this document are normative, this section
is informative in nature.</t>
      <section anchor="provide-dns-privacy" numbered="true" toc="include" removeInRFC="false" pn="section-3.1">
        <name slugifiedName="name-provide-dns-privacy">Provide DNS Privacy</name>
        <t indent="0" pn="section-3.1-1">DoT <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/> defines how to mitigate some of the issues described in "DNS
Privacy Considerations" <xref target="RFC9076" format="default" sectionFormat="of" derivedContent="RFC9076"/> by specifying how to transmit DNS messages
over TLS. The "Usage Profiles for DNS over TLS and DNS over DTLS" <xref target="RFC8310" format="default" sectionFormat="of" derivedContent="RFC8310"/>
specify Strict and Opportunistic usage profiles for DoT including how stub
resolvers can authenticate recursive resolvers.</t>
        <t indent="0" pn="section-3.1-2">QUIC connection setup includes the negotiation of security parameters using
TLS, as specified in "Using TLS to Secure QUIC" <xref target="RFC9001" format="default" sectionFormat="of" derivedContent="RFC9001"/>,
enabling encryption of the QUIC transport. Transmitting DNS messages over QUIC
will provide essentially the same privacy protections as DoT <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>
including Strict and Opportunistic usage profiles <xref target="RFC8310" format="default" sectionFormat="of" derivedContent="RFC8310"/>. Further
discussion on this is provided in <xref target="privacy-considerations" format="default" sectionFormat="of" derivedContent="Section 7"/>.</t>
      </section>
      <section anchor="design-for-minimum-latency" numbered="true" toc="include" removeInRFC="false" pn="section-3.2">
        <name slugifiedName="name-design-for-minimum-latency">Design for Minimum Latency</name>
        <t indent="0" pn="section-3.2-1">QUIC is specifically designed to reduce protocol-induced delays, with features
such as:</t>
        <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-3.2-2"><li pn="section-3.2-2.1" derivedCounter="1.">Support for 0-RTT data during session resumption.</li>
          <li pn="section-3.2-2.2" derivedCounter="2.">Support for advanced packet-loss recovery procedures as specified in
"QUIC Loss Detection and Congestion Control" <xref target="RFC9002" format="default" sectionFormat="of" derivedContent="RFC9002"/>.</li>
          <li pn="section-3.2-2.3" derivedCounter="3.">Mitigation of head-of-line blocking by allowing parallel
delivery of data on multiple streams.</li>
        </ol>
        <t indent="0" pn="section-3.2-3">This mapping of DNS to QUIC will take advantage of these features in
three ways:</t>
        <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-3.2-4"><li pn="section-3.2-4.1" derivedCounter="1.">Optional support for sending 0-RTT data during session resumption
(the security and privacy implications of this are discussed
in later sections).</li>
          <li pn="section-3.2-4.2" derivedCounter="2.">Long-lived QUIC connections over which multiple DNS transactions
are performed,
generating the sustained traffic required to benefit from
advanced recovery features.</li>
          <li pn="section-3.2-4.3" derivedCounter="3.">Mapping of each DNS Query/Response transaction to a separate stream,
to mitigate head-of-line blocking. This enables servers to respond
to queries "out of order". It also enables clients to process
responses as soon as they arrive, without having to wait for in-order delivery of responses previously posted by the server.</li>
        </ol>
        <t indent="0" pn="section-3.2-5">These considerations are reflected in the mapping of DNS traffic
to QUIC streams in <xref target="stream-mapping-and-usage" format="default" sectionFormat="of" derivedContent="Section 4.2"/>.</t>
      </section>
      <section anchor="middlebox-considerations" numbered="true" toc="include" removeInRFC="false" pn="section-3.3">
        <name slugifiedName="name-middlebox-considerations">Middlebox Considerations</name>
        <t indent="0" pn="section-3.3-1">Using QUIC might allow a protocol to disguise its purpose from devices on the
network path using encryption and traffic analysis resistance techniques like
padding, traffic pacing, and traffic shaping. This specification does not
include any measures that are designed to avoid such classification;
the padding mechanisms defined in <xref target="padding" format="default" sectionFormat="of" derivedContent="Section 5.4"/> are intended to obfuscate the specific
records contained in DNS queries and responses, but not the fact that this is DNS traffic.
Consequently, firewalls and other middleboxes might
be able to distinguish DoQ from other protocols that use QUIC, like HTTP, and
apply different treatment.</t>
        <t indent="0" pn="section-3.3-2">The lack of measures in this specification to avoid protocol classification is 
not an endorsement of such practices.</t>
      </section>
      <section anchor="no-server-initiated-transactions" numbered="true" toc="include" removeInRFC="false" pn="section-3.4">
        <name slugifiedName="name-no-server-initiated-transac">No Server-Initiated Transactions</name>
        <t indent="0" pn="section-3.4-1">As stated in <xref target="introduction" format="default" sectionFormat="of" derivedContent="Section 1"/>, this document does not specify support for
server-initiated transactions within established DoQ connections. That is, only
the initiator of the DoQ connection may send queries over the connection.</t>
        <t indent="0" pn="section-3.4-2">DSO does support server-initiated transactions within existing connections.
However, DoQ as defined here does not meet the criteria for an applicable
transport for DSO because it does not guarantee in-order delivery of messages;
see <xref section="4.2" sectionFormat="of" target="RFC8490" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8490#section-4.2" derivedContent="RFC8490"/>.</t>
      </section>
    </section>
    <section anchor="specifications" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-specifications">Specifications</name>
      <section anchor="connection-establishment" numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-connection-establishment">Connection Establishment</name>
        <t indent="0" pn="section-4.1-1">DoQ connections are established as described in the QUIC transport
specification <xref target="RFC9000" format="default" sectionFormat="of" derivedContent="RFC9000"/>. During connection establishment, DoQ support is
indicated by selecting the Application-Layer Protocol Negotiation (ALPN) token "doq" in the crypto handshake.</t>
        <section anchor="port-selection" numbered="true" toc="include" removeInRFC="false" pn="section-4.1.1">
          <name slugifiedName="name-port-selection">Port Selection</name>
          <t indent="0" pn="section-4.1.1-1">By default, a DNS server that supports DoQ <bcp14>MUST</bcp14> listen for and accept QUIC
connections on the dedicated UDP port 853 (<xref target="iana-considerations" format="default" sectionFormat="of" derivedContent="Section 8"/>), unless there is a mutual agreement to
use another port.</t>
          <t indent="0" pn="section-4.1.1-2">By default, a DNS client desiring to use DoQ with a particular server <bcp14>MUST</bcp14>
establish a QUIC connection to UDP port 853 on the server, unless there is a
mutual agreement to use another port.</t>
          <t indent="0" pn="section-4.1.1-3">DoQ connections <bcp14>MUST NOT</bcp14> use UDP port 53. This recommendation against use of
port 53 for DoQ is to avoid confusion between DoQ and the use of DNS over UDP
<xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>. The risk of confusion exists even if two parties agreed on
port 53, as other parties without knowledge of that agreement might still
try to use that port.</t>
          <t indent="0" pn="section-4.1.1-4">In the stub to recursive scenario, the use of port 443 as a mutually agreed
alternative port can be operationally beneficial, since port 443 is 
used by many services using QUIC and HTTP-3 and is thus less likely
to be blocked than other ports. Several mechanisms for stubs to discover
recursives offering encrypted transports, including the use of custom ports, are
the subject of ongoing work.</t>
        </section>
      </section>
      <section anchor="stream-mapping-and-usage" numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-stream-mapping-and-usage">Stream Mapping and Usage</name>
        <t indent="0" pn="section-4.2-1">The mapping of DNS traffic over QUIC streams takes advantage of the QUIC stream
features detailed in <xref section="2" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-2" derivedContent="RFC9000"/>, the QUIC transport specification.</t>
        <t indent="0" pn="section-4.2-2">DNS query/response traffic <xref target="RFC1034" format="default" sectionFormat="of" derivedContent="RFC1034"/> <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>
follows a simple pattern in which the client sends a query, and the
server provides one or more responses (multiple responses can occur in zone
transfers).</t>
        <t indent="0" pn="section-4.2-3">The mapping specified here requires that the client select a separate QUIC
stream for each query. The server then uses the same stream to provide all the
response messages for that query. In order for multiple responses to be
parsed, a 2-octet length field is used in exactly the same way as the 2-octet
length field defined for DNS over TCP <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>. The practical result of this
is that the content of each QUIC stream is exactly the same as the content of a
TCP connection that would manage exactly one query.</t>
        <t indent="0" pn="section-4.2-4">All DNS messages (queries and responses) sent over DoQ connections <bcp14>MUST</bcp14> be
encoded as a 2-octet length field followed by the message content as specified
in <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>.</t>
        <t indent="0" pn="section-4.2-5">The client <bcp14>MUST</bcp14> select the next available client-initiated bidirectional stream
for each subsequent query on a QUIC connection, in conformance with the QUIC
transport specification <xref target="RFC9000" format="default" sectionFormat="of" derivedContent="RFC9000"/>. Packet losses and other network events might
cause queries to arrive in a different order. Servers <bcp14>SHOULD</bcp14> process queries
as they arrive, as not doing so would cause unnecessary delays.</t>
        <t indent="0" pn="section-4.2-6">The client <bcp14>MUST</bcp14> send the DNS query over the selected stream and <bcp14>MUST</bcp14> indicate
through the STREAM FIN mechanism that no further data will be sent on that
stream.</t>
        <t indent="0" pn="section-4.2-7">The server <bcp14>MUST</bcp14> send the response(s) on the same stream and <bcp14>MUST</bcp14> indicate, after
the last response, through the STREAM FIN mechanism that no further data will be
sent on that stream.</t>
        <t indent="0" pn="section-4.2-8">Therefore, a single DNS transaction consumes a single bidirectional client-initiated stream.
This means that the client's first query occurs on QUIC stream 0, the second on
4, and so on (see <xref section="2.1" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-2.1" derivedContent="RFC9000"/>).</t>
        <t indent="0" pn="section-4.2-9">Servers <bcp14>MAY</bcp14> defer processing of a query until the STREAM FIN has been indicated
on the stream selected by the client.</t>
        <t indent="0" pn="section-4.2-10">Servers and clients <bcp14>MAY</bcp14> monitor the number
of "dangling" streams. These are open streams where the following events have not 
occurred after implementation-defined timeouts:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4.2-11">
          <li pn="section-4.2-11.1">the expected queries or responses have not been received or,</li>
          <li pn="section-4.2-11.2">the expected queries or responses have been received but not the STREAM FIN</li>
        </ul>
        <t indent="0" pn="section-4.2-12">Implementations <bcp14>MAY</bcp14> impose a limit on the number of
	such dangling streams. If limits are encountered, implementations <bcp14>MAY</bcp14> close the connection.</t>
        <section anchor="dns-message-ids" numbered="true" toc="include" removeInRFC="false" pn="section-4.2.1">
          <name slugifiedName="name-dns-message-ids">DNS Message IDs</name>
          <t indent="0" pn="section-4.2.1-1">When sending queries over a QUIC connection, the DNS Message ID <bcp14>MUST</bcp14> be set to
0. The stream mapping for DoQ allows for unambiguous correlation of queries
and responses, so the Message ID field is not required.</t>
          <t indent="0" pn="section-4.2.1-2">This has implications for proxying DoQ messages to and from other transports.
For example, proxies may have to manage the fact that DoQ can support a larger
number of outstanding queries on a single connection than, for example, DNS over TCP,
because DoQ is not limited by the Message ID space. This issue already exists for DoH,
where a Message ID of 0 is recommended.</t>
          <t indent="0" pn="section-4.2.1-3">When forwarding a DNS message from DoQ over another transport, a DNS Message ID
<bcp14>MUST</bcp14> be generated according to the rules of the protocol that is in use. When
forwarding a DNS message from another transport over DoQ, the Message ID <bcp14>MUST</bcp14>
be set to 0.</t>
        </section>
      </section>
      <section anchor="doq-error-codes" numbered="true" toc="include" removeInRFC="false" pn="section-4.3">
        <name slugifiedName="name-doq-error-codes">DoQ Error Codes</name>
        <t indent="0" pn="section-4.3-1">The following error codes are defined for use when abruptly terminating streams,
for use as application protocol error codes when
aborting reading of streams, or for immediately closing connections:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-4.3-2">
          <dt pn="section-4.3-2.1">
DOQ_NO_ERROR (0x0):  </dt>
          <dd pn="section-4.3-2.2">
            <t indent="0" pn="section-4.3-2.2.1">No error.  This is used when the connection or stream needs to be closed, but
there is no error to signal.</t>
          </dd>
          <dt pn="section-4.3-2.3">
DOQ_INTERNAL_ERROR (0x1):  </dt>
          <dd pn="section-4.3-2.4">
            <t indent="0" pn="section-4.3-2.4.1">The DoQ implementation encountered an internal error and is incapable of
pursuing the transaction or the connection.</t>
          </dd>
          <dt pn="section-4.3-2.5">
DOQ_PROTOCOL_ERROR (0x2):  </dt>
          <dd pn="section-4.3-2.6">
            <t indent="0" pn="section-4.3-2.6.1">The DoQ implementation encountered a protocol error and is forcibly aborting
the connection.</t>
          </dd>
          <dt pn="section-4.3-2.7">
DOQ_REQUEST_CANCELLED (0x3):  </dt>
          <dd pn="section-4.3-2.8">
            <t indent="0" pn="section-4.3-2.8.1">A DoQ client uses this to signal that it wants to cancel an
outstanding transaction.</t>
          </dd>
          <dt pn="section-4.3-2.9">
DOQ_EXCESSIVE_LOAD (0x4):  </dt>
          <dd pn="section-4.3-2.10">
            <t indent="0" pn="section-4.3-2.10.1">A DoQ implementation uses this to signal when closing a connection due to excessive load.</t>
          </dd>
          <dt pn="section-4.3-2.11">
DOQ_UNSPECIFIED_ERROR (0x5):  </dt>
          <dd pn="section-4.3-2.12">
            <t indent="0" pn="section-4.3-2.12.1">A DoQ implementation uses this in the absence of a more specific error code.</t>
          </dd>
          <dt pn="section-4.3-2.13">
DOQ_ERROR_RESERVED (0xd098ea5e):  </dt>
          <dd pn="section-4.3-2.14">
            <t indent="0" pn="section-4.3-2.14.1">An alternative error code used for tests.</t>
          </dd>
        </dl>
        <t indent="0" pn="section-4.3-3">See <xref target="iana-error-codes" format="default" sectionFormat="of" derivedContent="Section 8.4"/> for details on registering new error codes.</t>
        <section anchor="transaction-cancellation" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.1">
          <name slugifiedName="name-transaction-cancellation">Transaction Cancellation</name>
          <t indent="0" pn="section-4.3.1-1">In QUIC, sending STOP_SENDING requests that a peer cease transmission on a
stream. If a DoQ client wishes to cancel an outstanding request, it <bcp14>MUST</bcp14> issue
a QUIC STOP_SENDING, and it <bcp14>SHOULD</bcp14> use the error code DOQ_REQUEST_CANCELLED.
It <bcp14>MAY</bcp14> use a more specific error code registered according to <xref target="iana-error-codes" format="default" sectionFormat="of" derivedContent="Section 8.4"/>.
The STOP_SENDING request may be sent at
any time but will have no effect if the server response has already been
sent, in which case the client will simply discard the incoming response.
The corresponding DNS transaction <bcp14>MUST</bcp14> be abandoned.</t>
          <t indent="0" pn="section-4.3.1-2">Servers that receive STOP_SENDING act in accordance with <xref section="3.5" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-3.5" derivedContent="RFC9000"/>. 
Servers <bcp14>SHOULD NOT</bcp14> continue processing a DNS transaction if they receive a STOP_SENDING.</t>
          <t indent="0" pn="section-4.3.1-3">Servers <bcp14>MAY</bcp14> impose implementation limits on the total number or rate of cancellation requests.
If limits are encountered, servers <bcp14>MAY</bcp14> close the connection. In this case,
servers wanting to help client debugging <bcp14>MAY</bcp14> use the error code DOQ_EXCESSIVE_LOAD.
There is always a trade-off between helping good faith clients debug issues
and allowing denial-of-service attackers to test server defenses; depending
on circumstances servers might very well choose to send different error codes.</t>
          <t indent="0" pn="section-4.3.1-4">Note that this mechanism provides a way for secondaries to cancel a single zone
transfer occurring on a given stream without having to close the QUIC
connection.</t>
          <t indent="0" pn="section-4.3.1-5">Servers <bcp14>MUST NOT</bcp14> continue processing a DNS transaction if they receive a RESET_STREAM
request from the client before the client indicates the STREAM FIN. The server <bcp14>MUST</bcp14>
issue a RESET_STREAM to indicate that the transaction is abandoned unless:</t>
          <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4.3.1-6">
            <li pn="section-4.3.1-6.1">it has already done so for another reason or</li>
            <li pn="section-4.3.1-6.2">it has already both sent the response and indicated the STREAM FIN.</li>
          </ul>
        </section>
        <section anchor="transaction-errors" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.2">
          <name slugifiedName="name-transaction-errors">Transaction Errors</name>
          <t indent="0" pn="section-4.3.2-1">Servers normally complete transactions by sending a DNS response (or responses)
on the transaction's stream, including cases where the DNS response indicates a
DNS error. 

For example, a client <bcp14>SHOULD</bcp14> be notified of a Server Failure
(SERVFAIL, <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>) through a response with the Response Code set to
SERVFAIL.

</t>
          <t indent="0" pn="section-4.3.2-2">If a server is incapable of sending a DNS response due to an internal error, it
<bcp14>SHOULD</bcp14> issue a QUIC RESET_STREAM frame. The error code <bcp14>SHOULD</bcp14> be set to DOQ_INTERNAL_ERROR. The
corresponding DNS transaction <bcp14>MUST</bcp14> be abandoned. Clients <bcp14>MAY</bcp14> limit the number of
unsolicited QUIC RESET_STREAM frames received on a connection before choosing to close the
	  connection.</t>
          <t indent="0" pn="section-4.3.2-3">Note that this mechanism provides a way for primaries to abort a single zone
transfer occurring on a given stream without having to close the QUIC
connection.</t>
        </section>
        <section anchor="protocol-errors" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.3">
          <name slugifiedName="name-protocol-errors">Protocol Errors</name>
          <t indent="0" pn="section-4.3.3-1">Other error scenarios can occur due to malformed, incomplete, or unexpected
messages during a transaction. These include (but are not limited to):</t>
          <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4.3.3-2">
            <li pn="section-4.3.3-2.1">a client or server receives a message with a non-zero Message ID</li>
            <li pn="section-4.3.3-2.2">a client or server receives a STREAM FIN before receiving all the bytes for a
message indicated in the 2-octet length field</li>
            <li pn="section-4.3.3-2.3">a client receives a STREAM FIN before receiving all the expected responses</li>
            <li pn="section-4.3.3-2.4">a server receives more than one query on a stream</li>
            <li pn="section-4.3.3-2.5">a client receives a different number of responses on a stream than expected
(e.g., multiple responses to a query for an A record)</li>
            <li pn="section-4.3.3-2.6">a client receives a STOP_SENDING request</li>
            <li pn="section-4.3.3-2.7">the client or server does not indicate the expected STREAM FIN after
sending requests or responses (see <xref target="stream-mapping-and-usage" format="default" sectionFormat="of" derivedContent="Section 4.2"/>)</li>
            <li pn="section-4.3.3-2.8">an implementation receives a message containing the edns-tcp-keepalive
EDNS(0) Option <xref target="RFC7828" format="default" sectionFormat="of" derivedContent="RFC7828"/> (see
<xref target="resource-management" format="default" sectionFormat="of" derivedContent="Section 5.5.2"/>)</li>
            <li pn="section-4.3.3-2.9">a client or a server attempts to open a unidirectional QUIC stream</li>
            <li pn="section-4.3.3-2.10">a server attempts to open a server-initiated bidirectional QUIC stream</li>
            <li pn="section-4.3.3-2.11">a server receives a "replayable" transaction in 0-RTT data (for servers not willing to          
 handle this case, see <xref target="session-resumption-and-0-rtt" format="default" sectionFormat="of" derivedContent="Section 4.5"/>)
</li>
          </ul>
          <t indent="0" pn="section-4.3.3-3">If a peer encounters such an error condition, it is considered a fatal error. It
<bcp14>SHOULD</bcp14> forcibly abort the connection using QUIC's CONNECTION_CLOSE mechanism
and <bcp14>SHOULD</bcp14> use the DoQ error code DOQ_PROTOCOL_ERROR. In some cases, it <bcp14>MAY</bcp14>
instead silently abandon the connection, which uses fewer of the local resources
but makes debugging at the offending node more difficult.</t>
          <t indent="0" pn="section-4.3.3-4">It is noted that the restrictions on use of the above EDNS(0) option has
implications for proxying messages from TCP/DoT/DoH over DoQ.</t>
        </section>
        <section anchor="alternative-error-codes" numbered="true" toc="include" removeInRFC="false" pn="section-4.3.4">
          <name slugifiedName="name-alternative-error-codes">Alternative Error Codes</name>
          <t indent="0" pn="section-4.3.4-1">This specification describes specific error codes in Sections <xref target="transaction-cancellation" format="counter" sectionFormat="of" derivedContent="4.3.1"/>,
<xref target="transaction-errors" format="counter" sectionFormat="of" derivedContent="4.3.2"/>, and <xref target="protocol-errors" format="counter" sectionFormat="of" derivedContent="4.3.3"/>. These error codes are meant
to facilitate investigation of failures and other incidents. New error
codes may be defined in future versions of DoQ or registered as specified
in <xref target="iana-error-codes" format="default" sectionFormat="of" derivedContent="Section 8.4"/>.</t>
          <t indent="0" pn="section-4.3.4-2">Because new error codes can be defined without negotiation, use of an error
code in an unexpected context or receipt of an unknown error code <bcp14>MUST</bcp14> be
treated as equivalent to DOQ_UNSPECIFIED_ERROR.</t>
          <t indent="0" pn="section-4.3.4-3">Implementations <bcp14>MAY</bcp14> wish to test the support for the error code extension
mechanism by using error codes not listed in this document, or they <bcp14>MAY</bcp14> use
DOQ_ERROR_RESERVED.</t>
        </section>
      </section>
      <section anchor="connection-management" numbered="true" toc="include" removeInRFC="false" pn="section-4.4">
        <name slugifiedName="name-connection-management">Connection Management</name>
        <t indent="0" pn="section-4.4-1"><xref section="10" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-10" derivedContent="RFC9000"/>, the QUIC transport specification, specifies that
connections can be closed in three ways:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4.4-2">
          <li pn="section-4.4-2.1">idle timeout</li>
          <li pn="section-4.4-2.2">immediate close</li>
          <li pn="section-4.4-2.3">stateless reset</li>
        </ul>
        <t indent="0" pn="section-4.4-3">Clients and servers implementing DoQ <bcp14>SHOULD</bcp14> negotiate use of the idle timeout.
Closing on idle timeout is done without any packet exchange, which minimizes
protocol overhead. Per <xref section="10.1" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-10.1" derivedContent="RFC9000"/>, the QUIC transport specification, the
effective value of the idle timeout is computed as the minimum of the values
advertised by the two endpoints. Practical considerations on setting the idle
timeout are discussed in <xref target="resource-management" format="default" sectionFormat="of" derivedContent="Section 5.5.2"/>.</t>
        <t indent="0" pn="section-4.4-4">Clients <bcp14>SHOULD</bcp14> monitor the idle time incurred on their connection to the
server, defined by the time spent since the last packet from the server has
been received. When a client prepares to send a new DNS query to the server, it
<bcp14>SHOULD</bcp14> check whether the idle time is sufficiently lower than the idle timer. If it
is, the client <bcp14>SHOULD</bcp14> send the DNS query over the existing connection. If not,
the client <bcp14>SHOULD</bcp14> establish a new connection and send the query over that
connection.</t>
        <t indent="0" pn="section-4.4-5">Clients <bcp14>MAY</bcp14> discard their connections to the server before the idle timeout
expires. A client that has outstanding queries <bcp14>SHOULD</bcp14> close the connection
explicitly using QUIC's CONNECTION_CLOSE mechanism and the DoQ error code
DOQ_NO_ERROR.</t>
        <t indent="0" pn="section-4.4-6">Clients and servers <bcp14>MAY</bcp14> close the connection for a variety of other
reasons, indicated using QUIC's CONNECTION_CLOSE. Client and servers
that send packets over a connection discarded by their peer might
receive a stateless reset indication. If a connection fails, all the
in-progress transactions on that connection <bcp14>MUST</bcp14> be abandoned.</t>
      </section>
      <section anchor="session-resumption-and-0-rtt" numbered="true" toc="include" removeInRFC="false" pn="section-4.5">
        <name slugifiedName="name-session-resumption-and-0-rt">Session Resumption and 0-RTT</name>
        <t indent="0" pn="section-4.5-1">A client <bcp14>MAY</bcp14> take advantage of the session resumption and 0-RTT mechanisms supported by
QUIC transport <xref target="RFC9000" format="default" sectionFormat="of" derivedContent="RFC9000"/> and QUIC TLS <xref target="RFC9001" format="default" sectionFormat="of" derivedContent="RFC9001"/> if the server supports them.
Clients <bcp14>SHOULD</bcp14> consider
potential privacy issues associated with session resumption before deciding to use
this mechanism and specifically evaluate the trade-offs presented in the various sections of this document. 
The privacy issues are detailed in Sections <xref target="privacy-issues-with-0-rtt-data" format="counter" sectionFormat="of" derivedContent="7.1"/>
and <xref target="privacy-issues-with-session-resumption" format="counter" sectionFormat="of" derivedContent="7.2"/>,
and the implementation considerations are discussed in
<xref target="using-0-rtt-and-session-resumption" format="default" sectionFormat="of" derivedContent="Section 5.5.3"/>.</t>
        <t indent="0" pn="section-4.5-2">The 0-RTT mechanism <bcp14>MUST NOT</bcp14> be used to send DNS requests that are not
"replayable" transactions. In this specification, only transactions that have
an OPCODE of QUERY or NOTIFY are considered replayable; therefore, other OPCODES <bcp14>MUST NOT</bcp14>
be sent in 0-RTT data. See <xref target="the-notify-service" format="default" sectionFormat="of" derivedContent="Appendix A"/> for a detailed discussion of why NOTIFY is
included here.</t>
        <t indent="0" pn="section-4.5-3">Servers <bcp14>MAY</bcp14> support session resumption, and <bcp14>MAY</bcp14> do that with or without supporting
0-RTT, using the mechanisms described in <xref section="4.6.1" sectionFormat="of" target="RFC9001" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9001#section-4.6.1" derivedContent="RFC9001"/>.
Servers supporting 0-RTT <bcp14>MUST NOT</bcp14> immediately process
non-replayable transactions received in 0-RTT data but instead
<bcp14>MUST</bcp14> adopt one of the following behaviors:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4.5-4">
          <li pn="section-4.5-4.1">Queue the offending transaction and only process it after the QUIC handshake
has been completed, as defined in <xref section="4.1.1" sectionFormat="of" target="RFC9001" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9001#section-4.1.1" derivedContent="RFC9001"/>.</li>
          <li pn="section-4.5-4.2">Reply to the offending transaction with a response code REFUSED and
an Extended DNS Error Code (EDE) "Too Early" using the extended RCODE
mechanisms defined in <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/> and the extended DNS errors defined in <xref target="RFC8914" format="default" sectionFormat="of" derivedContent="RFC8914"/>; see
<xref target="reservation-of-extended-dns-error-code-too-early" format="default" sectionFormat="of" derivedContent="Section 8.3"/>.</li>
          <li pn="section-4.5-4.3">Close the connection with the error code DOQ_PROTOCOL_ERROR.</li>
        </ul>
      </section>
      <section anchor="message-sizes" numbered="true" toc="include" removeInRFC="false" pn="section-4.6">
        <name slugifiedName="name-message-sizes">Message Sizes</name>
        <t indent="0" pn="section-4.6-1">DoQ queries and responses are sent on QUIC streams, which in theory can carry
up to 2<sup>62</sup> bytes. However, DNS messages are restricted in practice to a maximum
size of 65535 bytes. This maximum size is enforced by the use of a 2-octet
message length field in DNS over TCP <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/> and DoT
<xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>, and by the definition of the "application/dns-message" for DoH <xref target="RFC8484" format="default" sectionFormat="of" derivedContent="RFC8484"/>. DoQ enforces the same restriction.</t>
        <t indent="0" pn="section-4.6-2">The Extension Mechanisms for DNS (EDNS(0)) <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/> allow peers to specify the
UDP message size. This parameter is ignored by DoQ. DoQ implementations always
assume that the maximum message size is 65535 bytes.</t>
      </section>
    </section>
    <section anchor="implementation-requirements" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-implementation-requirements">Implementation Requirements</name>
      <section anchor="authentication" numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-authentication">Authentication</name>
        <t indent="0" pn="section-5.1-1">For the stub to recursive scenario, the authentication requirements
are the same as described in DoT <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/> and "Usage Profiles for DNS over
TLS and DNS over DTLS" <xref target="RFC8310" format="default" sectionFormat="of" derivedContent="RFC8310"/>. <xref target="RFC8932" format="default" sectionFormat="of" derivedContent="RFC8932"/> states that DNS privacy
services <bcp14>SHOULD</bcp14> provide credentials that clients can use to authenticate the
server. Given this, and to align with the authentication model for DoH, DoQ stubs
<bcp14>SHOULD</bcp14> use a Strict usage profile. Client authentication for the encrypted
stub to recursive scenario is not described in any DNS RFC.</t>
        <t indent="0" pn="section-5.1-2">For zone transfer, the authentication requirements are the same as described in
<xref target="RFC9103" format="default" sectionFormat="of" derivedContent="RFC9103"/>.</t>
        <t indent="0" pn="section-5.1-3">For the recursive to authoritative scenario, authentication
requirements are unspecified at the time of writing and are the subject of
ongoing work in the DPRIVE WG.</t>
      </section>
      <section anchor="fallback-to-other-protocols-on-connection-failure" numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-fallback-to-other-protocols">Fallback to Other Protocols on Connection Failure</name>
        <t indent="0" pn="section-5.2-1">If the establishment of the DoQ connection fails, clients <bcp14>MAY</bcp14> attempt to
fall back to DoT and then potentially cleartext, as specified in DoT
<xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/> and "Usage Profiles for DNS over TLS and DNS over DTLS"
<xref target="RFC8310" format="default" sectionFormat="of" derivedContent="RFC8310"/>, depending on their usage profile.</t>
        <t indent="0" pn="section-5.2-2">DNS clients <bcp14>SHOULD</bcp14> remember server IP addresses that don't support DoQ.
Mobile clients might also remember the lack of DoQ support by
given IP addresses on a per-context basis (e.g., per network or provisioning domain).</t>
        <t indent="0" pn="section-5.2-3">Timeouts, connection refusals, and QUIC handshake failures are indicators
that a server does not support DoQ.  Clients <bcp14>SHOULD NOT</bcp14> attempt DoQ queries to a
server that does not support DoQ for a reasonable period (such as one hour per
server).  DNS clients following an out-of-band key-pinned usage profile
<xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/> <bcp14>MAY</bcp14> be more aggressive about retrying after DoQ connection failures.</t>
      </section>
      <section anchor="address-validation" numbered="true" toc="include" removeInRFC="false" pn="section-5.3">
        <name slugifiedName="name-address-validation">Address Validation</name>
        <t indent="0" pn="section-5.3-1"><xref section="8" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-8" derivedContent="RFC9000"/>, the QUIC transport specification, defines Address
Validation procedures to avoid servers being used in address amplification
attacks. DoQ implementations <bcp14>MUST</bcp14> conform to this specification, which limits
the worst-case amplification to a factor 3.</t>
        <t indent="0" pn="section-5.3-2">DoQ implementations <bcp14>SHOULD</bcp14> consider configuring servers to use the Address
Validation using Retry Packets procedure defined in <xref section="8.1.2" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-8.1.2" derivedContent="RFC9000"/>, the QUIC
transport specification. This procedure imposes a 1-RTT delay for
verifying the return routability of the source address of a client, similar to
the DNS Cookies mechanism <xref target="RFC7873" format="default" sectionFormat="of" derivedContent="RFC7873"/>.</t>
        <t indent="0" pn="section-5.3-3">DoQ implementations that configure Address Validation using Retry Packets
<bcp14>SHOULD</bcp14> implement the Address Validation for Future Connections procedure
defined in <xref section="8.1.3" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-8.1.3" derivedContent="RFC9000"/>, the QUIC transport specification.
This defines how servers can send NEW_TOKEN frames to clients after the client
address is validated in order to avoid the 1-RTT penalty during subsequent
connections by the client from the same address.</t>
      </section>
      <section anchor="padding" numbered="true" toc="include" removeInRFC="false" pn="section-5.4">
        <name slugifiedName="name-padding">Padding</name>
        <t indent="0" pn="section-5.4-1">Implementations <bcp14>MUST</bcp14> protect against the traffic analysis attacks described in
<xref target="traffic-analysis" format="default" sectionFormat="of" derivedContent="Section 7.5"/> by the judicious injection of padding. This
could be done either by padding individual DNS messages using the
EDNS(0) Padding Option <xref target="RFC7830" format="default" sectionFormat="of" derivedContent="RFC7830"/> or by padding QUIC packets (see
<xref section="19.1" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-19.1" derivedContent="RFC9000"/>).</t>
        <t indent="0" pn="section-5.4-2">In theory, padding at the QUIC packet level could result in better performance for the equivalent
protection, because the amount of padding can take into account non-DNS frames
such as acknowledgements or flow control updates, and also because QUIC packets
can carry multiple DNS messages. However, applications can only control the
amount of padding in QUIC packets if the implementation of QUIC exposes adequate APIs. This leads
to the following recommendations:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5.4-3">
          <li pn="section-5.4-3.1">If the implementation of QUIC exposes APIs to set a padding policy,
DoQ <bcp14>SHOULD</bcp14> use that API to align the packet length to a small set of
fixed sizes.</li>
          <li pn="section-5.4-3.2">If padding at the QUIC packet level is not available or not used,
DoQ <bcp14>MUST</bcp14> ensure that all DNS queries and responses are padded to
a small set of fixed sizes, using the EDNS(0) padding extension as specified
in <xref target="RFC7830" format="default" sectionFormat="of" derivedContent="RFC7830"/>.</li>
        </ul>
        <t indent="0" pn="section-5.4-4">Implementations might choose not to use a QUIC API for padding if it is
significantly simpler to reuse existing DNS message padding logic that is
applied to other encrypted transports.</t>
        <t indent="0" pn="section-5.4-5">In the absence of a standard policy for padding sizes, implementations <bcp14>SHOULD</bcp14>
follow the recommendations of the Experimental status "Padding Policies for
Extension Mechanisms for DNS (EDNS(0))" <xref target="RFC8467" format="default" sectionFormat="of" derivedContent="RFC8467"/>. While Experimental,
these recommendations are referenced because they are implemented and deployed
for DoT and provide a way for implementations to be fully compliant with this
specification.</t>
      </section>
      <section anchor="connection-handling" numbered="true" toc="include" removeInRFC="false" pn="section-5.5">
        <name slugifiedName="name-connection-handling">Connection Handling</name>
        <t indent="0" pn="section-5.5-1">"DNS Transport over TCP - Implementation Requirements" <xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/> provides
updated guidance on DNS over TCP, some of which is applicable to DoQ. This 
section provides similar advice on connection handling for DoQ.</t>
        <section anchor="connection-reuse" numbered="true" toc="include" removeInRFC="false" pn="section-5.5.1">
          <name slugifiedName="name-connection-reuse">Connection Reuse</name>
          <t indent="0" pn="section-5.5.1-1">Historic implementations of DNS clients are known to open and close TCP
connections for each DNS query. To amortize connection setup costs, both
clients and servers <bcp14>SHOULD</bcp14> support connection reuse by sending multiple queries
and responses over a single persistent QUIC connection.</t>
          <t indent="0" pn="section-5.5.1-2">In order to achieve performance on par with UDP, DNS clients <bcp14>SHOULD</bcp14> send their
queries concurrently over the QUIC streams on a QUIC connection. That is, when
a DNS client sends multiple queries to a server over a QUIC connection, it
<bcp14>SHOULD NOT</bcp14> wait for an outstanding reply before sending the next query.</t>
        </section>
        <section anchor="resource-management" numbered="true" toc="include" removeInRFC="false" pn="section-5.5.2">
          <name slugifiedName="name-resource-management">Resource Management</name>
          <t indent="0" pn="section-5.5.2-1">Proper management of established and idle connections is important to the
healthy operation of a DNS server.</t>
          <t indent="0" pn="section-5.5.2-2">An implementation of DoQ <bcp14>SHOULD</bcp14> follow best practices similar to those
specified for DNS over TCP <xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/>, in particular with regard to:</t>
          <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5.5.2-3">
            <li pn="section-5.5.2-3.1">Concurrent Connections (<xref section="6.2.2" sectionFormat="of" target="RFC7766" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7766#section-6.2.2" derivedContent="RFC7766"/>, updated by <xref section="6.4" sectionFormat="of" target="RFC9103" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9103#section-6.4" derivedContent="RFC9103"/>)</li>
            <li pn="section-5.5.2-3.2">Security Considerations (<xref section="10" sectionFormat="of" target="RFC7766" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7766#section-10" derivedContent="RFC7766"/>)</li>
          </ul>
          <t indent="0" pn="section-5.5.2-4">Failure to do so may lead to resource exhaustion and denial of service.</t>
          <t indent="0" pn="section-5.5.2-5">Clients that want to maintain long duration DoQ connections <bcp14>SHOULD</bcp14> use the idle
timeout mechanisms defined in <xref section="10.1" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-10.1" derivedContent="RFC9000"/>, the QUIC transport
specification. Clients and servers <bcp14>MUST NOT</bcp14> send the edns-tcp-keepalive EDNS(0)
Option <xref target="RFC7828" format="default" sectionFormat="of" derivedContent="RFC7828"/> in any messages sent on a DoQ connection (because it is
specific to the use of TCP/TLS as a transport).</t>
          <t indent="0" pn="section-5.5.2-6">This document does not make specific recommendations for timeout values on idle
connections. Clients and servers should reuse and/or close connections
depending on the level of available resources. Timeouts may be longer during
periods of low activity and shorter during periods of high activity.</t>
        </section>
        <section anchor="using-0-rtt-and-session-resumption" numbered="true" toc="include" removeInRFC="false" pn="section-5.5.3">
          <name slugifiedName="name-using-0-rtt-and-session-res">Using 0-RTT and Session Resumption</name>
          <t indent="0" pn="section-5.5.3-1">Using 0-RTT for DoQ has many compelling advantages. Clients
can establish connections and send queries without incurring a connection
delay. Servers can thus negotiate low values of the connection
timers, which reduces the total number of connections that they need to
manage. They can do that because the clients that use 0-RTT will not incur
latency penalties if new connections are required for a query.</t>
          <t indent="0" pn="section-5.5.3-2">Session resumption and 0-RTT data transmission create
privacy risks detailed in Sections  <xref target="privacy-issues-with-0-rtt-data" format="counter" sectionFormat="of" derivedContent="7.1"/> and <xref target="privacy-issues-with-session-resumption" format="counter" sectionFormat="of" derivedContent="7.2"/>.
The following recommendations are meant to reduce the privacy
risks while enjoying the performance benefits of 0-RTT data, subject to the
restrictions specified in <xref target="session-resumption-and-0-rtt" format="default" sectionFormat="of" derivedContent="Section 4.5"/>.</t>
          <t indent="0" pn="section-5.5.3-3">Clients <bcp14>SHOULD</bcp14> use resumption tickets only once, as
specified in <xref target="RFC8446" sectionFormat="of" section="C.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#appendix-C.4" derivedContent="RFC8446"/>. By
default, clients <bcp14>SHOULD NOT</bcp14> use session resumption if the
client's connectivity has changed.</t>
          <t indent="0" pn="section-5.5.3-4">Clients could receive address validation tokens from the server using the
NEW_TOKEN mechanism; see <xref section="8" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-8" derivedContent="RFC9000"/>. The associated tracking
risks are mentioned in <xref target="privacy-issues-with-address-validation-tokens" format="default" sectionFormat="of" derivedContent="Section 7.3"/>.
Clients <bcp14>SHOULD</bcp14> only use the address validation tokens when they are also using session
resumption thus avoiding additional tracking risks.</t>
          <t indent="0" pn="section-5.5.3-5">Servers <bcp14>SHOULD</bcp14> issue session resumption tickets with a sufficiently long lifetime (e.g., 6 hours),
so that clients are not tempted to either keep the connection alive or frequently poll the server
to renew session resumption tickets.
Servers <bcp14>SHOULD</bcp14> implement the anti-replay mechanisms specified in <xref section="8" sectionFormat="of" target="RFC8446" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-8" derivedContent="RFC8446"/>.</t>
        </section>
        <section anchor="controlling-connection-migration-for-privacy" numbered="true" toc="include" removeInRFC="false" pn="section-5.5.4">
          <name slugifiedName="name-controlling-connection-migr">Controlling Connection Migration for Privacy</name>
          <t indent="0" pn="section-5.5.4-1">DoQ implementations might consider using the connection migration features defined
in <xref section="9" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-9" derivedContent="RFC9000"/>. These features enable connections to continue operating
as the client's connectivity changes.
As detailed in <xref target="privacy-issues-with-long-duration-sessions" format="default" sectionFormat="of" derivedContent="Section 7.4"/>, these features
trade off privacy for latency. By default, clients <bcp14>SHOULD</bcp14> be configured
to prioritize privacy and start new sessions if their connectivity changes.</t>
        </section>
      </section>
      <section anchor="processing-queries-in-parallel" numbered="true" toc="include" removeInRFC="false" pn="section-5.6">
        <name slugifiedName="name-processing-queries-in-paral">Processing Queries in Parallel</name>
        <t indent="0" pn="section-5.6-1">As specified in <xref section="7" sectionFormat="of" target="RFC7766" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7766#section-7" derivedContent="RFC7766"/> "DNS Transport over TCP - Implementation
Requirements", resolvers are <bcp14>RECOMMENDED</bcp14> to support the preparing
of responses in parallel and sending them out of order. In DoQ, they do that by
sending responses on their specific stream as soon as possible, without waiting
for availability of responses for previously opened streams.</t>
      </section>
      <section anchor="zone-transfer" numbered="true" toc="include" removeInRFC="false" pn="section-5.7">
        <name slugifiedName="name-zone-transfer">Zone Transfer</name>
        <t indent="0" pn="section-5.7-1"><xref target="RFC9103" format="default" sectionFormat="of" derivedContent="RFC9103"/> specifies zone transfer over TLS (XoT)
and includes updates to <xref target="RFC1995" format="default" sectionFormat="of" derivedContent="RFC1995"/> (IXFR), <xref target="RFC5936" format="default" sectionFormat="of" derivedContent="RFC5936"/> (AXFR), and
<xref target="RFC7766" format="default" sectionFormat="of" derivedContent="RFC7766"/>. Considerations relating to the reuse of XoT connections
described there apply analogously to zone transfers performed using DoQ
connections. One reason for reiterating such specific guidance is the
lack of effective connection reuse in existing TCP/TLS zone transfer
implementations today. The following recommendations apply:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5.7-2">
          <li pn="section-5.7-2.1">DoQ servers <bcp14>MUST</bcp14> be able to handle multiple concurrent IXFR requests on a
single QUIC connection.</li>
          <li pn="section-5.7-2.2">DoQ servers <bcp14>MUST</bcp14> be able to handle multiple concurrent AXFR requests on a
single QUIC connection.</li>
          <li pn="section-5.7-2.3">
            <t indent="0" pn="section-5.7-2.3.1">DoQ implementations <bcp14>SHOULD</bcp14>
            </t>
            <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5.7-2.3.2">
              <li pn="section-5.7-2.3.2.1">use the same QUIC connection for both AXFR and IXFR requests to the same
primary</li>
              <li pn="section-5.7-2.3.2.2">send those requests in parallel as soon as they are queued, i.e., do not wait
for a response before sending the next query on the connection
(this is analogous to pipelining requests on a TCP/TLS connection)</li>
              <li pn="section-5.7-2.3.2.3">send the response(s) for each request as soon as they are available, i.e.,
response streams <bcp14>MAY</bcp14> be sent intermingled</li>
            </ul>
          </li>
        </ul>
      </section>
      <section anchor="flow-control-mechanisms" numbered="true" toc="include" removeInRFC="false" pn="section-5.8">
        <name slugifiedName="name-flow-control-mechanisms">Flow Control Mechanisms</name>
        <t indent="0" pn="section-5.8-1">Servers and clients manage flow control using the mechanisms defined in
<xref section="4" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-4" derivedContent="RFC9000"/>. These mechanisms allow clients and servers to specify
how many streams can be created, how much data can be sent on a stream,
and how much data can be sent on the union of all streams. For DoQ,
controlling how many streams are created allows servers to control how many
new requests the client can send on a given connection.</t>
        <t indent="0" pn="section-5.8-2">Flow control exists to protect endpoint resources.
For servers, global and per-stream flow control limits control how much data can be sent by
clients. The same mechanisms
allow clients to control how much data can be sent by servers.
Values that are too small will unnecessarily limit performance.
Values that are too large might expose endpoints to overload or memory exhaustion.
Implementations or deployments will need to adjust flow control limits to
balance these concerns. In particular, zone transfer implementations will need to control
these limits carefully to ensure both large and concurrent zone transfers are well managed.</t>
        <t indent="0" pn="section-5.8-3">Initial values of parameters control how many requests and how much data can be
sent by clients and servers at the beginning of the connection. These values
are specified in transport parameters exchanged during the connection handshake.
The parameter values received in the initial connection also control how many requests and
how much data can be sent by clients using 0-RTT data in a resumed connection.
Using too small values of these initial parameters would restrict the
usefulness of allowing 0-RTT data.</t>
      </section>
    </section>
    <section anchor="security-considerations" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-6-1">A Threat Analysis of the Domain Name System is found in <xref target="RFC3833" format="default" sectionFormat="of" derivedContent="RFC3833"/>.
This analysis was written before the development of DoT, DoH, and DoQ, and
probably needs to be updated.</t>
      <t indent="0" pn="section-6-2">The security considerations of DoQ should be comparable to those of DoT
<xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>. DoT as specified in <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/> only addresses the stub to recursive scenario, but the considerations about person-in-the-middle
attacks, middleboxes, and caching of data from cleartext connections also
apply for DoQ to the resolver to authoritative server scenario. 
As stated in <xref target="authentication" format="default" sectionFormat="of" derivedContent="Section 5.1"/>, the authentication requirements for securing zone transfer using DoQ are the same as those for zone transfer over DoT; therefore, the general security considerations are entirely analogous to those described in <xref target="RFC9103" format="default" sectionFormat="of" derivedContent="RFC9103"/>.</t>
      <t indent="0" pn="section-6-3">DoQ relies on QUIC, which itself relies on TLS 1.3 and thus supports by default
the protections against downgrade attacks described in <xref target="BCP195" format="default" sectionFormat="of" derivedContent="BCP195"/>.
QUIC-specific issues and their mitigations are described in
<xref section="21" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-21" derivedContent="RFC9000"/>.</t>
    </section>
    <section anchor="privacy-considerations" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-privacy-considerations">Privacy Considerations</name>
      <t indent="0" pn="section-7-1">The general considerations of encrypted transports provided in "DNS Privacy
Considerations" <xref target="RFC9076" format="default" sectionFormat="of" derivedContent="RFC9076"/> apply to DoQ. The specific
considerations provided there do not differ between DoT and DoQ, and they are not
discussed further here. Similarly, "Recommendations for DNS Privacy Service
Operators" <xref target="RFC8932" format="default" sectionFormat="of" derivedContent="RFC8932"/> (which covers operational, policy, and security
considerations for DNS privacy services) is also applicable to DoQ services.</t>
      <t indent="0" pn="section-7-2">QUIC incorporates the mechanisms of TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>, and this enables QUIC
transmission of "0-RTT" data. This can provide interesting latency gains, but
it raises two concerns:</t>
      <ol spacing="normal" type="1" indent="adaptive" start="1" pn="section-7-3"><li pn="section-7-3.1" derivedCounter="1.">Adversaries could replay the 0-RTT data and infer its content
from the behavior of the receiving server.</li>
        <li pn="section-7-3.2" derivedCounter="2.">The 0-RTT mechanism relies on TLS session resumption, which can provide
linkability between successive client sessions.</li>
      </ol>
      <t indent="0" pn="section-7-4">These issues are developed in Sections <xref target="privacy-issues-with-0-rtt-data" format="counter" sectionFormat="of" derivedContent="7.1"/> and <xref target="privacy-issues-with-session-resumption" format="counter" sectionFormat="of" derivedContent="7.2"/>.</t>
      <section anchor="privacy-issues-with-0-rtt-data" numbered="true" toc="include" removeInRFC="false" pn="section-7.1">
        <name slugifiedName="name-privacy-issues-with-0-rtt-d">Privacy Issues with 0-RTT data</name>
        <t indent="0" pn="section-7.1-1">The 0-RTT data can be replayed by adversaries. That data may trigger queries by
a recursive resolver to authoritative resolvers. Adversaries may be able to
pick a time at which the recursive resolver outgoing traffic is observable and
thus find out what name was queried for in the 0-RTT data.</t>
        <t indent="0" pn="section-7.1-2">This risk is in fact a subset of the general problem of observing the behavior
of the recursive resolver discussed in "DNS Privacy Considerations"
<xref target="RFC9076" format="default" sectionFormat="of" derivedContent="RFC9076"/>. The attack is partially mitigated by reducing the observability
of this traffic. The mandatory replay protection mechanisms in
TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> limit but do not eliminate the risk of replay.
0-RTT packets can only be replayed within a narrow window,
which is only wide enough to account for variations in clock skew and network transmission.</t>
        <t indent="0" pn="section-7.1-3">The recommendation for TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> is that the capability to use 0-RTT
data should be turned off by default and only enabled if the user clearly
understands the associated risks. In the case of DoQ, allowing 0-RTT data
provides significant performance gains, and there is a concern that a
recommendation to not use it would simply be ignored. Instead, a set of
practical recommendations is provided in Sections <xref target="session-resumption-and-0-rtt" format="counter" sectionFormat="of" derivedContent="4.5"/> and
<xref target="using-0-rtt-and-session-resumption" format="counter" sectionFormat="of" derivedContent="5.5.3"/>.</t>
        <t indent="0" pn="section-7.1-4">The specifications in <xref target="session-resumption-and-0-rtt" format="default" sectionFormat="of" derivedContent="Section 4.5"/> block the most obvious
risks of replay attacks, as they only allow for transactions that will
not change the long-term state of the server.</t>
        <t indent="0" pn="section-7.1-5">The attacks described above apply to the stub resolver to recursive resolver scenario, but similar attacks might be envisaged in the
recursive resolver to authoritative resolver scenario, and the
same mitigations apply.</t>
      </section>
      <section anchor="privacy-issues-with-session-resumption" numbered="true" toc="include" removeInRFC="false" pn="section-7.2">
        <name slugifiedName="name-privacy-issues-with-session">Privacy Issues with Session Resumption</name>
        <t indent="0" pn="section-7.2-1">The QUIC session resumption mechanism reduces the cost of re-establishing sessions
and enables 0-RTT data. There is a linkability issue associated with session
resumption, if the same resumption token is used several times. Attackers on path
between client and server could observe repeated usage of the token and
use that to track the client over time or over multiple locations.</t>
        <t indent="0" pn="section-7.2-2">The session resumption mechanism allows servers to correlate the resumed sessions
with the initial sessions and thus to track the client. This creates a virtual
long duration session. The series of queries in that session can be used by the
server to identify the client. Servers can most probably do that already if
the client address remains constant, but session resumption tickets also enable
tracking after changes of the client's address.</t>
        <t indent="0" pn="section-7.2-3">The recommendations in <xref target="using-0-rtt-and-session-resumption" format="default" sectionFormat="of" derivedContent="Section 5.5.3"/> are designed to
mitigate these risks. Using session tickets only once mitigates
the risk of tracking by third parties. Refusing to resume a session if addresses
change mitigates the incremental risk of tracking by the server (but the risk of
tracking by IP address remains).</t>
        <t indent="0" pn="section-7.2-4">The privacy trade-offs here may be context specific. Stub resolvers will have a strong
motivation to prefer privacy over latency since they often change location. However,
recursive resolvers that use a small set of static IP addresses are more likely to prefer the reduced
latency provided by session resumption and may consider this a valid reason to use
resumption tickets even if the IP address changed between sessions.</t>
        <t indent="0" pn="section-7.2-5">Encrypted zone transfer (<xref target="RFC9103" format="default" sectionFormat="of" derivedContent="RFC9103"/>) explicitly does
not attempt to hide the identity of the parties involved in the transfer; at the
same time, such transfers are not particularly latency sensitive. This means that
applications supporting zone transfers may decide to apply the same
protections as stub to recursive applications.</t>
      </section>
      <section anchor="privacy-issues-with-address-validation-tokens" numbered="true" toc="include" removeInRFC="false" pn="section-7.3">
        <name slugifiedName="name-privacy-issues-with-address">Privacy Issues with Address Validation Tokens</name>
        <t indent="0" pn="section-7.3-1">QUIC specifies address validation mechanisms in <xref section="8" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-8" derivedContent="RFC9000"/>. Use
of an address validation token allows QUIC servers to avoid an extra RTT for
new connections. Address validation tokens are typically tied to an IP address.
QUIC clients normally only use these tokens when setting up a new connection
from a previously used address. However, clients are not always aware that they
are using a new address. This could be due to NAT, or because the client does
not have an API available to check if the IP address has changed (which can be
quite often for IPv6). There is a linkability risk if clients mistakenly use
address validation tokens after unknowingly moving to a new location.</t>
        <t indent="0" pn="section-7.3-2">The recommendations in <xref target="using-0-rtt-and-session-resumption" format="default" sectionFormat="of" derivedContent="Section 5.5.3"/> mitigates
this risk by tying the usage of the NEW_TOKEN to that of session resumption,
though this recommendation does not cover the case where the client is unaware
of the address change.</t>
      </section>
      <section anchor="privacy-issues-with-long-duration-sessions" numbered="true" toc="include" removeInRFC="false" pn="section-7.4">
        <name slugifiedName="name-privacy-issues-with-long-du">Privacy Issues with Long Duration Sessions</name>
        <t indent="0" pn="section-7.4-1">A potential alternative to session resumption is the use of long duration sessions:
if a session remains open for a long time, new queries can be sent without incurring
connection establishment delays. It is worth pointing out that the two solutions have
similar privacy characteristics. Session resumption may allow servers to keep track
of the IP addresses of clients, but long duration sessions have the same effect.</t>
        <t indent="0" pn="section-7.4-2">In particular, a DoQ implementation might take advantage of the connection migration
features of QUIC to maintain a session even if the client's connectivity changes,
for example, if the client migrates from a Wi-Fi connection to a cellular network
connection and then to another Wi-Fi connection. The server would be
able to track the client location by monitoring the succession of IP addresses
used by the long duration connection.</t>
        <t indent="0" pn="section-7.4-3">The recommendation in <xref target="controlling-connection-migration-for-privacy" format="default" sectionFormat="of" derivedContent="Section 5.5.4"/> mitigates
the privacy concerns related to long duration sessions using multiple client addresses.</t>
      </section>
      <section anchor="traffic-analysis" numbered="true" toc="include" removeInRFC="false" pn="section-7.5">
        <name slugifiedName="name-traffic-analysis">Traffic Analysis</name>
        <t indent="0" pn="section-7.5-1">Even though QUIC packets are encrypted, adversaries can gain information from
observing packet lengths, in both queries and responses, as well as packet
timing. Many DNS requests are emitted by web browsers. Loading a specific web
page may require resolving dozens of DNS names. If an application adopts a
simple mapping of one query or response per packet, or "one QUIC STREAM frame
per packet", then the succession of packet lengths may provide enough
information to identify the requested site.</t>
        <t indent="0" pn="section-7.5-2">Implementations <bcp14>SHOULD</bcp14> use the mechanisms defined in <xref target="padding" format="default" sectionFormat="of" derivedContent="Section 5.4"/> to mitigate
this attack.</t>
      </section>
    </section>
    <section anchor="iana-considerations" numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <section anchor="registration-of-doq-identification-string" numbered="true" toc="include" removeInRFC="false" pn="section-8.1">
        <name slugifiedName="name-registration-of-a-doq-ident">Registration of a DoQ Identification String</name>
        <t indent="0" pn="section-8.1-1">This document creates a new registration for the identification of DoQ in the
"TLS Application-Layer Protocol Negotiation (ALPN) Protocol IDs" registry
<xref target="RFC7301" format="default" sectionFormat="of" derivedContent="RFC7301"/>.</t>
        <t indent="0" pn="section-8.1-2">The "doq" string identifies DoQ:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-8.1-3">
          <dt pn="section-8.1-3.1">
Protocol:  </dt>
          <dd pn="section-8.1-3.2">
            <t indent="0" pn="section-8.1-3.2.1">DoQ</t>
          </dd>
          <dt pn="section-8.1-3.3">
Identification Sequence:  </dt>
          <dd pn="section-8.1-3.4">
            <t indent="0" pn="section-8.1-3.4.1">0x64 0x6F 0x71 ("doq")</t>
          </dd>
          <dt pn="section-8.1-3.5">
Specification:  </dt>
          <dd pn="section-8.1-3.6">
            <t indent="0" pn="section-8.1-3.6.1">This document</t>
          </dd>
        </dl>
      </section>
      <section anchor="reservation-of-dedicated-port" numbered="true" toc="include" removeInRFC="false" pn="section-8.2">
        <name slugifiedName="name-reservation-of-a-dedicated-">Reservation of a Dedicated Port</name>
        <t indent="0" pn="section-8.2-1">For both TCP and UDP, port 853 is currently reserved for "DNS query-response 
protocol run over TLS/DTLS" <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/>.</t>
        <t indent="0" pn="section-8.2-2">However, the specification for DNS over DTLS (DoD)
<xref target="RFC8094" format="default" sectionFormat="of" derivedContent="RFC8094"/> is experimental, limited to stub to resolver, and no
implementations or deployments currently exist to the authors' knowledge (even though
several years have passed since the specification was published).</t>
        <t indent="0" pn="section-8.2-3">This specification additionally reserves the use of UDP port 853 for
DoQ. QUIC version 1 was designed to be able to coexist with other protocols on
the same port, including DTLS; see <xref section="17.2" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-17.2" derivedContent="RFC9000"/>. This means
that deployments that serve DoD and DoQ (QUIC version 1) on the
same port will be able to demultiplex the two due to the second most
significant bit in each UDP payload. Such deployments ought to check the
signatures of future versions or extensions (e.g., <xref target="I-D.ietf-quic-bit-grease" format="default" sectionFormat="of" derivedContent="GREASING-QUIC"/>)
of QUIC and DTLS before deploying them to serve DNS on the same port.</t>
        <t indent="0" pn="section-8.2-4">IANA has updated the following value in the "Service Name and Transport
Protocol Port Number Registry" in the System range. The registry for that range
requires IETF Review or IESG Approval <xref target="RFC6335" format="default" sectionFormat="of" derivedContent="RFC6335"/>.</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-8.2-5">
          <dt pn="section-8.2-5.1">
Service Name:  </dt>
          <dd pn="section-8.2-5.2">
            <t indent="0" pn="section-8.2-5.2.1">domain-s</t>
          </dd>
          <dt pn="section-8.2-5.3">
Port Number:  </dt>
          <dd pn="section-8.2-5.4">
            <t indent="0" pn="section-8.2-5.4.1">853</t>
          </dd>
          <dt pn="section-8.2-5.5">
Transport Protocol(s):  </dt>
          <dd pn="section-8.2-5.6">
            <t indent="0" pn="section-8.2-5.6.1">UDP</t>
          </dd>
          <dt pn="section-8.2-5.7">
Assignee:  </dt>
          <dd pn="section-8.2-5.8">
            <t indent="0" pn="section-8.2-5.8.1">IESG</t>
          </dd>
          <dt pn="section-8.2-5.9">
Contact:  </dt>
          <dd pn="section-8.2-5.10">
            <t indent="0" pn="section-8.2-5.10.1">IETF Chair</t>
          </dd>
          <dt pn="section-8.2-5.11">
Description:  </dt>
          <dd pn="section-8.2-5.12">
            <t indent="0" pn="section-8.2-5.12.1">DNS query-response protocol run over DTLS or QUIC</t>
          </dd>
          <dt pn="section-8.2-5.13">
Reference:  </dt>
          <dd pn="section-8.2-5.14">
            <t indent="0" pn="section-8.2-5.14.1"><xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/><xref target="RFC8094" format="default" sectionFormat="of" derivedContent="RFC8094"/> This document</t>
          </dd>
        </dl>
        <t indent="0" pn="section-8.2-6">Additionally, IANA has updated the Description field for the
corresponding TCP port 853 allocation to be "DNS query-response protocol run
over TLS" and removed <xref target="RFC8094" format="default" sectionFormat="of" derivedContent="RFC8094"/> from the TCP allocation's Reference field for consistency and clarity.</t>
      </section>
      <section anchor="reservation-of-extended-dns-error-code-too-early" numbered="true" toc="include" removeInRFC="false" pn="section-8.3">
        <name slugifiedName="name-reservation-of-an-extended-">Reservation of an Extended DNS Error Code: Too Early</name>
        <t indent="0" pn="section-8.3-1">IANA has registered the following value in
the "Extended DNS Error Codes" registry <xref target="RFC8914" format="default" sectionFormat="of" derivedContent="RFC8914"/>:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-8.3-2">
          <dt pn="section-8.3-2.1">
INFO-CODE:  </dt>
          <dd pn="section-8.3-2.2">
            <t indent="0" pn="section-8.3-2.2.1">26</t>
          </dd>
          <dt pn="section-8.3-2.3">
Purpose:  </dt>
          <dd pn="section-8.3-2.4">
            <t indent="0" pn="section-8.3-2.4.1">Too Early</t>
          </dd>
          <dt pn="section-8.3-2.5">
Reference:  </dt>
          <dd pn="section-8.3-2.6">
            <t indent="0" pn="section-8.3-2.6.1">This document</t>
          </dd>
        </dl>
      </section>
      <section anchor="iana-error-codes" numbered="true" toc="include" removeInRFC="false" pn="section-8.4">
        <name slugifiedName="name-dns-over-quic-error-codes-r">DNS-over-QUIC Error Codes Registry</name>
        <t indent="0" pn="section-8.4-1">IANA has added a registry for "DNS-over-QUIC Error Codes" on the
"Domain Name System (DNS) Parameters" web page.</t>
        <t indent="0" pn="section-8.4-2">The "DNS-over-QUIC Error Codes" registry governs a 62-bit space. This space is
split into three regions that are governed by different policies:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-8.4-3">
          <li pn="section-8.4-3.1">Permanent registrations for values between 0x00 and 0x3f (in hexadecimal;
inclusive), which are assigned using Standards Action or IESG Approval as
defined in Sections <xref target="RFC8126" section="4.9" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8126#section-4.9" derivedContent="RFC8126"/> and <xref target="RFC8126" section="4.10" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8126#section-4.10" derivedContent="RFC8126"/> of <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/></li>
          <li pn="section-8.4-3.2">Permanent registrations for values larger than 0x3f, which are assigned
using the Specification Required policy (<xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>)</li>
          <li pn="section-8.4-3.3">Provisional registrations for values larger than 0x3f, which require Expert
Review, as defined in <xref section="4.5" sectionFormat="of" target="RFC8126" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8126#section-4.5" derivedContent="RFC8126"/>.</li>
        </ul>
        <t indent="0" pn="section-8.4-4">Provisional reservations share the range of values larger than 0x3f
with some permanent registrations. This is by design to enable conversion
of provisional registrations into permanent registrations without requiring
changes in deployed systems. (This design is aligned with the principles
set in <xref section="22" sectionFormat="of" target="RFC9000" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9000#section-22" derivedContent="RFC9000"/>.)</t>
        <t indent="0" pn="section-8.4-5">Registrations in this registry <bcp14>MUST</bcp14> include the following fields:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-8.4-6">
          <dt pn="section-8.4-6.1">
Value:  </dt>
          <dd pn="section-8.4-6.2">
            <t indent="0" pn="section-8.4-6.2.1">The assigned codepoint</t>
          </dd>
          <dt pn="section-8.4-6.3">
Status:  </dt>
          <dd pn="section-8.4-6.4">
            <t indent="0" pn="section-8.4-6.4.1">"Permanent" or "Provisional"</t>
          </dd>
          <dt pn="section-8.4-6.5">
Contact:  </dt>
          <dd pn="section-8.4-6.6">
            <t indent="0" pn="section-8.4-6.6.1">Contact details for the registrant</t>
          </dd>
        </dl>
        <t indent="0" pn="section-8.4-7">In addition, permanent registrations <bcp14>MUST</bcp14> include:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-8.4-8">
          <dt pn="section-8.4-8.1">
Error:  </dt>
          <dd pn="section-8.4-8.2">
            <t indent="0" pn="section-8.4-8.2.1">A short mnemonic for the parameter</t>
          </dd>
          <dt pn="section-8.4-8.3">
Specification:  </dt>
          <dd pn="section-8.4-8.4">
            <t indent="0" pn="section-8.4-8.4.1">A reference to a publicly available specification for the value (optional for provisional registrations)</t>
          </dd>
          <dt pn="section-8.4-8.5">
Description:  </dt>
          <dd pn="section-8.4-8.6">
            <t indent="0" pn="section-8.4-8.6.1">A brief description of the error code semantics, which <bcp14>MAY</bcp14> be a summary if a
specification reference is provided</t>
          </dd>
        </dl>
        <t indent="0" pn="section-8.4-9">Provisional registrations of codepoints are intended to allow for private use
and experimentation with extensions to DoQ.  However,
provisional registrations could be reclaimed and reassigned for other purposes.
In addition to the parameters listed above, provisional registrations <bcp14>MUST</bcp14> include:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-8.4-10">
          <dt pn="section-8.4-10.1">
Date:  </dt>
          <dd pn="section-8.4-10.2">
            <t indent="0" pn="section-8.4-10.2.1">The date of last update to the registration</t>
          </dd>
        </dl>
        <t indent="0" pn="section-8.4-11">A request to update the date on any provisional
registration can be made without review from the designated expert(s).</t>
        <t indent="0" pn="section-8.4-12">The initial content of this registry is shown in <xref target="iana-error-table" format="default" sectionFormat="of" derivedContent="Table 1"/> and all
entries share the following fields:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-8.4-13">
          <dt pn="section-8.4-13.1">
Status:  </dt>
          <dd pn="section-8.4-13.2">
            <t indent="0" pn="section-8.4-13.2.1">Permanent</t>
          </dd>
          <dt pn="section-8.4-13.3">
Contact:  </dt>
          <dd pn="section-8.4-13.4">
            <t indent="0" pn="section-8.4-13.4.1">DPRIVE WG</t>
          </dd>
          <dt pn="section-8.4-13.5">
Specification:  </dt>
          <dd pn="section-8.4-13.6">
            <t indent="0" pn="section-8.4-13.6.1"><xref target="doq-error-codes" format="default" sectionFormat="of" derivedContent="Section 4.3"/></t>
          </dd>
        </dl>
        <table anchor="iana-error-table" align="center" pn="table-1">
          <name slugifiedName="name-initial-dns-over-quic-error">Initial DNS-over-QUIC Error Codes Entries</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="left" colspan="1" rowspan="1">Error</th>
              <th align="left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x0</td>
              <td align="left" colspan="1" rowspan="1">DOQ_NO_ERROR</td>
              <td align="left" colspan="1" rowspan="1">No error</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x1</td>
              <td align="left" colspan="1" rowspan="1">DOQ_INTERNAL_ERROR</td>
              <td align="left" colspan="1" rowspan="1">Implementation error</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x2</td>
              <td align="left" colspan="1" rowspan="1">DOQ_PROTOCOL_ERROR</td>
              <td align="left" colspan="1" rowspan="1">Generic protocol violation</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x3</td>
              <td align="left" colspan="1" rowspan="1">DOQ_REQUEST_CANCELLED</td>
              <td align="left" colspan="1" rowspan="1">Request cancelled by client</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x4</td>
              <td align="left" colspan="1" rowspan="1">DOQ_EXCESSIVE_LOAD</td>
              <td align="left" colspan="1" rowspan="1">Closing a connection for excessive load</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x5</td>
              <td align="left" colspan="1" rowspan="1">DOQ_UNSPECIFIED_ERROR</td>
              <td align="left" colspan="1" rowspan="1">No error reason specified</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0xd098ea5e</td>
              <td align="left" colspan="1" rowspan="1">DOQ_ERROR_RESERVED</td>
              <td align="left" colspan="1" rowspan="1">Alternative error code used for tests</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-dnsop-rfc8499bis" to="DNS-TERMS"/>
    <displayreference target="I-D.ietf-quic-bit-grease" to="GREASING-QUIC"/>
    <displayreference target="I-D.ietf-quic-http" to="HTTP/3"/>
    <references pn="section-9">
      <name slugifiedName="name-references">References</name>
      <references pn="section-9.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC1034" target="https://www.rfc-editor.org/info/rfc1034" quoteTitle="true" derivedAnchor="RFC1034">
          <front>
            <title>Domain names - concepts and facilities</title>
            <author initials="P.V." surname="Mockapetris" fullname="P.V. Mockapetris">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1987" month="November"/>
            <abstract>
              <t indent="0">This RFC is the revised basic definition of The Domain Name System.  It obsoletes RFC-882.  This memo describes the domain style names and their used for host address look up and electronic mail forwarding.  It discusses the clients and servers in the domain name system and the protocol used between them.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="13"/>
          <seriesInfo name="RFC" value="1034"/>
          <seriesInfo name="DOI" value="10.17487/RFC1034"/>
        </reference>
        <reference anchor="RFC1035" target="https://www.rfc-editor.org/info/rfc1035" quoteTitle="true" derivedAnchor="RFC1035">
          <front>
            <title>Domain names - implementation and specification</title>
            <author initials="P.V." surname="Mockapetris" fullname="P.V. Mockapetris">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1987" month="November"/>
            <abstract>
              <t indent="0">This RFC is the revised specification of the protocol and format used in the implementation of the Domain Name System.  It obsoletes RFC-883. This memo documents the details of the domain name client - server communication.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="13"/>
          <seriesInfo name="RFC" value="1035"/>
          <seriesInfo name="DOI" value="10.17487/RFC1035"/>
        </reference>
        <reference anchor="RFC1995" target="https://www.rfc-editor.org/info/rfc1995" quoteTitle="true" derivedAnchor="RFC1995">
          <front>
            <title>Incremental Zone Transfer in DNS</title>
            <author initials="M." surname="Ohta" fullname="M. Ohta">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1996" month="August"/>
            <abstract>
              <t indent="0">This document proposes extensions to the DNS protocols to provide an incremental zone transfer (IXFR) mechanism.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="1995"/>
          <seriesInfo name="DOI" value="10.17487/RFC1995"/>
        </reference>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC5936" target="https://www.rfc-editor.org/info/rfc5936" quoteTitle="true" derivedAnchor="RFC5936">
          <front>
            <title>DNS Zone Transfer Protocol (AXFR)</title>
            <author initials="E." surname="Lewis" fullname="E. Lewis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Hoenes" fullname="A. Hoenes" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="June"/>
            <abstract>
              <t indent="0">The standard means within the Domain Name System protocol for maintaining coherence among a zone's authoritative name servers consists of three mechanisms.  Authoritative Transfer (AXFR) is one of the mechanisms and is defined in RFC 1034 and RFC 1035.</t>
              <t indent="0">The definition of AXFR has proven insufficient in detail, thereby forcing implementations intended to be compliant to make assumptions, impeding interoperability.  Yet today we have a satisfactory set of implementations that do interoperate.  This document is a new definition of AXFR -- new in the sense that it records an accurate definition of an interoperable AXFR mechanism.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5936"/>
          <seriesInfo name="DOI" value="10.17487/RFC5936"/>
        </reference>
        <reference anchor="RFC6891" target="https://www.rfc-editor.org/info/rfc6891" quoteTitle="true" derivedAnchor="RFC6891">
          <front>
            <title>Extension Mechanisms for DNS (EDNS(0))</title>
            <author initials="J." surname="Damas" fullname="J. Damas">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Graff" fullname="M. Graff">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="April"/>
            <abstract>
              <t indent="0">The Domain Name System's wire protocol includes a number of fixed fields whose range has been or soon will be exhausted and does not allow requestors to advertise their capabilities to responders.  This document describes backward-compatible mechanisms for allowing the protocol to grow.</t>
              <t indent="0">This document updates the Extension Mechanisms for DNS (EDNS(0)) specification (and obsoletes RFC 2671) based on feedback from deployment experience in several implementations.  It also obsoletes RFC 2673 ("Binary Labels in the Domain Name System") and adds considerations on the use of extended labels in the DNS.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="75"/>
          <seriesInfo name="RFC" value="6891"/>
          <seriesInfo name="DOI" value="10.17487/RFC6891"/>
        </reference>
        <reference anchor="RFC7301" target="https://www.rfc-editor.org/info/rfc7301" quoteTitle="true" derivedAnchor="RFC7301">
          <front>
            <title>Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension</title>
            <author initials="S." surname="Friedl" fullname="S. Friedl">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Popov" fullname="A. Popov">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Langley" fullname="A. Langley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Stephan" fullname="E. Stephan">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="July"/>
            <abstract>
              <t indent="0">This document describes a Transport Layer Security (TLS) extension for application-layer protocol negotiation within the TLS handshake. For instances in which multiple application protocols are supported on the same TCP or UDP port, this extension allows the application layer to negotiate which protocol will be used within the TLS connection.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7301"/>
          <seriesInfo name="DOI" value="10.17487/RFC7301"/>
        </reference>
        <reference anchor="RFC7766" target="https://www.rfc-editor.org/info/rfc7766" quoteTitle="true" derivedAnchor="RFC7766">
          <front>
            <title>DNS Transport over TCP - Implementation Requirements</title>
            <author initials="J." surname="Dickinson" fullname="J. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Mankin" fullname="A. Mankin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Wessels" fullname="D. Wessels">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="March"/>
            <abstract>
              <t indent="0">This document specifies the requirement for support of TCP as a transport protocol for DNS implementations and provides guidelines towards DNS-over-TCP performance on par with that of DNS-over-UDP. This document obsoletes RFC 5966 and therefore updates RFC 1035 and RFC 1123.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7766"/>
          <seriesInfo name="DOI" value="10.17487/RFC7766"/>
        </reference>
        <reference anchor="RFC7830" target="https://www.rfc-editor.org/info/rfc7830" quoteTitle="true" derivedAnchor="RFC7830">
          <front>
            <title>The EDNS(0) Padding Option</title>
            <author initials="A." surname="Mayrhofer" fullname="A. Mayrhofer">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="May"/>
            <abstract>
              <t indent="0">This document specifies the EDNS(0) "Padding" option, which allows DNS clients and servers to pad request and response messages by a variable number of octets.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7830"/>
          <seriesInfo name="DOI" value="10.17487/RFC7830"/>
        </reference>
        <reference anchor="RFC7858" target="https://www.rfc-editor.org/info/rfc7858" quoteTitle="true" derivedAnchor="RFC7858">
          <front>
            <title>Specification for DNS over Transport Layer Security (TLS)</title>
            <author initials="Z." surname="Hu" fullname="Z. Hu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Zhu" fullname="L. Zhu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Heidemann" fullname="J. Heidemann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Mankin" fullname="A. Mankin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Wessels" fullname="D. Wessels">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="May"/>
            <abstract>
              <t indent="0">This document describes the use of Transport Layer Security (TLS) to provide privacy for DNS.  Encryption provided by TLS eliminates opportunities for eavesdropping and on-path tampering with DNS queries in the network, such as discussed in RFC 7626.  In addition, this document specifies two usage profiles for DNS over TLS and provides advice on performance considerations to minimize overhead from using TCP and TLS with DNS.</t>
              <t indent="0">This document focuses on securing stub-to-recursive traffic, as per the charter of the DPRIVE Working Group.  It does not prevent future applications of the protocol to recursive-to-authoritative traffic.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7858"/>
          <seriesInfo name="DOI" value="10.17487/RFC7858"/>
        </reference>
        <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <author initials="M." surname="Cotton" fullname="M. Cotton">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="June"/>
            <abstract>
              <t indent="0">Many protocols make use of points of extensibility that use constants to identify various protocol parameters.  To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper.  For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
              <t indent="0">To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed.  This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
              <t indent="0">This is the third edition of this document; it obsoletes RFC 5226.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="26"/>
          <seriesInfo name="RFC" value="8126"/>
          <seriesInfo name="DOI" value="10.17487/RFC8126"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8310" target="https://www.rfc-editor.org/info/rfc8310" quoteTitle="true" derivedAnchor="RFC8310">
          <front>
            <title>Usage Profiles for DNS over TLS and DNS over DTLS</title>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Gillmor" fullname="D. Gillmor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Reddy" fullname="T. Reddy">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="March"/>
            <abstract>
              <t indent="0">This document discusses usage profiles, based on one or more authentication mechanisms, which can be used for DNS over Transport Layer Security (TLS) or Datagram TLS (DTLS).  These profiles can increase the privacy of DNS transactions compared to using only cleartext DNS.  This document also specifies new authentication mechanisms -- it describes several ways that a DNS client can use an authentication domain name to authenticate a (D)TLS connection to a DNS server.  Additionally, it defines (D)TLS protocol profiles for DNS clients and servers implementing DNS over (D)TLS.  This document updates RFC 7858.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8310"/>
          <seriesInfo name="DOI" value="10.17487/RFC8310"/>
        </reference>
        <reference anchor="RFC8446" target="https://www.rfc-editor.org/info/rfc8446" quoteTitle="true" derivedAnchor="RFC8446">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="August"/>
            <abstract>
              <t indent="0">This document specifies version 1.3 of the Transport Layer Security (TLS) protocol.  TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t>
              <t indent="0">This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961.  This document also specifies new requirements for TLS 1.2 implementations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8446"/>
          <seriesInfo name="DOI" value="10.17487/RFC8446"/>
        </reference>
        <reference anchor="RFC8467" target="https://www.rfc-editor.org/info/rfc8467" quoteTitle="true" derivedAnchor="RFC8467">
          <front>
            <title>Padding Policies for Extension Mechanisms for DNS (EDNS(0))</title>
            <author initials="A." surname="Mayrhofer" fullname="A. Mayrhofer">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="October"/>
            <abstract>
              <t indent="0">RFC 7830 specifies the "Padding" option for Extension Mechanisms for DNS (EDNS(0)) but does not specify the actual padding length for specific applications.  This memo lists the possible options ("padding policies"), discusses the implications of each option, and provides a recommended (experimental) option.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8467"/>
          <seriesInfo name="DOI" value="10.17487/RFC8467"/>
        </reference>
        <reference anchor="RFC8914" target="https://www.rfc-editor.org/info/rfc8914" quoteTitle="true" derivedAnchor="RFC8914">
          <front>
            <title>Extended DNS Errors</title>
            <author initials="W." surname="Kumari" fullname="W. Kumari">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Hunt" fullname="E. Hunt">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Arends" fullname="R. Arends">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Hardaker" fullname="W. Hardaker">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Lawrence" fullname="D. Lawrence">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="October"/>
            <abstract>
              <t indent="0">This document defines an extensible method to return additional information about the cause of DNS errors. Though created primarily to extend SERVFAIL to provide additional information about the cause of DNS and DNSSEC failures, the Extended DNS Errors option defined in this document allows all response types to contain extended error information. Extended DNS Error information does not change the processing of RCODEs.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8914"/>
          <seriesInfo name="DOI" value="10.17487/RFC8914"/>
        </reference>
        <reference anchor="RFC9000" target="https://www.rfc-editor.org/info/rfc9000" quoteTitle="true" derivedAnchor="RFC9000">
          <front>
            <title>QUIC: A UDP-Based Multiplexed and Secure Transport</title>
            <author initials="J." surname="Iyengar" fullname="J. Iyengar" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Thomson" fullname="M. Thomson" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="May"/>
            <abstract>
              <t indent="0">This document defines the core of the QUIC transport protocol.  QUIC provides applications with flow-controlled streams for structured communication, low-latency connection establishment, and network path migration. QUIC includes security measures that ensure confidentiality, integrity, and availability in a range of deployment circumstances.  Accompanying documents describe the integration of TLS for key negotiation, loss detection, and an exemplary congestion control algorithm.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9000"/>
          <seriesInfo name="DOI" value="10.17487/RFC9000"/>
        </reference>
        <reference anchor="RFC9001" target="https://www.rfc-editor.org/info/rfc9001" quoteTitle="true" derivedAnchor="RFC9001">
          <front>
            <title>Using TLS to Secure QUIC</title>
            <author initials="M." surname="Thomson" fullname="M. Thomson" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Turner" fullname="S. Turner" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="May"/>
            <abstract>
              <t indent="0">This document describes how Transport Layer Security (TLS) is used to secure QUIC.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9001"/>
          <seriesInfo name="DOI" value="10.17487/RFC9001"/>
        </reference>
        <reference anchor="RFC9103" target="https://www.rfc-editor.org/info/rfc9103" quoteTitle="true" derivedAnchor="RFC9103">
          <front>
            <title>DNS Zone Transfer over TLS</title>
            <author initials="W." surname="Toorop" fullname="W. Toorop">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Sahib" fullname="S. Sahib">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Aras" fullname="P. Aras">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Mankin" fullname="A. Mankin">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="August"/>
            <abstract>
              <t indent="0">DNS zone transfers are transmitted in cleartext, which gives attackers the opportunity to collect the content of a zone by eavesdropping on network connections. The DNS Transaction Signature (TSIG) mechanism is specified to restrict direct zone transfer to authorized clients only, but it does not add confidentiality. This document specifies the use of TLS, rather than cleartext, to prevent zone content collection via passive monitoring of zone transfers: XFR over TLS (XoT). Additionally, this specification updates RFC 1995 and RFC 5936 with respect to efficient use of TCP connections and RFC 7766 with respect to the recommended number of connections between a client and server for each transport.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9103"/>
          <seriesInfo name="DOI" value="10.17487/RFC9103"/>
        </reference>
      </references>
      <references pn="section-9.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <referencegroup anchor="BCP195" target="https://www.rfc-editor.org/info/bcp195" derivedAnchor="BCP195">
          <reference anchor="RFC7525" target="https://www.rfc-editor.org/info/rfc7525" quoteTitle="true">
            <front>
              <title>Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</title>
              <author initials="Y." surname="Sheffer" fullname="Y. Sheffer">
                <organization showOnFrontPage="true"/>
              </author>
              <author initials="R." surname="Holz" fullname="R. Holz">
                <organization showOnFrontPage="true"/>
              </author>
              <author initials="P." surname="Saint-Andre" fullname="P. Saint-Andre">
                <organization showOnFrontPage="true"/>
              </author>
              <date year="2015" month="May"/>
              <abstract>
                <t indent="0">Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS) are widely used to protect data exchanged over application protocols such as HTTP, SMTP, IMAP, POP, SIP, and XMPP.  Over the last few years, several serious attacks on TLS have emerged, including attacks on its most commonly used cipher suites and their modes of operation.  This document provides recommendations for improving the security of deployed services that use TLS and DTLS. The recommendations are applicable to the majority of use cases.</t>
              </abstract>
            </front>
            <seriesInfo name="BCP" value="195"/>
            <seriesInfo name="RFC" value="7525"/>
            <seriesInfo name="DOI" value="10.17487/RFC7525"/>
          </reference>
          <reference anchor="RFC8996" target="https://www.rfc-editor.org/info/rfc8996" quoteTitle="true">
            <front>
              <title>Deprecating TLS 1.0 and TLS 1.1</title>
              <author initials="K." surname="Moriarty" fullname="K. Moriarty">
                <organization showOnFrontPage="true"/>
              </author>
              <author initials="S." surname="Farrell" fullname="S. Farrell">
                <organization showOnFrontPage="true"/>
              </author>
              <date year="2021" month="March"/>
              <abstract>
                <t indent="0">This document formally deprecates Transport Layer Security (TLS) versions 1.0 (RFC 2246) and 1.1 (RFC 4346). Accordingly, those documents have been moved to Historic status. These versions lack support for current and recommended cryptographic algorithms and mechanisms, and various government and industry profiles of applications using TLS now mandate avoiding these old TLS versions. TLS version 1.2 became the recommended version for IETF protocols in 2008 (subsequently being obsoleted by TLS version 1.3 in 2018), providing sufficient time to transition away from older versions. Removing support for older versions from implementations reduces the attack surface, reduces opportunity for misconfiguration, and streamlines library and product maintenance. </t>
                <t indent="0">This document also deprecates Datagram TLS (DTLS) version 1.0 (RFC 4347) but not DTLS version 1.2, and there is no DTLS version 1.1.</t>
                <t indent="0">This document updates many RFCs that normatively refer to TLS version 1.0 or TLS version 1.1, as described herein. This document also updates the best practices for TLS usage in RFC 7525; hence, it is part of BCP 195.</t>
              </abstract>
            </front>
            <seriesInfo name="BCP" value="195"/>
            <seriesInfo name="RFC" value="8996"/>
            <seriesInfo name="DOI" value="10.17487/RFC8996"/>
          </reference>
        </referencegroup>
        <reference anchor="I-D.ietf-dnsop-rfc8499bis" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-rfc8499bis-03" derivedAnchor="DNS-TERMS">
          <front>
            <title>DNS Terminology</title>
            <author fullname="Paul Hoffman">
              <organization showOnFrontPage="true">ICANN</organization>
            </author>
            <author fullname="Kazunori Fujiwara">
              <organization showOnFrontPage="true">Japan Registry Services Co., Ltd.</organization>
            </author>
            <date month="September" day="28" year="2021"/>
            <abstract>
              <t indent="0">   The Domain Name System (DNS) is defined in literally dozens of
   different RFCs.  The terminology used by implementers and developers
   of DNS protocols, and by operators of DNS systems, has sometimes
   changed in the decades since the DNS was first defined.  This
   document gives current definitions for many of the terms used in the
   DNS in a single document.

   This document obsoletes RFC 8499 and updates RFC 2308.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-dnsop-rfc8499bis-03"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-dnsop-rfc8499bis-03.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="DNS0RTT" target="https://www.ietf.org/mail-archive/web/dns-privacy/current/msg01276.html" quoteTitle="true" derivedAnchor="DNS0RTT">
          <front>
            <title>DNS + 0-RTT</title>
            <author initials="D." surname="Kahn Gillmor" fullname="Daniel Kahn Gillmor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="April" day="06"/>
          </front>
          <seriesInfo name="Message" value="to DNS-Privacy WG mailing list"/>
        </reference>
        <reference anchor="I-D.ietf-quic-bit-grease" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-quic-bit-grease-02" derivedAnchor="GREASING-QUIC">
          <front>
            <title>Greasing the QUIC Bit</title>
            <author fullname="Martin Thomson">
              <organization showOnFrontPage="true">Mozilla</organization>
            </author>
            <date month="November" day="10" year="2021"/>
            <abstract>
              <t indent="0">   This document describes a method for negotiating the ability to send
   an arbitrary value for the second-to-most significant bit in QUIC
   packets.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-quic-bit-grease-02"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-quic-bit-grease-02.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="I-D.ietf-quic-http" target="https://datatracker.ietf.org/doc/html/draft-ietf-quic-http-34" quoteTitle="true" derivedAnchor="HTTP/3">
          <front>
            <title>Hypertext Transfer Protocol Version 3 (HTTP/3)</title>
            <author initials="M" surname="Bishop" fullname="Mike Bishop" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date day="2" month="February" year="2021"/>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-quic-http-34"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="RFC1996" target="https://www.rfc-editor.org/info/rfc1996" quoteTitle="true" derivedAnchor="RFC1996">
          <front>
            <title>A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)</title>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1996" month="August"/>
            <abstract>
              <t indent="0">This memo describes the NOTIFY opcode for DNS, by which a master server advises a set of slave servers that the master's data has been changed and that a query should be initiated to discover the new data. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="1996"/>
          <seriesInfo name="DOI" value="10.17487/RFC1996"/>
        </reference>
        <reference anchor="RFC3833" target="https://www.rfc-editor.org/info/rfc3833" quoteTitle="true" derivedAnchor="RFC3833">
          <front>
            <title>Threat Analysis of the Domain Name System (DNS)</title>
            <author initials="D." surname="Atkins" fullname="D. Atkins">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Austein" fullname="R. Austein">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2004" month="August"/>
            <abstract>
              <t indent="0">Although the DNS Security Extensions (DNSSEC) have been under development for most of the last decade, the IETF has never written down the specific set of threats against which DNSSEC is designed to protect.  Among other drawbacks, this cart-before-the-horse situation has made it difficult to determine whether DNSSEC meets its design goals, since its design goals are not well specified.  This note attempts to document some of the known threats to the DNS, and, in doing so, attempts to measure to what extent (if any) DNSSEC is a useful tool in defending against these threats.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3833"/>
          <seriesInfo name="DOI" value="10.17487/RFC3833"/>
        </reference>
        <reference anchor="RFC6335" target="https://www.rfc-editor.org/info/rfc6335" quoteTitle="true" derivedAnchor="RFC6335">
          <front>
            <title>Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry</title>
            <author initials="M." surname="Cotton" fullname="M. Cotton">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Eggert" fullname="L. Eggert">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Touch" fullname="J. Touch">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Westerlund" fullname="M. Westerlund">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Cheshire" fullname="S. Cheshire">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="August"/>
            <abstract>
              <t indent="0">This document defines the procedures that the Internet Assigned Numbers Authority (IANA) uses when handling assignment and other requests related to the Service Name and Transport Protocol Port Number registry.  It also discusses the rationale and principles behind these procedures and how they facilitate the long-term sustainability of the registry.</t>
              <t indent="0">This document updates IANA's procedures by obsoleting the previous UDP and TCP port assignment procedures defined in Sections 8 and 9.1 of the IANA Allocation Guidelines, and it updates the IANA service name and port assignment procedures for UDP-Lite, the Datagram Congestion Control Protocol (DCCP), and the Stream Control Transmission Protocol (SCTP).  It also updates the DNS SRV specification to clarify what a service name is and how it is registered.  This memo documents an Internet Best Current Practice.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="165"/>
          <seriesInfo name="RFC" value="6335"/>
          <seriesInfo name="DOI" value="10.17487/RFC6335"/>
        </reference>
        <reference anchor="RFC7828" target="https://www.rfc-editor.org/info/rfc7828" quoteTitle="true" derivedAnchor="RFC7828">
          <front>
            <title>The edns-tcp-keepalive EDNS0 Option</title>
            <author initials="P." surname="Wouters" fullname="P. Wouters">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Abley" fullname="J. Abley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="April"/>
            <abstract>
              <t indent="0">DNS messages between clients and servers may be received over either UDP or TCP.  UDP transport involves keeping less state on a busy server, but can cause truncation and retries over TCP.  Additionally, UDP can be exploited for reflection attacks.  Using TCP would reduce retransmits and amplification.  However, clients commonly use TCP only for retries and servers typically use idle timeouts on the order of seconds.</t>
              <t indent="0">This document defines an EDNS0 option ("edns-tcp-keepalive") that allows DNS servers to signal a variable idle timeout.  This signalling encourages the use of long-lived TCP connections by allowing the state associated with TCP transport to be managed effectively with minimal impact on the DNS transaction time.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7828"/>
          <seriesInfo name="DOI" value="10.17487/RFC7828"/>
        </reference>
        <reference anchor="RFC7873" target="https://www.rfc-editor.org/info/rfc7873" quoteTitle="true" derivedAnchor="RFC7873">
          <front>
            <title>Domain Name System (DNS) Cookies</title>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Andrews" fullname="M. Andrews">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="May"/>
            <abstract>
              <t indent="0">DNS Cookies are a lightweight DNS transaction security mechanism that provides limited protection to DNS servers and clients against a variety of increasingly common denial-of-service and amplification/ forgery or cache poisoning attacks by off-path attackers.  DNS Cookies are tolerant of NAT, NAT-PT (Network Address Translation - Protocol Translation), and anycast and can be incrementally deployed. (Since DNS Cookies are only returned to the IP address from which they were originally received, they cannot be used to generally track Internet users.)</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7873"/>
          <seriesInfo name="DOI" value="10.17487/RFC7873"/>
        </reference>
        <reference anchor="RFC8094" target="https://www.rfc-editor.org/info/rfc8094" quoteTitle="true" derivedAnchor="RFC8094">
          <front>
            <title>DNS over Datagram Transport Layer Security (DTLS)</title>
            <author initials="T." surname="Reddy" fullname="T. Reddy">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Wing" fullname="D. Wing">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Patil" fullname="P. Patil">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="February"/>
            <abstract>
              <t indent="0">DNS queries and responses are visible to network elements on the path between the DNS client and its server.  These queries and responses can contain privacy-sensitive information, which is valuable to protect.</t>
              <t indent="0">This document proposes the use of Datagram Transport Layer Security (DTLS) for DNS, to protect against passive listeners and certain active attacks.  As latency is critical for DNS, this proposal also discusses mechanisms to reduce DTLS round trips and reduce the DTLS handshake size.  The proposed mechanism runs over port 853.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8094"/>
          <seriesInfo name="DOI" value="10.17487/RFC8094"/>
        </reference>
        <reference anchor="RFC8484" target="https://www.rfc-editor.org/info/rfc8484" quoteTitle="true" derivedAnchor="RFC8484">
          <front>
            <title>DNS Queries over HTTPS (DoH)</title>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="McManus" fullname="P. McManus">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="October"/>
            <abstract>
              <t indent="0">This document defines a protocol for sending DNS queries and getting DNS responses over HTTPS.  Each DNS query-response pair is mapped into an HTTP exchange.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8484"/>
          <seriesInfo name="DOI" value="10.17487/RFC8484"/>
        </reference>
        <reference anchor="RFC8490" target="https://www.rfc-editor.org/info/rfc8490" quoteTitle="true" derivedAnchor="RFC8490">
          <front>
            <title>DNS Stateful Operations</title>
            <author initials="R." surname="Bellis" fullname="R. Bellis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Cheshire" fullname="S. Cheshire">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Dickinson" fullname="J. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Lemon" fullname="T. Lemon">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Pusateri" fullname="T. Pusateri">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="March"/>
            <abstract>
              <t indent="0">This document defines a new DNS OPCODE for DNS Stateful Operations (DSO).  DSO messages communicate operations within persistent stateful sessions using Type Length Value (TLV) syntax.  Three TLVs are defined that manage session timeouts, termination, and encryption padding, and a framework is defined for extensions to enable new stateful operations.  This document updates RFC 1035 by adding a new DNS header OPCODE that has both different message semantics and a new result code.  This document updates RFC 7766 by redefining a session, providing new guidance on connection reuse, and providing a new mechanism for handling session idle timeouts.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8490"/>
          <seriesInfo name="DOI" value="10.17487/RFC8490"/>
        </reference>
        <reference anchor="RFC8932" target="https://www.rfc-editor.org/info/rfc8932" quoteTitle="true" derivedAnchor="RFC8932">
          <front>
            <title>Recommendations for DNS Privacy Service Operators</title>
            <author initials="S." surname="Dickinson" fullname="S. Dickinson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Overeinder" fullname="B. Overeinder">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="van Rijswijk-Deij" fullname="R. van Rijswijk-Deij">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Mankin" fullname="A. Mankin">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="October"/>
            <abstract>
              <t indent="0">This document presents operational, policy, and security considerations for DNS recursive resolver operators who choose to offer DNS privacy services.  With these recommendations, the operator can make deliberate decisions regarding which services to provide, as well as understanding how those decisions and the alternatives impact the privacy of users. </t>
              <t indent="0">This document also presents a non-normative framework to assist writers of a Recursive operator Privacy Statement, analogous to DNS Security Extensions (DNSSEC) Policies and DNSSEC Practice Statements described in RFC 6841.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="232"/>
          <seriesInfo name="RFC" value="8932"/>
          <seriesInfo name="DOI" value="10.17487/RFC8932"/>
        </reference>
        <reference anchor="RFC9002" target="https://www.rfc-editor.org/info/rfc9002" quoteTitle="true" derivedAnchor="RFC9002">
          <front>
            <title>QUIC Loss Detection and Congestion Control</title>
            <author initials="J." surname="Iyengar" fullname="J. Iyengar" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="I." surname="Swett" fullname="I. Swett" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="May"/>
            <abstract>
              <t indent="0">This document describes loss detection and congestion control mechanisms for QUIC.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9002"/>
          <seriesInfo name="DOI" value="10.17487/RFC9002"/>
        </reference>
        <reference anchor="RFC9076" target="https://www.rfc-editor.org/info/rfc9076" quoteTitle="true" derivedAnchor="RFC9076">
          <front>
            <title>DNS Privacy Considerations</title>
            <author initials="T." surname="Wicinski" fullname="T. Wicinski" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="July"/>
            <abstract>
              <t indent="0">This document describes the privacy issues associated with the use of the DNS by Internet users. It provides general observations about typical current privacy practices. It is intended to be an analysis of the present situation and does not prescribe solutions. This document obsoletes RFC 7626.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9076"/>
          <seriesInfo name="DOI" value="10.17487/RFC9076"/>
        </reference>
      </references>
    </references>
    <section anchor="the-notify-service" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-the-notify-service">The NOTIFY Service</name>
      <t indent="0" pn="section-appendix.a-1">This appendix discusses why it is considered acceptable to send NOTIFY
(see <xref target="RFC1996" format="default" sectionFormat="of" derivedContent="RFC1996"/>) in 0-RTT data.</t>
      <t indent="0" pn="section-appendix.a-2"><xref target="session-resumption-and-0-rtt" format="default" sectionFormat="of" derivedContent="Section 4.5"/> says "The 0-RTT mechanism <bcp14>MUST NOT</bcp14>
be used to send DNS requests that are not "replayable" transactions". This
specification supports sending a NOTIFY in 0-RTT data because
although a NOTIFY technically changes the state of the receiving server, the
effect of replaying NOTIFYs has negligible impact in practice.</t>
      <t indent="0" pn="section-appendix.a-3">NOTIFY messages prompt a secondary to either send an SOA query or an XFR
request to the primary on the basis that a newer version of the zone is
available. It has long been recognized that NOTIFYs can be forged and, in
theory, used to cause a secondary to send repeated unnecessary requests to the
primary. For this reason, most implementations have some form of throttling of the
SOA/XFR queries triggered by the receipt of one or more NOTIFYs.</t>
      <t indent="0" pn="section-appendix.a-4"><xref target="RFC9103" format="default" sectionFormat="of" derivedContent="RFC9103"/> describes the privacy risks associated with both NOTIFY and SOA queries
and does not include addressing those risks within the scope of encrypting zone
transfers. Given this, the privacy benefit of using DoQ for NOTIFY is not clear,
but for the same reason, sending NOTIFY as 0-RTT data has no privacy risk above
that of sending it using cleartext DNS.</t>
    </section>
    <section anchor="acknowledgements" numbered="false" toc="include" removeInRFC="false" pn="section-appendix.b">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.b-1">This document liberally borrows text from the HTTP/3 specification
      <xref target="I-D.ietf-quic-http" format="default" sectionFormat="of" derivedContent="HTTP/3"/> edited by <contact fullname="Mike       Bishop"/> and from the DoT specification <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858"/> authored by <contact fullname="Zi Hu"/>, <contact fullname="Liang Zhu"/>, <contact fullname="John Heidemann"/>, <contact fullname="Allison       Mankin"/>, <contact fullname="Duane Wessels"/>, and <contact fullname="Paul Hoffman"/>.</t>
      <t indent="0" pn="section-appendix.b-2">The privacy issue with 0-RTT data and session resumption was
      analyzed by <contact fullname="Daniel Kahn Gillmor"/> (DKG) in a message to the IETF DPRIVE
      Working Group <xref target="DNS0RTT" format="default" sectionFormat="of" derivedContent="DNS0RTT"/>.</t>
      <t indent="0" pn="section-appendix.b-3">Thanks to <contact fullname="Tony Finch"/> for an extensive review of the initial draft version
      of this document, and to <contact fullname="Robert Evans"/> for the discussion of 0-RTT privacy
      issues.  Early reviews by <contact fullname="Paul Hoffman"/> and <contact fullname="Martin Thomson"/> and
      interoperability tests conducted by Stephane Bortzmeyer helped improve
      the definition of the protocol.</t>
      <t indent="0" pn="section-appendix.b-4">Thanks also to <contact fullname="Martin Thomson"/> and <contact fullname="Martin Duke"/> for their later reviews
      focusing on the low-level QUIC details, which helped clarify several
      aspects of DoQ. Thanks to <contact fullname="Andrey Meshkov"/>, <contact fullname="Loganaden Velvindron"/>, <contact fullname="Lucas       Pardue"/>, <contact fullname="Matt Joras"/>, <contact fullname="Mirja Kuelewind"/>, <contact fullname="Brian Trammell"/>, and <contact fullname="Phillip       Hallam-Baker"/> for their reviews and contributions.</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.c">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author initials="C" surname="Huitema" fullname="Christian Huitema">
        <organization showOnFrontPage="true">Private Octopus Inc.</organization>
        <address>
          <postal>
            <street>427 Golfcourse Rd</street>
            <city>Friday Harbor</city>
            <code>WA 98250</code>
            <country>USA</country>
          </postal>
          <email>huitema@huitema.net</email>
        </address>
      </author>
      <author initials="S." surname="Dickinson" fullname="Sara Dickinson">
        <organization showOnFrontPage="true">Sinodun IT</organization>
        <address>
          <postal>
            <street>Oxford Science Park</street>
            <city>Oxford</city>
            <code>OX4 4GA</code>
            <country>United Kingdom</country>
          </postal>
          <email>sara@sinodun.com</email>
        </address>
      </author>
      <author initials="A." surname="Mankin" fullname="Allison Mankin">
        <organization showOnFrontPage="true">Salesforce</organization>
        <address>
          <email>allison.mankin@gmail.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
