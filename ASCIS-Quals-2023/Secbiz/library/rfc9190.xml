<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-emu-eap-tls13-21" indexInclude="true" ipr="trust200902" number="9190" prepTime="2022-02-15T18:13:43" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" updates="5216" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-emu-eap-tls13-21" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9190" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="EAP-TLS 1.3">EAP-TLS 1.3: Using the Extensible Authentication Protocol with TLS 1.3</title>
    <seriesInfo name="RFC" value="9190" stream="IETF"/>
    <author initials="J." surname="Preuß Mattsson" fullname="John Preuß Mattsson">
      <organization showOnFrontPage="true">Ericsson</organization>
      <address>
        <postal>
          <street/>
          <city>Kista</city>
          <code>164 40</code>
          <country>Sweden</country>
        </postal>
        <email>john.mattsson@ericsson.com</email>
      </address>
    </author>
    <author initials="M" surname="Sethi" fullname="Mohit Sethi">
      <organization showOnFrontPage="true">Ericsson</organization>
      <address>
        <postal>
          <street/>
          <city>Jorvas</city>
          <code>02420</code>
          <country>Finland</country>
        </postal>
        <email>mohit@iki.fi</email>
      </address>
    </author>
    <date month="02" year="2022"/>
    <workgroup>EMU</workgroup>
    <keyword>Extensible Authentication Protocol</keyword>
    <keyword>IEEE 802</keyword>
    <keyword>5G</keyword>
    <keyword>authentication</keyword>
    <keyword>identity protection</keyword>
    <keyword>privacy</keyword>
    <keyword>forward secrecy</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
	The Extensible Authentication Protocol (EAP), defined in RFC 3748, provides a standard mechanism for support of multiple authentication methods. This document specifies the use of EAP-TLS with TLS 1.3 while remaining backwards compatible with existing implementations of EAP-TLS. TLS 1.3 provides significantly improved security and privacy, and reduced latency when compared to earlier versions of TLS. EAP-TLS with TLS 1.3 (EAP-TLS 1.3) further improves security and privacy by always providing forward secrecy, never disclosing the peer identity, and by mandating use of revocation checking when compared to EAP-TLS with earlier versions of TLS. This document also provides guidance on authentication, authorization, and resumption for EAP-TLS in general (regardless of the underlying TLS version used). This document updates RFC 5216.
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9190" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-and-terminolog">Requirements and Terminology</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-protocol-overview">Protocol Overview</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2">
              <li pn="section-toc.1-1.2.2.1">
                <t indent="0" pn="section-toc.1-1.2.2.1.1"><xref derivedContent="2.1" format="counter" sectionFormat="of" target="section-2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-overview-of-the-eap-tls-con">Overview of the EAP-TLS Conversation</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2.1.2">
                  <li pn="section-toc.1-1.2.2.1.2.1">
                    <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.1.2.1.1"><xref derivedContent="2.1.1" format="counter" sectionFormat="of" target="section-2.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-authentication">Authentication</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.2">
                    <t indent="0" pn="section-toc.1-1.2.2.1.2.2.1"><xref derivedContent="2.1.2" format="counter" sectionFormat="of" target="section-2.1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ticket-establishment">Ticket Establishment</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.3">
                    <t indent="0" pn="section-toc.1-1.2.2.1.2.3.1"><xref derivedContent="2.1.3" format="counter" sectionFormat="of" target="section-2.1.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-resumption">Resumption</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.4">
                    <t indent="0" pn="section-toc.1-1.2.2.1.2.4.1"><xref derivedContent="2.1.4" format="counter" sectionFormat="of" target="section-2.1.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-termination">Termination</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.5">
                    <t indent="0" pn="section-toc.1-1.2.2.1.2.5.1"><xref derivedContent="2.1.5" format="counter" sectionFormat="of" target="section-2.1.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-no-peer-authentication">No Peer Authentication</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.6">
                    <t indent="0" pn="section-toc.1-1.2.2.1.2.6.1"><xref derivedContent="2.1.6" format="counter" sectionFormat="of" target="section-2.1.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-hello-retry-request">Hello Retry Request</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.7">
                    <t indent="0" pn="section-toc.1-1.2.2.1.2.7.1"><xref derivedContent="2.1.7" format="counter" sectionFormat="of" target="section-2.1.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-identity">Identity</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.8">
                    <t indent="0" pn="section-toc.1-1.2.2.1.2.8.1"><xref derivedContent="2.1.8" format="counter" sectionFormat="of" target="section-2.1.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy">Privacy</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.9">
                    <t indent="0" pn="section-toc.1-1.2.2.1.2.9.1"><xref derivedContent="2.1.9" format="counter" sectionFormat="of" target="section-2.1.9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-fragmentation">Fragmentation</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.2.2.2">
                <t indent="0" pn="section-toc.1-1.2.2.2.1"><xref derivedContent="2.2" format="counter" sectionFormat="of" target="section-2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-identity-verification">Identity Verification</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.3">
                <t indent="0" pn="section-toc.1-1.2.2.3.1"><xref derivedContent="2.3" format="counter" sectionFormat="of" target="section-2.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-hierarchy">Key Hierarchy</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.4">
                <t indent="0" pn="section-toc.1-1.2.2.4.1"><xref derivedContent="2.4" format="counter" sectionFormat="of" target="section-2.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-parameter-negotiation-and-c">Parameter Negotiation and Compliance Requirements</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.5">
                <t indent="0" pn="section-toc.1-1.2.2.5.1"><xref derivedContent="2.5" format="counter" sectionFormat="of" target="section-2.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-eap-state-machines">EAP State Machines</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-detailed-description-of-the">Detailed Description of the EAP-TLS Protocol</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-claims">Security Claims</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-peer-and-server-identities">Peer and Server Identities</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t indent="0" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-certificate-validation">Certificate Validation</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.4">
                <t indent="0" pn="section-toc.1-1.5.2.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-certificate-revocation">Certificate Revocation</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.5">
                <t indent="0" pn="section-toc.1-1.5.2.5.1"><xref derivedContent="5.5" format="counter" sectionFormat="of" target="section-5.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-packet-modification-attacks">Packet Modification Attacks</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.6">
                <t indent="0" pn="section-toc.1-1.5.2.6.1"><xref derivedContent="5.6" format="counter" sectionFormat="of" target="section-5.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-authorization">Authorization</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.7">
                <t indent="0" pn="section-toc.1-1.5.2.7.1"><xref derivedContent="5.7" format="counter" sectionFormat="of" target="section-5.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-resumption-2">Resumption</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.8">
                <t indent="0" pn="section-toc.1-1.5.2.8.1"><xref derivedContent="5.8" format="counter" sectionFormat="of" target="section-5.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-privacy-considerations">Privacy Considerations</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.9">
                <t indent="0" pn="section-toc.1-1.5.2.9.1"><xref derivedContent="5.9" format="counter" sectionFormat="of" target="section-5.9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-pervasive-monitoring">Pervasive Monitoring</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.10">
                <t indent="0" pn="section-toc.1-1.5.2.10.1"><xref derivedContent="5.10" format="counter" sectionFormat="of" target="section-5.10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-discovered-vulnerabilities">Discovered Vulnerabilities</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.11">
                <t indent="0" pn="section-toc.1-1.5.2.11.1"><xref derivedContent="5.11" format="counter" sectionFormat="of" target="section-5.11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-cross-protocol-attacks">Cross-Protocol Attacks</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t indent="0" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative references</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-updated-references">Updated References</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.c"/><xref derivedContent="" format="title" sectionFormat="of" target="name-contributors">Contributors</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.d"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">The Extensible Authentication Protocol (EAP), defined in <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/>, provides a standard mechanism for
      support of multiple authentication methods. EAP-TLS <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/> specifies an EAP authentication
      method with certificate-based mutual authentication utilizing the TLS
      handshake protocol for cryptographic algorithms and protocol version
      negotiation and establishment of shared secret keying material. EAP-TLS
      is widely supported for authentication and key establishment in IEEE
      802.11 <xref target="IEEE-802.11" format="default" sectionFormat="of" derivedContent="IEEE-802.11"/> (Wi-Fi) and IEEE
      802.1AE <xref target="IEEE-802.1AE" format="default" sectionFormat="of" derivedContent="IEEE-802.1AE"/> (MACsec) networks
      using IEEE 802.1X <xref target="IEEE-802.1X" format="default" sectionFormat="of" derivedContent="IEEE-802.1X"/> and it's
      the default mechanism for certificate-based authentication in 3GPP 5G
      <xref target="TS.33.501" format="default" sectionFormat="of" derivedContent="TS.33.501"/> and MulteFire <xref target="MulteFire" format="default" sectionFormat="of" derivedContent="MulteFire"/> networks.

Many other EAP methods such as Flexible Authentication via Secure Tunneling
(EAP-FAST) <xref target="RFC4851" format="default" sectionFormat="of" derivedContent="RFC4851"/>, Tunneled Transport Layer
Security (EAP-TTLS) <xref target="RFC5281" format="default" sectionFormat="of" derivedContent="RFC5281"/>, the Tunnel
Extensible Authentication Protocol (TEAP) <xref target="RFC7170" format="default" sectionFormat="of" derivedContent="RFC7170"/>, as well as vendor-specific EAP methods such as the
Protected Extensible Authentication Protocol (PEAP) <xref target="PEAP" format="default" sectionFormat="of" derivedContent="PEAP"/>, depend on TLS and EAP-TLS.
 

      </t>
      <t indent="0" pn="section-1-2">EAP-TLS <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/> references TLS 1.0
      <xref target="RFC2246" format="default" sectionFormat="of" derivedContent="RFC2246"/> and TLS 1.1 <xref target="RFC4346" format="default" sectionFormat="of" derivedContent="RFC4346"/> but can also work with TLS 1.2 <xref target="RFC5246" format="default" sectionFormat="of" derivedContent="RFC5246"/>. TLS 1.0 and 1.1 are formally
      deprecated and prohibited from being negotiated or used <xref target="RFC8996" format="default" sectionFormat="of" derivedContent="RFC8996"/>. Weaknesses found in TLS 1.2 as well as new
      requirements for security, privacy, and reduced latency have led to the
      specification of TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>,
      which obsoletes TLS 1.2 <xref target="RFC5246" format="default" sectionFormat="of" derivedContent="RFC5246"/>. TLS
      1.3 is in large part a complete remodeling of the TLS handshake
      protocol including a different message flow, different handshake
      messages, different key schedule, different cipher suites, different
      resumption mechanism, different privacy protection, and different record
      padding. This means that significant parts of the normative text in the
      previous EAP-TLS specification <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>
      are not applicable to EAP-TLS with TLS 1.3. Therefore, aspects such as
      resumption, privacy handling, and key derivation need to be
      appropriately addressed for EAP-TLS with TLS 1.3.</t>
      <t indent="0" pn="section-1-3">This document updates <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/> to define how to use EAP-TLS with TLS 1.3. When older TLS versions are negotiated, RFC 5216 applies to maintain backwards compatibility. However, this document does provide additional guidance on authentication, authorization, and resumption for EAP-TLS regardless of the underlying TLS version used. This document only describes differences compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>. When EAP-TLS is used with TLS 1.3, some references are updated as specified in <xref target="updateref" format="default" sectionFormat="of" derivedContent="Appendix A"/>. All message flows are example message flows specific to TLS 1.3 and do not apply to TLS 1.2. Since EAP-TLS couples the TLS handshake state machine with the EAP state machine, it is possible that new versions of TLS will cause incompatibilities that introduce failures or security issues if they are not carefully integrated into the EAP-TLS protocol. Therefore, implementations <bcp14>MUST</bcp14> limit the maximum TLS version they use to 1.3, unless later versions are explicitly enabled by the administrator.</t>
      <t indent="0" pn="section-1-4">This document specifies EAP-TLS 1.3 and does not specify how other TLS-based EAP methods use TLS 1.3. The specification for how other TLS-based EAP methods use TLS 1.3 is left to other documents such as <xref target="I-D.ietf-emu-tls-eap-types" format="default" sectionFormat="of" derivedContent="TLS-EAP-TYPES"/>.</t>
      <t indent="0" pn="section-1-5">In addition to the improved security and privacy offered by TLS 1.3, there are other significant benefits of using EAP-TLS with TLS 1.3. Privacy, which in EAP-TLS means that no information about the underlying peer identity is disclosed, is mandatory and achieved without any additional round trips. Revocation checking is mandatory and simplified with Online Certificate Status Protocol (OCSP) stapling, and TLS 1.3 introduces more possibilities to reduce fragmentation when compared to earlier versions of TLS.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-1.1">
        <name slugifiedName="name-requirements-and-terminolog">Requirements and Terminology</name>
        <t indent="0" pn="section-1.1-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
        <t indent="0" pn="section-1.1-2">Readers are expected to be familiar with the terms and concepts used in EAP-TLS <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/> and TLS <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>. The term EAP-TLS peer is used for the entity acting as EAP peer and TLS client. The term EAP-TLS server is used for the entity acting as EAP server and TLS server.</t>
        <t indent="0" pn="section-1.1-3">This document follows the terminology from <xref target="I-D.ietf-tls-rfc8446bis" format="default" sectionFormat="of" derivedContent="TLS-bis"/> where the master secret is renamed to the main secret and the exporter_master_secret is renamed to the exporter_secret.</t>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-protocol-overview">Protocol Overview</name>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1">
        <name slugifiedName="name-overview-of-the-eap-tls-con">Overview of the EAP-TLS Conversation</name>
        <t indent="0" pn="section-2.1-1">This section updates <xref target="RFC5216" sectionFormat="of" section="2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1" derivedContent="RFC5216"/> by amending it in accordance with the
        following discussion.</t>
        <t indent="0" pn="section-2.1-2">If the TLS implementation correctly implements TLS version
        negotiation, EAP-TLS will automatically leverage that capability. The
        EAP-TLS implementation needs to know which version of TLS was
        negotiated to correctly support EAP-TLS 1.3 as well as to maintain
        backward compatibility with EAP-TLS 1.2.</t>
        <t indent="0" pn="section-2.1-3">TLS 1.3 changes both the message flow and the handshake messages
        compared to earlier versions of TLS. Therefore, much of <xref target="RFC5216" sectionFormat="of" section="2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1" derivedContent="RFC5216"/>
        does not apply for TLS 1.3. Except for Sections <xref target="identity" format="counter" sectionFormat="of" derivedContent="2.2"/> and <xref target="secres" format="counter" sectionFormat="of" derivedContent="5.7"/>, this update applies only when TLS 1.3 is
        negotiated. When TLS 1.2 is negotiated, then <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/> applies.</t>
        <t indent="0" pn="section-2.1-4">TLS 1.3 introduces several new handshake messages including
        HelloRetryRequest, NewSessionTicket, and KeyUpdate. In general, these
        messages will be handled by the underlying TLS libraries and are not
        visible to EAP-TLS; however, there are a few things to note:

        </t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-2.1-5">
          <li pn="section-2.1-5.1">The HelloRetryRequest is used by the server to reject the
          parameters offered in the ClientHello and suggest new
          parameters. When this message is encountered, it will increase the
          number of round trips used by the protocol.</li>
          <li pn="section-2.1-5.2">The NewSessionTicket message is used to convey resumption information and is covered in Sections <xref target="ticket" format="counter" sectionFormat="of" derivedContent="2.1.2"/> and <xref target="resumption" format="counter" sectionFormat="of" derivedContent="2.1.3"/>.</li>
          <li pn="section-2.1-5.3">The KeyUpdate message is used to update the traffic keys used on
          a TLS connection. EAP-TLS does not encrypt significant amounts of
          data so this functionality is not needed. Implementations
          <bcp14>SHOULD NOT</bcp14> send this message; however, some TLS
          libraries may automatically generate and process this message.</li>
          <li pn="section-2.1-5.4">Early Data <bcp14>MUST NOT</bcp14> be used in EAP-TLS. EAP-TLS servers <bcp14>MUST NOT</bcp14> send an early_data extension and clients <bcp14>MUST NOT</bcp14> send an EndOfEarlyData message.</li>
          <li pn="section-2.1-5.5">Post-handshake authentication <bcp14>MUST NOT</bcp14> be used in EAP-TLS. Clients <bcp14>MUST NOT</bcp14> send a "post_handshake_auth" extension and Servers <bcp14>MUST NOT</bcp14> request post-handshake client authentication.</li>
        </ul>
        <t indent="0" pn="section-2.1-6">After receiving an EAP-Request packet with EAP-Type=EAP-TLS as described in <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>, the conversation will continue with the TLS handshake protocol encapsulated in the data fields of EAP-Response and EAP-Request packets. When EAP-TLS is used with TLS version 1.3, the formatting and processing of the TLS handshake <bcp14>SHALL</bcp14> be done as specified in version 1.3 of TLS. This update only lists additional and different requirements, restrictions, and processing compared to <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> and <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
        <section anchor="section_auth" numbered="true" toc="include" removeInRFC="false" pn="section-2.1.1">
          <name slugifiedName="name-authentication">Authentication</name>
          <t indent="0" pn="section-2.1.1-1">This section updates <xref target="RFC5216" sectionFormat="of" section="2.1.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1.1" derivedContent="RFC5216"/> by amending it in accordance with the following discussion.</t>
          <t indent="0" pn="section-2.1.1-2">The EAP-TLS server <bcp14>MUST</bcp14> authenticate with a
	  certificate and <bcp14>SHOULD</bcp14> require the EAP-TLS peer to
	  authenticate with a certificate. Certificates can be of any type
	  supported by TLS including raw public keys. Pre-Shared Key (PSK)
	  authentication <bcp14>SHALL NOT</bcp14> be used except for
	  resumption. The full handshake in EAP-TLS with TLS 1.3 always
	  provides forward secrecy by exchange of ephemeral "key_share"
	  extensions in the ClientHello and ServerHello (e.g., containing
	  Ephemeral Elliptic Curve Diffie-Hellman (ECDHE) public keys). SessionID is deprecated in TLS 1.3;


	  see Sections <xref target="RFC8446" section="4.1.2" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-4.1.2" derivedContent="RFC8446"/> and <xref target="RFC8446" section="4.1.3" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-4.1.3" derivedContent="RFC8446"/> of <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>. TLS 1.3
	  introduced early application data that like all application data
	  (other than the protected success indication described below) is not
	  used in EAP-TLS; see <xref target="RFC8446" sectionFormat="of" section="4.2.10" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-4.2.10" derivedContent="RFC8446"/> for additional information on
	  the "early_data" extension. Resumption is handled as described in
	  <xref target="resumption" format="default" sectionFormat="of" derivedContent="Section 2.1.3"/>. As a protected success
	  indication <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/>, the EAP-TLS
	  server always sends TLS application data 0x00; see <xref target="state" format="default" sectionFormat="of" derivedContent="Section 2.5"/>. Note that a TLS implementation <bcp14>MAY</bcp14>
	  not allow the EAP-TLS layer to control in which order things are
	  sent and the application data <bcp14>MAY</bcp14> therefore be sent
	  before a NewSessionTicket. TLS application data 0x00 is therefore to
	  be interpreted as success after the EAP-Request that contains TLS
	  application data 0x00. After the EAP-TLS server has sent an
	  EAP-Request containing the TLS application data 0x00 and received an
	  EAP-Response packet of EAP-Type=EAP-TLS and no data, the EAP-TLS
	  server sends EAP-Success.</t>
          <t indent="0" pn="section-2.1.1-3"><xref target="figbase1" format="default" sectionFormat="of" derivedContent="Figure 1"/> shows an example
          message flow for a successful EAP-TLS full handshake with mutual
          authentication (and neither HelloRetryRequest nor post-handshake
          messages are sent).</t>
          <figure anchor="figbase1" align="left" suppress-title="false" pn="figure-1">
            <name slugifiedName="name-eap-tls-mutual-authenticati">EAP-TLS Mutual Authentication</name>
            <artwork name="" type="" align="left" alt="" pn="section-2.1.1-4.1">
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</artwork>
          </figure>
        </section>
        <section anchor="ticket" numbered="true" toc="include" removeInRFC="false" pn="section-2.1.2">
          <name slugifiedName="name-ticket-establishment">Ticket Establishment</name>
          <t indent="0" pn="section-2.1.2-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
          <t indent="0" pn="section-2.1.2-2">To enable resumption when using EAP-TLS with TLS 1.3, the EAP-TLS server <bcp14>MUST</bcp14> send one or more post-handshake NewSessionTicket messages (each associated with a PSK, a PSK identity, a ticket lifetime, and other parameters) in the initial authentication. Note that TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> limits the ticket lifetime to a maximum of 604800 seconds (7 days) and EAP-TLS servers <bcp14>MUST</bcp14> respect this upper limit when issuing tickets. The NewSessionTicket is sent after the EAP-TLS server has received the client Finished message in the initial authentication. The NewSessionTicket can be sent in the same flight as the TLS server Finished or later. The PSK associated with the ticket depends on the client Finished and cannot be pre-computed (so as to be sent in the same flight as the TLS server Finished) in handshakes with client authentication. The NewSessionTicket message <bcp14>MUST NOT</bcp14> include an "early_data" extension. If the "early_data" extension is received, then it <bcp14>MUST</bcp14> be ignored. Servers should take into account that fewer NewSessionTickets will likely be needed in EAP-TLS than in the usual HTTPS connection scenario. In most cases, a single NewSessionTicket will be sufficient. A mechanism by which clients can specify the desired number of tickets needed for future connections is defined in <xref target="I-D.ietf-tls-ticketrequests" format="default" sectionFormat="of" derivedContent="TICKET-REQUESTS"/>.</t>
          <t indent="0" pn="section-2.1.2-3"><xref target="figbase2" format="default" sectionFormat="of" derivedContent="Figure 2"/> shows an example message flow for a successful EAP-TLS full handshake with mutual authentication and ticket establishment of a single ticket.</t>
          <figure anchor="figbase2" align="left" suppress-title="false" pn="figure-2">
            <name slugifiedName="name-eap-tls-ticket-establishmen">EAP-TLS Ticket Establishment</name>
            <artwork name="" type="" align="left" alt="" pn="section-2.1.2-4.1">
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                            (TLS NewSessionTicket,
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</artwork>
          </figure>
        </section>
        <section anchor="resumption" numbered="true" toc="include" removeInRFC="false" pn="section-2.1.3">
          <name slugifiedName="name-resumption">Resumption</name>
          <t indent="0" pn="section-2.1.3-1">This section updates <xref target="RFC5216" sectionFormat="of" section="2.1.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1.2" derivedContent="RFC5216"/> by amending it in accordance with the following discussion.</t>
          <t indent="0" pn="section-2.1.3-2">EAP-TLS is typically used with client authentication and
          typically fragments the TLS flights into a large number of
          EAP-requests and EAP-responses. Resumption significantly reduces the
          number of round trips and enables the EAP-TLS server to omit
          database lookups needed during a full handshake with client
          authentication. TLS 1.3 replaces the session resumption mechanisms
          in earlier versions of TLS with a new PSK exchange. When EAP-TLS is
          used with TLS version 1.3, EAP-TLS <bcp14>SHALL</bcp14> use a
          resumption mechanism compatible with version 1.3 of TLS.</t>
          <t indent="0" pn="section-2.1.3-3">For TLS 1.3, resumption is described in <xref target="RFC8446" sectionFormat="of" section="2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-2.2" derivedContent="RFC8446"/>. If the client
          has received a NewSessionTicket message from the EAP-TLS server, the
          client can use the PSK identity associated with the ticket to
          negotiate the use of the associated PSK. If the EAP-TLS server
          accepts it, then the resumed session has been deemed to be
          authenticated and securely associated with the prior authentication
          or resumption. It is up to the EAP-TLS peer to use resumption, but
          it is <bcp14>RECOMMENDED</bcp14> that the EAP-TLS peer use
          resumption if it has a valid ticket that has not been used
          before. It is left to the EAP-TLS server whether to accept
          resumption, but it is <bcp14>RECOMMENDED</bcp14> that the EAP-TLS
          server accept resumption if the ticket that was issued is still
          valid. However, the EAP-TLS server <bcp14>MAY</bcp14> choose to
          require a full handshake. In the case a full handshake is required,
          the negotiation proceeds as if the session was a new authentication,
          and the resumption attempt is ignored. The requirements of Sections
          <xref target="section_auth" format="counter" sectionFormat="of" derivedContent="2.1.1"/> and <xref target="ticket" format="counter" sectionFormat="of" derivedContent="2.1.2"/> then apply in their entirety. As
          described in <xref target="RFC8446" format="default" sectionFormat="of" section="C.4" derivedLink="https://rfc-editor.org/rfc/rfc8446#appendix-C.4" derivedContent="RFC8446"/>, reuse of a ticket allows
          passive observers to correlate different connections. EAP-TLS peers
          and EAP-TLS servers <bcp14>SHOULD</bcp14> follow the client tracking
          preventions in <xref target="RFC8446" format="default" sectionFormat="of" section="C.4" derivedLink="https://rfc-editor.org/rfc/rfc8446#appendix-C.4" derivedContent="RFC8446"/>.</t>
          <t indent="0" pn="section-2.1.3-4">It is <bcp14>RECOMMENDED</bcp14> to use Network Access
          Identifiers (NAIs) with the same realm during resumption and the
          original full handshake. This requirement allows EAP packets to be
          routed to the same destination as the original full handshake. If
          this recommendation is not followed, resumption is likely
          impossible. When NAI reuse can be done without privacy implications,
          it is <bcp14>RECOMMENDED</bcp14> to use the same NAI in the
          resumption as was used in the original full handshake <xref target="RFC7542" format="default" sectionFormat="of" derivedContent="RFC7542"/>. For example, the NAI @realm can
          safely be reused since it does not provide any specific information
          to associate a user's resumption attempt with the original full
          handshake. However, reusing the NAI
          P2ZIM2F+OEVAO21nNWg2bVpgNnU=@realm enables an on-path attacker to
          associate a resumption attempt with the original full handshake. The
          TLS PSK identity is typically derived by the TLS implementation and
          may be an opaque blob without a routable realm. The TLS PSK identity
          on its own is therefore unsuitable as an NAI in the Identity
          Response.</t>
          <t indent="0" pn="section-2.1.3-5"><xref target="figresumption" format="default" sectionFormat="of" derivedContent="Figure 3"/> shows an example message flow for a subsequent successful EAP-TLS resumption handshake where both sides authenticate via a PSK provisioned via an earlier NewSessionTicket and where the server provisions a single new ticket.</t>
          <figure anchor="figresumption" align="left" suppress-title="false" pn="figure-3">
            <name slugifiedName="name-eap-tls-resumption">EAP-TLS Resumption</name>
            <artwork name="" type="" align="left" alt="" pn="section-2.1.3-6.1">
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello
 + pre_shared_key)           --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                             &lt;--------               TLS Finished,
                                             TLS NewSessionTicket)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</artwork>
          </figure>
          <t indent="0" pn="section-2.1.3-7">As specified in <xref target="RFC8446" sectionFormat="of" section="2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-2.2" derivedContent="RFC8446"/>, the EAP-TLS peer
          <bcp14>SHOULD</bcp14> supply a "key_share" extension when attempting
          resumption, which allows the EAP-TLS server to potentially decline
          resumption and fall back to a full handshake. If the EAP-TLS peer
          did not supply a "key_share" extension when attempting resumption,
          the EAP-TLS server needs to send a HelloRetryRequest to signal that
          additional information is needed to complete the handshake, and the
          EAP-TLS peer needs to send a second ClientHello containing that
          information. Providing a "key_share" and using the "psk_dhe_ke"
          pre-shared key exchange mode is also important in order to limit the
          impact of a key compromise. When using "psk_dhe_ke", TLS 1.3
          provides forward secrecy meaning that compromise of the PSK used for
          resumption does not compromise any earlier connections. The
          "psk_dh_ke" key exchange mode <bcp14>MUST</bcp14> be used for
          resumption unless the deployment has a local requirement to allow
          configuration of other mechanisms.</t>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1.4">
          <name slugifiedName="name-termination">Termination</name>
          <t indent="0" pn="section-2.1.4-1">This section updates <xref target="RFC5216" sectionFormat="of" section="2.1.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1.3" derivedContent="RFC5216"/> by amending it in accordance with the following discussion.</t>
          <t indent="0" pn="section-2.1.4-2">TLS 1.3 changes both the message flow and the handshake messages
          compared to earlier versions of TLS. Therefore, some normative text
          in <xref target="RFC5216" sectionFormat="of" section="2.1.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1.3" derivedContent="RFC5216"/> does not apply for TLS 1.3. The two paragraphs
          below replace the corresponding paragraphs in <xref target="RFC5216" sectionFormat="of" section="2.1.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1.3" derivedContent="RFC5216"/> when EAP-TLS
          is used with TLS 1.3. The other paragraphs in <xref target="RFC5216" sectionFormat="of" section="2.1.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1.3" derivedContent="RFC5216"/> still apply
          with the exception that SessionID is deprecated.
          </t>
          <t indent="3" pn="section-2.1.4-3">If the EAP-TLS peer authenticates successfully, the EAP-TLS
	    server <bcp14>MUST</bcp14> send an EAP-Request packet with
	    EAP-Type=EAP-TLS containing TLS records conforming to the version
	    of TLS used. The message flow ends with a protected success
	    indication from the EAP-TLS server, followed by an EAP-Response
	    packet of EAP-Type=EAP-TLS and no data from the EAP-TLS peer,
	    followed by EAP-Success from the server.</t>
          <t indent="3" pn="section-2.1.4-4">If the EAP-TLS server authenticates successfully, the EAP-TLS
            peer <bcp14>MUST</bcp14> send an EAP-Response message with
            EAP-Type=EAP-TLS containing TLS records conforming to the version
            of TLS used.
          </t>
          <t indent="0" pn="section-2.1.4-5">Figures <xref target="figterm1" format="counter" sectionFormat="of" derivedContent="4"/>, <xref target="figterm2" format="counter" sectionFormat="of" derivedContent="5"/>, and <xref target="figterm3" format="counter" sectionFormat="of" derivedContent="6"/> illustrate message flows in several cases where the EAP-TLS peer or EAP-TLS server sends a TLS Error alert message. In earlier versions of TLS, error alerts could be warnings or fatal. In TLS 1.3, error alerts are always fatal and the only alerts sent at warning level are "close_notify" and "user_canceled", both of which indicate that the connection is not going to continue normally; see <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>.</t>
          <t indent="0" pn="section-2.1.4-6">In TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>, error alerts are not mandatory to send after a fatal error condition. Failure to send TLS Error alerts means that the peer or server would have no way of determining what went wrong. EAP-TLS 1.3 strengthens this requirement. Whenever an implementation encounters a fatal error condition, it <bcp14>MUST</bcp14> send an appropriate TLS Error alert.</t>
          <t indent="0" pn="section-2.1.4-7"><xref target="figterm1" format="default" sectionFormat="of" derivedContent="Figure 4"/> shows an example message flow where the EAP-TLS server rejects the ClientHello with an error alert. The EAP-TLS server can also partly reject the ClientHello with a HelloRetryRequest; see <xref target="helloretry" format="default" sectionFormat="of" derivedContent="Section 2.1.6"/>.</t>
          <figure anchor="figterm1" align="left" suppress-title="false" pn="figure-4">
            <name slugifiedName="name-eap-tls-server-rejection-of">EAP-TLS Server Rejection of ClientHello</name>
            <artwork name="" type="" align="left" alt="" pn="section-2.1.4-8.1">
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------           (TLS Error Alert)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Failure
</artwork>
          </figure>
          <t indent="0" pn="section-2.1.4-9"><xref target="figterm2" format="default" sectionFormat="of" derivedContent="Figure 5"/> shows an example message flow where EAP-TLS server authentication is unsuccessful and the EAP-TLS peer sends a TLS Error alert.</t>
          <figure anchor="figterm2" align="left" suppress-title="false" pn="figure-5">
            <name slugifiedName="name-eap-tls-unsuccessful-eap-tl">EAP-TLS Unsuccessful EAP-TLS Server Authentication</name>
            <artwork name="" type="" align="left" alt="" pn="section-2.1.4-10.1">
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Error Alert)
                             --------&gt;
                             &lt;--------               EAP-Failure
</artwork>
          </figure>
          <t indent="0" pn="section-2.1.4-11"><xref target="figterm3" format="default" sectionFormat="of" derivedContent="Figure 6"/> shows an example message flow where the EAP-TLS server authenticates to the EAP-TLS peer successfully, but the EAP-TLS peer fails to authenticate to the EAP-TLS server and the server sends a TLS Error alert.</t>
          <figure anchor="figterm3" align="left" suppress-title="false" pn="figure-6">
            <name slugifiedName="name-eap-tls-unsuccessful-client">EAP-TLS Unsuccessful Client Authentication</name>
            <artwork name="" type="" align="left" alt="" pn="section-2.1.4-12.1">
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------           (TLS Error Alert)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Failure
</artwork>
          </figure>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1.5">
          <name slugifiedName="name-no-peer-authentication">No Peer Authentication</name>
          <t indent="0" pn="section-2.1.5-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
          <t indent="0" pn="section-2.1.5-2"><xref target="figbase3" format="default" sectionFormat="of" derivedContent="Figure 7"/> shows an example message flow for a successful EAP-TLS full handshake without peer authentication (e.g., emergency services, as described in <xref target="RFC7406" format="default" sectionFormat="of" derivedContent="RFC7406"/>).</t>
          <figure anchor="figbase3" align="left" suppress-title="false" pn="figure-7">
            <name slugifiedName="name-eap-tls-without-peer-authen">EAP-TLS without Peer Authentication</name>
            <artwork name="" type="" align="left" alt="" pn="section-2.1.5-3.1">
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</artwork>
          </figure>
        </section>
        <section anchor="helloretry" numbered="true" toc="include" removeInRFC="false" pn="section-2.1.6">
          <name slugifiedName="name-hello-retry-request">Hello Retry Request</name>
          <t indent="0" pn="section-2.1.6-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
          <t indent="0" pn="section-2.1.6-2">As defined in TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>,
          EAP-TLS servers can send a HelloRetryRequest message in response to
          a ClientHello if the EAP-TLS server finds an acceptable set of
          parameters but the initial ClientHello does not contain all the
          needed information to continue the handshake. One use case is if the
          EAP-TLS server does not support the groups in the "key_share"
          extension (or there is no "key_share" extension) but supports one of
          the groups in the "supported_groups" extension. In this case, the
          client should send a new ClientHello with a "key_share" that the
          EAP-TLS server supports.</t>
          <t indent="0" pn="section-2.1.6-3"><xref target="fighelloretryrequest" format="default" sectionFormat="of" derivedContent="Figure 8"/> shows an example message flow for a successful EAP-TLS full handshake with mutual authentication and HelloRetryRequest. Note the extra round trip as a result of the HelloRetryRequest.</t>
          <figure anchor="fighelloretryrequest" align="left" suppress-title="false" pn="figure-8">
            <name slugifiedName="name-eap-tls-with-hello-retry-re">EAP-TLS with Hello Retry Request</name>
            <artwork name="" type="" align="left" alt="" pn="section-2.1.6-4.1">
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                           (TLS HelloRetryRequest)
                             &lt;--------
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                                                     TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</artwork>
          </figure>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1.7">
          <name slugifiedName="name-identity">Identity</name>
          <t indent="0" pn="section-2.1.7-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
          <t indent="0" pn="section-2.1.7-2">It is <bcp14>RECOMMENDED</bcp14> to use anonymous NAIs <xref target="RFC7542" format="default" sectionFormat="of" derivedContent="RFC7542"/> in the Identity Response as such
          identities are routable and privacy-friendly. While opaque blobs are
          allowed by <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/>, such
          identities are <bcp14>NOT RECOMMENDED</bcp14> as they are not
          routable and should only be considered in local deployments where
          the EAP-TLS peer, EAP authenticator, and EAP-TLS server all belong
          to the same network. Many client certificates contain an identity
          such as an email address, which is already in NAI format. When the
          client certificate contains an NAI as subject name or alternative
          subject name, an anonymous NAI <bcp14>SHOULD</bcp14> be derived from
          the NAI in the certificate; see <xref target="privacy" format="default" sectionFormat="of" derivedContent="Section 2.1.8"/>. More details on identities are described in
          Sections <xref target="resumption" format="counter" sectionFormat="of" derivedContent="2.1.3"/>, <xref target="privacy" format="counter" sectionFormat="of" derivedContent="2.1.8"/>, <xref target="identity" format="counter" sectionFormat="of" derivedContent="2.2"/>, and <xref target="privcon" format="counter" sectionFormat="of" derivedContent="5.8"/>.</t>
        </section>
        <section anchor="privacy" numbered="true" toc="include" removeInRFC="false" pn="section-2.1.8">
          <name slugifiedName="name-privacy">Privacy</name>
          <t indent="0" pn="section-2.1.8-1">This section updates <xref target="RFC5216" sectionFormat="of" section="2.1.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1.4" derivedContent="RFC5216"/> by amending it in accordance with
          the following discussion.</t>
          <t indent="0" pn="section-2.1.8-2">EAP-TLS 1.3 significantly improves privacy when compared to
          earlier versions of EAP-TLS. EAP-TLS 1.3 forbids cipher suites
          without confidentiality, which means that TLS 1.3 is always
          encrypting large parts of the TLS handshake including the
          certificate messages.</t>
          <t indent="0" pn="section-2.1.8-3">EAP-TLS peer and server implementations supporting TLS 1.3
          <bcp14>MUST</bcp14> support anonymous Network Access Identifiers
          (NAIs) (<xref target="RFC7542" sectionFormat="of" section="2.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7542#section-2.4" derivedContent="RFC7542"/>). A client supporting TLS 1.3 <bcp14>MUST NOT</bcp14> send its username (or any other permanent identifiers)
          in cleartext in the Identity Response (or any message used instead
          of the Identity Response). Following <xref target="RFC7542" format="default" sectionFormat="of" derivedContent="RFC7542"/>, it is <bcp14>RECOMMENDED</bcp14> to omit the
          username (i.e., the NAI is @realm), but other constructions such as
          a fixed username (e.g., anonymous@realm) or an encrypted username
          (e.g., xCZINCPTK5+7y81CrSYbPg+RKPE3OTrYLn4AQc4AC2U=@realm) are
          allowed. Note that the NAI <bcp14>MUST</bcp14> be a UTF-8 string as
          defined by the grammar in <xref target="RFC7542" section="2.2" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7542#section-2.2" derivedContent="RFC7542"/>.</t>
          <t indent="0" pn="section-2.1.8-4">The HelloRequest message used for privacy in EAP-TLS 1.2 does not exist in TLS 1.3 but as the certificate messages in TLS 1.3 are encrypted, there is no need to send an empty certificate_list and perform a second handshake for privacy (as needed by EAP-TLS with earlier versions of TLS). When EAP-TLS is used with TLS version 1.3, the EAP-TLS peer and EAP-TLS server <bcp14>SHALL</bcp14> follow the processing specified by version 1.3 of TLS. This means that the EAP-TLS peer only sends an empty certificate_list if it does not have an appropriate certificate to send, and the EAP-TLS server <bcp14>MAY</bcp14> treat an empty certificate_list as a terminal condition.</t>
          <t indent="0" pn="section-2.1.8-5">EAP-TLS with TLS 1.3 is always used with privacy. This does not add any extra round trips and the message flow with privacy is just the normal message flow as shown in <xref target="figbase1" format="default" sectionFormat="of" derivedContent="Figure 1"/>.</t>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1.9">
          <name slugifiedName="name-fragmentation">Fragmentation</name>
          <t indent="0" pn="section-2.1.9-1">This section updates <xref target="RFC5216" sectionFormat="of" section="2.1.5" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.1.5" derivedContent="RFC5216"/> by amending it in accordance with the following discussion.</t>
          <t indent="0" pn="section-2.1.9-2">Including ContentType (1 byte), ProtocolVersion (2 bytes), and
          length (2 bytes) headers, a single TLS record may be up to 16645
          octets in length. EAP-TLS fragmentation support is provided through
          addition of a flags octet within the EAP-Response and EAP-Request
          packets, as well as a (conditional) TLS Message Length field of four
          octets. Implementations <bcp14>MUST NOT</bcp14> set the L bit in
          unfragmented messages, but they <bcp14>MUST</bcp14> accept unfragmented
          messages with and without the L bit set.</t>
          <t indent="0" pn="section-2.1.9-3">Some EAP implementations and access networks may limit the number
          of EAP packet exchanges that can be handled. To avoid fragmentation,
          it is <bcp14>RECOMMENDED</bcp14> to keep the sizes of EAP-TLS peer,
          EAP-TLS server, and trust anchor certificates small and the length
          of the certificate chains short. In addition, it is
          <bcp14>RECOMMENDED</bcp14> to use mechanisms that reduce the sizes
          of Certificate messages. For a detailed discussion on reducing
          message sizes to prevent fragmentation, see <xref target="RFC9191" format="default" sectionFormat="of" derivedContent="RFC9191"/>.</t>
        </section>
      </section>
      <section anchor="identity" numbered="true" toc="include" removeInRFC="false" pn="section-2.2">
        <name slugifiedName="name-identity-verification">Identity Verification</name>
        <t indent="0" pn="section-2.2-1">This section replaces <xref target="RFC5216" sectionFormat="of" section="2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.2" derivedContent="RFC5216"/> with the following discussion. The
        guidance in this section is relevant for EAP-TLS in general
        (regardless of the underlying TLS version used).</t>
        <t indent="0" pn="section-2.2-2">The EAP peer identity provided in the EAP-Response/Identity is not
        authenticated by EAP-TLS. Unauthenticated information <bcp14>MUST NOT</bcp14> be used for accounting purposes or to give
        authorization. The authenticator and the EAP-TLS server
        <bcp14>MAY</bcp14> examine the identity presented in
        EAP-Response/Identity for purposes such as routing and EAP method
        selection. EAP-TLS servers <bcp14>MAY</bcp14> reject conversations if
        the identity does not match their policy. Note that this also applies
        to resumption; see Sections <xref target="resumption" format="counter" sectionFormat="of" derivedContent="2.1.3"/>, <xref target="secauth" format="counter" sectionFormat="of" derivedContent="5.6"/>, and
        <xref target="secres" format="counter" sectionFormat="of" derivedContent="5.7"/>.</t>
        <t indent="0" pn="section-2.2-3">The EAP server identity in the TLS server certificate is typically a fully qualified domain name (FQDN) in the SubjectAltName (SAN) extension. Since EAP-TLS deployments may use more than one EAP server, each with a different certificate, EAP peer implementations <bcp14>SHOULD</bcp14> allow for the configuration of one or more trusted root certificates (CA certificate) to authenticate the server certificate and one or more server names to match against the SubjectAltName (SAN) extension in the server certificate. If any of the configured names match any of the names in the SAN extension, then the name check passes. To simplify name matching, an EAP-TLS deployment can assign a name to represent an authorized EAP server and EAP Server certificates can include this name in the list of SANs for each certificate that represents an EAP-TLS server. If server name matching is not used, then it degrades the confidence that the EAP server with which it is interacting is authoritative for the given network. If name matching is not used with a public root CA, then effectively any server can obtain a certificate that will be trusted for EAP authentication by the peer. While this guidance to verify domain names is new, and was not mentioned in <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>, it has been widely implemented in EAP-TLS peers. As such, it is believed that this section contains minimal new interoperability or implementation requirements on EAP-TLS peers and can be applied to earlier versions of TLS.</t>
        <t indent="0" pn="section-2.2-4">The process of configuring a root CA certificate and a server name is non-trivial; therefore, automated methods of provisioning are <bcp14>RECOMMENDED</bcp14>. For example, the eduroam federation <xref target="RFC7593" format="default" sectionFormat="of" derivedContent="RFC7593"/> provides a Configuration Assistant Tool (CAT) to automate the configuration process. In the absence of a trusted root CA certificate (user configured or system-wide), EAP peers <bcp14>MAY</bcp14> implement a trust on first use (TOFU) mechanism where the peer trusts and stores the server certificate during the first connection attempt. The EAP peer ensures that the server presents the same stored certificate on subsequent interactions. Use of a TOFU mechanism does not allow for the server certificate to change without out-of-band validation of the certificate and is therefore not suitable for many deployments including ones where multiple EAP servers are deployed for high availability. TOFU mechanisms increase the susceptibility to traffic interception attacks and should only be used if there are adequate controls in place to mitigate this risk.</t>
      </section>
      <section anchor="keyhierarchy" numbered="true" toc="include" removeInRFC="false" pn="section-2.3">
        <name slugifiedName="name-key-hierarchy">Key Hierarchy</name>
        <t indent="0" pn="section-2.3-1">This section updates <xref target="RFC5216" sectionFormat="of" section="2.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.3" derivedContent="RFC5216"/> by replacing it in accordance with the following discussion.</t>
        <t indent="0" pn="section-2.3-2">TLS 1.3 replaces the TLS pseudorandom function (PRF) used in
        earlier versions of TLS with the HMAC-based Key Derivation Function
        (HKDF) and completely changes the key schedule. The key hierarchies
        shown in <xref target="RFC5216" sectionFormat="of" section="2.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.3" derivedContent="RFC5216"/> are therefore not correct when EAP-TLS is used with
        TLS version 1.3. For TLS 1.3 the key schedule is described in <xref target="RFC8446" sectionFormat="of" section="7.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-7.1" derivedContent="RFC8446"/>.</t>
        <t indent="0" pn="section-2.3-3">When EAP-TLS is used with TLS version 1.3, the Key_Material and
        Method-Id <bcp14>SHALL</bcp14> be derived from the exporter_secret
        using the TLS exporter interface <xref target="RFC5705" format="default" sectionFormat="of" derivedContent="RFC5705"/> (for TLS 1.3, this is defined in <xref target="RFC8446" sectionFormat="of" section="7.5" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-7.5" derivedContent="RFC8446"/>). Type is the value of the EAP Type field defined
        in <xref target="RFC3748" section="2" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc3748#section-2" derivedContent="RFC3748"/>. For EAP-TLS, the Type field has value 0x0D.</t>
        <sourcecode markers="false" pn="section-2.3-4">
Type = 0x0D
Key_Material = TLS-Exporter("EXPORTER_EAP_TLS_Key_Material",
                            Type, 128)
Method-Id    = TLS-Exporter("EXPORTER_EAP_TLS_Method-Id",
                            Type, 64)
Session-Id   = Type || Method-Id
</sourcecode>
        <t indent="0" pn="section-2.3-5">The MSK and EMSK are derived from the Key_Material in the same
        manner as with EAP-TLS <xref target="RFC5216" sectionFormat="comma" section="2.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.3" derivedContent="RFC5216"/>. The definitions are repeated below
        for simplicity:</t>
        <sourcecode markers="false" pn="section-2.3-6">
MSK          = Key_Material(0, 63)
EMSK         = Key_Material(64, 127)
</sourcecode>
        <t indent="0" pn="section-2.3-7">Other TLS-based EAP methods can use the TLS exporter in a similar
        fashion; see <xref target="I-D.ietf-emu-tls-eap-types" format="default" sectionFormat="of" derivedContent="TLS-EAP-TYPES"/>.</t>
        <t indent="0" pn="section-2.3-8"><xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/> deprecates the use of an
        Initialization Vector (IV). Thus, RECV-IV and SEND-IV are not exported
        in EAP-TLS with TLS 1.3. As noted in <xref target="RFC5247" format="default" sectionFormat="of" derivedContent="RFC5247"/>, lower layers use the MSK in a
        lower-layer-dependent manner. EAP-TLS with TLS 1.3 exports the MSK and
        does not specify how it is used by lower layers.</t>
        <t indent="0" pn="section-2.3-9">Note that the key derivation <bcp14>MUST</bcp14> use the length
        values given above. While in TLS 1.2 and earlier it was possible to
        truncate the output by requesting less data from the TLS-Exporter
        function, this practice is not possible with TLS 1.3. If an
        implementation intends to use only a part of the output of the
        TLS-Exporter function, then it <bcp14>MUST</bcp14> ask for the full
        output and then only use the desired part. Failure to do so will
        result in incorrect values being calculated for the above keying
        material.</t>
        <t indent="0" pn="section-2.3-10">By using the TLS exporter, EAP-TLS can use any TLS 1.3
        implementation that provides a public API for the exporter. Note that
        when TLS 1.2 is used with the EAP-TLS exporter <xref target="RFC5705" format="default" sectionFormat="of" derivedContent="RFC5705"/> it generates the same key material as in EAP-TLS
        <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.4">
        <name slugifiedName="name-parameter-negotiation-and-c">Parameter Negotiation and Compliance Requirements</name>
        <t indent="0" pn="section-2.4-1">This section updates <xref target="RFC5216" sectionFormat="of" section="2.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.4" derivedContent="RFC5216"/> by amending it in accordance with the following discussion.</t>
        <t indent="0" pn="section-2.4-2">TLS 1.3 cipher suites are defined differently than in earlier
        versions of TLS (see <xref target="RFC8446" section="B.4" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#appendix-B.4" derivedContent="RFC8446"/>), and the cipher suites
        discussed in <xref target="RFC5216" sectionFormat="of" section="2.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-2.4" derivedContent="RFC5216"/> can therefore not be used when EAP-TLS is used with
        TLS version 1.3.</t>
        <t indent="0" pn="section-2.4-3">When EAP-TLS is used with TLS version 1.3, the EAP-TLS peers and EAP-TLS servers <bcp14>MUST</bcp14> comply with the compliance requirements (mandatory-to-implement cipher suites, signature algorithms, key exchange algorithms, extensions, etc.) defined in <xref target="RFC8446" sectionFormat="of" section="9" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-9" derivedContent="RFC8446"/>. In EAP-TLS with TLS 1.3, only cipher suites with confidentiality <bcp14>SHALL</bcp14> be supported.</t>
        <t indent="0" pn="section-2.4-4">While EAP-TLS does not protect any application data except for the 0x00 byte that serves as protected success indication, the negotiated cipher suites and algorithms <bcp14>MAY</bcp14> be used to secure data as done in other TLS-based EAP methods.</t>
      </section>
      <section anchor="state" numbered="true" toc="include" removeInRFC="false" pn="section-2.5">
        <name slugifiedName="name-eap-state-machines">EAP State Machines</name>
        <t indent="0" pn="section-2.5-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/> and only applies to TLS 1.3. <xref target="RFC4137" format="default" sectionFormat="of" derivedContent="RFC4137"/> offers a proposed state machine for EAP.</t>
        <t indent="0" pn="section-2.5-2">TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> introduces
        post-handshake messages. These post-handshake messages use the
        handshake content type and can be sent after the main
        handshake. Examples of post-handshake messages are NewSessionTicket,
        which is used for resumption and KeyUpdate, which is not useful and
        not expected in EAP-TLS. After sending TLS Finished, the EAP-TLS
        server may send any number of post-handshake messages in one or more
        EAP-Requests.</t>
        <t indent="0" pn="section-2.5-3">To provide a protected success result indication and to decrease the uncertainty for the EAP-TLS peer, the following procedure <bcp14>MUST</bcp14> be followed:</t>
        <t indent="0" pn="section-2.5-4">When an EAP-TLS server has successfully processed the TLS client
        Finished and sent its last handshake message (Finished or a
        post-handshake message), it sends an encrypted TLS record with
        application data 0x00. The encrypted TLS record with application data
        0x00 is a protected success result indication, as defined in <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/>. After sending an EAP-Request that
        contains the protected success result indication, the EAP-TLS server
        must not send any more EAP-Requests and may only send an
        EAP-Success. The EAP-TLS server <bcp14>MUST NOT</bcp14> send an
        encrypted TLS record with application data 0x00 before it has
        successfully processed the client Finished and sent its last handshake
        message.</t>
        <t indent="0" pn="section-2.5-5">TLS Error alerts <bcp14>SHOULD</bcp14> be considered a failure
        result indication, as defined in <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/>. Implementations following <xref target="RFC4137" format="default" sectionFormat="of" derivedContent="RFC4137"/> set the alternate indication of failure variable
        altReject after sending or receiving an error alert. After sending or
        receiving a TLS Error alert, the EAP-TLS server may only send an
        EAP-Failure. Protected TLS Error alerts are protected failure result
        indications, and unprotected TLS Error alerts are not.</t>
        <t indent="0" pn="section-2.5-6">The keying material can be derived after the TLS server Finished
        has been sent or received. Implementations following <xref target="RFC4137" format="default" sectionFormat="of" derivedContent="RFC4137"/> can then set the eapKeyData and
        aaaEapKeyData variables.</t>
        <t indent="0" pn="section-2.5-7">The keying material can be made available to lower layers and the
        authenticator after the authenticated success result indication has
        been sent or received. Implementations following <xref target="RFC4137" format="default" sectionFormat="of" derivedContent="RFC4137"/> can set the eapKeyAvailable and
        aaaEapKeyAvailable variables.</t>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-detailed-description-of-the">Detailed Description of the EAP-TLS Protocol</name>
      <t indent="0" pn="section-3-1">There are no updates to <xref target="RFC5216" section="3" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-3" derivedContent="RFC5216"/>.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-4-1">This section provides guidance to the Internet Assigned Numbers Authority (IANA) regarding registration of values related to EAP-TLS 1.3 in accordance with <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>.</t>
      <t indent="0" pn="section-4-2">Per this document, IANA has added the following labels to the "TLS
      Exporter Labels" registry defined by <xref target="RFC5705" format="default" sectionFormat="of" derivedContent="RFC5705"/>. These labels are used in derivation of Key_Material
      and Method-Id as defined in <xref target="keyhierarchy" format="default" sectionFormat="of" derivedContent="Section 2.3"/>:</t>
      <table anchor="exporter-label" align="center" pn="table-1">
        <name slugifiedName="name-tls-exporter-labels">TLS Exporter Labels</name>
        <thead>
          <tr>
            <th align="left" colspan="1" rowspan="1">Value</th>
            <th align="left" colspan="1" rowspan="1">DTLS-OK</th>
            <th align="left" colspan="1" rowspan="1">Recommended</th>
            <th align="left" colspan="1" rowspan="1">Note</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" colspan="1" rowspan="1">EXPORTER_EAP_TLS_Key_Material</td>
            <td align="center" colspan="1" rowspan="1">N</td>
            <td align="center" colspan="1" rowspan="1">Y</td>
            <td align="left" colspan="1" rowspan="1"/>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">EXPORTER_EAP_TLS_Method-Id</td>
            <td align="center" colspan="1" rowspan="1">N</td>
            <td align="center" colspan="1" rowspan="1">Y</td>
            <td align="left" colspan="1" rowspan="1"/>
          </tr>
        </tbody>
      </table>
    </section>
    <section anchor="seccon" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-5-1">The security considerations of TLS 1.3 <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> apply to EAP-TLS 1.3.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-security-claims">Security Claims</name>
        <t indent="0" pn="section-5.1-1">Using EAP-TLS with TLS 1.3 does not change the security claims for EAP-TLS as given in <xref target="RFC5216" sectionFormat="of" section="5.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-5.1" derivedContent="RFC5216"/>. However, it strengthens several of the claims as described in the following updates to the notes given in <xref target="RFC5216" sectionFormat="of" section="5.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-5.1" derivedContent="RFC5216"/>.</t>
        <dl indent="4" newline="false" spacing="normal" pn="section-5.1-2">
          <dt pn="section-5.1-2.1">[1] Mutual authentication:
          </dt>
          <dd pn="section-5.1-2.2">By mandating revocation checking of certificates, the
	  authentication in EAP-TLS with TLS 1.3 is stronger as authentication
	  with revoked certificates will always fail.
	  </dd>
          <dt pn="section-5.1-2.3">[2] Confidentiality:
          </dt>
          <dd pn="section-5.1-2.4">The TLS 1.3 handshake offers much better confidentiality than
	  earlier versions of TLS. EAP-TLS with TLS 1.3 mandates use of cipher
	  suites that ensure confidentiality. TLS 1.3 also encrypts
	  certificates and some of the extensions. When using EAP-TLS with TLS
	  1.3, the use of privacy is mandatory and does not cause any
	  additional round trips.
	  </dd>
          <dt pn="section-5.1-2.5">[3] Cryptographic strength:
          </dt>
          <dd pn="section-5.1-2.6">TLS 1.3 only defines strong algorithms without major weaknesses
	  and EAP-TLS with TLS 1.3 always provides forward secrecy; see <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>. Weak algorithms such as 3DES, CBC mode, RC4, SHA-1, MD5,
	  P-192, and RSA-1024 have not been registered for use in TLS 1.3.
	  </dd>
          <dt pn="section-5.1-2.7">[4] Cryptographic negotiation:
          </dt>
          <dd pn="section-5.1-2.8">The TLS layer handles the negotiation of cryptographic
	  parameters. When EAP-TLS is used with TLS 1.3, EAP-TLS inherits the
	  cryptographic negotiation of the AEAD algorithm, HKDF hash
	  algorithm, key exchange groups, and signature algorithm; see <xref target="RFC8446" sectionFormat="of" section="4.1.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-4.1.1" derivedContent="RFC8446"/>.
	  </dd>
        </dl>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-peer-and-server-identities">Peer and Server Identities</name>
        <t indent="0" pn="section-5.2-1">No updates to <xref target="RFC5216" sectionFormat="of" section="5.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-5.2" derivedContent="RFC5216"/>. Note that <xref target="identity" format="default" sectionFormat="of" derivedContent="Section 2.2"/> has additional discussion on identities.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.3">
        <name slugifiedName="name-certificate-validation">Certificate Validation</name>
        <t indent="0" pn="section-5.3-1">No updates to <xref target="RFC5216" sectionFormat="of" section="5.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-5.3" derivedContent="RFC5216"/>. In addition to <xref target="RFC5216" sectionFormat="of" section="5.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-5.3" derivedContent="RFC5216"/>, guidance on server certificate validation can be found in <xref target="RFC6125" format="default" sectionFormat="of" derivedContent="RFC6125"/>.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.4">
        <name slugifiedName="name-certificate-revocation">Certificate Revocation</name>
        <t indent="0" pn="section-5.4-1">This section updates <xref target="RFC5216" sectionFormat="of" section="5.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-5.4" derivedContent="RFC5216"/> by amending it in accordance with the following discussion.</t>
        <t indent="0" pn="section-5.4-2">There are a number of reasons (e.g., key compromise, CA compromise, privilege withdrawn, etc.) why EAP-TLS peer, EAP-TLS server, or sub-CA certificates have to be revoked before their expiry date. Revocation of the EAP-TLS server's certificate is complicated by the fact that the EAP-TLS peer may not have Internet connectivity until authentication completes.</t>
        <t indent="0" pn="section-5.4-3">When EAP-TLS is used with TLS 1.3, the revocation status of all the
        certificates in the certificate chains <bcp14>MUST</bcp14> be checked
        (except the trust anchor). An implementation may use the Certificate
        Revocation List (CRL), Online Certificate Status Protocol (OSCP), or
        other standardized/proprietary methods for revocation
        checking. Examples of proprietary methods are non-standard formats for
        distribution of revocation lists as well as certificates with very
        short lifetime.</t>
        <t indent="0" pn="section-5.4-4">EAP-TLS servers supporting TLS 1.3 <bcp14>MUST</bcp14> implement
        Certificate Status Requests (OCSP stapling) as specified in <xref target="RFC6066" format="default" sectionFormat="of" derivedContent="RFC6066"/> and <xref target="RFC8446" sectionFormat="of" section="4.4.2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-4.4.2.1" derivedContent="RFC8446"/>. It is
        <bcp14>RECOMMENDED</bcp14> that EAP-TLS peers and EAP-TLS servers use
        OCSP stapling for verifying the status of the EAP-TLS server's
        certificate chain. When an EAP-TLS peer uses Certificate Status
        Requests to check the revocation status of the EAP-TLS server's
        certificate chain, it <bcp14>MUST</bcp14> treat a CertificateEntry
        (but not the trust anchor) without a valid CertificateStatus extension
        as invalid and abort the handshake with an appropriate alert. The OCSP
        status handling in TLS 1.3 is different from earlier versions of TLS;
        see <xref target="RFC8446" sectionFormat="of" section="4.4.2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-4.4.2.1" derivedContent="RFC8446"/>. In TLS 1.3, the OCSP information is carried in the
        CertificateEntry containing the associated certificate instead of a
        separate CertificateStatus message as in <xref target="RFC6066" format="default" sectionFormat="of" derivedContent="RFC6066"/>. This enables sending OCSP information for all
        certificates in the certificate chain (except the trust anchor).</t>
        <t indent="0" pn="section-5.4-5">To enable revocation checking in situations where EAP-TLS peers do not implement or use OCSP stapling, and where network connectivity is not available prior to authentication completion, EAP-TLS peer implementations <bcp14>MUST</bcp14> also support checking for certificate revocation after authentication completes and network connectivity is available. An EAP peer implementation <bcp14>SHOULD NOT</bcp14> trust the network (and any services) until it has verified the revocation status of the server certificate after receiving network connectivity. An EAP peer <bcp14>MUST</bcp14> use a secure transport to verify the revocation status of the server certificate. An EAP peer <bcp14>SHOULD NOT</bcp14> send any other traffic before revocation checking for the server certificate is complete.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.5">
        <name slugifiedName="name-packet-modification-attacks">Packet Modification Attacks</name>
        <t indent="0" pn="section-5.5-1">This section updates <xref target="RFC5216" sectionFormat="of" section="5.5" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-5.5" derivedContent="RFC5216"/> by amending it in accordance with the
        following discussion.</t>
        <t indent="0" pn="section-5.5-2">As described in <xref target="RFC3748" format="default" sectionFormat="of" derivedContent="RFC3748"/> and <xref target="RFC5216" section="5.5" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5216#section-5.5" derivedContent="RFC5216"/>,
        the only information that is integrity and replay protected in EAP-TLS
        are the parts of the TLS Data that TLS protects. All other information
        in the EAP-TLS message exchange including EAP-Request and EAP-Response
        headers, the identity in the Identity Response, EAP-TLS packet header
        fields, Type, Flags, EAP-Success, and EAP-Failure can be modified,
        spoofed, or replayed.</t>
        <t indent="0" pn="section-5.5-3">Protected TLS Error alerts are protected failure result indications
        and enable the EAP-TLS peer and EAP-TLS server to determine that the
        failure result was not spoofed by an attacker. Protected failure
        result indications provide integrity and replay protection but
        <bcp14>MAY</bcp14> be unauthenticated. Protected failure results do
        not significantly improve availability as TLS 1.3 treats most
        malformed data as a fatal error.</t>
      </section>
      <section anchor="secauth" numbered="true" toc="include" removeInRFC="false" pn="section-5.6">
        <name slugifiedName="name-authorization">Authorization</name>
        <t indent="0" pn="section-5.6-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>. The guidance in this section is relevant for EAP-TLS in general (regardless of the underlying TLS version used).</t>
        <t indent="0" pn="section-5.6-2">EAP servers will usually require the EAP peer to provide a valid
        certificate and will fail the connection if one is not provided. Some
        deployments may permit no peer authentication for some or all
        connections. When peer authentication is not used, EAP-TLS server
        implementations <bcp14>MUST</bcp14> take care to limit network access
        appropriately for unauthenticated peers, and implementations
        <bcp14>MUST</bcp14> use resumption with caution to ensure that a
        resumed session is not granted more privilege than was intended for
        the original session. An example of limiting network access would be
        to invoke a vendor's walled garden or quarantine network
        functionality.</t>
        <t indent="0" pn="section-5.6-3">EAP-TLS is typically encapsulated in other protocols such as PPP
        <xref target="RFC1661" format="default" sectionFormat="of" derivedContent="RFC1661"/>, RADIUS <xref target="RFC2865" format="default" sectionFormat="of" derivedContent="RFC2865"/>, Diameter <xref target="RFC6733" format="default" sectionFormat="of" derivedContent="RFC6733"/>, or the Protocol for Carrying Authentication for
        Network Access (PANA) <xref target="RFC5191" format="default" sectionFormat="of" derivedContent="RFC5191"/>. The
        encapsulating protocols can also provide additional, non-EAP
        information to an EAP-TLS server. This information can include, but is
        not limited to, information about the authenticator, information about
        the EAP-TLS peer, or information about the protocol layers above or
        below EAP (MAC addresses, IP addresses, port numbers, Wi-Fi Service
        Set Identifiers (SSIDs), etc.). EAP-TLS servers implementing EAP-TLS
        inside those protocols can make policy decisions and enforce
        authorization based on a combination of information from the EAP-TLS
        exchange and non-EAP information.</t>
        <t indent="0" pn="section-5.6-4">As noted in <xref target="identity" format="default" sectionFormat="of" derivedContent="Section 2.2"/>, the
        identity presented in EAP-Response/Identity is not authenticated by
        EAP-TLS and is therefore trivial for an attacker to forge, modify, or
        replay. Authorization and accounting <bcp14>MUST</bcp14> be based on
        authenticated information such as information in the certificate or
        the PSK identity and cached data provisioned for resumption as
        described in <xref target="secres" format="default" sectionFormat="of" derivedContent="Section 5.7"/>. Note that the
        requirements for Network Access Identifiers (NAIs) specified in <xref target="RFC7542" sectionFormat="of" section="4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7542#section-4" derivedContent="RFC7542"/>
        still apply and <bcp14>MUST</bcp14> be followed. </t>
        <t indent="0" pn="section-5.6-5">EAP-TLS servers <bcp14>MAY</bcp14> reject conversations based on
        non-EAP information provided by the encapsulating protocol, for
        example if the MAC address of the authenticator does not match the
        expected policy.</t>
        <t indent="0" pn="section-5.6-6">In addition to allowing configuration of one or more trusted root
        certificates (CA certificate) to authenticate the server certificate
        and one or more server names to match against the SubjectAltName (SAN)
        extension, EAP peer implementations <bcp14>MAY</bcp14> allow binding
        the configured acceptable SAN to a specific CA (or CAs) that should
        have issued the server certificate to prevent attacks from rogue or
        compromised CAs.</t>
      </section>
      <section anchor="secres" numbered="true" toc="include" removeInRFC="false" pn="section-5.7">
        <name slugifiedName="name-resumption-2">Resumption</name>
        <t indent="0" pn="section-5.7-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>. The guidance in this section is relevant for
        EAP-TLS in general (regardless of the underlying TLS version
        used).</t>
        <t indent="0" pn="section-5.7-2">There are a number of security issues related to resumption that
        are not described in <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>. The
        problems, guidelines, and requirements in this section therefore apply
        to EAP-TLS when it is used with any version of TLS.</t>
        <t indent="0" pn="section-5.7-3">When resumption occurs, it is based on cached information at the
        TLS layer. To perform resumption securely, the EAP-TLS peer and
        EAP-TLS server need to be able to securely retrieve authorization
        information such as certificate chains from the initial full
        handshake. This document uses the term "cached data" to describe such
        information. Authorization during resumption <bcp14>MUST</bcp14> be
        based on such cached data. The EAP-TLS peer and EAP-TLS server
        <bcp14>MAY</bcp14> perform fresh revocation checks on the cached
        certificate data. Any security policies for authorization
        <bcp14>MUST</bcp14> be followed also for resumption. The certificates
        may have been revoked since the initial full handshake and the
        authorizations of the other party may have been reduced. If the cached
        revocation data is not sufficiently current, the EAP-TLS peer or
        EAP-TLS server <bcp14>MAY</bcp14> force a full TLS handshake.</t>
        <t indent="0" pn="section-5.7-4">There are two ways to retrieve the cached data from the original
        full handshake. The first method is that the EAP-TLS server and client
        cache the information locally. The cached information is identified by
        an identifier. For TLS versions before 1.3, the identifier can be the
        session ID; for TLS 1.3, the identifier is the PSK identity. The
        second method for retrieving cached information is via <xref target="RFC5077" format="default" sectionFormat="of" derivedContent="RFC5077"/> or <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>, where the EAP-TLS server avoids storing
        information locally and instead encapsulates the information into a
        ticket that is sent to the client for storage. This ticket is
        encrypted using a key that only the EAP-TLS server knows. Note that
        the client still needs to cache the original handshake information
        locally and will obtain it while determining the session ID or PSK
        identity to use for resumption. However, the EAP-TLS server is able to
        decrypt the ticket or PSK to obtain the original handshake
        information.</t>
        <t indent="0" pn="section-5.7-5">The EAP-TLS server or EAP client <bcp14>MUST</bcp14> cache data
        during the initial full handshake sufficient to allow authorization
        decisions to be made during resumption. If cached data cannot be
        retrieved securely, resumption <bcp14>MUST NOT</bcp14> be done.</t>
        <t indent="0" pn="section-5.7-6">The above requirements also apply if the EAP-TLS server expects
        some system to perform accounting for the session. Since accounting
        must be tied to an authenticated identity, and resumption does not
        supply such an identity, accounting is impossible without access to
        cached data. Therefore, systems that expect to perform accounting for
        the session <bcp14>SHOULD</bcp14> cache an identifier that can be used
        in subsequent accounting.</t>
        <t indent="0" pn="section-5.7-7">As suggested in <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>, EAP-TLS
        peers <bcp14>MUST NOT</bcp14> store resumption PSKs or tickets (and
        associated cached data) for longer than 604800 seconds (7 days)
        regardless of the PSK or ticket lifetime. The EAP-TLS peer
        <bcp14>MAY</bcp14> delete them earlier based on local policy. The
        cached data <bcp14>MAY</bcp14> also be removed on the EAP-TLS server
        or EAP-TLS peer if any certificate in the certificate chain has been
        revoked or has expired. In all such cases, an attempt at resumption
        results in a full TLS handshake instead.</t>
        <t indent="0" pn="section-5.7-8">Information from the EAP-TLS exchange (e.g., the identity provided
        in EAP-Response/Identity) as well as non-EAP information (e.g., IP
        addresses) may change between the initial full handshake and
        resumption. This change creates a "time-of-check time-of-use" (TOCTOU)
        security vulnerability. A malicious or compromised user could supply
        one set of data during the initial authentication, and a different set
        of data during resumption, potentially allowing them to obtain access
        that they should not have.</t>
        <t indent="0" pn="section-5.7-9">If any authorization, accounting, or policy decisions were made
        with information that has changed between the initial full handshake
        and resumption, and if change may lead to a different decision, such
        decisions <bcp14>MUST</bcp14> be reevaluated. It is
        <bcp14>RECOMMENDED</bcp14> that authorization, accounting, and policy
        decisions are reevaluated based on the information given in the
        resumption. EAP-TLS servers <bcp14>MAY</bcp14> reject resumption where
        the information supplied during resumption does not match the
        information supplied during the original authentication. If a safe
        decision is not possible, EAP-TLS servers <bcp14>SHOULD</bcp14> reject
        the resumption and continue with a full handshake.</t>
        <t indent="0" pn="section-5.7-10">Sections <xref target="RFC8446" sectionFormat="bare" section="2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-2.2" derivedContent="RFC8446"/> and <xref target="RFC8446" section="4.2.11" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-4.2.11" derivedContent="RFC8446"/>
        of <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> provide security considerations for TLS
        1.3 resumption.</t>
      </section>
      <section anchor="privcon" numbered="true" toc="include" removeInRFC="false" pn="section-5.8">
        <name slugifiedName="name-privacy-considerations">Privacy Considerations</name>
        <t indent="0" pn="section-5.8-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
        <t indent="0" pn="section-5.8-2">TLS 1.3 offers much better privacy than earlier versions of TLS as discussed in <xref target="privacy" format="default" sectionFormat="of" derivedContent="Section 2.1.8"/>. In this section, we only discuss the privacy properties of EAP-TLS with TLS 1.3. For privacy properties of TLS 1.3 itself, see <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>.</t>
        <t indent="0" pn="section-5.8-3">EAP-TLS sends the standard TLS 1.3 handshake messages encapsulated in EAP packets. Additionally, the EAP-TLS peer sends an identity in the first EAP-Response. The other fields in the EAP-TLS Request and the EAP-TLS Response packets do not contain any cleartext privacy-sensitive information.</t>
        <t indent="0" pn="section-5.8-4">Tracking of users by eavesdropping on Identity Responses or
        certificates is a well-known problem in many EAP methods. When EAP-TLS
        is used with TLS 1.3, all certificates are encrypted, and the username
        part of the Identity Response is not revealed (e.g., using anonymous
        NAIs). Note that even though all certificates are encrypted, the
        server's identity is only protected against passive attackers while
        the client's identity is protected against both passive and active
        attackers. As with other EAP methods, even when privacy-friendly
        identifiers or EAP tunneling is used, the domain name (i.e., the
        realm) in the NAI is still typically visible. How much
        privacy-sensitive information the domain name leaks is highly
        dependent on how many other users are using the same domain name in
        the particular access network. If all EAP-TLS peers have the same
        domain, no additional information is leaked. If a domain name is used
        by a small subset of the EAP-TLS peers, it may aid an attacker in
        tracking or identifying the user.</t>
        <t indent="0" pn="section-5.8-5">Without padding, information about the size of the client
        certificate is leaked from the size of the EAP-TLS packets. The
        EAP-TLS packets sizes may therefore leak information that can be used
        to track or identify the user. If all client certificates have the
        same length, no information is leaked. EAP-TLS peers
        <bcp14>SHOULD</bcp14> use record padding; see <xref target="RFC8446" sectionFormat="of" section="5.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-5.4" derivedContent="RFC8446"/> to reduce
        information leakage of certificate sizes.</t>
        <t indent="0" pn="section-5.8-6">If anonymous NAIs are not used, the privacy-friendly identifiers
        need to be generated with care. The identities <bcp14>MUST</bcp14> be
        generated in a cryptographically secure way so that it is
        computationally infeasible for an attacker to differentiate two
        identities belonging to the same user from two identities belonging to
        different users in the same realm. This can be achieved, for instance,
        by using random or pseudo-random usernames such as random byte strings
        or ciphertexts and only using the pseudo-random usernames a single
        time. Note that the privacy-friendly usernames also <bcp14>MUST NOT</bcp14> include substrings that can be used to relate the identity
        to a specific user. Similarly, privacy-friendly usernames <bcp14>MUST NOT</bcp14> be formed by a fixed mapping that stays the same across
        multiple different authentications.</t>
        <t indent="0" pn="section-5.8-7">An EAP-TLS peer with a policy allowing communication with EAP-TLS
        servers supporting only TLS 1.2 without privacy and with a static RSA
        key exchange is vulnerable to disclosure of the EAP-TLS peer
        username. An active attacker can in this case make the EAP-TLS peer
        believe that an EAP-TLS server supporting TLS 1.3 only supports TLS
        1.2 without privacy. The attacker can simply impersonate the EAP-TLS
        server and negotiate TLS 1.2 with static RSA key exchange and send a
        TLS alert message when the EAP-TLS peer tries to use privacy by
        sending an empty certificate message. Since the attacker
        (impersonating the EAP-TLS server) does not provide a
        proof-of-possession of the private key until the Finished message when
        a static RSA key exchange is used, an EAP-TLS peer may inadvertently
        disclose its identity (username) to an attacker. Therefore, it is
        <bcp14>RECOMMENDED</bcp14> for EAP-TLS peers to not use EAP-TLS with
        TLS 1.2 and static RSA-based cipher suites without privacy. This
        implies that an EAP-TLS peer <bcp14>SHOULD NOT</bcp14> continue the
        EAP authentication attempt if a TLS 1.2 EAP-TLS server sends an
        EAP-TLS/Request with a TLS alert message in response to an empty
        certificate message from the peer.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.9">
        <name slugifiedName="name-pervasive-monitoring">Pervasive Monitoring</name>
        <t indent="0" pn="section-5.9-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
        <t indent="0" pn="section-5.9-2">Pervasive monitoring refers to widespread surveillance of users. In
	the context of EAP-TLS, pervasive monitoring attacks can target
	EAP-TLS peer devices for tracking them (and their users) when they
	join a network. By encrypting more information, mandating the use of
	privacy, and always providing forward secrecy, EAP-TLS with TLS 1.3
	offers much better protection against pervasive monitoring. In
	addition to the privacy attacks discussed above, surveillance on a
	large scale may enable tracking of a user over a wide geographical
	area and across different access networks. Using information from
	EAP-TLS together with information gathered from other protocols
	increases the risk of identifying individual users.</t>
        <t indent="0" pn="section-5.9-3">
	   In TLS 1.3, the post-handshake key update mechanism provides
	   forward secrecy for the traffic secrets. EAP-TLS 1.3 does not
	   provide a similar mechanism for MSK and EMSK.  Implementation using
	   the exported MSK and EMSK can achieve forward secrecy by frequently
	   deriving new keys in a similar way as described in <xref target="RFC8446" sectionFormat="of" section="7.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-7.2" derivedContent="RFC8446"/>.
 
        </t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.10">
        <name slugifiedName="name-discovered-vulnerabilities">Discovered Vulnerabilities</name>
        <t indent="0" pn="section-5.10-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
        <t indent="0" pn="section-5.10-2">Over the years, there have been several serious attacks on earlier
        versions of Transport Layer Security (TLS), including attacks on its
        most commonly used ciphers and modes of operation. <xref target="RFC7457" format="default" sectionFormat="of" derivedContent="RFC7457"/> summarizes the attacks that were
        known at the time of publishing, and BCP 195 <xref target="RFC7525" format="default" sectionFormat="of" derivedContent="RFC7525"/> <xref target="RFC8996" format="default" sectionFormat="of" derivedContent="RFC8996"/> provides recommendations and requirements for
        improving the security of deployed services that use TLS. However,
        many of the attacks are less serious for EAP-TLS as EAP-TLS only uses
        the TLS handshake and does not protect any application data. EAP-TLS
        implementations <bcp14>MUST</bcp14> mitigate known attacks. EAP-TLS
        implementations need to monitor and follow new EAP- and TLS-related
        security guidance and requirements such as <xref target="RFC8447" format="default" sectionFormat="of" derivedContent="RFC8447"/> and <xref target="RFC9155" format="default" sectionFormat="of" derivedContent="RFC9155"/>.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.11">
        <name slugifiedName="name-cross-protocol-attacks">Cross-Protocol Attacks</name>
        <t indent="0" pn="section-5.11-1">This is a new section when compared to <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/>.</t>
        <t indent="0" pn="section-5.11-2">Allowing the same certificate to be used in multiple protocols can
        potentially allow an attacker to authenticate via one protocol and
        then "resume" that session in another protocol. <xref target="identity" format="default" sectionFormat="of" derivedContent="Section 2.2"/> suggests that certificates
        typically have one or more FQDNs in the SAN extension. However, those
        fields are for EAP validation only and do not indicate that the
        certificates are suitable for use with HTTPS or other protocols on the
        named host.</t>
        <t indent="0" pn="section-5.11-3"><xref target="resumption" format="default" sectionFormat="of" derivedContent="Section 2.1.3"/> suggests that
        authorization rules should be reapplied on resumption but does not
        mandate this behavior. As a result, this cross-protocol resumption
        could allow the attacker to bypass authorization policies and to
        obtain undesired access to secured systems. Along with making sure
        that appropriate authorization information is available and used
        during resumption, using different certificates and resumption caches
        for different protocols is <bcp14>RECOMMENDED</bcp14> to help keep
        different protocol usages separate.</t>
      </section>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-emu-tls-eap-types" to="TLS-EAP-TYPES"/>
    <displayreference target="I-D.ietf-tls-rfc8446bis" to="TLS-bis"/>
    <displayreference target="I-D.ietf-tls-ticketrequests" to="TICKET-REQUESTS"/>
    <references pn="section-6">
      <name slugifiedName="name-references">References</name>
      <references pn="section-6.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC3748" target="https://www.rfc-editor.org/info/rfc3748" quoteTitle="true" derivedAnchor="RFC3748">
          <front>
            <title>Extensible Authentication Protocol (EAP)</title>
            <author initials="B." surname="Aboba" fullname="B. Aboba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Blunk" fullname="L. Blunk">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Vollbrecht" fullname="J. Vollbrecht">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Carlson" fullname="J. Carlson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Levkowetz" fullname="H. Levkowetz" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2004" month="June"/>
            <abstract>
              <t indent="0">This document defines the Extensible Authentication Protocol (EAP), an authentication framework which supports multiple authentication methods.  EAP typically runs directly over data link layers such as Point-to-Point Protocol (PPP) or IEEE 802, without requiring IP.  EAP provides its own support for duplicate elimination and retransmission, but is reliant on lower layer ordering guarantees.  Fragmentation is not supported within EAP itself; however, individual EAP methods may support this.  This document obsoletes RFC 2284.  A summary of the changes between this document and RFC 2284 is available in Appendix A.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3748"/>
          <seriesInfo name="DOI" value="10.17487/RFC3748"/>
        </reference>
        <reference anchor="RFC5216" target="https://www.rfc-editor.org/info/rfc5216" quoteTitle="true" derivedAnchor="RFC5216">
          <front>
            <title>The EAP-TLS Authentication Protocol</title>
            <author initials="D." surname="Simon" fullname="D. Simon">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Aboba" fullname="B. Aboba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Hurst" fullname="R. Hurst">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="March"/>
            <abstract>
              <t indent="0">The Extensible Authentication Protocol (EAP), defined in RFC 3748, provides support for multiple authentication methods.  Transport Layer Security (TLS) provides for mutual authentication, integrity-protected ciphersuite negotiation, and key exchange between two endpoints.  This document defines EAP-TLS, which includes support for certificate-based mutual authentication and key derivation.</t>
              <t indent="0">This document obsoletes RFC 2716.  A summary of the changes between this document and RFC 2716 is available in Appendix A.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5216"/>
          <seriesInfo name="DOI" value="10.17487/RFC5216"/>
        </reference>
        <reference anchor="RFC5280" target="https://www.rfc-editor.org/info/rfc5280" quoteTitle="true" derivedAnchor="RFC5280">
          <front>
            <title>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</title>
            <author initials="D." surname="Cooper" fullname="D. Cooper">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Santesson" fullname="S. Santesson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Farrell" fullname="S. Farrell">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Boeyen" fullname="S. Boeyen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Housley" fullname="R. Housley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Polk" fullname="W. Polk">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="May"/>
            <abstract>
              <t indent="0">This memo profiles the X.509 v3 certificate and X.509 v2 certificate revocation list (CRL) for use in the Internet.  An overview of this approach and model is provided as an introduction.  The X.509 v3 certificate format is described in detail, with additional information regarding the format and semantics of Internet name forms.  Standard certificate extensions are described and two Internet-specific extensions are defined.  A set of required certificate extensions is specified.  The X.509 v2 CRL format is described in detail along with standard and Internet-specific extensions.  An algorithm for X.509 certification path validation is described.  An ASN.1 module and examples are provided in the appendices.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5280"/>
          <seriesInfo name="DOI" value="10.17487/RFC5280"/>
        </reference>
        <reference anchor="RFC5705" target="https://www.rfc-editor.org/info/rfc5705" quoteTitle="true" derivedAnchor="RFC5705">
          <front>
            <title>Keying Material Exporters for Transport Layer Security (TLS)</title>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="March"/>
            <abstract>
              <t indent="0">A number of protocols wish to leverage Transport Layer Security (TLS) to perform key establishment but then use some of the keying material for their own purposes.  This document describes a general mechanism for allowing that.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5705"/>
          <seriesInfo name="DOI" value="10.17487/RFC5705"/>
        </reference>
        <reference anchor="RFC6066" target="https://www.rfc-editor.org/info/rfc6066" quoteTitle="true" derivedAnchor="RFC6066">
          <front>
            <title>Transport Layer Security (TLS) Extensions: Extension Definitions</title>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="January"/>
            <abstract>
              <t indent="0">This document provides specifications for existing TLS extensions.  It is a companion document for RFC 5246, "The Transport Layer Security (TLS) Protocol Version 1.2".  The extensions specified are server_name, max_fragment_length, client_certificate_url, trusted_ca_keys, truncated_hmac, and status_request.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6066"/>
          <seriesInfo name="DOI" value="10.17487/RFC6066"/>
        </reference>
        <reference anchor="RFC6960" target="https://www.rfc-editor.org/info/rfc6960" quoteTitle="true" derivedAnchor="RFC6960">
          <front>
            <title>X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</title>
            <author initials="S." surname="Santesson" fullname="S. Santesson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Myers" fullname="M. Myers">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Ankney" fullname="R. Ankney">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Malpani" fullname="A. Malpani">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Galperin" fullname="S. Galperin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Adams" fullname="C. Adams">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="June"/>
            <abstract>
              <t indent="0">This document specifies a protocol useful in determining the current status of a digital certificate without requiring Certificate Revocation Lists (CRLs). Additional mechanisms addressing PKIX operational requirements are specified in separate documents.  This document obsoletes RFCs 2560 and 6277.  It also updates RFC 5912.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6960"/>
          <seriesInfo name="DOI" value="10.17487/RFC6960"/>
        </reference>
        <reference anchor="RFC7542" target="https://www.rfc-editor.org/info/rfc7542" quoteTitle="true" derivedAnchor="RFC7542">
          <front>
            <title>The Network Access Identifier</title>
            <author initials="A." surname="DeKok" fullname="A. DeKok">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="May"/>
            <abstract>
              <t indent="0">In order to provide inter-domain authentication services, it is necessary to have a standardized method that domains can use to identify each other's users.  This document defines the syntax for the Network Access Identifier (NAI), the user identifier submitted by the client prior to accessing resources.  This document is a revised version of RFC 4282.  It addresses issues with international character sets and makes a number of other corrections to RFC 4282.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7542"/>
          <seriesInfo name="DOI" value="10.17487/RFC7542"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8446" target="https://www.rfc-editor.org/info/rfc8446" quoteTitle="true" derivedAnchor="RFC8446">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="August"/>
            <abstract>
              <t indent="0">This document specifies version 1.3 of the Transport Layer Security (TLS) protocol.  TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t>
              <t indent="0">This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961.  This document also specifies new requirements for TLS 1.2 implementations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8446"/>
          <seriesInfo name="DOI" value="10.17487/RFC8446"/>
        </reference>
      </references>
      <references pn="section-6.2">
        <name slugifiedName="name-informative-references">Informative references</name>
        <reference anchor="IEEE-802.11" quoteTitle="true" target="https://doi.org/10.1109/IEEESTD.2016.7786995" derivedAnchor="IEEE-802.11">
          <front>
            <title>IEEE Standard for Information technology-Telecommunications and information exchange between systems Local and metropolitan area networks-Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="February" year="2021"/>
          </front>
          <seriesInfo name="IEEE Std." value="802.11-2020"/>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2016.7786995"/>
        </reference>
        <reference anchor="IEEE-802.1AE" quoteTitle="true" target="https://doi.org/10.1109/IEEESTD.2018.8585421" derivedAnchor="IEEE-802.1AE">
          <front>
            <title>IEEE Standard for Local and metropolitan area networks -- Media Access Control (MAC) Security</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="December" year="2018"/>
          </front>
          <seriesInfo name="IEEE Std." value="802.1AE-2018"/>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2018.8585421"/>
        </reference>
        <reference anchor="IEEE-802.1X" quoteTitle="true" target="https://doi.org/10.1109/IEEESTD.2020.9018454" derivedAnchor="IEEE-802.1X">
          <front>
            <title>IEEE Standard for Local and Metropolitan Area Networks--Port-Based Network Access Control</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="February" year="2020"/>
          </front>
          <seriesInfo name="IEEE Std." value="802.1X-2020"/>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2020.9018454"/>
        </reference>
        <reference anchor="MulteFire" quoteTitle="true" derivedAnchor="MulteFire">
          <front>
            <title>MulteFire Release 1.1 Specification</title>
            <author>
              <organization showOnFrontPage="true">MulteFire Alliance</organization>
            </author>
            <date year="2019"/>
          </front>
        </reference>
        <reference anchor="PEAP" quoteTitle="true" derivedAnchor="PEAP">
          <front>
            <title>[MS-PEAP]: Protected Extensible Authentication Protocol (PEAP)</title>
            <author>
              <organization showOnFrontPage="true">Microsoft Corporation</organization>
            </author>
            <date month="June" year="2021"/>
          </front>
        </reference>
        <reference anchor="RFC1661" target="https://www.rfc-editor.org/info/rfc1661" quoteTitle="true" derivedAnchor="RFC1661">
          <front>
            <title>The Point-to-Point Protocol (PPP)</title>
            <author initials="W." surname="Simpson" fullname="W. Simpson" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1994" month="July"/>
            <abstract>
              <t indent="0">This document defines the PPP organization and methodology, and the PPP encapsulation, together with an extensible option negotiation mechanism which is able to negotiate a rich assortment of configuration parameters and provides additional management functions.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="51"/>
          <seriesInfo name="RFC" value="1661"/>
          <seriesInfo name="DOI" value="10.17487/RFC1661"/>
        </reference>
        <reference anchor="RFC2246" target="https://www.rfc-editor.org/info/rfc2246" quoteTitle="true" derivedAnchor="RFC2246">
          <front>
            <title>The TLS Protocol Version 1.0</title>
            <author initials="T." surname="Dierks" fullname="T. Dierks">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Allen" fullname="C. Allen">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1999" month="January"/>
            <abstract>
              <t indent="0">This document specifies Version 1.0 of the Transport Layer Security (TLS) protocol. The TLS protocol provides communications privacy over the Internet. The protocol allows client/server applications to communicate in a way that is designed to prevent eavesdropping, tampering, or message forgery.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2246"/>
          <seriesInfo name="DOI" value="10.17487/RFC2246"/>
        </reference>
        <reference anchor="RFC2560" target="https://www.rfc-editor.org/info/rfc2560" quoteTitle="true" derivedAnchor="RFC2560">
          <front>
            <title>X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</title>
            <author initials="M." surname="Myers" fullname="M. Myers">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Ankney" fullname="R. Ankney">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Malpani" fullname="A. Malpani">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Galperin" fullname="S. Galperin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Adams" fullname="C. Adams">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1999" month="June"/>
            <abstract>
              <t indent="0">This document specifies a protocol useful in determining the current status of a digital certificate without requiring CRLs.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2560"/>
          <seriesInfo name="DOI" value="10.17487/RFC2560"/>
        </reference>
        <reference anchor="RFC2865" target="https://www.rfc-editor.org/info/rfc2865" quoteTitle="true" derivedAnchor="RFC2865">
          <front>
            <title>Remote Authentication Dial In User Service (RADIUS)</title>
            <author initials="C." surname="Rigney" fullname="C. Rigney">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Willens" fullname="S. Willens">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Rubens" fullname="A. Rubens">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Simpson" fullname="W. Simpson">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2000" month="June"/>
            <abstract>
              <t indent="0">This document describes a protocol for carrying authentication, authorization, and configuration information between a Network Access Server which desires to authenticate its links and a shared Authentication Server.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2865"/>
          <seriesInfo name="DOI" value="10.17487/RFC2865"/>
        </reference>
        <reference anchor="RFC3280" target="https://www.rfc-editor.org/info/rfc3280" quoteTitle="true" derivedAnchor="RFC3280">
          <front>
            <title>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</title>
            <author initials="R." surname="Housley" fullname="R. Housley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Polk" fullname="W. Polk">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Ford" fullname="W. Ford">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Solo" fullname="D. Solo">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2002" month="April"/>
            <abstract>
              <t indent="0">This memo profiles the X.509 v3 certificate and X.509 v2 Certificate Revocation List (CRL) for use in the Internet.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3280"/>
          <seriesInfo name="DOI" value="10.17487/RFC3280"/>
        </reference>
        <reference anchor="RFC4137" target="https://www.rfc-editor.org/info/rfc4137" quoteTitle="true" derivedAnchor="RFC4137">
          <front>
            <title>State Machines for Extensible Authentication Protocol (EAP) Peer and Authenticator</title>
            <author initials="J." surname="Vollbrecht" fullname="J. Vollbrecht">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Eronen" fullname="P. Eronen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="N." surname="Petroni" fullname="N. Petroni">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Ohba" fullname="Y. Ohba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="August"/>
            <abstract>
              <t indent="0">This document describes a set of state machines for Extensible Authentication Protocol (EAP) peer, EAP stand-alone authenticator (non-pass-through), EAP backend authenticator (for use on Authentication, Authorization, and Accounting (AAA) servers), and EAP full authenticator (for both local and pass-through).  This set of state machines shows how EAP can be implemented to support deployment in either a peer/authenticator or peer/authenticator/AAA Server environment.  The peer and stand-alone authenticator machines are illustrative of how the EAP protocol defined in RFC 3748 may be implemented.  The backend and full/pass-through authenticators illustrate how EAP/AAA protocol support defined in RFC 3579 may be implemented.  Where there are differences, RFC 3748 and RFC 3579 are authoritative.</t>
              <t indent="0">The state machines are based on the EAP "Switch" model.  This model includes events and actions for the interaction between the EAP Switch and EAP methods.  A brief description of the EAP "Switch" model is given in the Introduction section.</t>
              <t indent="0">The state machine and associated model are informative only. Implementations may achieve the same results using different methods.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4137"/>
          <seriesInfo name="DOI" value="10.17487/RFC4137"/>
        </reference>
        <reference anchor="RFC4282" target="https://www.rfc-editor.org/info/rfc4282" quoteTitle="true" derivedAnchor="RFC4282">
          <front>
            <title>The Network Access Identifier</title>
            <author initials="B." surname="Aboba" fullname="B. Aboba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Beadles" fullname="M. Beadles">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Arkko" fullname="J. Arkko">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Eronen" fullname="P. Eronen">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="December"/>
            <abstract>
              <t indent="0">In order to provide roaming services, it is necessary to have a standardized method for identifying users.  This document defines the syntax for the Network Access Identifier (NAI), the user identity submitted by the client during network authentication.  "Roaming" may be loosely defined as the ability to use any one of multiple Internet Service Providers (ISPs), while maintaining a formal, \%customer-vendor relationship with only one.  Examples of where roaming capabilities might be required include ISP "confederations" and \%ISP-provided corporate network access support.  This document is a revised version of RFC 2486, which originally defined NAIs.  Enhancements include international character set and privacy support, as well as a number of corrections to the original RFC.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4282"/>
          <seriesInfo name="DOI" value="10.17487/RFC4282"/>
        </reference>
        <reference anchor="RFC4346" target="https://www.rfc-editor.org/info/rfc4346" quoteTitle="true" derivedAnchor="RFC4346">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.1</title>
            <author initials="T." surname="Dierks" fullname="T. Dierks">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="April"/>
            <abstract>
              <t indent="0">This document specifies Version 1.1 of the Transport Layer Security (TLS) protocol.  The TLS protocol provides communications security over the Internet.  The protocol allows client/server applications to communicate in a way that is designed to prevent eavesdropping, tampering, or message forgery.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4346"/>
          <seriesInfo name="DOI" value="10.17487/RFC4346"/>
        </reference>
        <reference anchor="RFC4851" target="https://www.rfc-editor.org/info/rfc4851" quoteTitle="true" derivedAnchor="RFC4851">
          <front>
            <title>The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)</title>
            <author initials="N." surname="Cam-Winget" fullname="N. Cam-Winget">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="McGrew" fullname="D. McGrew">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Salowey" fullname="J. Salowey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Zhou" fullname="H. Zhou">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="May"/>
            <abstract>
              <t indent="0">This document defines the Extensible Authentication Protocol (EAP) based Flexible Authentication via Secure Tunneling (EAP-FAST) protocol.  EAP-FAST is an EAP method that enables secure communication between a peer and a server by using the Transport Layer Security (TLS) to establish a mutually authenticated tunnel. Within the tunnel, Type-Length-Value (TLV) objects are used to convey authentication related data between the peer and the EAP server.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4851"/>
          <seriesInfo name="DOI" value="10.17487/RFC4851"/>
        </reference>
        <reference anchor="RFC5077" target="https://www.rfc-editor.org/info/rfc5077" quoteTitle="true" derivedAnchor="RFC5077">
          <front>
            <title>Transport Layer Security (TLS) Session Resumption without Server-Side State</title>
            <author initials="J." surname="Salowey" fullname="J. Salowey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Zhou" fullname="H. Zhou">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Eronen" fullname="P. Eronen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Tschofenig" fullname="H. Tschofenig">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="January"/>
            <abstract>
              <t indent="0">This document describes a mechanism that enables the Transport Layer Security (TLS) server to resume sessions and avoid keeping per-client session state.  The TLS server encapsulates the session state into a ticket and forwards it to the client.  The client can subsequently resume a session using the obtained ticket.  This document obsoletes RFC 4507.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5077"/>
          <seriesInfo name="DOI" value="10.17487/RFC5077"/>
        </reference>
        <reference anchor="RFC5191" target="https://www.rfc-editor.org/info/rfc5191" quoteTitle="true" derivedAnchor="RFC5191">
          <front>
            <title>Protocol for Carrying Authentication for Network Access (PANA)</title>
            <author initials="D." surname="Forsberg" fullname="D. Forsberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Ohba" fullname="Y. Ohba" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Patil" fullname="B. Patil">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Tschofenig" fullname="H. Tschofenig">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Yegin" fullname="A. Yegin">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="May"/>
            <abstract>
              <t indent="0">This document defines the Protocol for Carrying Authentication for Network Access (PANA), a network-layer transport for Extensible Authentication Protocol (EAP) to enable network access authentication between clients and access networks.  In EAP terms, PANA is a UDP-based EAP lower layer that runs between the EAP peer and the EAP authenticator.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5191"/>
          <seriesInfo name="DOI" value="10.17487/RFC5191"/>
        </reference>
        <reference anchor="RFC5246" target="https://www.rfc-editor.org/info/rfc5246" quoteTitle="true" derivedAnchor="RFC5246">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.2</title>
            <author initials="T." surname="Dierks" fullname="T. Dierks">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="August"/>
            <abstract>
              <t indent="0">This document specifies Version 1.2 of the Transport Layer Security (TLS) protocol.  The TLS protocol provides communications security over the Internet.  The protocol allows client/server applications to communicate in a way that is designed to prevent eavesdropping, tampering, or message forgery.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5246"/>
          <seriesInfo name="DOI" value="10.17487/RFC5246"/>
        </reference>
        <reference anchor="RFC5247" target="https://www.rfc-editor.org/info/rfc5247" quoteTitle="true" derivedAnchor="RFC5247">
          <front>
            <title>Extensible Authentication Protocol (EAP) Key Management Framework</title>
            <author initials="B." surname="Aboba" fullname="B. Aboba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Simon" fullname="D. Simon">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Eronen" fullname="P. Eronen">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="August"/>
            <abstract>
              <t indent="0">The Extensible Authentication Protocol (EAP), defined in RFC 3748, enables extensible network access authentication.  This document specifies the EAP key hierarchy and provides a framework for the transport and usage of keying material and parameters generated by EAP authentication algorithms, known as "methods".  It also provides a detailed system-level security analysis, describing the conditions under which the key management guidelines described in RFC 4962 can be satisfied.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5247"/>
          <seriesInfo name="DOI" value="10.17487/RFC5247"/>
        </reference>
        <reference anchor="RFC5281" target="https://www.rfc-editor.org/info/rfc5281" quoteTitle="true" derivedAnchor="RFC5281">
          <front>
            <title>Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)</title>
            <author initials="P." surname="Funk" fullname="P. Funk">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Blake-Wilson" fullname="S. Blake-Wilson">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="August"/>
            <abstract>
              <t indent="0">EAP-TTLS is an EAP (Extensible Authentication Protocol) method that encapsulates a TLS (Transport Layer Security) session, consisting of a handshake phase and a data phase.  During the handshake phase, the server is authenticated to the client (or client and server are mutually authenticated) using standard TLS procedures, and keying material is generated in order to create a cryptographically secure tunnel for information exchange in the subsequent data phase.  During the data phase, the client is authenticated to the server (or client and server are mutually authenticated) using an arbitrary authentication mechanism encapsulated within the secure tunnel.  The encapsulated authentication mechanism may itself be EAP, or it may be another authentication protocol such as PAP, CHAP, MS-CHAP, or MS-CHAP-V2.  Thus, EAP-TTLS allows legacy password-based authentication protocols to be used against existing authentication databases, while protecting the security of these legacy protocols against eavesdropping, man-in-the-middle, and other attacks.  The data phase may also be used for additional, arbitrary data exchange.  This memo  provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5281"/>
          <seriesInfo name="DOI" value="10.17487/RFC5281"/>
        </reference>
        <reference anchor="RFC6125" target="https://www.rfc-editor.org/info/rfc6125" quoteTitle="true" derivedAnchor="RFC6125">
          <front>
            <title>Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</title>
            <author initials="P." surname="Saint-Andre" fullname="P. Saint-Andre">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Hodges" fullname="J. Hodges">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="March"/>
            <abstract>
              <t indent="0">Many application technologies enable secure communication between two entities by means of Internet Public Key Infrastructure Using X.509 (PKIX) certificates in the context of Transport Layer Security (TLS). This document specifies procedures for representing and verifying the identity of application services in such interactions.   [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6125"/>
          <seriesInfo name="DOI" value="10.17487/RFC6125"/>
        </reference>
        <reference anchor="RFC6733" target="https://www.rfc-editor.org/info/rfc6733" quoteTitle="true" derivedAnchor="RFC6733">
          <front>
            <title>Diameter Base Protocol</title>
            <author initials="V." surname="Fajardo" fullname="V. Fajardo" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Arkko" fullname="J. Arkko">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Loughney" fullname="J. Loughney">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Zorn" fullname="G. Zorn" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="October"/>
            <abstract>
              <t indent="0">The Diameter base protocol is intended to provide an Authentication, Authorization, and Accounting (AAA) framework for applications such as network access or IP mobility in both local and roaming situations.  This document specifies the message format, transport, error reporting, accounting, and security services used by all Diameter applications.  The Diameter base protocol as defined in this document obsoletes RFC 3588 and RFC 5719, and it must be supported by all new Diameter implementations.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6733"/>
          <seriesInfo name="DOI" value="10.17487/RFC6733"/>
        </reference>
        <reference anchor="RFC7170" target="https://www.rfc-editor.org/info/rfc7170" quoteTitle="true" derivedAnchor="RFC7170">
          <front>
            <title>Tunnel Extensible Authentication Protocol (TEAP) Version 1</title>
            <author initials="H." surname="Zhou" fullname="H. Zhou">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="N." surname="Cam-Winget" fullname="N. Cam-Winget">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Salowey" fullname="J. Salowey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Hanna" fullname="S. Hanna">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="May"/>
            <abstract>
              <t indent="0">This document defines the Tunnel Extensible Authentication Protocol (TEAP) version 1.  TEAP is a tunnel-based EAP method that enables secure communication between a peer and a server by using the Transport Layer Security (TLS) protocol to establish a mutually authenticated tunnel.  Within the tunnel, TLV objects are used to convey authentication-related data between the EAP peer and the EAP server.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7170"/>
          <seriesInfo name="DOI" value="10.17487/RFC7170"/>
        </reference>
        <reference anchor="RFC7406" target="https://www.rfc-editor.org/info/rfc7406" quoteTitle="true" derivedAnchor="RFC7406">
          <front>
            <title>Extensions to the Emergency Services Architecture for Dealing With Unauthenticated and Unauthorized Devices</title>
            <author initials="H." surname="Schulzrinne" fullname="H. Schulzrinne">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="McCann" fullname="S. McCann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Bajko" fullname="G. Bajko">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Tschofenig" fullname="H. Tschofenig">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Kroeselberg" fullname="D. Kroeselberg">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="December"/>
            <abstract>
              <t indent="0">This document provides a problem statement, introduces terminology, and describes an extension for the base IETF emergency services architecture to address cases where an emergency caller is not authenticated, has no identifiable service provider, or has no remaining credit with which to pay for access to the network.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7406"/>
          <seriesInfo name="DOI" value="10.17487/RFC7406"/>
        </reference>
        <reference anchor="RFC7457" target="https://www.rfc-editor.org/info/rfc7457" quoteTitle="true" derivedAnchor="RFC7457">
          <front>
            <title>Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)</title>
            <author initials="Y." surname="Sheffer" fullname="Y. Sheffer">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Holz" fullname="R. Holz">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Saint-Andre" fullname="P. Saint-Andre">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="February"/>
            <abstract>
              <t indent="0">Over the last few years, there have been several serious attacks on Transport Layer Security (TLS), including attacks on its most commonly used ciphers and modes of operation.  This document summarizes these attacks, with the goal of motivating generic and protocol-specific recommendations on the usage of TLS and Datagram TLS (DTLS).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7457"/>
          <seriesInfo name="DOI" value="10.17487/RFC7457"/>
        </reference>
        <reference anchor="RFC7525" target="https://www.rfc-editor.org/info/rfc7525" quoteTitle="true" derivedAnchor="RFC7525">
          <front>
            <title>Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</title>
            <author initials="Y." surname="Sheffer" fullname="Y. Sheffer">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Holz" fullname="R. Holz">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Saint-Andre" fullname="P. Saint-Andre">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="May"/>
            <abstract>
              <t indent="0">Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS) are widely used to protect data exchanged over application protocols such as HTTP, SMTP, IMAP, POP, SIP, and XMPP.  Over the last few years, several serious attacks on TLS have emerged, including attacks on its most commonly used cipher suites and their modes of operation.  This document provides recommendations for improving the security of deployed services that use TLS and DTLS. The recommendations are applicable to the majority of use cases.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="195"/>
          <seriesInfo name="RFC" value="7525"/>
          <seriesInfo name="DOI" value="10.17487/RFC7525"/>
        </reference>
        <reference anchor="RFC7593" target="https://www.rfc-editor.org/info/rfc7593" quoteTitle="true" derivedAnchor="RFC7593">
          <front>
            <title>The eduroam Architecture for Network Roaming</title>
            <author initials="K." surname="Wierenga" fullname="K. Wierenga">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Winter" fullname="S. Winter">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Wolniewicz" fullname="T. Wolniewicz">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="September"/>
            <abstract>
              <t indent="0">This document describes the architecture of the eduroam service for federated (wireless) network access in academia.  The combination of IEEE 802.1X, the Extensible Authentication Protocol (EAP), and RADIUS that is used in eduroam provides a secure, scalable, and deployable service for roaming network access.  The successful deployment of eduroam over the last decade in the educational sector may serve as an example for other sectors, hence this document.  In particular, the initial architectural choices and selection of standards are described, along with the changes that were prompted by operational experience.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7593"/>
          <seriesInfo name="DOI" value="10.17487/RFC7593"/>
        </reference>
        <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <author initials="M." surname="Cotton" fullname="M. Cotton">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="June"/>
            <abstract>
              <t indent="0">Many protocols make use of points of extensibility that use constants to identify various protocol parameters.  To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper.  For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
              <t indent="0">To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed.  This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
              <t indent="0">This is the third edition of this document; it obsoletes RFC 5226.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="26"/>
          <seriesInfo name="RFC" value="8126"/>
          <seriesInfo name="DOI" value="10.17487/RFC8126"/>
        </reference>
        <reference anchor="RFC8447" target="https://www.rfc-editor.org/info/rfc8447" quoteTitle="true" derivedAnchor="RFC8447">
          <front>
            <title>IANA Registry Updates for TLS and DTLS</title>
            <author initials="J." surname="Salowey" fullname="J. Salowey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Turner" fullname="S. Turner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="August"/>
            <abstract>
              <t indent="0">This document describes a number of changes to TLS and DTLS IANA registries that range from adding notes to the registry all the way to changing the registration policy.  These changes were mostly motivated by WG review of the TLS- and DTLS-related registries undertaken as part of the TLS 1.3 development process.</t>
              <t indent="0">This document updates the following RFCs: 3749, 5077, 4680, 5246, 5705, 5878, 6520, and 7301.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8447"/>
          <seriesInfo name="DOI" value="10.17487/RFC8447"/>
        </reference>
        <reference anchor="RFC8996" target="https://www.rfc-editor.org/info/rfc8996" quoteTitle="true" derivedAnchor="RFC8996">
          <front>
            <title>Deprecating TLS 1.0 and TLS 1.1</title>
            <author initials="K." surname="Moriarty" fullname="K. Moriarty">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Farrell" fullname="S. Farrell">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="March"/>
            <abstract>
              <t indent="0">This document formally deprecates Transport Layer Security (TLS) versions 1.0 (RFC 2246) and 1.1 (RFC 4346). Accordingly, those documents have been moved to Historic status. These versions lack support for current and recommended cryptographic algorithms and mechanisms, and various government and industry profiles of applications using TLS now mandate avoiding these old TLS versions. TLS version 1.2 became the recommended version for IETF protocols in 2008 (subsequently being obsoleted by TLS version 1.3 in 2018), providing sufficient time to transition away from older versions. Removing support for older versions from implementations reduces the attack surface, reduces opportunity for misconfiguration, and streamlines library and product maintenance. </t>
              <t indent="0">This document also deprecates Datagram TLS (DTLS) version 1.0 (RFC 4347) but not DTLS version 1.2, and there is no DTLS version 1.1.</t>
              <t indent="0">This document updates many RFCs that normatively refer to TLS version 1.0 or TLS version 1.1, as described herein. This document also updates the best practices for TLS usage in RFC 7525; hence, it is part of BCP 195.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="195"/>
          <seriesInfo name="RFC" value="8996"/>
          <seriesInfo name="DOI" value="10.17487/RFC8996"/>
        </reference>
        <reference anchor="RFC9155" target="https://www.rfc-editor.org/info/rfc9155" quoteTitle="true" derivedAnchor="RFC9155">
          <front>
            <title>Deprecating MD5 and SHA-1 Signature Hashes in TLS 1.2 and DTLS 1.2</title>
            <author initials="L." surname="Velvindron" fullname="L. Velvindron">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Moriarty" fullname="K. Moriarty">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Ghedini" fullname="A. Ghedini">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="December"/>
            <abstract>
              <t indent="0">The MD5 and SHA-1 hashing algorithms are increasingly vulnerable to attack, and this document deprecates their use in TLS 1.2 and DTLS 1.2 digital signatures. However, this document does not deprecate SHA-1 with Hashed Message Authentication Code (HMAC), as used in record protection. This document updates RFC 5246.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9155"/>
          <seriesInfo name="DOI" value="10.17487/RFC9155"/>
        </reference>
        <reference anchor="RFC9191" quoteTitle="true" target="https://www.rfc-editor.org/rfc/rfc9191" derivedAnchor="RFC9191">
          <front>
            <title>Handling Large Certificates and Long Certificate Chains in TLS-Based EAP Methods</title>
            <author initials="M" surname="Sethi" fullname="Mohit Sethi">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J" surname="Preuß Mattsson" fullname="John Preuß Mattsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S" surname="Turner" fullname="Sean Turner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2022" month="February"/>
          </front>
          <seriesInfo name="RFC" value="9191"/>
          <seriesInfo name="DOI" value="10.17487/RFC9191"/>
        </reference>
        <reference anchor="I-D.ietf-tls-ticketrequests" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-tls-ticketrequests-07" derivedAnchor="TICKET-REQUESTS">
          <front>
            <title>TLS Ticket Requests</title>
            <author fullname="Tommy Pauly">
              <organization showOnFrontPage="true">Apple Inc.</organization>
            </author>
            <author fullname="David Schinazi">
              <organization showOnFrontPage="true">Google LLC</organization>
            </author>
            <author fullname="Christopher A. Wood">
              <organization showOnFrontPage="true">Cloudflare</organization>
            </author>
            <date month="December" day="3" year="2020"/>
            <abstract>
              <t indent="0">   TLS session tickets enable stateless connection resumption for
   clients without server-side, per-client, state.  Servers vend an
   arbitrary number of session tickets to clients, at their discretion,
   upon connection establishment.  Clients store and use tickets when
   resuming future connections.  This document describes a mechanism by
   which clients can specify the desired number of tickets needed for
   future connections.  This extension aims to provide a means for
   servers to determine the number of tickets to generate in order to
   reduce ticket waste, while simultaneously priming clients for future
   connection attempts.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-tls-ticketrequests-07"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-tls-ticketrequests-07.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="I-D.ietf-tls-rfc8446bis" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8446bis-03" derivedAnchor="TLS-bis">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
            <author fullname="Eric Rescorla">
              <organization showOnFrontPage="true">Mozilla</organization>
            </author>
            <date month="October" day="25" year="2021"/>
            <abstract>
              <t indent="0">   This document specifies version 1.3 of the Transport Layer Security
   (TLS) protocol.  TLS allows client/server applications to communicate
   over the Internet in a way that is designed to prevent eavesdropping,
   tampering, and message forgery.

   This document updates RFCs 5705 and 6066 and obsoletes RFCs 5077,
   5246, and 6961.  This document also specifies new requirements for
   TLS 1.2 implementations.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-tls-rfc8446bis-03"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-tls-rfc8446bis-03.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="I-D.ietf-emu-tls-eap-types" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-emu-tls-eap-types-04" derivedAnchor="TLS-EAP-TYPES">
          <front>
            <title>TLS-based EAP types and TLS 1.3</title>
            <author fullname="Alan DeKok">
              <organization showOnFrontPage="true">FreeRADIUS</organization>
            </author>
            <date month="January" day="21" year="2022"/>
            <abstract>
              <t indent="0">   EAP-TLS [RFC5216] is being updated for TLS 1.3 in [EAPTLS].  Many
   other EAP [RFC3748] and [RFC5247] types also depend on TLS, such as
   FAST [RFC4851], TTLS [RFC5281], TEAP [RFC7170], and possibly many
   vendor specific EAP methods.  This document updates those methods in
   order to use the new key derivation methods available in TLS 1.3.
   Additional changes necessitated by TLS 1.3 are also discussed.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-emu-tls-eap-types-04"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-emu-tls-eap-types-04.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="TS.33.501" quoteTitle="true" derivedAnchor="TS.33.501">
          <front>
            <title>Security architecture and procedures for 5G system</title>
            <author>
              <organization showOnFrontPage="true">3GPP</organization>
            </author>
            <date month="January" year="2022"/>
          </front>
          <refcontent>Release 17
          </refcontent>
          <seriesInfo name="TS" value="33.501"/>
        </reference>
      </references>
    </references>
    <section anchor="updateref" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-updated-references">Updated References</name>
      <t indent="0" pn="section-appendix.a-1">
	The following references in <xref target="RFC5216" format="default" sectionFormat="of" derivedContent="RFC5216"/> are updated as specified below when EAP-TLS is used with TLS 1.3.
      </t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-appendix.a-2">
        <li pn="section-appendix.a-2.1">
          <t indent="0" pn="section-appendix.a-2.1.1">
	All references to <xref target="RFC2560" format="default" sectionFormat="of" derivedContent="RFC2560"/> are updated to refer to <xref target="RFC6960" format="default" sectionFormat="of" derivedContent="RFC6960"/>.
          </t>
        </li>
        <li pn="section-appendix.a-2.2">
          <t indent="0" pn="section-appendix.a-2.2.1">
	All references to <xref target="RFC3280" format="default" sectionFormat="of" derivedContent="RFC3280"/> are
	updated to refer to <xref target="RFC5280" format="default" sectionFormat="of" derivedContent="RFC5280"/>. References to <xref target="RFC3280" section="4.2.1.13" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc3280#section-4.2.1.13" derivedContent="RFC3280"/> are updated
	to refer to <xref target="RFC5280" sectionFormat="of" section="4.2.1.12" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.12" derivedContent="RFC5280"/>.
          </t>
        </li>
        <li pn="section-appendix.a-2.3">
          <t indent="0" pn="section-appendix.a-2.3.1">
	All references to <xref target="RFC4282" format="default" sectionFormat="of" derivedContent="RFC4282"/> are
	updated to refer to <xref target="RFC7542" format="default" sectionFormat="of" derivedContent="RFC7542"/>. References to <xref target="RFC4282" sectionFormat="of" section="2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4282#section-2.1" derivedContent="RFC4282"/> are updated to
	refer to <xref target="RFC7542" sectionFormat="of" section="2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7542#section-2.2" derivedContent="RFC7542"/>.
          </t>
        </li>
      </ul>
    </section>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.b">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.b-1">
	The authors want to thank <contact fullname="Bernard Aboba"/>,
	<contact fullname="Jari Arkko"/>, <contact fullname="Terry Burton"/>,
	<contact fullname="Alan DeKok"/>, <contact fullname="Ari Keränen"/>,
	<contact fullname="Benjamin Kaduk"/>, <contact fullname="Jouni  Malinen"/>, <contact fullname="Oleg Pekar"/>, <contact fullname="Eric  Rescorla"/>, <contact fullname="Jim Schaad"/>, <contact fullname="Joseph Salowey"/>, <contact fullname="Martin Thomson"/>,
	<contact fullname="Vesa Torvinen"/>, <contact fullname="Hannes  Tschofenig"/>, and <contact fullname="Heikki Vatiainen"/> for comments
	and suggestions on this document. Special thanks to the Document Shepherd
	<contact fullname="Joseph Salowey"/>.
      </t>
    </section>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.c">
      <name slugifiedName="name-contributors">Contributors</name>
      <t indent="0" pn="section-appendix.c-1">
	<contact fullname="Alan DeKok"/>, FreeRADIUS
      </t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.d">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author initials="J." surname="Preuß Mattsson" fullname="John Preuß Mattsson">
        <organization showOnFrontPage="true">Ericsson</organization>
        <address>
          <postal>
            <street/>
            <city>Kista</city>
            <code>164 40</code>
            <country>Sweden</country>
          </postal>
          <email>john.mattsson@ericsson.com</email>
        </address>
      </author>
      <author initials="M" surname="Sethi" fullname="Mohit Sethi">
        <organization showOnFrontPage="true">Ericsson</organization>
        <address>
          <postal>
            <street/>
            <city>Jorvas</city>
            <code>02420</code>
            <country>Finland</country>
          </postal>
          <email>mohit@iki.fi</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
