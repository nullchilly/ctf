<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 8756: Commercial National Security Algorithm (CNSA) Suite Profile of Certificate Management over CMS</title>
<meta content="Michael Jenkins" name="author">
<meta content="Lydia Zieglar" name="author">
<meta content="
       This document specifies a profile of the Certificate Management over CMS (CMC) protocol for managing X.509 public key certificates in applications that use the Commercial National Security Algorithm (CNSA) Suite published by the United States Government.
 
       The profile applies to the capabilities, configuration, and operation of all components of US National Security Systems that manage X.509 public key certificates over CMS.  It is also appropriate for all other US Government systems that process high-value information.
 
       The profile is made publicly available here for use by developers and operators of these and any other system deployments.
 
    " name="description">
<meta content="xml2rfc 2.41.0" name="generator">
<meta content="NSA" name="keyword">
<meta content="CNSA" name="keyword">
<meta content="NSS" name="keyword">
<meta content="certificate" name="keyword">
<meta content="enrollment" name="keyword">
<meta content="8756" name="rfc.number">
<link href="rfc8756.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link href="https://dx.doi.org/10.17487/rfc8756" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  <link href="https://datatracker.ietf.org/doc/draft-jenkins-cnsa-cmc-profile-05" rel="prev">
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8756</td>
<td class="center">CNSA Suite CMC Profile</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jenkins &amp; Zieglar</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Independent Submission</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc8756" class="eref">8756</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-03" class="published">March 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Jenkins</div>
<div class="org">NSA</div>
</div>
<div class="author">
      <div class="author-name">L. Zieglar</div>
<div class="org">NSA</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8756</h1>
<h1 id="title">Commercial National Security Algorithm (CNSA) Suite Profile of Certificate Management over CMS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a profile of the Certificate Management over CMS (CMC) protocol for managing X.509 public key certificates in applications that use the Commercial National Security Algorithm (CNSA) Suite published by the United States Government.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The profile applies to the capabilities, configuration, and operation of all components of US National Security Systems that manage X.509 public key certificates over CMS.  It is also appropriate for all other US Government systems that process high-value information.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">The profile is made publicly available here for use by developers and operators of these and any other system deployments.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This is a contribution to the RFC Series, independently of any
            other RFC stream.  The RFC Editor has chosen to publish this
            document at its discretion and makes no statement about its value
            for implementation or deployment.  Documents approved for
            publication by the RFC Editor are not candidates for any level of
            Internet Standard; see Section 2 of RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8756">https://www.rfc-editor.org/info/rfc8756</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-the-commercial-national-sec" class="xref">The Commercial National Security Algorithm Suite</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-requirements-and-assumption" class="xref">Requirements and Assumptions</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-client-requirements-generat" class="xref">Client Requirements: Generating PKI Requests</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-tagged-certification-reques" class="xref">Tagged Certification Request</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-certificate-request-message" class="xref">Certificate Request Message</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-ra-requirements" class="xref">RA Requirements</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-ra-processing-of-requests" class="xref">RA Processing of Requests</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-ra-generated-pki-requests" class="xref">RA-Generated PKI Requests</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-ra-generated-pki-responses" class="xref">RA-Generated PKI Responses</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ca-requirements" class="xref">CA Requirements</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-ca-processing-of-pki-reques" class="xref">CA Processing of PKI Requests</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-ca-generated-pki-responses" class="xref">CA-Generated PKI Responses</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-client-requirements-process" class="xref">Client Requirements: Processing PKI Responses</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-shared-secrets" class="xref">Shared-Secrets</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-scenarios" class="xref">Scenarios</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-initial-enrollment" class="xref">Initial Enrollment</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-rekey" class="xref">Rekey</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies a profile of the Certificate Management over CMS (CMC) protocol to comply with the United States National Security Agency's Commercial National Security Algorithm (CNSA) Suite <span>[<a href="#CNSA" class="xref">CNSA</a>]</span>. The profile applies to the capabilities, configuration, and operation of all components of US National Security Systems <span>[<a href="#SP80059" class="xref">SP80059</a>]</span>. It is also appropriate for all other US Government systems that process high-value information. It is made publicly available for use by developers and operators of these and any other system deployments.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document does not define any new cryptographic algorithm suites; instead, it defines a CNSA-compliant profile of CMC. CMC is defined in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="xref">RFC5273</a>]</span>, and <span>[<a href="#RFC5274" class="xref">RFC5274</a>]</span> and is updated by <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>. This document profiles CMC to manage X.509 public key certificates in compliance with the CNSA Suite Certificate and Certificate Revocation List (CRL) profile <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>. This document specifically focuses on defining CMC interactions for both the initial enrollment and rekey of CNSA Suite public key certificates between a client and a Certification Authority (CA).  One or more Registration Authorities (RAs) may act as intermediaries between the client and the CA.  This profile may be further tailored by specific communities to meet their needs.  Specific communities will also define certificate policies that implementations need to comply with.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The terminology in <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-2.1" class="relref">Section 2.1</a></span> applies to this profile.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">The term "certificate request" is used to refer to a single PKCS #10
      or  Certificate Request Message Format (CRMF) structure. All PKI Requests are Full PKI Requests, and all PKI Responses are Full PKI Responses; the respective set of terms should be interpreted synonymously in this document.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cnsa">
<section id="section-2">
      <h2 id="name-the-commercial-national-sec">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-commercial-national-sec" class="section-name selfRef">The Commercial National Security Algorithm Suite</a>
      </h2>
<p id="section-2-1">The National Security Agency (NSA) profiles commercial cryptographic algorithms and protocols as part of its mission to support secure, interoperable communications for US Government National Security Systems. To this end, it publishes guidance both to assist with the US Government transition to new algorithms and to provide vendors -- and the Internet community in general -- with information concerning their proper use and configuration within the scope of US Government National Security Systems.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Recently, cryptographic transition plans have become overshadowed by
      the prospect of the development of a cryptographically relevant quantum
      computer. The NSA has established the Commercial National Security
      Algorithm (CNSA) Suite to provide vendors and IT users near-term
      flexibility in meeting their cybersecurity interoperability
      requirements. The purpose behind this flexibility is to avoid having vendors and customers make two major transitions in a relatively short timeframe, as we anticipate a need to shift to quantum-resistant cryptography in the near future.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The NSA is authoring a set of RFCs, including this one, to provide updated guidance concerning the use of certain commonly available commercial algorithms in IETF protocols. These RFCs can be used in conjunction with other RFCs and cryptographic guidance (e.g., NIST Special Publications) to properly protect Internet traffic and data-at-rest for US Government National Security Systems.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reqts">
<section id="section-3">
      <h2 id="name-requirements-and-assumption">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-requirements-and-assumption" class="section-name selfRef">Requirements and Assumptions</a>
      </h2>
<p id="section-3-1">Elliptic Curve Digital Signature Algorithm (ECDSA) and Elliptic Curve
      Diffie-Hellman (ECDH) key pairs are on the P-384 curve.  FIPS 186-4 <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span>, Appendix B.4 provides useful guidance for elliptic curve key pair generation that <span class="bcp14">SHOULD</span> be followed by systems that conform to this document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">RSA key pairs (public, private) are identified by the modulus size expressed in bits; RSA-3072 and RSA-4096 are computed using moduli of 3072 bits and 4096 bits, respectively.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">RSA signature key pairs used in CNSA Suite-compliant implementations are either RSA-3072 or RSA-4096. The RSA exponent e <span class="bcp14">MUST</span> satisfy 2<sup>16</sup> &lt; e &lt; 2<sup>256</sup> and be odd per <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">It is recognized that, while the vast majority of RSA signatures are currently made using the RSASSA-PKCS1-v1_5 algorithm, the preferred RSA signature scheme for new applications is RSASSA-PSS.  CNSA Suite-compliant X.509 certificates will be issued in accordance with <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>, and while those certificates must be signed and validated using RSASSA-PKCS1-v1_5, the subject's private key can be used to generate signatures of either signing scheme.  Where use of RSASSA-PSS is indicated in this document, the following parameters apply:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-3-5.1">The hash algorithm <span class="bcp14">MUST</span> be id-sha384 as defined in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>;<a href="#section-3-5.1" class="pilcrow">¶</a>
</li>
<li id="section-3-5.2">The mask generation function <span class="bcp14">MUST</span> use the algorithm identifier mfg1SHA384Identifier as defined in <span>[<a href="#RFC4055" class="xref">RFC4055</a>]</span>;<a href="#section-3-5.2" class="pilcrow">¶</a>
</li>
<li id="section-3-5.3">The salt length <span class="bcp14">MUST</span> be 48 octets; and<a href="#section-3-5.3" class="pilcrow">¶</a>
</li>
<li id="section-3-5.4">The trailerField <span class="bcp14">MUST</span> have value 1.<a href="#section-3-5.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3-6">

These parameters will not appear in a certificate and <span class="bcp14">MUST</span> be securely
      communicated with the signature, as required by <span><a href="https://www.rfc-editor.org/rfc/rfc4056#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC4056" class="xref">RFC4056</a>]</span>. Application developers are obliged to ensure that the chosen signature scheme is appropriate for the application and will be interoperable within the intended operating scope of the application.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">This document assumes that the required trust anchors have been securely provisioned to the client and, when applicable, to any RAs.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">All requirements in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="xref">RFC5273</a>]</span>, <span>[<a href="#RFC5274" class="xref">RFC5274</a>]</span>, and <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span> apply, except where overridden by this profile.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">This profile was developed with the scenarios described in <a href="#scenarios" class="xref">Appendix A</a> in mind.  However, use of this profile is not limited to just those scenarios.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">The term "client" in this profile typically refers to an end-entity. However, it may instead refer to a third party acting on the end-entity's behalf.  The client may or may not be the entity that actually generates the key pair, but it does perform the CMC protocol interactions with the RA and/or CA.  For example, the client may be a token management system that communicates with a cryptographic token through an out-of-band secure protocol.<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">This profile uses the term "rekey" in the same manner as CMC does (defined in <span><a href="https://www.rfc-editor.org/rfc/rfc5272#section-2" class="relref">Section 2</a> of [<a href="#RFC5272" class="xref">RFC5272</a>]</span>).  The profile makes no specific statements about the ability to do "renewal" operations; however, the statements applicable to "rekey" should be applied to "renewal" as well.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">This profile may be used to manage RA and/or CA certificates.  In that case, the RA and/or CA whose certificate is being managed is considered to be the end-entity.<a href="#section-3-12" class="pilcrow">¶</a></p>
<p id="section-3-13">This profile does not discuss key establishment certification requests from cryptographic modules that cannot generate a one-time signature with a key establishment key for proof-of-possession purposes.  In that case, a separate profile would be needed to define the use of another proof-of-possession technique.<a href="#section-3-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-reqts-gen">
<section id="section-4">
      <h2 id="name-client-requirements-generat">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-client-requirements-generat" class="section-name selfRef">Client Requirements: Generating PKI Requests</a>
      </h2>
<p id="section-4-1">This section specifies the conventions employed when a client requests a certificate from a Public Key Infrastructure (PKI).<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The Full PKI Request <span class="bcp14">MUST</span> be used; it <span class="bcp14">MUST</span> be encapsulated in a SignedData; and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>. The PKIData content type defined in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span> is used with the following additional requirements:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-3.1">
          <p id="section-4-3.1.1">controlSequence <span class="bcp14">SHOULD</span> be present.<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-3.1.2.1">TransactionId and SenderNonce <span class="bcp14">SHOULD</span> be included. Other CMC controls <span class="bcp14">MAY</span> be included.<a href="#section-4-3.1.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4-3.1.2.2">
              <p id="section-4-3.1.2.2.1">If the request is being authenticated using a shared-secret, then Identity Proof Version 2 control <span class="bcp14">MUST</span> be included with the following constraints:<a href="#section-4-3.1.2.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4-3.1.2.2.2.1">hashAlgId <span class="bcp14">MUST</span> be id-sha384 for all certification requests (algorithm OIDs are defined in <span>[<a href="#RFC5754" class="xref">RFC5754</a>]</span>).<a href="#section-4-3.1.2.2.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4-3.1.2.2.2.2">macAlgId <span class="bcp14">MUST</span> be HMAC-SHA384 (the Hashed
 Message Authentication Code (HMAC) algorithm is defined in <span>[<a href="#RFC4231" class="xref">RFC4231</a>]</span>).<a href="#section-4-3.1.2.2.2.2" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-4-3.1.2.3">If the subject name included in the certification request is NULL
     or otherwise does not uniquely identify the end-entity, then the
     POP Link Random control <span class="bcp14">MUST</span> be included, and the
     POP Link Witness Version 2 control <span class="bcp14">MUST</span> be included
     in the inner PKCS #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> or
     Certificate Request Message Format (CRMF) <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span> request as described in Sections <a href="#tgd-cert-reqst" class="xref">4.1</a> and <a href="#cert-reqst-msg" class="xref">4.2</a>.<a href="#section-4-3.1.2.3" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-4-3.2">reqSequence <span class="bcp14">MUST</span> be present.  It <span class="bcp14">MUST</span> include at least one tcr (see <a href="#tgd-cert-reqst" class="xref">Section 4.1</a>) or crm (see <a href="#cert-reqst-msg" class="xref">Section 4.2</a>) TaggedRequest. Support for the orm choice is <span class="bcp14">OPTIONAL</span>.<a href="#section-4-3.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4-4">The private signing key used to generate the encapsulating SignedData <span class="bcp14">MUST</span> correspond to the public key of an existing signature certificate unless an appropriate signature certificate does not yet exist, such as during initial enrollment.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">The encapsulating SignedData <span class="bcp14">MUST</span> be generated using SHA-384 and either ECDSA on P-384 or RSA using either RSASSA-PKCS1-v1_5 or RSASSA-PSS with an RSA-3072 or RSA-4096 key.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">If an appropriate signature certificate does not yet exist and if a Full PKI Request includes one or more certification requests and is authenticated using a shared-secret (because no appropriate certificate exists yet to authenticate the request), the Full PKI Request <span class="bcp14">MUST</span> be signed using the private key corresponding to the public key of one of the requested certificates.  When necessary (i.e., because there is no existing signature certificate and there is no signature certification request included), a Full PKI Request <span class="bcp14">MAY</span> be signed using a key pair intended for use in a key establishment certificate.  However, servers are not required to allow this behavior.<a href="#section-4-6" class="pilcrow">¶</a></p>
<div id="tgd-cert-reqst">
<section id="section-4.1">
        <h3 id="name-tagged-certification-reques">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-tagged-certification-reques" class="section-name selfRef">Tagged Certification Request</a>
        </h3>
<p id="section-4.1-1">The reqSequence tcr choice conveys PKCS #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> syntax.  The CertificateRequest <span class="bcp14">MUST</span>
 comply with <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.1" class="relref">Section 3.2.1.2.1</a></span>, with the following additional requirements:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">certificationRequestInfo:<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1-2.1.2.1">subjectPublicKeyInfo <span class="bcp14">MUST</span> be set as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc8603#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.1-2.1.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.1.2.2">
                <p id="section-4.1-2.1.2.2.1">Attributes:<a href="#section-4.1-2.1.2.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1-2.1.2.2.2.1">
                    <p id="section-4.1-2.1.2.2.2.1.1">The ExtensionReq attribute <span class="bcp14">MUST</span> be included with its contents as follows:<a href="#section-4.1-2.1.2.2.2.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1-2.1.2.2.2.1.2.1">The keyUsage extension <span class="bcp14">MUST</span> be included, and it <span class="bcp14">MUST</span> be set as defined in <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.1-2.1.2.2.2.1.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.1.2.2.2.1.2.2">For rekey requests, the SubjectAltName extension <span class="bcp14">MUST</span> be included and set equal to the SubjectAltName of the certificate that is being used to sign the SignedData encapsulating the request (i.e., not the certificate being rekeyed) if the subject field of the certificate being used to generate the signature is NULL.<a href="#section-4.1-2.1.2.2.2.1.2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.1.2.2.2.1.2.3">Other extension requests <span class="bcp14">MAY</span> be included as desired.<a href="#section-4.1-2.1.2.2.2.1.2.3" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-4.1-2.1.2.2.2.2">The ChangeSubjectName attribute, as defined in <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>, <span class="bcp14">MUST</span> be included if the Full PKI Request encapsulating this Tagged Certification Request is being signed by a key for which a certificate currently exists and the existing certificate's subject field or SubjectAltName extension does not match the desired subject name or SubjectAltName extension of this certification request.<a href="#section-4.1-2.1.2.2.2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.1.2.2.2.3">The POP Link Witness Version 2 attribute <span class="bcp14">MUST</span> be included if the request is being authenticated using a shared-secret and the subject name in the certification request is NULL or otherwise does not uniquely identify the end-entity.  In the POP Link Witness Version 2 attribute, keyGenAlgorithm <span class="bcp14">MUST</span> be id-sha384 for certification requests, as defined in <span>[<a href="#RFC5754" class="xref">RFC5754</a>]</span>; macAlgorithm <span class="bcp14">MUST</span> be HMAC-SHA384, as defined in <span>[<a href="#RFC4231" class="xref">RFC4231</a>]</span>.<a href="#section-4.1-2.1.2.2.2.3" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-4.1-2.1.2.3">signatureAlgorithm <span class="bcp14">MUST</span> be ecdsa-with-sha384 for P-384 certification requests and sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096 certification requests.<a href="#section-4.1-2.1.2.3" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.1.2.4">signature <span class="bcp14">MUST</span> be generated using the private key corresponding to the public key in the CertificationRequestInfo for both signature and key establishment certification requests.  The signature provides proof-of-possession of the private key to the CA.<a href="#section-4.1-2.1.2.4" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
</section>
</div>
<div id="cert-reqst-msg">
<section id="section-4.2">
        <h3 id="name-certificate-request-message">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-certificate-request-message" class="section-name selfRef">Certificate Request Message</a>
        </h3>
<p id="section-4.2-1">The reqSequence crm choice conveys Certificate Request Message
 Format (CRMF) <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span>
 syntax.  The CertReqMsg <span class="bcp14">MUST</span> comply with <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2" class="relref">Section 3.2.1.2.2</a></span>, with the following additional requirements:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.2-2.1">popo <span class="bcp14">MUST</span> be included using the signature (POPOSigningKey)
   proof-of-possession choice and be set as defined in <span>[<a href="#RFC4211" class="xref">RFC4211</a>], <a href="https://www.rfc-editor.org/rfc/rfc4211#section-4.1" class="relref">Section 4.1</a></span> for both signature and key establishment certification requests. The POPOSigningKey poposkInput field <span class="bcp14">MUST</span> be omitted.  The POPOSigningKey algorithmIdentifier <span class="bcp14">MUST</span> be ecdsa-with-sha384 for P-384 certification requests and sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096 certification requests.  The signature <span class="bcp14">MUST</span> be generated using the private key corresponding to the public key in the CertTemplate.<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.2-3">The CertTemplate <span class="bcp14">MUST</span> comply with <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2" class="relref">Section 3.2.1.2.2</a></span>, with the following additional requirements:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.2-4.1">If version is included, it <span class="bcp14">MUST</span> be set to 2 as defined in
   <span><a href="https://www.rfc-editor.org/rfc/rfc8603#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.2-4.1" class="pilcrow">¶</a>
</li>
<li id="section-4.2-4.2">publicKey <span class="bcp14">MUST</span> be set as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc8603#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.2-4.2" class="pilcrow">¶</a>
</li>
<li id="section-4.2-4.3">
            <p id="section-4.2-4.3.1">Extensions:<a href="#section-4.2-4.3.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.2-4.3.2.1">The keyUsage extension <span class="bcp14">MUST</span> be included, and it <span class="bcp14">MUST</span> be set as defined in <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.2-4.3.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.2-4.3.2.2">For rekey requests, the SubjectAltName extension <span class="bcp14">MUST</span> be included and set equal to the SubjectAltName of the certificate that is being used to sign the SignedData encapsulating the request (i.e., not the certificate being rekeyed) if the subject name of the certificate being used to generate the signature is NULL.<a href="#section-4.2-4.3.2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.2-4.3.2.3">Other extension requests <span class="bcp14">MAY</span> be included as desired.<a href="#section-4.2-4.3.2.3" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-4.2-4.4">
            <p id="section-4.2-4.4.1">Controls:<a href="#section-4.2-4.4.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.2-4.4.2.1">The ChangeSubjectName attribute, as defined in <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>, <span class="bcp14">MUST</span> be included if the Full PKI Request encapsulating this Tagged Certification Request is being signed by a key for which a certificate currently exists and the existing certificate's subject name or SubjectAltName extension does not match the desired subject name or SubjectAltName extension of this certification request.<a href="#section-4.2-4.4.2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.2-4.4.2.2">The POP Link Witness Version 2 attribute <span class="bcp14">MUST</span> be included if the request is being authenticated using a shared-secret and the subject name in the certification request is NULL or otherwise does not uniquely identify the end-entity.  In the POP Link Witness Version 2 attribute, keyGenAlgorithm <span class="bcp14">MUST</span> be id-sha384 for certification requests; macAlgorithm <span class="bcp14">MUST</span> be HMAC-SHA384 when keyGenAlgorithm is id-sha384.<a href="#section-4.2-4.4.2.2" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="ra_reqts">
<section id="section-5">
      <h2 id="name-ra-requirements">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-ra-requirements" class="section-name selfRef">RA Requirements</a>
      </h2>
<p id="section-5-1">This section addresses the optional case where one or more RAs act as
      intermediaries between clients and a CA as described in <span><a href="https://www.rfc-editor.org/rfc/rfc5272#section-7" class="relref">Section 7</a> of [<a href="#RFC5272" class="xref">RFC5272</a>]</span>.  In this section, the term "client" refers to the entity from which the RA received the PKI Request. This section is only applicable to RAs.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="ra-proc-reqst">
<section id="section-5.1">
        <h3 id="name-ra-processing-of-requests">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-ra-processing-of-requests" class="section-name selfRef">RA Processing of Requests</a>
        </h3>
<p id="section-5.1-1">RAs conforming to this document <span class="bcp14">MUST</span> ensure that only the permitted signature, hash, and MAC algorithms described throughout this profile are used in requests; if they are not, the RA <span class="bcp14">MUST</span> reject those requests.  The RA <span class="bcp14">SHOULD</span> return a CMCFailInfo with the value of badAlg <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">When processing end-entity-generated SignedData objects, RAs <span class="bcp14">MUST NOT</span> perform Cryptographic Message Syntax (CMS) Content Constraints (CCC) certificate extension processing <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Other RA processing is performed as described in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ra-gend-pki-reqst">
<section id="section-5.2">
        <h3 id="name-ra-generated-pki-requests">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-ra-generated-pki-requests" class="section-name selfRef">RA-Generated PKI Requests</a>
        </h3>
<p id="section-5.2-1">RAs mediate the certificate request process by collecting client requests in batches. The RA <span class="bcp14">MUST</span> encapsulate client-generated PKI Requests in a new RA-signed PKI Request, it <span class="bcp14">MUST</span> create a Full PKI Request encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>.  The PKIData content type complies with <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span> with the following additional requirements:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.2-2.1">controlSequence <span class="bcp14">MUST</span> be present. It
   <span class="bcp14">MUST</span> include the following CMC controls: Transaction
   ID, Sender Nonce, and Batch Requests. Other appropriate CMC controls
   <span class="bcp14">MAY</span> be included.<a href="#section-5.2-2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.2-2.2">cmsSequence <span class="bcp14">MUST</span> be present.  It contains the original, unmodified request(s) received from the client.<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</li>
</ul>
<div id="section-5.2-3">
<pre class="sourcecode">
      SignedData (applied by the RA)
        PKIData
          controlSequence (Transaction ID, Sender Nonce,
                                               Batch Requests)
          cmsSequence
            SignedData (applied by client)
              PKIData
                controlSequence (Transaction ID, Sender Nonce)
                reqSequence
                  TaggedRequest
                  {TaggedRequest}
            {SignedData     (second client request)
              PKIData...}
</pre><a href="#section-5.2-3" class="pilcrow">¶</a>
</div>
<p id="section-5.2-4">Authorization to sign RA-generated Full PKI Requests
 <span class="bcp14">SHOULD</span> be indicated in the RA certificate by inclusion
 of the id-kp-cmcRA Extended Key Usage (EKU) from <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>. The RA certificate <span class="bcp14">MAY</span> also include
 the CCC certificate extension <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span>, or it <span class="bcp14">MAY</span> indicate authorization
 through inclusion of the CCC certificate extension alone. The RA
 certificate may also be authorized through the local configuration.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">If the RA is authorized via the CCC extension, then the CCC extension <span class="bcp14">MUST</span> include the object identifier for the PKIData content type. CCC <span class="bcp14">SHOULD</span> be included if constraints are to be placed on the content types generated.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">The outer SignedData <span class="bcp14">MUST</span> be generated using SHA-384 and either ECDSA on P-384 or RSA using RSASSA-PKCS1-v1_5 or RSASSA-PSS with an RSA-3072 or RSA-4096 key.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">If the Full PKI Response is a successful response to a PKI Request that only contained a Get Certificate or Get CRL control, then the algorithm used in the response <span class="bcp14">MUST</span> match the algorithm used in the request.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ra-gend-resp">
<section id="section-5.3">
        <h3 id="name-ra-generated-pki-responses">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-ra-generated-pki-responses" class="section-name selfRef">RA-Generated PKI Responses</a>
        </h3>
<p id="section-5.3-1">In order for an RA certificate using the CCC certificate extension to be authorized to generate responses, the object identifier for the PKIResponse content type must be present in the CCC certificate extension.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ca-reqts">
<section id="section-6">
      <h2 id="name-ca-requirements">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ca-requirements" class="section-name selfRef">CA Requirements</a>
      </h2>
<p id="section-6-1">This section specifies the requirements for CAs that receive PKI Requests and generate PKI Responses.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="ca-proc-reqst">
<section id="section-6.1">
        <h3 id="name-ca-processing-of-pki-reques">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ca-processing-of-pki-reques" class="section-name selfRef">CA Processing of PKI Requests</a>
        </h3>
<p id="section-6.1-1">CAs conforming to this document <span class="bcp14">MUST</span> ensure that
 only the permitted signature, hash, and MAC algorithms described
 throughout this profile are used in requests; if they are not, the CA
 <span class="bcp14">MUST</span> reject those requests.  The CA
 <span class="bcp14">SHOULD</span> return a CMCStatusInfoV2 control with a CMCStatus of failed and a CMCFailInfo with the value of badAlg <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">For requests involving an RA (i.e., batched requests), the CA
 <span class="bcp14">MUST</span> verify the RA's authorization.  The following
 certificate fields <span class="bcp14">MUST NOT</span> be modifiable using the
 Modify Certification Request control: publicKey and the keyUsage
 extension.  The request <span class="bcp14">MUST</span> be rejected if an attempt
 to modify those certification request fields is present.  The CA
 <span class="bcp14">SHOULD</span> return a CMCStatusInfoV2 control with a CMCStatus of failed and a CMCFailInfo with a value of badRequest.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">When processing end-entity-generated SignedData objects, CAs <span class="bcp14">MUST NOT</span> perform CCC certificate extension processing <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span>.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">If a client-generated PKI Request includes the ChangeSubjectName
 attribute as described in <a href="#tgd-cert-reqst" class="xref">Section 4.1</a> or <a href="#cert-reqst-msg" class="xref">4.2</a>
 above, the CA <span class="bcp14">MUST</span> ensure that name change is
 authorized. The mechanism for ensuring that the name change is
 authorized is out of scope.  A CA that performs this check and finds
 that the name change is not authorized <span class="bcp14">MUST</span> reject the
 PKI Request. The CA <span class="bcp14">SHOULD</span> return an Extended CMC
 Status Info control (CMCStatusInfoV2) with a CMCStatus of failed.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Other processing of PKIRequests is performed as described in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ca-gend-resp">
<section id="section-6.2">
        <h3 id="name-ca-generated-pki-responses">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-ca-generated-pki-responses" class="section-name selfRef">CA-Generated PKI Responses</a>
        </h3>
<p id="section-6.2-1">CAs send PKI Responses to both client-generated requests and RA-generated requests. If a Full PKI Response is returned in direct response to a client-generated request, it <span class="bcp14">MUST</span> be encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">If the PKI Response is in response to an RA-generated PKI Request, then the above PKI Response is encapsulated in another CA-generated PKI Response.  That PKI Response <span class="bcp14">MUST</span> be encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>.  The above PKI Response is placed in the encapsulating PKI Response cmsSequence field.  The other fields are as above with the addition of the batch response control in controlSequence.  The following illustrates a successful CA response to an RA-encapsulated PKI Request, both of which include Transaction IDs and Nonces:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<div id="section-6.2-3">
<pre class="sourcecode">
      SignedData (applied by the CA)
        PKIResponse
          controlSequence (Transaction ID, Sender Nonce, Recipient
                           Nonce, Batch Response)
          cmsSequence
            SignedData (applied by CA and includes returned
                        certificates)
              PKIResponse
                controlSequence (Transaction ID, Sender Nonce,
                                 Recipient Nonce)
</pre><a href="#section-6.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2-4">The same private key used to sign certificates <span class="bcp14">MUST NOT</span> be used to sign Full PKI Response messages.  Instead, a separate certificate indicating authorization to sign CMC responses <span class="bcp14">MUST</span> be used.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">Authorization to sign Full PKI Responses <span class="bcp14">SHOULD</span> be indicated in the CA certificate by inclusion of the id-kp-cmcCA EKU from <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>. The CA certificate <span class="bcp14">MAY</span> also include the CCC certificate extension <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span>, or it <span class="bcp14">MAY</span> indicate authorization through inclusion of the CCC certificate extension alone. The CA certificate may also be authorized through local configuration.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">In order for a CA certificate using the CCC certificate extension to be authorized to generate responses, the object identifier for the PKIResponse content type must be present in the CCC certificate extension. CCC <span class="bcp14">SHOULD</span> be included if constraints are to be placed on the content types generated.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">Signatures applied to individual certificates are as required in <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<p id="section-6.2-8">The signature on the SignedData of a successful response to a
 client-generated request, or each individual inner SignedData on the
 successful response to an RA-generated request, <span class="bcp14">MUST</span> be
 generated using SHA-384 and either ECDSA on P-384 or RSA using
 RSASSA-PKCS1-v1_5 or RSASSA-PSS with an RSA-3072 or RSA-4096 key. An
 unsuccessful response <span class="bcp14">MUST</span> be signed using the same key
 type and algorithm that signed the request.<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<p id="section-6.2-9">The outer SignedData on the Full PKI Response to any RA-generated
 PKI Request <span class="bcp14">MUST</span> be signed with the same key type and algorithm that signed the request.<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<p id="section-6.2-10">The SignedData on a successful Full PKI Response to a PKI Request
 that only contained a Get Certificate or Get CRL control
 <span class="bcp14">MUST</span> be signed with the same key type and algorithm that signed the request.<a href="#section-6.2-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-reqts-proc">
<section id="section-7">
      <h2 id="name-client-requirements-process">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-client-requirements-process" class="section-name selfRef">Client Requirements: Processing PKI Responses</a>
      </h2>
<p id="section-7-1">Clients conforming to this document <span class="bcp14">MUST</span> ensure that only the permitted signature, hash, and MAC algorithms described throughout this profile are used in responses; if they are not, the client <span class="bcp14">MUST</span> reject those responses.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Clients <span class="bcp14">MUST</span> authenticate all Full PKI Responses.  This includes verifying that the PKI Response is signed by an authorized CA or RA whose certificate validates back to a trust anchor.  The authorized CA certificate <span class="bcp14">MUST</span> include the id-kp-cmcCA EKU and/or a CCC extension that includes the object identifier for the PKIResponse content type.  Otherwise, the CA is determined to be authorized to sign responses through an implementation-specific mechanism.  The PKI Response can be signed by an RA if it is an error message, if it is a response to a Get Certificate or Get CRL request, or if the PKI Response contains an inner PKI Response signed by a CA.  In the last case, each layer of PKI Response <span class="bcp14">MUST</span> still contain an authorized, valid signature signed by an entity with a valid certificate that verifies back to an acceptable trust anchor.  The authorized RA certificate <span class="bcp14">MUST</span> include the id-kp-cmcRA EKU and/or include a CCC extension that includes the object identifier for the PKIResponse content type.  Otherwise, the RA is determined to be authorized to sign responses through local configuration.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">When a newly issued certificate is included in the PKI Response, the client <span class="bcp14">MUST</span> verify that the newly issued certificate's public key matches the public key that the client requested.  The client <span class="bcp14">MUST</span> also ensure that the certificate's signature is valid and that the signature validates back to an acceptable trust anchor.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">Clients <span class="bcp14">MUST</span> reject PKI Responses that do not pass
      these tests. Local policy will determine whether the client returns a
      Full PKI Response with an Extended CMC Status Info control
      (CMCStatusInfoV2) with the CMCStatus set to failed to a user console, error log, or the server.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">If the Full PKI Response contains an Extended CMC Status Info control with a CMCStatus set to failed, then local policy will determine whether the client resends a duplicate certification request back to the server or an error state is returned to a console or error log.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="shared-secrets">
<section id="section-8">
      <h2 id="name-shared-secrets">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-shared-secrets" class="section-name selfRef">Shared-Secrets</a>
      </h2>
<p id="section-8-1">When the Identity Proof V2 and POP Link Witness V2 controls are used, the shared-secret <span class="bcp14">MUST</span> be randomly generated and securely distributed.  The shared-secret <span class="bcp14">MUST</span> provide at least 192 bits of strength.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">Protocol security considerations are found in <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span>, <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span>, <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>, <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="xref">RFC5273</a>]</span>, <span>[<a href="#RFC5274" class="xref">RFC5274</a>]</span>, <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>, and <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>. When CCC is used to authorize RA and CA certificates, then the security considerations in <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span> also apply.  Algorithm security considerations are found in <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Compliant with NIST Special Publication 800-57 <span>[<a href="#SP80057" class="xref">SP80057</a>]</span>, this profile defines proof-of-possession of a key establishment private key by performing a digital signature.  Except for one-time proof-of-possession, a single key pair <span class="bcp14">MUST NOT</span> be used for both signature and key establishment.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">This specification requires implementations to generate key pairs and other random values.  The use of inadequate pseudorandom number generators (PRNGs) can result in little or no security.  The generation of quality random numbers is difficult.  NIST Special Publication 800-90A <span>[<a href="#SP80090A" class="xref">SP80090A</a>]</span>, FIPS 186-3 <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span>, and <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span> offer random number generation guidance.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">When RAs are used, the list of authorized RAs <span class="bcp14">MUST</span> be
      securely distributed out of band to CAs.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">Presence of the POP Link Witness Version 2 and POP Link Random attributes protects against substitution attacks.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">The certificate policy for a particular environment will specify whether expired certificates can be used to sign certification requests.<a href="#section-9-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has no IANA actions.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CNSA">[CNSA]</dt>
<dd>
<span class="refAuthor">Committee on National Security Systems</span>, <span class="refTitle">"Use of Public Standards for Secure Information Sharing"</span>, <span class="seriesInfo">CNSS Policy 15</span>, <time datetime="2016-10">October 2016</time>, <span>&lt;<a href="https://www.cnss.gov/CNSS/issuances/Policies.cfm">https://www.cnss.gov/CNSS/issuances/Policies.cfm</a>&gt;</span>. </dd>
<dt id="FIPS186">[FIPS186]</dt>
<dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.186-4</span>, <span class="seriesInfo">FIPS PUB 186-4</span>, <time datetime="2013-07">July 2013</time>, <span>&lt;<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC2986">[RFC2986]</dt>
<dd>
<span class="refAuthor">Nystrom, M.</span><span class="refAuthor"> and B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dt id="RFC4055">[RFC4055]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, and R. Housley</span>, <span class="refTitle">"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 4055</span>, <span class="seriesInfo">DOI 10.17487/RFC4055</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4055">https://www.rfc-editor.org/info/rfc4055</a>&gt;</span>. </dd>
<dt id="RFC4056">[RFC4056]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Use of the RSASSA-PSS Signature Algorithm in Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 4056</span>, <span class="seriesInfo">DOI 10.17487/RFC4056</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4056">https://www.rfc-editor.org/info/rfc4056</a>&gt;</span>. </dd>
<dt id="RFC4086">[RFC4086]</dt>
<dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor">, Schiller, J.</span><span class="refAuthor">, and S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dt id="RFC4211">[RFC4211]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4211">https://www.rfc-editor.org/info/rfc4211</a>&gt;</span>. </dd>
<dt id="RFC4231">[RFC4231]</dt>
<dd>
<span class="refAuthor">Nystrom, M.</span>, <span class="refTitle">"Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512"</span>, <span class="seriesInfo">RFC 4231</span>, <span class="seriesInfo">DOI 10.17487/RFC4231</span>, <time datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4231">https://www.rfc-editor.org/info/rfc4231</a>&gt;</span>. </dd>
<dt id="RFC5272">[RFC5272]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;</span>. </dd>
<dt id="RFC5273">[RFC5273]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC): Transport Protocols"</span>, <span class="seriesInfo">RFC 5273</span>, <span class="seriesInfo">DOI 10.17487/RFC5273</span>, <time datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5273">https://www.rfc-editor.org/info/rfc5273</a>&gt;</span>. </dd>
<dt id="RFC5274">[RFC5274]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and M. Myers</span>, <span class="refTitle">"Certificate Management Messages over CMS (CMC): Compliance Requirements"</span>, <span class="seriesInfo">RFC 5274</span>, <span class="seriesInfo">DOI 10.17487/RFC5274</span>, <time datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5274">https://www.rfc-editor.org/info/rfc5274</a>&gt;</span>. </dd>
<dt id="RFC5754">[RFC5754]</dt>
<dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Using SHA2 Algorithms with Cryptographic Message Syntax"</span>, <span class="seriesInfo">RFC 5754</span>, <span class="seriesInfo">DOI 10.17487/RFC5754</span>, <time datetime="2010-01">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5754">https://www.rfc-editor.org/info/rfc5754</a>&gt;</span>. </dd>
<dt id="RFC6010">[RFC6010]</dt>
<dd>
<span class="refAuthor">Housley, R.</span><span class="refAuthor">, Ashmore, S.</span><span class="refAuthor">, and C. Wallace</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS) Content Constraints Extension"</span>, <span class="seriesInfo">RFC 6010</span>, <span class="seriesInfo">DOI 10.17487/RFC6010</span>, <time datetime="2010-09">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6010">https://www.rfc-editor.org/info/rfc6010</a>&gt;</span>. </dd>
<dt id="RFC6402">[RFC6402]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6402">https://www.rfc-editor.org/info/rfc6402</a>&gt;</span>. </dd>
<dt id="RFC8017">[RFC8017]</dt>
<dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, Jonsson, J.</span><span class="refAuthor">, and A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8603">[RFC8603]</dt>
<dd>
<span class="refAuthor">Jenkins, M.</span><span class="refAuthor"> and L. Zieglar</span>, <span class="refTitle">"Commercial National Security Algorithm (CNSA) Suite Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 8603</span>, <span class="seriesInfo">DOI 10.17487/RFC8603</span>, <time datetime="2019-05">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8603">https://www.rfc-editor.org/info/rfc8603</a>&gt;</span>. </dd>
<dt id="RFC8755">[RFC8755]</dt>
<dd>
<span class="refAuthor">Jenkins, M.</span>, <span class="refTitle">"Using Commercial National Security Algorithm Suite Algorithms in Secure/Multipurpose Internet Mail Extensions"</span>, <span class="seriesInfo">RFC 8755</span>, <span class="seriesInfo">DOI 10.17487/RFC8755</span>, <time datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8755">https://www.rfc-editor.org/info/rfc8755</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="SP80057">[SP80057]</dt>
<dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Key Management, Part 1: General"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-57pt1r4</span>, <span class="seriesInfo">Special Publication 800-57, Part 1,          Revision 4</span>, <time datetime="2016-01">January 2016</time>, <span>&lt;<a href="http://doi.org/10.6028/NIST.SP.800-57pt1r4">http://doi.org/10.6028/NIST.SP.800-57pt1r4</a>&gt;</span>. </dd>
<dt id="SP80059">[SP80059]</dt>
<dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Guideline for Identifying an Information System as a National Security System"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-59</span>, <span class="seriesInfo">Special Publication 800-59</span>, <time datetime="2003-08">August 2003</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-59/final">https://csrc.nist.gov/publications/detail/sp/800-59/final</a>&gt;</span>. </dd>
<dt id="SP80090A">[SP80090A]</dt>
<dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-90Ar1</span>, <span class="seriesInfo">Special Publication 800-90A Revision           1</span>, <time datetime="2015-06">June 2015</time>, <span>&lt;<a href="http://doi.org/10.6028/NIST.SP.800-90Ar1">http://doi.org/10.6028/NIST.SP.800-90Ar1</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="scenarios">
<section id="section-appendix.a">
      <h2 id="name-scenarios">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-scenarios" class="section-name selfRef">Scenarios</a>
      </h2>
<p id="section-appendix.a-1">This section illustrates several potential certificate enrollment and rekey scenarios supported by this profile.  This section does not intend to place any limits or restrictions on the use of CMC.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<div id="init_enroll">
<section id="section-a.1">
        <h2 id="name-initial-enrollment">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-initial-enrollment" class="section-name selfRef">Initial Enrollment</a>
        </h2>
<p id="section-a.1-1">This section describes three scenarios for authenticating initial enrollment requests:<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-a.1-2">
          <li id="section-a.1-2.1">Previously certified signature key-pair (e.g., Manufacturer Installed Certificate).<a href="#section-a.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-a.1-2.2">Shared-secret distributed securely out of band.<a href="#section-a.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-a.1-2.3">RA authentication.<a href="#section-a.1-2.3" class="pilcrow">¶</a>
</li>
</ol>
<div id="prev_inst">
<section id="section-a.1.1">
          <h3 id="name-previously-certified-signat">
<a href="#section-a.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-previously-certified-signat" class="section-name selfRef">Previously Certified Signature Key-Pair</a>
          </h3>
<p id="section-a.1.1-1">In this scenario, the end-entity has a private signing key and a corresponding public key certificate obtained from a cryptographic module manufacturer recognized by the CA. The end-entity signs a Full PKI Request with the private key that corresponds to the subject public key of the previously installed signature certificate. The CA will verify the authorization of the previously installed certificate and issue an appropriate new certificate to the end-entity.<a href="#section-a.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ss_oob">
<section id="section-a.1.2">
          <h3 id="name-shared-secret-distributed-s">
<a href="#section-a.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-shared-secret-distributed-s" class="section-name selfRef">Shared-Secret Distributed Securely Out of Band</a>
          </h3>
<p id="section-a.1.2-1">In this scenario, the CA distributes a shared-secret out of band
   to the end-entity that the end-entity uses to authenticate its
   certification request.  The end-entity signs the Full PKI Request
   with the private key for which the certification is being
   requested. The end-entity includes the Identity Proof Version 2
   control to authenticate the request using the shared-secret.  The CA
   uses either the Identification control or the subject name in the
   end-entity's enclosed PKCS #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span>
   certification request message to identify the request.  The
   end-entity performs either the POP Link Witness Version 2 mechanism
   as described in <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-6.3.1.1" class="relref">Section 6.3.1.1</a></span> or the shared-secret/subject distinguished
   name linking mechanism as described in <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-6.3.2" class="relref">Section 6.3.2</a></span>.  The subject name in the
   enclosed PKCS #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span> certification
   request does not necessarily match the issued certificate, as it may
   be used just to help identify the request (and the corresponding shared-secret) to the CA.<a href="#section-a.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ra_auth">
<section id="section-a.1.3">
          <h3 id="name-ra-authentication">
<a href="#section-a.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-ra-authentication" class="section-name selfRef">RA Authentication</a>
          </h3>
<p id="section-a.1.3-1">In this scenario, the end-entity does not automatically
   authenticate its enrollment request to the CA, either because the
   end-entity has nothing to authenticate the request with or because
   the organizational policy requires an RA's involvement.  The end-entity
   creates a Full PKI Request and sends it to an RA.  The RA verifies
   the authenticity of the request. If the request is approved, the RA encapsulates and
   signs the request as described in <a href="#cert-reqst-msg" class="xref">Section 4.2</a>,
   forwarding the new request on to the CA. The subject name in the PKCS
   #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span> certification request is not required to match the issued certificate; it may be used just to help identify the request to the RA and/or CA.<a href="#section-a.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rekey">
<section id="section-a.2">
        <h2 id="name-rekey">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-rekey" class="section-name selfRef">Rekey</a>
        </h2>
<p id="section-a.2-1">There are two scenarios to support the rekey of certificates that
 are already enrolled.  One addresses the rekey of signature
 certificates, and the other addresses the rekey of key establishment
 certificates. Typically, organizational policy will require certificates to be currently valid to be rekeyed, and it may require initial enrollment to be repeated when rekey is not possible.  However, some organizational policies might allow a grace period during which an expired certificate could be used to rekey.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<div id="rk_sig">
<section id="section-a.2.1">
          <h3 id="name-rekey-of-signature-certific">
<a href="#section-a.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-rekey-of-signature-certific" class="section-name selfRef">Rekey of Signature Certificates</a>
          </h3>
<p id="section-a.2.1-1">When a signature certificate is rekeyed, the <span><a href="#RFC2986" class="xref">PKCS #10</a> [<a href="#RFC2986" class="xref">RFC2986</a>]</span> or <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> certification request message enclosed in the Full PKI Request will include the same subject name as the current signature certificate.  The Full PKI Request will be signed by the current private key corresponding to the current signature certificate.<a href="#section-a.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rk_kes">
<section id="section-a.2.2">
          <h3 id="name-rekey-of-key-establishment-">
<a href="#section-a.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-rekey-of-key-establishment-" class="section-name selfRef">Rekey of Key Establishment Certificates</a>
          </h3>
<p id="section-a.2.2-1">When a key establishment certificate is rekeyed, the Full PKI Request will generally be signed by the current private key corresponding to the current signature certificate.  If there is no current signature certificate, one of the initial enrollment options in <a href="#init_enroll" class="xref">Appendix A.1</a> may be used.<a href="#section-a.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Jenkins</span></div>
<div dir="auto" class="left"><span class="org">National Security Agency</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mjjenki@nsa.gov" class="email">mjjenki@nsa.gov</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Lydia Zieglar</span></div>
<div dir="auto" class="left"><span class="org">National Security Agency</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:llziegl@tycho.ncsc.mil" class="email">llziegl@tycho.ncsc.mil</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
