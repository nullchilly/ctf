<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="info" consensus="true" docName="draft-ietf-perc-dtls-tunnel-12" indexInclude="true" ipr="trust200902" number="9185" prepTime="2022-04-25T17:20:28" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-perc-dtls-tunnel-12" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9185" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="DTLS Tunnel for PERC">DTLS Tunnel between a Media Distributor and Key Distributor to Facilitate Key Exchange</title>
    <seriesInfo name="RFC" value="9185" stream="IETF"/>
    <author initials="P." surname="Jones" fullname="Paul E. Jones">
      <organization abbrev="Cisco Systems" showOnFrontPage="true">Cisco Systems, Inc.</organization>
      <address>
        <postal>
          <street>7025 Kit Creek Rd.</street>
          <city>Research Triangle Park</city>
          <code>27709</code>
          <country>United States of America</country>
          <region>North Carolina</region>
        </postal>
        <phone>+1 919 476 2048</phone>
        <email>paulej@packetizer.com</email>
      </address>
    </author>
    <author initials="P." surname="Ellenbogen" fullname="Paul M. Ellenbogen">
      <organization showOnFrontPage="true">Princeton University</organization>
      <address>
        <postal>
          <street/>
        </postal>
        <phone>+1 206 851 2069</phone>
        <email>pe5@cs.princeton.edu</email>
      </address>
    </author>
    <author initials="N." surname="Ohlmeier" fullname="Nils H. Ohlmeier">
      <organization showOnFrontPage="true">8x8, Inc.</organization>
      <address>
        <postal>
          <street/>
        </postal>
        <phone>+1 408 659 6457</phone>
        <email>nils@ohlmeier.org</email>
      </address>
    </author>
    <date month="04" year="2022"/>
    <area>Applications and Real-Time Area</area>
    <workgroup>Privacy Enhanced RTP Conferencing</workgroup>
    <keyword>PERC</keyword>
    <keyword>SRTP</keyword>
    <keyword>RTP</keyword>
    <keyword>DTLS</keyword>
    <keyword>DTLS-SRTP</keyword>
    <keyword>DTLS tunnel</keyword>
    <keyword>conferencing</keyword>
    <keyword>security</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">This document defines a protocol for tunneling DTLS traffic in multimedia
conferences that enables a Media Distributor to facilitate key
exchange between an endpoint in a conference and the Key Distributor.
The protocol is designed to ensure that the keying material used for
hop-by-hop encryption and authentication is accessible to the Media
Distributor, while the keying material used for end-to-end encryption
and authentication is inaccessible to the Media Distributor.</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.  
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841. 
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9185" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-conventions-used-in-this-do">Conventions Used in This Document</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tunneling-concept">Tunneling Concept</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-message-flows">Example Message Flows</xref></t>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tunneling-procedures">Tunneling Procedures</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-endpoint-procedures">Endpoint Procedures</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tunnel-establishment-proced">Tunnel Establishment Procedures</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t indent="0" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-media-distributor-tunneling">Media Distributor Tunneling Procedures</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.4">
                <t indent="0" pn="section-toc.1-1.5.2.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-distributor-tunneling-p">Key Distributor Tunneling Procedures</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.5">
                <t indent="0" pn="section-toc.1-1.5.2.5.1"><xref derivedContent="5.5" format="counter" sectionFormat="of" target="section-5.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-versioning-considerations">Versioning Considerations</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tunneling-protocol">Tunneling Protocol</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tunnelmessage-structure">TunnelMessage Structure</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t indent="0" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-supportedprofiles-message">SupportedProfiles Message</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.3">
                <t indent="0" pn="section-toc.1-1.6.2.3.1"><xref derivedContent="6.3" format="counter" sectionFormat="of" target="section-6.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-unsupportedversion-message">UnsupportedVersion Message</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.4">
                <t indent="0" pn="section-toc.1-1.6.2.4.1"><xref derivedContent="6.4" format="counter" sectionFormat="of" target="section-6.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-mediakeys-message">MediaKeys Message</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.5">
                <t indent="0" pn="section-toc.1-1.6.2.5.1"><xref derivedContent="6.5" format="counter" sectionFormat="of" target="section-6.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tunneleddtls-message">TunneledDtls Message</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.6">
                <t indent="0" pn="section-toc.1-1.6.2.6.1"><xref derivedContent="6.6" format="counter" sectionFormat="of" target="section-6.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-endpointdisconnect-message">EndpointDisconnect Message</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-binary-encoding">Example Binary Encoding</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.10.2">
              <li pn="section-toc.1-1.10.2.1">
                <t indent="0" pn="section-toc.1-1.10.2.1.1"><xref derivedContent="10.1" format="counter" sectionFormat="of" target="section-10.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.10.2.2">
                <t indent="0" pn="section-toc.1-1.10.2.2.1"><xref derivedContent="10.2" format="counter" sectionFormat="of" target="section-10.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" removeInRFC="false" toc="include" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">An objective of Privacy-Enhanced RTP Conferencing (PERC) <xref target="RFC8871" format="default" sectionFormat="of" derivedContent="RFC8871"/> is to
ensure that endpoints in a multimedia conference have access to the
end-to-end (E2E) and hop-by-hop (HBH) keying material used to encrypt
and authenticate Real-time Transport Protocol (RTP) 
packets <xref target="RFC3550" format="default" sectionFormat="of" derivedContent="RFC3550"/>, while the Media Distributor has access only to the HBH
keying material for encryption and authentication.</t>
      <t indent="0" pn="section-1-2">This specification defines a tunneling protocol that enables the Media
Distributor to tunnel DTLS messages <xref target="RFC9147" format="default" sectionFormat="of" derivedContent="RFC9147"/> between an endpoint
and a Key Distributor, thus allowing an endpoint to use DTLS for the Secure Real-time Transport Protocol (DTLS-SRTP)
<xref target="RFC5764" format="default" sectionFormat="of" derivedContent="RFC5764"/> for establishing encryption and authentication keys with
the Key Distributor.</t>
      <t indent="0" pn="section-1-3">The tunnel established between the Media Distributor and Key
Distributor is a TLS connection <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> that is established before any
messages are forwarded by the Media Distributor on behalf of
endpoints.  DTLS packets received from an endpoint are encapsulated by
the Media Distributor inside this tunnel as data to be sent to the Key
Distributor.  Likewise, when the Media Distributor receives data from
the Key Distributor over the tunnel, it extracts the DTLS message
inside and forwards the DTLS message to the endpoint.  In this way,
the DTLS association for the DTLS-SRTP procedures is established
between an endpoint and the Key Distributor, with the Media
Distributor forwarding DTLS messages between the two entities via the
established tunnel to the Key Distributor and having no visibility into
the confidential information exchanged.</t>
      <t indent="0" pn="section-1-4">Following the existing DTLS-SRTP procedures, the endpoint and Key
Distributor will arrive at a selected cipher and keying material,
which are used for HBH encryption and authentication by both the
endpoint and the Media Distributor.  However, since the Media
Distributor would not have direct access to this information, the Key
Distributor explicitly shares the HBH key information with the Media
Distributor via the tunneling protocol defined in this document.
Additionally, the endpoint and Key Distributor will agree on a cipher
for E2E encryption and authentication.  The Key Distributor will
transmit keying material to the endpoint for E2E operations but will
not share that information with the Media Distributor.</t>
      <t indent="0" pn="section-1-5">By establishing this TLS tunnel between the Media Distributor and Key
Distributor and implementing the protocol defined in this document, it
is possible for the Media Distributor to facilitate the establishment
of a secure DTLS association between an endpoint and the Key
Distributor in order for the endpoint to generate E2E and HBH keying
material.  At the same time, the Key Distributor can securely provide
the HBH keying material to the Media Distributor.</t>
    </section>
    <section anchor="conventions-used-in-this-document" numbered="true" removeInRFC="false" toc="include" pn="section-2">
      <name slugifiedName="name-conventions-used-in-this-do">Conventions Used in This Document</name>
      <t indent="0" pn="section-2-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
      </t>
      <t indent="0" pn="section-2-2">This document uses the terms "endpoint", "Media Distributor", and
"Key Distributor" defined in <xref target="RFC8871" format="default" sectionFormat="of" derivedContent="RFC8871"/>.</t>
    </section>
    <section anchor="tunneling-concept" numbered="true" removeInRFC="false" toc="include" pn="section-3">
      <name slugifiedName="name-tunneling-concept">Tunneling Concept</name>
      <t indent="0" pn="section-3-1">A TLS connection (tunnel) is established between the Media Distributor
  and the Key Distributor.  This tunnel is used to relay DTLS messages
  between the endpoint and Key Distributor, as depicted in
  <xref target="fig-tunnel" format="default" sectionFormat="of" derivedContent="Figure 1"/>:</t>
      <figure anchor="fig-tunnel" align="center" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-tls-tunnel-to-key-distribut">TLS Tunnel to Key Distributor</name>
        <artwork name="" type="ascii-art" align="center" alt="" pn="section-3-2.1">
                         +-------------+
                         |     Key     |
                         | Distributor |
                         +-------------+
                             # ^ ^ #
                             # | | # &lt;-- TLS Tunnel
                             # | | #
+----------+             +-------------+             +----------+
|          |     DTLS    |             |    DTLS     |          |
| Endpoint |&lt;------------|    Media    |------------&gt;| Endpoint |
|          |    to Key   | Distributor |   to Key    |          |
|          | Distributor |             | Distributor |          |
+----------+             +-------------+             +----------+
</artwork>
      </figure>
      <t indent="0" pn="section-3-3">The three entities involved in this communication flow are the
endpoint, the Media Distributor, and the Key Distributor.  The
behavior of each entity is described in <xref target="tunneling-procedures" format="default" sectionFormat="of" derivedContent="Section 5"/>.</t>
      <t indent="0" pn="section-3-4"> The Key Distributor is a logical function that might be co-resident
 with a key management server operated by an enterprise, might
 reside in one of the endpoints participating in the conference, or
 might reside at some other location that is trusted with E2E keying
 material.
</t>
    </section>
    <section anchor="example-message-flows" numbered="true" removeInRFC="false" toc="include" pn="section-4">
      <name slugifiedName="name-example-message-flows">Example Message Flows</name>
      <t indent="0" pn="section-4-1">This section provides an example message flow to help clarify the
procedures described later in this document.  It is necessary that the
Key Distributor and Media Distributor establish a mutually
authenticated TLS connection for the purpose of sending tunneled
messages, though the complete TLS handshake for the tunnel is not
shown in <xref target="fig-message-flow" format="default" sectionFormat="of" derivedContent="Figure 2"/> because there is nothing new this document
introduces with regard to those procedures.</t>
      <t indent="0" pn="section-4-2">Once the tunnel is established, it is possible for the Media
Distributor to relay the DTLS messages between the endpoint and the
Key Distributor.  <xref target="fig-message-flow" format="default" sectionFormat="of" derivedContent="Figure 2"/> shows a message flow wherein the
endpoint uses DTLS-SRTP to establish an association with the Key
Distributor.  In the process, the Media Distributor shares its
supported SRTP protection profile information (see <xref target="RFC5764" format="default" sectionFormat="of" derivedContent="RFC5764"/>), and
the Key Distributor shares the HBH keying material and selected cipher
with the Media Distributor.</t>
      <figure anchor="fig-message-flow" align="center" suppress-title="false" pn="figure-2">
        <name slugifiedName="name-sample-dtls-srtp-exchange-v">Sample DTLS-SRTP Exchange via the Tunnel</name>
        <artwork name="" type="ascii-art" align="center" alt="" pn="section-4-3.1">
Endpoint              Media Distributor          Key Distributor
    |                         |                         |
    |                         |&lt;=======================&gt;|
    |                         |    TLS Connection Made  |
    |                         |                         |
    |                         |========================&gt;|
    |                         | SupportedProfiles       |
    |                         |                         |
    |------------------------&gt;|========================&gt;|
    | DTLS handshake message  | TunneledDtls            |
    |                         |                         |
         .... may be multiple handshake messages ...
    |                         |                         |
    |&lt;------------------------|&lt;========================|
    | DTLS handshake message  |            TunneledDtls |
    |                         |                         |
    |                         |                         |
    |                         |&lt;========================|
    |                         |               MediaKeys |
</artwork>
      </figure>
      <t indent="0" pn="section-4-4">After the initial TLS connection has been established, each of the
messages on the right-hand side of <xref target="fig-message-flow" format="default" sectionFormat="of" derivedContent="Figure 2"/> is a tunneling
protocol message, as defined in <xref target="tunneling-protocol" format="default" sectionFormat="of" derivedContent="Section 6"/>.</t>
      <t indent="0" pn="section-4-5">SRTP protection profiles supported by the Media Distributor will be
sent in a <tt>SupportedProfiles</tt> message when the TLS tunnel is initially
established.  The Key Distributor will use that information to select
a common profile supported by both the endpoint and the Media
Distributor to ensure that HBH operations can be successfully
performed.</t>
      <t indent="0" pn="section-4-6">As DTLS messages are received from the endpoint by the Media
Distributor, they are forwarded to the Key Distributor encapsulated
inside a <tt>TunneledDtls</tt> message.  Likewise, as <tt>TunneledDtls</tt>
messages are received by the Media Distributor from the Key
Distributor, the encapsulated DTLS packet is forwarded to the
endpoint.</t>
      <t indent="0" pn="section-4-7">The Key Distributor will provide the SRTP keying material
<xref target="RFC3711" format="default" sectionFormat="of" derivedContent="RFC3711"/> to the Media Distributor for HBH operations via the <tt>MediaKeys</tt>
message.  The Media Distributor will extract this keying material from
the <tt>MediaKeys</tt> message when received and use it for HBH
encryption and authentication.</t>
    </section>
    <section anchor="tunneling-procedures" numbered="true" removeInRFC="false" toc="include" pn="section-5">
      <name slugifiedName="name-tunneling-procedures">Tunneling Procedures</name>
      <t indent="0" pn="section-5-1">The following subsections explain in detail the expected behavior of
the endpoint, the Media Distributor, and the Key Distributor.</t>
      <t indent="0" pn="section-5-2">It is important to note that the tunneling protocol described in this
document is not an extension to TLS or DTLS.  Rather, it is a protocol that
transports DTLS messages generated by an endpoint or Key Distributor as data
inside of the TLS connection established between the Media Distributor and
Key Distributor.</t>
      <section anchor="endpoint-procedures" numbered="true" removeInRFC="false" toc="include" pn="section-5.1">
        <name slugifiedName="name-endpoint-procedures">Endpoint Procedures</name>
        <t indent="0" pn="section-5.1-1">The endpoint follows the procedures outlined for DTLS-SRTP <xref target="RFC5764" format="default" sectionFormat="of" derivedContent="RFC5764"/>
in order to establish the cipher and keys used for encryption and
authentication, with the endpoint acting as the client and the Key
Distributor acting as the server.  The endpoint does not need to be
aware of the fact that DTLS messages it transmits toward the Media
Distributor are being tunneled to the Key Distributor.</t>
        <t indent="0" pn="section-5.1-2">The endpoint <bcp14>MUST</bcp14> include a unique identifier in the <tt>tls-id</tt>
Session Description Protocol (SDP) attribute <xref target="RFC8866" format="default" sectionFormat="of" derivedContent="RFC8866"/> in all offer and answer messages <xref target="RFC3264" format="default" sectionFormat="of" derivedContent="RFC3264"/>
that it generates, as per <xref target="RFC8842" format="default" sectionFormat="of" derivedContent="RFC8842"/>. Further, the
endpoint <bcp14>MUST</bcp14> include this same unique identifier in the
<tt>external_session_id</tt> extension <xref target="RFC8844" format="default" sectionFormat="of" derivedContent="RFC8844"/> in the
<tt>ClientHello</tt> message when establishing a DTLS association.</t>
        <t indent="0" pn="section-5.1-3">When receiving an <tt>external_session_id</tt> value from the Key Distributor, the
client <bcp14>MUST</bcp14> check to ensure that value matches the <tt>tls-id</tt> value
received in SDP.  If the values do not match, the endpoint <bcp14>MUST</bcp14>
consider any received keying material to be invalid and terminate the
DTLS association.</t>
      </section>
      <section anchor="tunnel-establishment-procedures" numbered="true" removeInRFC="false" toc="include" pn="section-5.2">
        <name slugifiedName="name-tunnel-establishment-proced">Tunnel Establishment Procedures</name>
        <t indent="0" pn="section-5.2-1">Either the Media Distributor or Key Distributor initiates the
establishment of a TLS tunnel.  Which entity acts as the TLS client
when establishing the tunnel and what event triggers the establishment
of the tunnel are outside the scope of this document.  Further, how
the trust relationships are established between the Key Distributor
and Media Distributor are also outside the scope of this document.</t>
        <t indent="0" pn="section-5.2-2">A tunnel <bcp14>MUST</bcp14> be a mutually authenticated TLS connection.</t>
        <t indent="0" pn="section-5.2-3">The Media Distributor or Key Distributor <bcp14>MUST</bcp14> establish a tunnel
prior to forwarding tunneled DTLS messages.  Given the time-sensitive
nature of DTLS-SRTP procedures, a tunnel <bcp14>SHOULD</bcp14> be established
prior to the Media Distributor receiving a DTLS message from an
endpoint.</t>
        <t indent="0" pn="section-5.2-4">A single tunnel <bcp14>MAY</bcp14> be used to relay DTLS messages between any
number of endpoints and the Key Distributor.</t>
        <t indent="0" pn="section-5.2-5">A Media Distributor <bcp14>MAY</bcp14> have more than one tunnel established
between itself and one or more Key Distributors.  When multiple
tunnels are established, which tunnel or tunnels to use to send
messages for a given conference is outside the scope of this document.</t>
      </section>
      <section anchor="media-distributor-tunneling-procedures" numbered="true" removeInRFC="false" toc="include" pn="section-5.3">
        <name slugifiedName="name-media-distributor-tunneling">Media Distributor Tunneling Procedures</name>
        <t indent="0" pn="section-5.3-1">The first message transmitted over the tunnel is the
<tt>SupportedProfiles</tt> message (see <xref target="tunneling-protocol" format="default" sectionFormat="of" derivedContent="Section 6"/>).  This message informs
the Key Distributor about which DTLS-SRTP profiles the Media
Distributor supports.  This message <bcp14>MUST</bcp14> be sent each time a new
tunnel connection is established or, in the case of connection loss,
when a connection is re-established.  The Media Distributor <bcp14>MUST</bcp14>
support the same list of protection profiles for the duration of any
endpoint-initiated DTLS association and tunnel connection.</t>
        <t indent="0" pn="section-5.3-2">The Media Distributor <bcp14>MUST</bcp14> assign a unique association identifier
for each endpoint-initiated DTLS association and include it in all
messages forwarded to the Key Distributor.  The Key Distributor will
subsequently include this identifier in all messages it sends so that
the Media Distributor can map messages received via a tunnel and
forward those messages to the correct endpoint.  The association
identifier <bcp14>MUST</bcp14> be a version 4 Universally Unique Identifier (UUID), as described in 
<xref target="RFC4122" section="4.4" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4122#section-4.4" derivedContent="RFC4122"/>.</t>
        <t indent="0" pn="section-5.3-3">When a DTLS message is received by the Media Distributor from an
endpoint, it forwards the UDP payload portion of that message to the
Key Distributor encapsulated in a <tt>TunneledDtls</tt> message.
The Media Distributor is not required to forward all messages received
from an endpoint for a given DTLS association through the same tunnel
if more than one tunnel has been established between it and a Key
Distributor.</t>
        <t indent="0" pn="section-5.3-4">When a <tt>MediaKeys</tt> message is received, the Media Distributor <bcp14>MUST</bcp14>
extract the cipher and keying material conveyed in order to
subsequently perform HBH encryption and authentication operations for
RTP and RTP Control Protocol (RTCP) packets sent between it and an endpoint.  Since the HBH
keying material will be different for each endpoint, the Media
Distributor uses the association identifier included by the Key
Distributor to ensure that the HBH keying material is used with the
correct endpoint.</t>
        <t indent="0" pn="section-5.3-5">The Media Distributor <bcp14>MUST</bcp14> forward all DTLS messages received from
either the endpoint or the Key Distributor (via the <tt>TunneledDtls</tt>
message) to ensure proper communication between those two entities.</t>
        <t indent="0" pn="section-5.3-6">When the Media Distributor detects an endpoint has disconnected or
when it receives conference control messages indicating the endpoint
is to be disconnected, the Media Distributor <bcp14>MUST</bcp14> send an
<tt>EndpointDisconnect</tt> message with the association identifier assigned
to the endpoint to the Key Distributor.  The Media Distributor
<bcp14>SHOULD</bcp14> take a loss of all RTP and RTCP packets as an indicator
that the endpoint has disconnected.  The particulars of how RTP and
RTCP are to be used to detect an endpoint disconnect, such as timeout
period, are not specified.  The Media Distributor <bcp14>MAY</bcp14> use
additional indicators to determine when an endpoint has disconnected.</t>
      </section>
      <section anchor="key-distributor-tunneling-procedures" numbered="true" removeInRFC="false" toc="include" pn="section-5.4">
        <name slugifiedName="name-key-distributor-tunneling-p">Key Distributor Tunneling Procedures</name>
        <t indent="0" pn="section-5.4-1">Each TLS tunnel established between the Media Distributor and the
Key Distributor <bcp14>MUST</bcp14> be mutually authenticated.</t>
        <t indent="0" pn="section-5.4-2">When the Media Distributor relays a DTLS message from an endpoint, the
Media Distributor will include an association identifier that is
unique per endpoint-originated DTLS association.  The association
identifier remains constant for the life of the DTLS association.  The
Key Distributor identifies each distinct endpoint-originated DTLS
association by the association identifier.</t>
        <t indent="0" pn="section-5.4-3">When processing an incoming endpoint association, the Key Distributor
<bcp14>MUST</bcp14> extract the <tt>external_session_id</tt> value transmitted in the
<tt>ClientHello</tt> message and match that against the <tt>tls-id</tt> value the endpoint
transmitted via SDP.  If the values in SDP and the <tt>ClientHello</tt> message do not match,
the DTLS association <bcp14>MUST</bcp14> be rejected.</t>
        <t indent="0" pn="section-5.4-4">The process through which the <tt>tls-id</tt> value in SDP is conveyed to
the Key Distributor is outside the scope of this document.</t>
        <t indent="0" pn="section-5.4-5">The Key Distributor <bcp14>MUST</bcp14> match the fingerprint of the certificate and
<tt>external_session_id</tt> <xref target="RFC8844" format="default" sectionFormat="of" derivedContent="RFC8844"/> received from the endpoint via DTLS with the
expected fingerprint <xref target="RFC8122" format="default" sectionFormat="of" derivedContent="RFC8122"/> and <tt>tls-id</tt> <xref target="RFC8842" format="default" sectionFormat="of" derivedContent="RFC8842"/> values received via
SDP.  It is through this process that the Key Distributor can be sure to
deliver the correct conference key to the endpoint.</t>
        <t indent="0" pn="section-5.4-6">The Key Distributor <bcp14>MUST</bcp14> report its own unique identifier in the
<tt>external_session_id</tt> extension.  This extension is sent in the
<tt>EncryptedExtensions</tt> message in DTLS 1.3 and the <tt>ServerHello</tt> message in
previous DTLS versions.  This value <bcp14>MUST</bcp14> also be conveyed back to
the client via SDP as a <tt>tls-id</tt> attribute.</t>
        <t indent="0" pn="section-5.4-7">The Key Distributor <bcp14>MUST</bcp14> encapsulate any DTLS message it sends to
an endpoint inside a <tt>TunneledDtls</tt> message (see
<xref target="tunneling-protocol" format="default" sectionFormat="of" derivedContent="Section 6"/>).  The Key Distributor is not required to transmit
all messages for a given DTLS association through the same tunnel if more
than one tunnel has been established between it and the Media Distributor.</t>
        <t indent="0" pn="section-5.4-8">The Key Distributor <bcp14>MUST</bcp14> use the same association identifier in
messages sent to an endpoint as was received in messages from that
endpoint.  This ensures the Media Distributor can forward the messages
to the correct endpoint.</t>
        <t indent="0" pn="section-5.4-9">The Key Distributor extracts tunneled DTLS messages from an endpoint
and acts on those messages as if that endpoint had established the
DTLS association directly with the Key Distributor.  The Key
Distributor is acting as the DTLS server, and the endpoint is acting as
the DTLS client.  The handling of the messages and certificates is
exactly the same as normal DTLS-SRTP procedures between endpoints.</t>
        <t indent="0" pn="section-5.4-10">The Key Distributor <bcp14>MUST</bcp14> send a <tt>MediaKeys</tt> message to the Media
Distributor immediately after the DTLS handshake completes.  The <tt>MediaKeys</tt>
message includes the selected cipher (i.e., protection profile), Master Key Identifier (MKI)
value <xref target="RFC3711" format="default" sectionFormat="of" derivedContent="RFC3711"/> (if any), HBH SRTP master keys, and SRTP master salt
values.  The Key Distributor <bcp14>MUST</bcp14> use the same association
identifier in the <tt>MediaKeys</tt> message as is used in the <tt>TunneledDtls</tt>
messages for the given endpoint.</t>
        <t indent="0" pn="section-5.4-11">There are presently two SRTP protection profiles defined for PERC,
namely <tt>DOUBLE_AEAD_AES_128_GCM_AEAD_AES_128_GCM</tt> and
<tt>DOUBLE_AEAD_AES_256_GCM_AEAD_AES_256_GCM</tt> <xref target="RFC8723" format="default" sectionFormat="of" derivedContent="RFC8723"/>.  As explained in <xref target="RFC8723" section="5.2" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8723#section-5.2" derivedContent="RFC8723"/>, the Media Distributor is only given the SRTP
master key for HBH operations.  As such, the SRTP master key
length advertised in the <tt>MediaKeys</tt> message is half the length of the key
normally associated with the selected "double" protection profile.</t>
        <t indent="0" pn="section-5.4-12">The Key Distributor uses the certificate fingerprint of the endpoint
along with the unique identifier received in the <tt>external_session_id</tt>
extension to determine with which conference a given DTLS association is
associated.</t>
        <t indent="0" pn="section-5.4-13">The Key Distributor <bcp14>MUST</bcp14> select a cipher that is supported by itself, the endpoint, and the Media Distributor to ensure proper HBH
operations.</t>
        <t indent="0" pn="section-5.4-14">When the DTLS association between the endpoint and the Key Distributor
is terminated, regardless of which entity initiated the termination,
the Key Distributor <bcp14>MUST</bcp14> send an <tt>EndpointDisconnect</tt> message
with the association identifier assigned to the endpoint to the Media
Distributor.</t>
      </section>
      <section anchor="versioning-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-5.5">
        <name slugifiedName="name-versioning-considerations">Versioning Considerations</name>
        <t indent="0" pn="section-5.5-1">Since the Media Distributor sends the first message over the tunnel,
it effectively establishes the version of the protocol to be used.  If
that version is not supported by the Key Distributor, the Key
Distributor <bcp14>MUST</bcp14> transmit an <tt>UnsupportedVersion</tt> message containing
the highest version number supported and close the TLS connection.</t>
        <t indent="0" pn="section-5.5-2">The Media Distributor <bcp14>MUST</bcp14> take note of the version received in an
<tt>UnsupportedVersion</tt> message and use that version when attempting to
re-establish a failed tunnel connection.  Note that it is not
necessary for the Media Distributor to understand the newer version of
the protocol to understand that the first message received is an 
<tt>UnsupportedVersion</tt> message.  The Media Distributor can determine from the
first four octets received what the version number is and that the
message is an <tt>UnsupportedVersion</tt> message.  The rest of the data received, if
any, would be discarded and the connection closed (if not already
closed).</t>
      </section>
    </section>
    <section anchor="tunneling-protocol" numbered="true" removeInRFC="false" toc="include" pn="section-6">
      <name slugifiedName="name-tunneling-protocol">Tunneling Protocol</name>
      <t indent="0" pn="section-6-1">Tunneled messages are transported via the TLS tunnel as application
data between the Media Distributor and the Key Distributor.  Tunnel
messages are specified using the format described in <xref target="RFC8446" section="3" sectionFormat="comma" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8446#section-3" derivedContent="RFC8446"/>.  As in <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>, all values are stored in network byte
(big endian) order; the uint32 represented by the hex bytes 01 02 03
04 is equivalent to the decimal value 16909060.</t>
      <t indent="0" pn="section-6-2">This protocol defines several different messages, each of which
contains the following information:</t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-6-3">
        <li pn="section-6-3.1">message type identifier</li>
        <li pn="section-6-3.2">message body length</li>
        <li pn="section-6-3.3">the message body</li>
      </ul>
      <t indent="0" pn="section-6-4">Each of the tunnel messages is a <tt>TunnelMessage</tt> structure with the
message type indicating the actual content of the message body.</t>
      <section anchor="tunnelmessage-structure" numbered="true" removeInRFC="false" toc="include" pn="section-6.1">
        <name slugifiedName="name-tunnelmessage-structure">TunnelMessage Structure</name>
        <t indent="0" pn="section-6.1-1"><tt>TunnelMessage</tt> defines the structure of all messages sent via the tunnel
  protocol.  That structure includes a field called <tt>msg_type</tt> that identifies the
  specific type of message contained within <tt>TunnelMessage</tt>.</t>
        <sourcecode type="tls-presentation" markers="false" pn="section-6.1-2">
enum {
    supported_profiles(1),
    unsupported_version(2),
    media_keys(3),
    tunneled_dtls(4),
    endpoint_disconnect(5),
    (255)
} MsgType;

opaque uuid[16];

struct {
    MsgType msg_type;
    uint16 length;
    select (MsgType) {
        case supported_profiles:  SupportedProfiles;
        case unsupported_version: UnsupportedVersion;
        case media_keys:          MediaKeys;
        case tunneled_dtls:       TunneledDtls;
        case endpoint_disconnect: EndpointDisconnect;
  } body;
} TunnelMessage;
</sourcecode>
        <t indent="0" pn="section-6.1-3">The elements of <tt>TunnelMessage</tt> include:</t>
        <dl newline="false" spacing="normal" indent="3" pn="section-6.1-4">
          <dt pn="section-6.1-4.1"><tt>msg_type</tt>:</dt>
          <dd pn="section-6.1-4.2">the type of message contained within the structure <tt>body</tt>.</dd>
          <dt pn="section-6.1-4.3"><tt>length</tt>:</dt>
          <dd pn="section-6.1-4.4">the length in octets of the following <tt>body</tt> of the message.</dd>
          <dt pn="section-6.1-4.5"><tt>body</tt>:</dt>
          <dd pn="section-6.1-4.6">the actual message being conveyed within this <tt>TunnelMessage</tt> structure.</dd>
        </dl>
      </section>
      <section anchor="supportedprofiles-message" numbered="true" removeInRFC="false" toc="include" pn="section-6.2">
        <name slugifiedName="name-supportedprofiles-message">SupportedProfiles Message</name>
        <t indent="0" pn="section-6.2-1">The <tt>SupportedProfiles</tt> message is defined as:</t>
        <sourcecode type="tls-presentation" markers="false" pn="section-6.2-2">
uint8 SRTPProtectionProfile[2]; /* from RFC 5764 */

struct {
    uint8 version;
    SRTPProtectionProfile protection_profiles&lt;2..2^16-1&gt;;
} SupportedProfiles;
</sourcecode>
        <t indent="0" pn="section-6.2-3">The elements of <tt>SupportedProfiles</tt> include:</t>
        <dl newline="false" spacing="normal" indent="3" pn="section-6.2-4">
          <dt pn="section-6.2-4.1"><tt>version</tt>:</dt>
          <dd pn="section-6.2-4.2">this document specifies version 0x00.</dd>
          <dt pn="section-6.2-4.3"><tt>protection_profiles</tt>:</dt>
          <dd pn="section-6.2-4.4">the list of two-octet SRTP protection profile
  values, as per <xref target="RFC5764" format="default" sectionFormat="of" derivedContent="RFC5764"/>, supported by the Media Distributor.</dd>
        </dl>
      </section>
      <section anchor="unsupportedversion-message" numbered="true" removeInRFC="false" toc="include" pn="section-6.3">
        <name slugifiedName="name-unsupportedversion-message">UnsupportedVersion Message</name>
        <t indent="0" pn="section-6.3-1">The <tt>UnsupportedVersion</tt> message is defined as:</t>
        <sourcecode type="tls-presentation" markers="false" pn="section-6.3-2">
struct {
    uint8 highest_version;
} UnsupportedVersion;
</sourcecode>
        <t indent="0" pn="section-6.3-3"><tt>UnsupportedVersion</tt> contains this single element:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-6.3-4">
          <dt pn="section-6.3-4.1"><tt>highest_version</tt>:</dt>
          <dd pn="section-6.3-4.2">indicates the highest version of the protocol supported
  by the Key Distributor.</dd>
        </dl>
      </section>
      <section anchor="mediakeys-message" numbered="true" removeInRFC="false" toc="include" pn="section-6.4">
        <name slugifiedName="name-mediakeys-message">MediaKeys Message</name>
        <t indent="0" pn="section-6.4-1">The <tt>MediaKeys</tt> message is defined as:</t>
        <sourcecode type="tls-presentation" markers="false" pn="section-6.4-2">
struct {
    uuid association_id;
    SRTPProtectionProfile protection_profile;
    opaque mki&lt;0..255&gt;;
    opaque client_write_SRTP_master_key&lt;1..255&gt;;
    opaque server_write_SRTP_master_key&lt;1..255&gt;;
    opaque client_write_SRTP_master_salt&lt;1..255&gt;;
    opaque server_write_SRTP_master_salt&lt;1..255&gt;;
} MediaKeys;
</sourcecode>
        <t indent="0" pn="section-6.4-3">The fields are described as follows:</t>
        <dl newline="false" spacing="normal" indent="3" pn="section-6.4-4">
          <dt pn="section-6.4-4.1"><tt>association_id</tt>:</dt>
          <dd pn="section-6.4-4.2">a value that identifies a distinct DTLS association
  between an endpoint and the Key Distributor.</dd>
          <dt pn="section-6.4-4.3"><tt>protection_profiles</tt>:</dt>
          <dd pn="section-6.4-4.4">the value of the two-octet SRTP protection
  profile value, as per <xref target="RFC5764" format="default" sectionFormat="of" derivedContent="RFC5764"/>, used for this DTLS association.</dd>
          <dt pn="section-6.4-4.5"><tt>mki</tt>:</dt>
          <dd pn="section-6.4-4.6">master key identifier <xref target="RFC3711" format="default" sectionFormat="of" derivedContent="RFC3711"/>; a zero-length field indicates
  that no MKI value is present.</dd>
          <dt pn="section-6.4-4.7"><tt>client_write_SRTP_master_key</tt>:</dt>
          <dd pn="section-6.4-4.8">the value of the SRTP master key used by the client (endpoint).</dd>
          <dt pn="section-6.4-4.9"><tt>server_write_SRTP_master_key</tt>:</dt>
          <dd pn="section-6.4-4.10">the value of the SRTP master key used by the server (Media Distributor).</dd>
          <dt pn="section-6.4-4.11"><tt>client_write_SRTP_master_salt</tt>:</dt>
          <dd pn="section-6.4-4.12">the value of the SRTP master salt used by the client (endpoint).</dd>
          <dt pn="section-6.4-4.13"><tt>server_write_SRTP_master_salt</tt>:</dt>
          <dd pn="section-6.4-4.14">the value of the SRTP master salt used by the server (Media Distributor).</dd>
        </dl>
      </section>
      <section anchor="tunneleddtls-message" numbered="true" removeInRFC="false" toc="include" pn="section-6.5">
        <name slugifiedName="name-tunneleddtls-message">TunneledDtls Message</name>
        <t indent="0" pn="section-6.5-1">The <tt>TunneledDtls</tt> message is defined as:</t>
        <sourcecode type="tls-presentation" markers="false" pn="section-6.5-2">
struct {
    uuid association_id;
    opaque dtls_message&lt;1..2^16-1&gt;;
} TunneledDtls;
</sourcecode>
        <t indent="0" pn="section-6.5-3">The fields are described as follows:</t>
        <dl newline="false" spacing="normal" indent="3" pn="section-6.5-4">
          <dt pn="section-6.5-4.1"><tt>association_id</tt>:</dt>
          <dd pn="section-6.5-4.2">a value that identifies a distinct DTLS association
  between an endpoint and the Key Distributor.</dd>
          <dt pn="section-6.5-4.3"><tt>dtls_message</tt>:</dt>
          <dd pn="section-6.5-4.4">the content of the DTLS message received by the
  endpoint or to be sent to the endpoint, including one or more complete
  DTLS records.</dd>
        </dl>
      </section>
      <section anchor="endpointdisconnect-message" numbered="true" removeInRFC="false" toc="include" pn="section-6.6">
        <name slugifiedName="name-endpointdisconnect-message">EndpointDisconnect Message</name>
        <t indent="0" pn="section-6.6-1">The <tt>EndpointDisconnect</tt> message is defined as:</t>
        <sourcecode type="tls-presentation" markers="false" pn="section-6.6-2">
struct {
    uuid association_id;
} EndpointDisconnect;
</sourcecode>
        <t indent="0" pn="section-6.6-3">The field is described as follows:</t>
        <dl newline="false" spacing="normal" indent="3" pn="section-6.6-4">
          <dt pn="section-6.6-4.1"><tt>association_id</tt>:</dt>
          <dd pn="section-6.6-4.2">a value that identifies a distinct DTLS association
  between an endpoint and the Key Distributor.</dd>
        </dl>
      </section>
    </section>
    <section anchor="example-binary-encoding" numbered="true" removeInRFC="false" toc="include" pn="section-7">
      <name slugifiedName="name-example-binary-encoding">Example Binary Encoding</name>
      <t indent="0" pn="section-7-1">The <tt>TunnelMessage</tt> is encoded in binary, following the procedures
  specified in <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/>.  This section provides an example of what
  the bits on the wire would look like for the <tt>SupportedProfiles</tt>
  message that advertises support for both
  <tt>DOUBLE_AEAD_AES_128_GCM_AEAD_AES_128_GCM</tt> and
  <tt>DOUBLE_AEAD_AES_256_GCM_AEAD_AES_256_GCM</tt> <xref target="RFC8723" format="default" sectionFormat="of" derivedContent="RFC8723"/>.</t>
      <sourcecode type="" markers="false" pn="section-7-2">
TunnelMessage:
         message_type: 0x01
               length: 0x0007
    SupportedProfiles:
                   version:  0x00
       protection_profiles:  0x0004 (length)
                             0x0009000A (value)
</sourcecode>
      <t indent="0" pn="section-7-3">Thus, the encoding on the wire, presented here in network byte order,
would be this stream of octets:</t>
      <sourcecode type="" markers="false" pn="section-7-4">
0x0100070000040009000A
</sourcecode>
    </section>
    <section anchor="iana-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-8">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-8-1">This document establishes the "Datagram Transport Layer Security (DTLS) Tunnel Protocol Message Types for Privacy Enhanced Conferencing" registry to contain message type
  values used in the DTLS tunnel protocol.  These message type values are a
  single octet in length.  This document defines the values shown in
  <xref target="message_types" format="default" sectionFormat="of" derivedContent="Table 1"/> below, leaving the balance of possible values
  reserved for future specifications:</t>
      <table anchor="message_types" align="center" pn="table-1">
        <name slugifiedName="name-message-type-values-for-the">Message Type Values for the DTLS Tunnel Protocol</name>
        <thead>
          <tr>
            <th align="center" colspan="1" rowspan="1">MsgType</th>
            <th align="left" colspan="1" rowspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center" colspan="1" rowspan="1">0x01</td>
            <td align="left" colspan="1" rowspan="1">Supported SRTP Protection Profiles</td>
          </tr>
          <tr>
            <td align="center" colspan="1" rowspan="1">0x02</td>
            <td align="left" colspan="1" rowspan="1">Unsupported Version</td>
          </tr>
          <tr>
            <td align="center" colspan="1" rowspan="1">0x03</td>
            <td align="left" colspan="1" rowspan="1">Media Keys</td>
          </tr>
          <tr>
            <td align="center" colspan="1" rowspan="1">0x04</td>
            <td align="left" colspan="1" rowspan="1">Tunneled DTLS</td>
          </tr>
          <tr>
            <td align="center" colspan="1" rowspan="1">0x05</td>
            <td align="left" colspan="1" rowspan="1">Endpoint Disconnect</td>
          </tr>
        </tbody>
      </table>
      <t indent="0" pn="section-8-3">The value 0x00 is reserved, and all values in the range 0x06 to 0xFF are
available for allocation.  The procedures for updating this table are those
defined as "IETF Review" in <xref target="RFC8126" section="4.8" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8126#section-4.8" derivedContent="RFC8126"/>.</t>
    </section>
    <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-9">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-9-1">Since the procedures in this document rely on TLS <xref target="RFC8446" format="default" sectionFormat="of" derivedContent="RFC8446"/> for transport
security, the security considerations for TLS should be reviewed when
implementing the protocol defined in this document.</t>
      <t indent="0" pn="section-9-2">While the tunneling protocol defined in this document does not use
DTLS-SRTP <xref target="RFC5764" format="default" sectionFormat="of" derivedContent="RFC5764"/> directly, it does convey and negotiate some of the
same information (e.g., protection profile data).  As such, a review of the
security considerations found in that document may be useful.</t>
      <t indent="0" pn="section-9-3">This document describes a means of securely exchanging keying material and
cryptographic transforms for both E2E and HBH encryption and authentication of
media between an endpoint and a Key Distributor via a Media Distributor.
Additionally, the procedures result in delivering HBH information to the
intermediary Media Distributor.  The Key Distributor and endpoint are the only
two entities with access to both the E2E and HBH keys, while the Media
Distributor has access to only HBH information.  <xref target="RFC8871" section="8.2" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8871#section-8.2" derivedContent="RFC8871"/>
enumerates various attacks against which one must guard when implementing a
Media Distributor; these scenarios are important to note.</t>
      <t indent="0" pn="section-9-4">A requirement in this document is that a TLS connection between the Media
Distributor and the Key Distributor be mutually authenticated.  The reason
for this requirement is to ensure that only an authorized Media Distributor
receives the HBH keying material.  If an unauthorized Media Distributor gains
access to the HBH keying material, it can easily cause service degradation or
denial by transmitting HBH-valid packets that ultimately fail E2E
authentication or replay protection checks (see <xref target="RFC3711" section="3.3.2" sectionFormat="of" format="default" derivedLink="https://rfc-editor.org/rfc/rfc3711#section-3.3.2" derivedContent="RFC3711"/>).
Even if service does not appear degraded in any way, transmitting and
processing bogus packets are a waste of both computational and network
resources.</t>
      <t indent="0" pn="section-9-5">The procedures defined in this document assume that the Media Distributor
will properly convey DTLS messages between the endpoint and Key Distributor.
Should it fail in that responsibility by forwarding DTLS messages from
endpoint A advertised as being from endpoint B, this will result in
a failure at the DTLS layer of those DTLS sessions.  This could be an additional
attack vector that Key Distributor implementations should consider.</t>
      <t indent="0" pn="section-9-6">While E2E keying material passes through the Media Distributor via the protocol
defined in this document, the Media Distributor has no means of gaining access
to that information and therefore cannot affect the E2E media processing
function in the endpoint except to present it with invalid or replayed data.
That said, any entity along the path that interferes with the DTLS exchange
between the endpoint and the Key Distributor, including a malicious Media
Distributor that is not properly authorized, could prevent an endpoint from
properly communicating with the Key Distributor and therefore prevent
successful conference participation.</t>
      <t indent="0" pn="section-9-7">It is worth noting that a compromised Media Distributor can convey
information to an adversary, such as participant IP addresses,
negotiated protection profiles, or other metadata.
  While <xref target="RFC8871" format="default" sectionFormat="of" derivedContent="RFC8871"/> explains that
a malicious or compromised Media Distributor can disrupt communications,
an additional attack vector introduced by this protocol is the potential
disruption of DTLS negotiation or premature removal of a participant from
a conference by sending an <tt>EndpointDisconnect</tt> message to the
Key Distributor.</t>
      <t indent="0" pn="section-9-8">The Key Distributor should be aware of the possibility that a malicious
Media Distributor might transmit an <tt>EndpointDisconnect</tt> message to the Key
Distributor  when the endpoint is in fact still connected.</t>
      <t indent="0" pn="section-9-9">While the Security Considerations section of <xref target="RFC8871" format="default" sectionFormat="of" derivedContent="RFC8871"/> describes various
attacks one needs to consider with respect to the Key Distributor and
denial of service, use of this protocol introduces another possible
attack vector.  Consider the case where a malicious endpoint sends unsolicited
DTLS-SRTP messages to a Media Distributor.  The Media Distributor will normally
forward those messages to the Key Distributor and, if found invalid, such
messages only serve to consume resources on both the Media Distributor and
Key Distributor.</t>
    </section>
  </middle>
  <back>
    <references pn="section-10">
      <name slugifiedName="name-references">References</name>
      <references pn="section-10.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC3711" target="https://www.rfc-editor.org/info/rfc3711" quoteTitle="true" derivedAnchor="RFC3711">
          <front>
            <title>The Secure Real-time Transport Protocol (SRTP)</title>
            <author initials="M." surname="Baugher" fullname="M. Baugher">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="McGrew" fullname="D. McGrew">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Naslund" fullname="M. Naslund">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Carrara" fullname="E. Carrara">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Norrman" fullname="K. Norrman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2004" month="March"/>
            <abstract>
              <t indent="0">This document describes the Secure Real-time Transport Protocol (SRTP), a profile of the Real-time Transport Protocol (RTP), which can provide confidentiality, message authentication, and replay protection to the RTP traffic and to the control traffic for RTP, the Real-time Transport Control Protocol (RTCP).   [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3711"/>
          <seriesInfo name="DOI" value="10.17487/RFC3711"/>
        </reference>
        <reference anchor="RFC4122" target="https://www.rfc-editor.org/info/rfc4122" quoteTitle="true" derivedAnchor="RFC4122">
          <front>
            <title>A Universally Unique IDentifier (UUID) URN Namespace</title>
            <author initials="P." surname="Leach" fullname="P. Leach">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Mealling" fullname="M. Mealling">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Salz" fullname="R. Salz">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="July"/>
            <abstract>
              <t indent="0">This specification defines a Uniform Resource Name namespace for UUIDs (Universally Unique IDentifier), also known as GUIDs (Globally Unique IDentifier).  A UUID is 128 bits long, and can guarantee uniqueness across space and time.  UUIDs were originally used in the Apollo Network Computing System and later in the Open Software Foundation\'s (OSF) Distributed Computing Environment (DCE), and then in Microsoft Windows platforms.</t>
              <t indent="0">This specification is derived from the DCE specification with the kind permission of the OSF (now known as The Open Group).  Information from earlier versions of the DCE specification have been incorporated into this document.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4122"/>
          <seriesInfo name="DOI" value="10.17487/RFC4122"/>
        </reference>
        <reference anchor="RFC5764" target="https://www.rfc-editor.org/info/rfc5764" quoteTitle="true" derivedAnchor="RFC5764">
          <front>
            <title>Datagram Transport Layer Security (DTLS) Extension to Establish Keys for the Secure Real-time Transport Protocol (SRTP)</title>
            <author initials="D." surname="McGrew" fullname="D. McGrew">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="May"/>
            <abstract>
              <t indent="0">This document describes a Datagram Transport Layer Security (DTLS) extension to establish keys for Secure RTP (SRTP) and Secure RTP Control Protocol (SRTCP) flows.  DTLS keying happens on the media path, independent of any out-of-band signalling channel present. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5764"/>
          <seriesInfo name="DOI" value="10.17487/RFC5764"/>
        </reference>
        <reference anchor="RFC8122" target="https://www.rfc-editor.org/info/rfc8122" quoteTitle="true" derivedAnchor="RFC8122">
          <front>
            <title>Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)</title>
            <author initials="J." surname="Lennox" fullname="J. Lennox">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Holmberg" fullname="C. Holmberg">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="March"/>
            <abstract>
              <t indent="0">This document specifies how to establish secure connection-oriented media transport sessions over the Transport Layer Security (TLS) protocol using the Session Description Protocol (SDP).  It defines the SDP protocol identifier, 'TCP/TLS'.  It also defines the syntax and semantics for an SDP 'fingerprint' attribute that identifies the certificate that will be presented for the TLS session.  This mechanism allows media transport over TLS connections to be established securely, so long as the integrity of session descriptions is assured.</t>
              <t indent="0">This document obsoletes RFC 4572 by clarifying the usage of multiple fingerprints.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8122"/>
          <seriesInfo name="DOI" value="10.17487/RFC8122"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8446" target="https://www.rfc-editor.org/info/rfc8446" quoteTitle="true" derivedAnchor="RFC8446">
          <front>
            <title>The Transport Layer Security (TLS) Protocol Version 1.3</title>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="August"/>
            <abstract>
              <t indent="0">This document specifies version 1.3 of the Transport Layer Security (TLS) protocol.  TLS allows client/server applications to communicate over the Internet in a way that is designed to prevent eavesdropping, tampering, and message forgery.</t>
              <t indent="0">This document updates RFCs 5705 and 6066, and obsoletes RFCs 5077, 5246, and 6961.  This document also specifies new requirements for TLS 1.2 implementations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8446"/>
          <seriesInfo name="DOI" value="10.17487/RFC8446"/>
        </reference>
        <reference anchor="RFC8723" target="https://www.rfc-editor.org/info/rfc8723" quoteTitle="true" derivedAnchor="RFC8723">
          <front>
            <title>Double Encryption Procedures for the Secure Real-Time Transport Protocol (SRTP)</title>
            <author initials="C." surname="Jennings" fullname="C. Jennings">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Jones" fullname="P. Jones">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Barnes" fullname="R. Barnes">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A.B." surname="Roach" fullname="A.B. Roach">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="April"/>
            <abstract>
              <t indent="0">In some conferencing scenarios, it is desirable for an intermediary to be able to manipulate some parameters in Real-time Transport Protocol (RTP) packets, while still providing strong end-to-end security guarantees. This document defines a cryptographic transform for the Secure Real-time Transport Protocol (SRTP) that uses two separate but related cryptographic operations to provide hop-by-hop and end-to-end security guarantees.  Both the end-to-end and hop-by-hop cryptographic algorithms can utilize an authenticated encryption with associated data (AEAD) algorithm or take advantage of future SRTP transforms with different properties.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8723"/>
          <seriesInfo name="DOI" value="10.17487/RFC8723"/>
        </reference>
        <reference anchor="RFC8842" target="https://www.rfc-editor.org/info/rfc8842" quoteTitle="true" derivedAnchor="RFC8842">
          <front>
            <title>Session Description Protocol (SDP) Offer/Answer Considerations for Datagram Transport Layer Security (DTLS) and Transport Layer Security (TLS)</title>
            <author initials="C." surname="Holmberg" fullname="C. Holmberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Shpount" fullname="R. Shpount">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="January"/>
            <abstract>
              <t indent="0">This document defines the Session Description Protocol (SDP) offer/answer procedures for negotiating and establishing a Datagram Transport Layer Security (DTLS) association.  The document also defines the criteria for when a new DTLS association must be established.  The document updates RFCs 5763 and 7345 by replacing common SDP offer/answer procedures with a reference to this specification. </t>
              <t indent="0">This document defines a new SDP media-level attribute, "tls-id". </t>
              <t indent="0">This document also defines how the "tls-id" attribute can be used for negotiating and establishing a Transport Layer Security (TLS) connection, in conjunction with the procedures in RFCs 4145 and 8122.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8842"/>
          <seriesInfo name="DOI" value="10.17487/RFC8842"/>
        </reference>
        <reference anchor="RFC8844" target="https://www.rfc-editor.org/info/rfc8844" quoteTitle="true" derivedAnchor="RFC8844">
          <front>
            <title>Unknown Key-Share Attacks on Uses of TLS with the Session Description Protocol (SDP)</title>
            <author initials="M." surname="Thomson" fullname="M. Thomson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rescorla" fullname="E. Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="January"/>
            <abstract>
              <t indent="0">This document describes unknown key-share attacks on the use of Datagram Transport Layer Security for the Secure Real-Time Transport Protocol (DTLS-SRTP). Similar attacks are described on the use of DTLS-SRTP with the identity bindings used in Web Real-Time Communications (WebRTC) and SIP identity.  These attacks are difficult to mount, but they cause a victim to be misled about the identity of a communicating peer.  This document defines mitigation techniques that implementations of RFC 8122 are encouraged to deploy.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8844"/>
          <seriesInfo name="DOI" value="10.17487/RFC8844"/>
        </reference>
        <reference anchor="RFC8871" target="https://www.rfc-editor.org/info/rfc8871" quoteTitle="true" derivedAnchor="RFC8871">
          <front>
            <title>A Solution Framework for Private Media in Privacy-Enhanced RTP Conferencing (PERC)</title>
            <author initials="P." surname="Jones" fullname="P. Jones">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Benham" fullname="D. Benham">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Groves" fullname="C. Groves">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="January"/>
            <abstract>
              <t indent="0">This document describes a solution framework for ensuring that media confidentiality and integrity are maintained end to end within the context of a switched conferencing environment where Media Distributors are not trusted with the end-to-end media encryption keys.  The solution builds upon existing security mechanisms defined for the Real-time Transport Protocol (RTP).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8871"/>
          <seriesInfo name="DOI" value="10.17487/RFC8871"/>
        </reference>
        <reference anchor="RFC9147" target="https://www.rfc-editor.org/info/rfc9147" quoteTitle="true" derivedAnchor="RFC9147">
          <front>
            <title>The Datagram Transport Layer Security (DTLS) Protocol Version 1.3</title>
            <author initials="E" surname="Rescorla" fullname="Eric Rescorla">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H" surname="Tschofenig" fullname="Hannes Tschofenig">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="N" surname="Modadugu" fullname="Nagendra Modadugu">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2022" month="April"/>
          </front>
          <seriesInfo name="RFC" value="9147"/>
          <seriesInfo name="DOI" value="10.17487/RFC9147"/>
        </reference>
      </references>
      <references pn="section-10.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="RFC3264" target="https://www.rfc-editor.org/info/rfc3264" quoteTitle="true" derivedAnchor="RFC3264">
          <front>
            <title>An Offer/Answer Model with Session Description Protocol (SDP)</title>
            <author initials="J." surname="Rosenberg" fullname="J. Rosenberg">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Schulzrinne" fullname="H. Schulzrinne">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2002" month="June"/>
            <abstract>
              <t indent="0">This document defines a mechanism by which two entities can make use of the Session Description Protocol (SDP) to arrive at a common view of a multimedia session between them.  In the model, one participant offers the other a description of the desired session from their perspective, and the other participant answers with the desired session from their perspective.  This offer/answer model is most useful in unicast sessions where information from both participants is needed for the complete view of the session.  The offer/answer model is used by protocols like the Session Initiation Protocol (SIP).  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3264"/>
          <seriesInfo name="DOI" value="10.17487/RFC3264"/>
        </reference>
        <reference anchor="RFC3550" target="https://www.rfc-editor.org/info/rfc3550" quoteTitle="true" derivedAnchor="RFC3550">
          <front>
            <title>RTP: A Transport Protocol for Real-Time Applications</title>
            <author initials="H." surname="Schulzrinne" fullname="H. Schulzrinne">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Casner" fullname="S. Casner">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Frederick" fullname="R. Frederick">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="V." surname="Jacobson" fullname="V. Jacobson">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2003" month="July"/>
            <abstract>
              <t indent="0">This memorandum describes RTP, the real-time transport protocol.  RTP provides end-to-end network transport functions suitable for applications transmitting real-time data, such as audio, video or simulation data, over multicast or unicast network services.  RTP does not address resource reservation and does not guarantee quality-of- service for real-time services.  The data transport is augmented by a control protocol (RTCP) to allow monitoring of the data delivery in a manner scalable to large multicast networks, and to provide minimal control and identification functionality.  RTP and RTCP are designed to be independent of the underlying transport and network layers.  The protocol supports the use of RTP-level translators and mixers. Most of the text in this memorandum is identical to RFC 1889 which it obsoletes.  There are no changes in the packet formats on the wire, only changes to the rules and algorithms governing how the protocol is used. The biggest change is an enhancement to the scalable timer algorithm for calculating when to send RTCP packets in order to minimize transmission in excess of the intended rate when many participants join a session simultaneously.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="64"/>
          <seriesInfo name="RFC" value="3550"/>
          <seriesInfo name="DOI" value="10.17487/RFC3550"/>
        </reference>
        <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <author initials="M." surname="Cotton" fullname="M. Cotton">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="June"/>
            <abstract>
              <t indent="0">Many protocols make use of points of extensibility that use constants to identify various protocol parameters.  To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper.  For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
              <t indent="0">To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed.  This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
              <t indent="0">This is the third edition of this document; it obsoletes RFC 5226.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="26"/>
          <seriesInfo name="RFC" value="8126"/>
          <seriesInfo name="DOI" value="10.17487/RFC8126"/>
        </reference>
        <reference anchor="RFC8866" target="https://www.rfc-editor.org/info/rfc8866" quoteTitle="true" derivedAnchor="RFC8866">
          <front>
            <title>SDP: Session Description Protocol</title>
            <author initials="A." surname="Begen" fullname="A. Begen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Kyzivat" fullname="P. Kyzivat">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Perkins" fullname="C. Perkins">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Handley" fullname="M. Handley">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="January"/>
            <abstract>
              <t indent="0">This memo defines the Session Description Protocol (SDP). SDP is intended for describing multimedia sessions for the purposes of session announcement, session invitation, and other forms of multimedia session initiation. This document obsoletes RFC 4566.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8866"/>
          <seriesInfo name="DOI" value="10.17487/RFC8866"/>
        </reference>
      </references>
    </references>
    <section anchor="acknowledgements" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.a-1">The authors would like to thank <contact fullname="David Benham"/> and <contact fullname="Cullen Jennings"/> for reviewing this document and providing constructive
  comments.</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author initials="P." surname="Jones" fullname="Paul E. Jones">
        <organization abbrev="Cisco Systems" showOnFrontPage="true">Cisco Systems, Inc.</organization>
        <address>
          <postal>
            <street>7025 Kit Creek Rd.</street>
            <city>Research Triangle Park</city>
            <code>27709</code>
            <country>United States of America</country>
            <region>North Carolina</region>
          </postal>
          <phone>+1 919 476 2048</phone>
          <email>paulej@packetizer.com</email>
        </address>
      </author>
      <author initials="P." surname="Ellenbogen" fullname="Paul M. Ellenbogen">
        <organization showOnFrontPage="true">Princeton University</organization>
        <address>
          <postal>
            <street/>
          </postal>
          <phone>+1 206 851 2069</phone>
          <email>pe5@cs.princeton.edu</email>
        </address>
      </author>
      <author initials="N." surname="Ohlmeier" fullname="Nils H. Ohlmeier">
        <organization showOnFrontPage="true">8x8, Inc.</organization>
        <address>
          <postal>
            <street/>
          </postal>
          <phone>+1 408 659 6457</phone>
          <email>nils@ohlmeier.org</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
