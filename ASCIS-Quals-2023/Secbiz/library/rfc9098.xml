<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="info" consensus="true" docName="draft-ietf-v6ops-ipv6-ehs-packet-drops-08" indexInclude="true" ipr="trust200902" number="9098" prepTime="2021-09-15T11:28:27" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="2" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-v6ops-ipv6-ehs-packet-drops-08" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9098" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="IPv6 Extension Headers">Operational Implications of IPv6 Packets with Extension Headers</title>
    <seriesInfo name="RFC" value="9098" stream="IETF"/>
    <author fullname="Fernando Gont" initials="F." surname="Gont">
      <organization abbrev="SI6 Networks" showOnFrontPage="true">SI6 Networks</organization>
      <address>
        <postal>
          <street>Segurola y Habana 4310, 7mo Piso</street>
          <city>Villa Devoto</city>
          <region>Ciudad Autonoma de Buenos Aires</region>
          <country>Argentina</country>
        </postal>
        <email>fgont@si6networks.com</email>
        <uri>https://www.si6networks.com</uri>
      </address>
    </author>
    <author fullname="Nick Hilliard" initials="N" surname="Hilliard">
      <organization showOnFrontPage="true">INEX</organization>
      <address>
        <postal>
          <street>4027 Kingswood Road</street>
          <city>Dublin</city>
          <code>24</code>
          <country>Ireland</country>
        </postal>
        <email>nick@inex.ie</email>
      </address>
    </author>
    <author fullname="Gert Doering" initials="G" surname="Doering">
      <organization showOnFrontPage="true">SpaceNet AG</organization>
      <address>
        <postal>
          <street>Joseph-Dollinger-Bogen 14</street>
          <city>Muenchen</city>
          <code>D-80807</code>
          <country>Germany</country>
        </postal>
        <email>gert@space.net</email>
      </address>
    </author>
    <author fullname="Warren Kumari" initials="W." surname="Kumari">
      <organization showOnFrontPage="true">Google</organization>
      <address>
        <postal>
          <street>1600 Amphitheatre Parkway</street>
          <city>Mountain View</city>
          <region>CA</region>
          <code>94043</code>
          <country>US</country>
        </postal>
        <email>warren@kumari.net</email>
      </address>
    </author>
    <author fullname="Geoff Huston" initials="G." surname="Huston">
      <organization abbrev="APNIC" showOnFrontPage="true"/>
      <address>
        <email>gih@apnic.net</email>
        <uri>https://www.apnic.net</uri>
      </address>
    </author>
    <author fullname="Will (Shucheng) Liu" initials="W." surname="Liu">
      <organization showOnFrontPage="true">Huawei Technologies</organization>
      <address>
        <postal>
          <street>Bantian, Longgang District</street>
          <city>Shenzhen</city>
          <code>518129</code>
          <country>China</country>
        </postal>
        <email>liushucheng@huawei.com</email>
      </address>
    </author>
    <date month="09" year="2021"/>
    <area>Operations and Management</area>
    <workgroup>IPv6 Operations Working Group (v6ops)</workgroup>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
This document summarizes the operational implications of IPv6 extension headers specified in the IPv6 protocol specification (RFC 8200) and attempts to analyze reasons why packets with IPv6 extension headers are often dropped in the public Internet.
</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.  
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841. 
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9098" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-terminology">Terminology</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-disclaimer">Disclaimer</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-background-information">Background Information</xref></t>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-previous-work-on-ipv6-exten">Previous Work on IPv6 Extension Headers</xref></t>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-packet-forwarding-engine-co">Packet-Forwarding Engine Constraints</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-recirculation">Recirculation</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirement-to-process-laye">Requirement to Process Layer 3 / Layer 4 Information in Intermediate Systems</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t indent="0" pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ecmp-and-hash-based-load-sh">ECMP and Hash-Based Load Sharing</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.2">
                <t indent="0" pn="section-toc.1-1.7.2.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-enforcing-infrastructure-ac">Enforcing Infrastructure ACLs</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.3">
                <t indent="0" pn="section-toc.1-1.7.2.3.1"><xref derivedContent="7.3" format="counter" sectionFormat="of" target="section-7.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ddos-management-and-custome">DDoS Management and Customer Requests for Filtering</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.4">
                <t indent="0" pn="section-toc.1-1.7.2.4.1"><xref derivedContent="7.4" format="counter" sectionFormat="of" target="section-7.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-network-intrusion-detection">Network Intrusion Detection and Prevention</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.5">
                <t indent="0" pn="section-toc.1-1.7.2.5.1"><xref derivedContent="7.5" format="counter" sectionFormat="of" target="section-7.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-firewalling">Firewalling</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-operational-and-security-im">Operational and Security Implications</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2">
              <li pn="section-toc.1-1.8.2.1">
                <t indent="0" pn="section-toc.1-1.8.2.1.1"><xref derivedContent="8.1" format="counter" sectionFormat="of" target="section-8.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-inability-to-find-layer-4-i">Inability to Find Layer 4 Information</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.2">
                <t indent="0" pn="section-toc.1-1.8.2.2.1"><xref derivedContent="8.2" format="counter" sectionFormat="of" target="section-8.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-route-processor-protection">Route-Processor Protection</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.3">
                <t indent="0" pn="section-toc.1-1.8.2.3.1"><xref derivedContent="8.3" format="counter" sectionFormat="of" target="section-8.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-inability-to-perform-fine-g">Inability to Perform Fine-Grained Filtering</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.4">
                <t indent="0" pn="section-toc.1-1.8.2.4.1"><xref derivedContent="8.4" format="counter" sectionFormat="of" target="section-8.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-concerns-associate">Security Concerns Associated with IPv6 Extension Headers</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.11.2">
              <li pn="section-toc.1-1.11.2.1">
                <t indent="0" pn="section-toc.1-1.11.2.1.1"><xref derivedContent="11.1" format="counter" sectionFormat="of" target="section-11.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.2">
                <t indent="0" pn="section-toc.1-1.11.2.2.1"><xref derivedContent="11.2" format="counter" sectionFormat="of" target="section-11.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="intro" numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">
IPv6 extension headers (EHs) allow for the extension of the IPv6 protocol and provide support for core functionality such as IPv6 fragmentation. However, common implementation limitations suggest that EHs present a challenge for IPv6 packet routing equipment and middleboxes, and evidence exists that IPv6 packets with EHs are intentionally dropped in the public Internet in some circumstances.
</t>
      <t indent="0" pn="section-1-2">This document has the following goals:
</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-1-3">
        <li pn="section-1-3.1">Raise awareness about the operational and security implications of IPv6 extension headers specified in <xref target="RFC8200" format="default" sectionFormat="of" derivedContent="RFC8200"/> and present reasons why some networks resort to intentionally dropping packets containing IPv6 extension headers.</li>
        <li pn="section-1-3.2">Highlight areas where current IPv6 support by networking devices may be suboptimal, such that the aforementioned support is improved.</li>
        <li pn="section-1-3.3">Highlight operational issues associated with IPv6 extension headers, such that those issues are considered in IETF standardization efforts.</li>
      </ul>
      <t indent="0" pn="section-1-4">
<xref target="background" format="default" sectionFormat="of" derivedContent="Section 4"/> of this document provides background information about the IPv6 packet structure and associated implications. <xref target="previous-work" format="default" sectionFormat="of" derivedContent="Section 5"/> summarizes previous work that has been carried out in the area of IPv6 extension headers. <xref target="pfe-constraints" format="default" sectionFormat="of" derivedContent="Section 6"/> discusses packet-forwarding engine constraints in contemporary routers. <xref target="inability" format="default" sectionFormat="of" derivedContent="Section 7"/> discusses why intermediate systems may need to access Layer 4 information to make a forwarding decision. Finally, <xref target="operational-implications" format="default" sectionFormat="of" derivedContent="Section 8"/> discusses operational implications of IPv6 EHs.
</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-terminology">Terminology</name>
      <t indent="0" pn="section-2-1">
This document uses the term "intermediate system" to describe both routers and middleboxes when there is no need to distinguish between the two and where the important issue is that the device being discussed forwards packets.</t>
    </section>
    <section anchor="disclaimer" numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-disclaimer">Disclaimer</name>
      <t indent="0" pn="section-3-1">This document analyzes the operational challenges represented by packets that employ IPv6 extension headers and documents some of the operational reasons why these packets are often dropped in the public Internet. This document is not a recommendation to drop such packets, but rather an analysis of why they are currently dropped.
</t>
    </section>
    <section anchor="background" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-background-information">Background Information</name>
      <t indent="0" pn="section-4-1">
It is useful to compare the basic structure of IPv6 packets against that of IPv4 packets and analyze the implications of the two different packet structures.
</t>
      <t indent="0" pn="section-4-2">
    IPv4 packets have a variable-length header size that allows for the
    use of IPv4 "options" -- optional information that may be of use to
    nodes processing IPv4 packets.  The IPv4 header length is specified
    in the "Internet Header Length" (IHL) field of the mandatory IPv4 header and must be in
    the range of 20 octets (the minimum IPv4 header size) to 60 octets, accommodating at most 40 octets of options. The upper-layer protocol type is specified via the "Protocol" field of the mandatory IPv4 header.
</t>
      <figure anchor="ipv4-packet" align="left" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-ipv4-packet-structure">IPv4 Packet Structure</name>
        <artwork name="" type="" align="left" alt="" pn="section-4-3.1">
               Protocol, IHL
                    +--------+
                    |        |
                    |        v
               +------//-----+------------------------+
               |             |                        |
               |    IPv4     |       Upper-Layer      |
               |    Header   |       Protocol         |
               |             |                        |
               +-----//------+------------------------+

               variable length
               &lt;-------------&gt;
</artwork>
      </figure>
      <t indent="0" pn="section-4-4">
IPv6 took a different approach to the IPv6 packet structure. Rather than employing a variable-length header as IPv4 does, IPv6 employs a packet structure similar to a linked list, where a mandatory fixed-length IPv6 header is followed by an arbitrary number of optional extension headers, with the upper-layer header being the last header in the IPv6 header chain. Each extension header typically specifies its length (unless it is implicit from the extension header type) and the "next header" (NH) type that follows in the IPv6 header chain.
</t>
      <figure anchor="ipv6-packet" align="left" suppress-title="false" pn="figure-2">
        <name slugifiedName="name-ipv6-packet-structure">IPv6 Packet Structure</name>
        <artwork name="" type="" align="left" alt="" pn="section-4-5.1">
       NH          NH, EH-length      NH, EH-length
        +-------+      +------+            +-------+
        |       |      |      |            |       |
        |       v      |      v            |       v
  +-------------+-------------+-//-+---------------+--------------+
  |             |             |    |               |              |
  |    IPv6     |    Ext.     |    |     Ext.      |  Upper-Layer |
  |    header   |    Header   |    |     Header    |  Protocol    |
  |             |             |    |               |              |
  +-------------+-------------+-//-+---------------+--------------+

   fixed length    variable number of EHs &amp; length
  &lt;------------&gt; &lt;--------------------------------&gt;
</artwork>
      </figure>
      <t indent="0" pn="section-4-6">This packet structure has the following implications:

</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4-7">
        <li pn="section-4-7.1">
          <xref target="RFC8200" format="default" sectionFormat="of" derivedContent="RFC8200"/> requires the entire IPv6 header chain to be contained in the first fragment of a packet, therefore limiting the IPv6 header chain to the size of the path MTU.
</li>
        <li pn="section-4-7.2">Other than the path MTU constraints, there are no other limits to the number of IPv6 EHs that may be present in a packet. Therefore, there is no upper limit regarding how deep into the IPv6 packet the upper-layer protocol header may be found.
</li>
        <li pn="section-4-7.3">The only way for a node to obtain the upper-layer protocol
       type or find the upper-layer protocol header is to parse and
       process the entire IPv6 header chain, in sequence, starting from
       the mandatory IPv6 header until the last header in the IPv6
       header chain is found.
</li>
      </ul>
    </section>
    <section anchor="previous-work" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-previous-work-on-ipv6-exten">Previous Work on IPv6 Extension Headers</name>
      <t indent="0" pn="section-5-1">Some of the operational and security implications of IPv6 extension headers have been discussed in the IETF:
</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5-2">
        <li pn="section-5-2.1">
          <xref target="I-D.taylor-v6ops-fragdrop" format="default" sectionFormat="of" derivedContent="OPERATORS"/> discusses a rationale for which operators drop IPv6 fragments.</li>
        <li pn="section-5-2.2">
          <xref target="I-D.wkumari-long-headers" format="default" sectionFormat="of" derivedContent="HEADERS"/> discusses possible issues arising from "long" IPv6 header chains.</li>
        <li pn="section-5-2.3">
          <xref target="I-D.kampanakis-6man-ipv6-eh-parsing" format="default" sectionFormat="of" derivedContent="PARSING"/> describes how inconsistencies in the way IPv6 packets with extension headers are parsed by different implementations could result in evasion of security controls and presents guidelines for parsing IPv6 extension headers, with the goal of providing a common and consistent parsing methodology for IPv6 implementations.
</li>
        <li pn="section-5-2.4">
          <xref target="I-D.ietf-opsec-ipv6-eh-filtering" format="default" sectionFormat="of" derivedContent="IPV6-EH"/> analyzes the security implications of IPv6 EHs, as well as the operational implications of dropping packets that employ IPv6 EHs and associated options.
</li>
        <li pn="section-5-2.5">
          <xref target="RFC7113" format="default" sectionFormat="of" derivedContent="RFC7113"/> discusses how some popular Router Advertisement Guard (RA-Guard) implementations are subject to evasion by means of IPv6 extension headers.</li>
        <li pn="section-5-2.6">
          <xref target="RFC8900" format="default" sectionFormat="of" derivedContent="RFC8900"/> analyzes the fragility introduced by IP fragmentation.</li>
      </ul>
      <t indent="0" pn="section-5-3">A number of recent RFCs have discussed issues related to IPv6 extension headers and have specified updates to RFC 2460 <xref target="RFC2460" format="default" sectionFormat="of" derivedContent="RFC2460"/> (an earlier version of the IPv6 standard). Many of these updates have now been incorporated into the current IPv6 core standard <xref target="RFC8200" format="default" sectionFormat="of" derivedContent="RFC8200"/> or the IPv6 node requirements <xref target="RFC8504" format="default" sectionFormat="of" derivedContent="RFC8504"/>. Namely,
      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5-4">
        <li pn="section-5-4.1">
          <xref target="RFC5095" format="default" sectionFormat="of" derivedContent="RFC5095"/> discusses the security implications of Routing Header Type 0 (RHT0) and deprecates it.</li>
        <li pn="section-5-4.2">
          <xref target="RFC5722" format="default" sectionFormat="of" derivedContent="RFC5722"/> analyzes the security implications of overlapping fragments and provides recommendations in this area.</li>
        <li pn="section-5-4.3">
          <xref target="RFC7045" format="default" sectionFormat="of" derivedContent="RFC7045"/> clarifies how intermediate nodes should deal with IPv6 extension headers.</li>
        <li pn="section-5-4.4">
          <xref target="RFC7112" format="default" sectionFormat="of" derivedContent="RFC7112"/> discusses the issues arising in a specific fragmentation case where the IPv6 header chain is fragmented into two or more fragments and formally forbids such fragmentation.</li>
        <li pn="section-5-4.5">
          <xref target="RFC6946" format="default" sectionFormat="of" derivedContent="RFC6946"/> discusses a flawed (but common) processing of the so-called IPv6 "atomic fragments" and specifies improved processing of such packets.</li>
        <li pn="section-5-4.6">
          <xref target="RFC8021" format="default" sectionFormat="of" derivedContent="RFC8021"/> deprecates the generation of IPv6 atomic fragments.</li>
        <li pn="section-5-4.7">
          <xref target="RFC8504" format="default" sectionFormat="of" derivedContent="RFC8504"/> clarifies processing rules for packets with extension headers and also allows hosts to enforce limits on the number of options included in IPv6 EHs.</li>
        <li pn="section-5-4.8">
          <xref target="RFC7739" format="default" sectionFormat="of" derivedContent="RFC7739"/> discusses the security implications of predictable fragment Identification values and provides recommendations for the generation of these values.</li>
        <li pn="section-5-4.9">
          <xref target="RFC6980" format="default" sectionFormat="of" derivedContent="RFC6980"/> analyzes the security implications of employing IPv6 fragmentation with Neighbor Discovery for IPv6 and formally recommends against such usage.</li>
      </ul>
      <t indent="0" pn="section-5-5">Additionally, <xref target="RFC8200" format="default" sectionFormat="of" derivedContent="RFC8200"/> has relaxed the requirement that "all nodes must examine and process the Hop-by-Hop Options header" from <xref target="RFC2460" format="default" sectionFormat="of" derivedContent="RFC2460"/>, by specifying that only nodes that have been explicitly configured to process the Hop-by-Hop Options header are required to do so.</t>
      <t indent="0" pn="section-5-6">A number of studies have measured the extent to which packets employing IPv6 extension headers are dropped in the public Internet:

</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5-7">
        <li pn="section-5-7.1">
          <xref target="PMTUD-Blackholes" format="default" sectionFormat="of" derivedContent="PMTUD-Blackholes"/> and <xref target="Linkova-Gont-IEPG90" format="default" sectionFormat="of" derivedContent="Linkova-Gont-IEPG90"/> present some preliminary measurements regarding the extent to which packets containing IPv6 EHs are dropped in the public Internet.</li>
        <li pn="section-5-7.2">
          <xref target="RFC7872" format="default" sectionFormat="of" derivedContent="RFC7872"/> presents more comprehensive results and documents the methodology used to obtain these results.</li>
        <li pn="section-5-7.3">
          <xref target="Huston-2017" format="default" sectionFormat="of" derivedContent="Huston-2017"/> and <xref target="Huston-2020" format="default" sectionFormat="of" derivedContent="Huston-2020"/> measure packet drops resulting from IPv6 fragmentation when communicating with DNS servers.</li>
      </ul>
    </section>
    <section anchor="pfe-constraints" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-packet-forwarding-engine-co">Packet-Forwarding Engine Constraints</name>
      <t indent="0" pn="section-6-1">

Most contemporary carrier-grade routers use dedicated hardware, e.g., Application-Specific
Integrated Circuits (ASICs) or Network Processing Units (NPUs), to determine how to forward
packets across their internal fabrics (see <xref target="IEPG94-Scudder" format="default" sectionFormat="of" derivedContent="IEPG94-Scudder"/> and <xref target="APNIC-Scudder" format="default" sectionFormat="of" derivedContent="APNIC-Scudder"/> for details).  One common method of handling next-hop lookups is to send a small portion of the
ingress packet to a lookup engine with specialized hardware, e.g., ternary
content-addressable memory (TCAM) or reduced latency dynamic random-access memory
(RLDRAM), to determine the packet's next hop.  Technical constraints
mean that there is a trade-off between the amount of data sent to the lookup
engine and the overall packet-forwarding rate of the lookup engine.  If more data is
sent, the lookup engine can inspect further into the packet, but the overall
packet-forwarding rate of the system will be reduced.  If less data is sent, the
overall packet-forwarding rate of the router will be increased, but the packet lookup
engine may not be able to inspect far enough into a packet to determine how
it should be handled.
</t>
      <aside pn="section-6-2">
        <t indent="0" pn="section-6-2.1">NOTE:</t>
        <t indent="3" pn="section-6-2.2">
For example, some contemporary high-end routers are known to inspect up to 192 bytes, while others are known to parse up to 384 bytes of header.
</t>
      </aside>
      <t indent="0" pn="section-6-3">If a hardware-forwarding engine on a contemporary router cannot make a
forwarding decision about a packet because critical information is not sent
to the lookup engine, then the router will normally drop the packet. <xref target="inability" format="default" sectionFormat="of" derivedContent="Section 7"/> discusses some of the reasons for which a contemporary router might need to access Layer 4 information to make a forwarding decision.</t>
      <t indent="0" pn="section-6-4">
Historically, some packet-forwarding engines punted packets of this kind to
the control plane for more in-depth analysis, but this is unfeasible on most
contemporary router architectures as a result of the vast difference between the hardware-based forwarding
capacity of the router and the processing capacity of the control plane and the size of the management link that connects the control plane to the forwarding plane.  Other platforms may have a separate software-based forwarding plane that is
   distinct both from the hardware-based forwarding plane and the control
   plane. However, the limited CPU resources of this software-based
   forwarding plane, as well as the limited bandwidth of the associated
   link, results in similar throughput constraints. </t>
      <t indent="0" pn="section-6-5">

   If an IPv6 header chain is sufficiently long such that it exceeds the
   packet lookup capacity of the router, the router might be unable to
   determine how the packet should be handled and thus could resort to
   dropping the packet.

</t>
      <section anchor="recirculation" numbered="true" toc="include" removeInRFC="false" pn="section-6.1">
        <name slugifiedName="name-recirculation">Recirculation</name>
        <t indent="0" pn="section-6.1-1">

Although type-length-value (TLV) chains are amenable to iterative processing on architectures
that have packet lookup engines with deep inspection capabilities, some
packet-forwarding engines manage IPv6 header chains using
recirculation.  This approach processes extension headers one at a time:
when processing on one extension header is completed, the packet is looped
back through the processing engine again.  This recirculation process
continues repeatedly until there are no more extension headers left to be
processed.

</t>
        <t indent="0" pn="section-6.1-2">

Recirculation is typically used on packet-forwarding engines with limited
lookup capability, because it allows arbitrarily long header chains to be
processed without the complexity and cost associated with packet-forwarding
engines, which have deep lookup capabilities.  However, recirculation can
impact the forwarding capacity of hardware, as each packet will pass through
the processing engine multiple times.  Depending on configuration, the type
of packets being processed, and the hardware capabilities of the packet-forwarding
engine, the data-plane throughput performance on the
router might be negatively affected.

</t>
      </section>
    </section>
    <section anchor="inability" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-requirement-to-process-laye">Requirement to Process Layer 3 / Layer 4 Information in Intermediate Systems</name>
      <t indent="0" pn="section-7-1">The following subsections discuss some of the reasons for which intermediate systems may need to process Layer 3 / Layer 4 information to make a forwarding decision.</t>
      <section anchor="ecmp-load-balancing" numbered="true" toc="include" removeInRFC="false" pn="section-7.1">
        <name slugifiedName="name-ecmp-and-hash-based-load-sh">ECMP and Hash-Based Load Sharing</name>
        <t indent="0" pn="section-7.1-1">In the case of Equal Cost Multipath (ECMP) load sharing, the intermediate system
needs to make a decision regarding which of its interfaces to
use to forward a given packet.  Since round-robin usage of the links is usually
avoided to prevent packet reordering, forwarding engines need to
use a mechanism that will consistently forward the same data streams down
the same forwarding paths.  Most forwarding engines achieve this by
calculating a simple hash using an n-tuple gleaned from a combination of
Layer 2 through to Layer 4 protocol header information.  This n-tuple will
typically use the src/dst Media Access Control (MAC) addresses, src/dst IP addresses, and, if possible,
further Layer 4 src/dst port information.
</t>
        <t indent="0" pn="section-7.1-2">In the IPv6 world, flows are expected to be identified by means of the IPv6 "Flow Label" <xref target="RFC6437" format="default" sectionFormat="of" derivedContent="RFC6437"/>. Thus, ECMP and hash-based load sharing should be possible without the need to process the entire IPv6 header chain to obtain upper-layer information to identify flows. <xref target="RFC7098" format="default" sectionFormat="of" derivedContent="RFC7098"/> discusses how the IPv6 Flow Label can be used to enhance Layer 3/4 load distribution and balancing for large server farms.
</t>
        <t indent="0" pn="section-7.1-3">Historically, many IPv6 implementations failed to set the Flow Label, and hash-based ECMP/load-sharing devices also did not employ the Flow Label for performing their task. While support of <xref target="RFC6437" format="default" sectionFormat="of" derivedContent="RFC6437"/> is currently widespread for current versions of all popular host implementations, there is still only marginal usage of the IPv6 Flow Label for ECMP and load balancing <xref target="Almeida-2020" format="default" sectionFormat="of" derivedContent="Almeida-2020"/>. A contributing factor could be the issues that have been found in host implementations and middleboxes <xref target="Jaeggli-2018" format="default" sectionFormat="of" derivedContent="Jaeggli-2018"/>.</t>
        <t indent="0" pn="section-7.1-4">
Clearly, widespread support of <xref target="RFC6437" format="default" sectionFormat="of" derivedContent="RFC6437"/> would relieve intermediate systems from having to process the entire IPv6 header chain, making Flow Label-based ECMP and load sharing <xref target="RFC6438" format="default" sectionFormat="of" derivedContent="RFC6438"/> feasible.
</t>
        <t indent="0" pn="section-7.1-5">
If an intermediate system cannot determine consistent n-tuples for calculating flow hashes, data streams are more likely to end up being distributed unequally across ECMP and load-shared links.  This may lead to packet drops or reduced performance.
</t>
      </section>
      <section anchor="enforcing-infrastructure-acls" numbered="true" toc="include" removeInRFC="false" pn="section-7.2">
        <name slugifiedName="name-enforcing-infrastructure-ac">Enforcing Infrastructure ACLs</name>
        <t indent="0" pn="section-7.2-1">Infrastructure Access Control Lists (iACLs) drop unwanted packets destined
to a network's infrastructure.  Typically, iACLs are deployed because external direct access to a network's infrastructure addresses is operationally unnecessary and can be used for attacks of different sorts against router
control planes.  To this end, traffic usually needs to be differentiated on the basis of Layer 3
or Layer 4 criteria to achieve a useful balance of protection and functionality.  For example, an infrastructure may be configured with the following policy:
</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-7.2-2">
          <li pn="section-7.2-2.1">Permit some amount of ICMP echo (ping) traffic towards a router's
 addresses for troubleshooting.</li>
          <li pn="section-7.2-2.2">Permit BGP sessions on the shared network of an exchange point (potentially differentiating between the amount of packets/second permitted for established sessions and for connection establishment), but do not permit other traffic from the same peer IP addresses.</li>
        </ul>
        <t indent="0" pn="section-7.2-3">
If a forwarding router cannot determine consistent n-tuples for calculating flow hashes, data streams are more likely to end up being distributed unequally across ECMP and load-shared links.  This may lead to packet drops or reduced performance.
</t>
        <t indent="0" pn="section-7.2-4">
If a network cannot deploy infrastructure ACLs, then the security of the network may be compromised as a result of the increased attack surface.
</t>
      </section>
      <section anchor="ddos-management" numbered="true" toc="include" removeInRFC="false" pn="section-7.3">
        <name slugifiedName="name-ddos-management-and-custome">DDoS Management and Customer Requests for Filtering</name>
        <t indent="0" pn="section-7.3-1">The case of customer Distributed Denial-of-Service (DDoS) protection and edge-to-core customer protection
filters is similar in nature to the iACL protection.  Similar
to iACL protection, Layer 4 ACLs generally need to be applied as close to the
edge of the network as possible, even though the intent is usually to protect the
customer edge rather than the provider core.  Application of Layer 4 DDoS protection
to a network edge is often automated using BGP Flowspec <xref target="RFC8955" format="default" sectionFormat="of" derivedContent="RFC8955"/> <xref target="RFC8956" format="default" sectionFormat="of" derivedContent="RFC8956"/>.
</t>
        <t indent="0" pn="section-7.3-2">For example, a website that normally only handles traffic on TCP ports
80 and 443 could be subject to a volumetric DDoS attack using NTP and DNS
packets with a randomized source IP address, thereby rendering
source-based remote triggered black hole <xref target="RFC5635" format="default" sectionFormat="of" derivedContent="RFC5635"/>
mechanisms useless.  In this situation, ACLs that provide DDoS protection could be configured to
block all UDP traffic at the network edge without impairing the web server
functionality in any way.  Thus, being able to block arbitrary
protocols at the network edge can avoid DDoS-related problems both in the provider
network and on the customer edge link.
</t>
      </section>
      <section anchor="nids" numbered="true" toc="include" removeInRFC="false" pn="section-7.4">
        <name slugifiedName="name-network-intrusion-detection">Network Intrusion Detection and Prevention</name>
        <t indent="0" pn="section-7.4-1">Network Intrusion Detection Systems (NIDS) examine network traffic and try to identify traffic patterns that can be correlated to network-based attacks. These systems generally attempt to inspect application-layer traffic (if possible) but, at the bare minimum, inspect Layer 4 flows. When attack activity is inferred, the operator is notified of the potential intrusion attempt.
</t>
        <t indent="0" pn="section-7.4-2">Network Intrusion Prevention Systems (IPS) operate similarly to NIDSs, but they can also prevent intrusions by reacting to detected attack attempts by e.g., triggering packet filtering policies at firewalls and other devices.</t>
        <t indent="0" pn="section-7.4-3">Use of extension headers can be problematic for NIDS/IPS, since:
</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-7.4-4">
          <li pn="section-7.4-4.1">Extension headers increase the complexity of resulting traffic and the associated work and system requirements to process it.</li>
          <li pn="section-7.4-4.2">Use of unknown extension headers can prevent a NIDS or IPS from processing Layer 4 information.</li>
          <li pn="section-7.4-4.3">Use of IPv6 fragmentation requires a stateful fragment-reassembly operation, even for decoy traffic employing forged source addresses (see, e.g., <xref target="nmap" format="default" sectionFormat="of" derivedContent="nmap"/>).</li>
        </ul>
        <t indent="0" pn="section-7.4-5">As a result, in order to increase the efficiency or effectiveness of these systems, packets employing IPv6 extension headers are often dropped at the network ingress point(s) of networks that deploy these systems.</t>
      </section>
      <section anchor="firewalls" numbered="true" toc="include" removeInRFC="false" pn="section-7.5">
        <name slugifiedName="name-firewalling">Firewalling</name>
        <t indent="0" pn="section-7.5-1">Firewalls enforce security policies by means of packet filtering. These systems usually inspect Layer 3 and Layer 4 traffic but can often also examine application-layer traffic flows.</t>
        <t indent="0" pn="section-7.5-2">As with a NIDS or IPS (<xref target="nids" format="default" sectionFormat="of" derivedContent="Section 7.4"/>), use of IPv6 extension headers can represent a challenge to network firewalls, since:
</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-7.5-3">
          <li pn="section-7.5-3.1">Extension headers increase the complexity of resulting traffic and the associated work and system requirements to process it, as outlined in <xref target="Zack-FW-Benchmark" format="default" sectionFormat="of" derivedContent="Zack-FW-Benchmark"/>.</li>
          <li pn="section-7.5-3.2">Use of unknown extension headers can prevent firewalls from processing Layer 4 information.</li>
          <li pn="section-7.5-3.3">Use of IPv6 fragmentation requires a stateful fragment-reassembly operation, even for decoy traffic employing forged source addresses (see, e.g., <xref target="nmap" format="default" sectionFormat="of" derivedContent="nmap"/>).</li>
        </ul>
        <t indent="0" pn="section-7.5-4">Additionally, a common firewall filtering policy is the so-called "default deny", where all traffic is blocked (by default), and only expected traffic is added to an "allow/accept list".</t>
        <t indent="0" pn="section-7.5-5">As a result, packets employing IPv6 extension headers are often
dropped by network firewalls, either because of the challenges
represented by extension headers or because the use of IPv6 extension
headers has not been explicitly allowed.</t>
        <t indent="0" pn="section-7.5-6">Note that although the data presented in <xref target="Zack-FW-Benchmark" format="default" sectionFormat="of" derivedContent="Zack-FW-Benchmark"/> was several years old at the time of publication of this document, many contemporary firewalls use comparable hardware and software architectures; consequently, the conclusions of this benchmark are still relevant, despite its age.</t>
      </section>
    </section>
    <section anchor="operational-implications" numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-operational-and-security-im">Operational and Security Implications</name>
      <section anchor="inability-layer-4-info" numbered="true" toc="include" removeInRFC="false" pn="section-8.1">
        <name slugifiedName="name-inability-to-find-layer-4-i">Inability to Find Layer 4 Information</name>
        <t indent="0" pn="section-8.1-1">As discussed in <xref target="inability" format="default" sectionFormat="of" derivedContent="Section 7"/>, intermediate systems that need to find the Layer 4 header must process the entire IPv6 header chain.  When such devices are unable to obtain the required information, the forwarding device has the option to drop the packet unconditionally, forward the packet unconditionally, or process the packet outside the normal forwarding path.  Forwarding packets unconditionally will usually allow for the circumvention of security controls (see, e.g., <xref target="firewalls" format="default" sectionFormat="of" derivedContent="Section 7.5"/>), while processing packets outside of the normal forwarding path will usually open the door to Denial-of-Service (DoS) attacks (see, e.g., <xref target="pfe-constraints" format="default" sectionFormat="of" derivedContent="Section 6"/>). Thus, in these scenarios, devices often simply resort to dropping such packets unconditionally.
</t>
      </section>
      <section anchor="route-processor-protection" numbered="true" toc="include" removeInRFC="false" pn="section-8.2">
        <name slugifiedName="name-route-processor-protection">Route-Processor Protection</name>
        <t indent="0" pn="section-8.2-1">Most contemporary carrier-grade routers have a fast hardware-assisted forwarding plane
and a loosely coupled control plane, connected together with a link that
has much less capacity than the forwarding plane could handle.  Traffic
differentiation cannot be performed by the control plane because this would
overload the internal link connecting the forwarding plane to the control
plane.
</t>
        <t indent="0" pn="section-8.2-2">The Hop-by-Hop Options header has been particularly challenging since, in most circumstances, the corresponding packet is punted to the control plane for processing. As a result, many operators drop IPv6 packets containing this extension header <xref target="RFC7872" format="default" sectionFormat="of" derivedContent="RFC7872"/>. <xref target="RFC6192" format="default" sectionFormat="of" derivedContent="RFC6192"/> provides advice regarding protection of a router's control plane.</t>
      </section>
      <section anchor="finer-grained" numbered="true" toc="include" removeInRFC="false" pn="section-8.3">
        <name slugifiedName="name-inability-to-perform-fine-g">Inability to Perform Fine-Grained Filtering</name>
        <t indent="0" pn="section-8.3-1">Some intermediate systems do not have support for fine-grained filtering of IPv6 extension headers. For example, an operator that wishes to drop packets containing RHT0 may only be able to filter on the extension header type (Routing Header). This could result in an operator enforcing a coarser filtering policy (e.g., "drop all packets containing a Routing Header" vs. "only drop packets that contain a Routing Header Type 0").
</t>
      </section>
      <section anchor="security-implications" numbered="true" toc="include" removeInRFC="false" pn="section-8.4">
        <name slugifiedName="name-security-concerns-associate">Security Concerns Associated with IPv6 Extension Headers</name>
        <t indent="0" pn="section-8.4-1">The security implications of IPv6 extension headers generally fall into one or more of these categories:
</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-8.4-2">
          <li pn="section-8.4-2.1">Evasion of security controls</li>
          <li pn="section-8.4-2.2">DoS due to processing requirements</li>
          <li pn="section-8.4-2.3">DoS due to implementation errors</li>
          <li pn="section-8.4-2.4">Issues specific to the extension header type</li>
        </ul>
        <t indent="0" pn="section-8.4-3">Unlike IPv4 packets where the upper-layer protocol can be trivially found by means of the IHL field of the IPv4 header, the structure of IPv6 packets is more flexible and complex.  This can represent a challenge for devices that need to find this information, since locating upper-layer protocol information requires that all IPv6 extension headers be examined. In turn, this presents implementation difficulties, since some packet-filtering mechanisms that require upper-layer information (even if just the upper-layer protocol type) can be trivially circumvented by inserting IPv6 extension headers between the main IPv6 header and the upper-layer protocol header. <xref target="RFC7113" format="default" sectionFormat="of" derivedContent="RFC7113"/> describes this issue for the RA-Guard case, but the same techniques could be employed to circumvent other IPv6 firewall and packet-filtering mechanisms.  Additionally, implementation inconsistencies in packet-forwarding engines can result in evasion of security controls <xref target="I-D.kampanakis-6man-ipv6-eh-parsing" format="default" sectionFormat="of" derivedContent="PARSING"/> <xref target="Atlasis2014" format="default" sectionFormat="of" derivedContent="Atlasis2014"/> <xref target="BH-EU-2014" format="default" sectionFormat="of" derivedContent="BH-EU-2014"/>.
</t>
        <t indent="0" pn="section-8.4-4">Sometimes, packets with IPv6 extension headers can impact throughput performance on intermediate systems. Unless appropriate mitigations are put in place (e.g., packet dropping and/or rate limiting), an attacker could simply send a large amount of IPv6 traffic employing IPv6 extension headers with the purpose of performing a DoS attack (see Sections <xref target="recirculation" format="counter" sectionFormat="of" derivedContent="6.1"/> and <xref target="operational-implications" format="counter" sectionFormat="of" derivedContent="8"/> for further details). The extent to which performance is affected on these devices is implementation dependent.
</t>
        <aside pn="section-8.4-5">
          <t indent="0" pn="section-8.4-5.1">NOTE:</t>
          <t indent="3" pn="section-8.4-5.2">
In the most trivial case, a packet that includes a Hop-by-Hop Options header might go through the slow forwarding path, to be processed by the router's CPU. Alternatively, a router configured to enforce an ACL based on upper-layer information (e.g., upper-layer protocol type or TCP Destination Port) may need to process the entire IPv6 header chain in order to find the required information, thereby causing the packet to be processed in the slow path <xref target="Cisco-EH-Cons" format="default" sectionFormat="of" derivedContent="Cisco-EH-Cons"/>. We note that, for obvious reasons, the aforementioned performance issues can affect devices such as firewalls, NIDSs, etc. <xref target="Zack-FW-Benchmark" format="default" sectionFormat="of" derivedContent="Zack-FW-Benchmark"/>. 
</t>
        </aside>
        <t indent="0" pn="section-8.4-6">IPv6 implementations, like all other software, tend to mature with time and wide-scale deployment. While the IPv6 protocol itself has existed for over 20 years, serious bugs related to IPv6 extension header processing continue to be discovered (see, e.g., <xref target="Cisco-Frag" format="default" sectionFormat="of" derivedContent="Cisco-Frag"/>, <xref target="Microsoft-SA" format="default" sectionFormat="of" derivedContent="Microsoft-SA"/>, and <xref target="FreeBSD-SA" format="default" sectionFormat="of" derivedContent="FreeBSD-SA"/>).  Because there is currently little operational reliance on IPv6 extension headers, the corresponding code paths are rarely exercised, and there is the potential for bugs that still remain to be discovered in some implementations.</t>
        <t indent="0" pn="section-8.4-7">The IPv6 Fragment Header is employed for the fragmentation and reassembly of IPv6 packets. While many of the security implications of the fragmentation/reassembly mechanism are known from the IPv4 world, several related issues have crept into IPv6 implementations. These range from DoS attacks to information leakages, as discussed in <xref target="RFC7739" format="default" sectionFormat="of" derivedContent="RFC7739"/>, <xref target="Bonica-NANOG58" format="default" sectionFormat="of" derivedContent="Bonica-NANOG58"/>, and <xref target="Atlasis2012" format="default" sectionFormat="of" derivedContent="Atlasis2012"/>.
</t>
      </section>
    </section>
    <section anchor="iana-cons" numbered="true" toc="include" removeInRFC="false" pn="section-9">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-9-1">This document has no IANA actions.
</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-10">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-10-1">The security implications of IPv6 extension headers are discussed in <xref target="security-implications" format="default" sectionFormat="of" derivedContent="Section 8.4"/>.  This document does not introduce any new security issues.
</t>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-opsec-ipv6-eh-filtering" to="IPV6-EH"/>
    <displayreference target="I-D.kampanakis-6man-ipv6-eh-parsing" to="PARSING"/>
    <displayreference target="I-D.taylor-v6ops-fragdrop" to="OPERATORS"/>
    <displayreference target="I-D.wkumari-long-headers" to="HEADERS"/>
    <references pn="section-11">
      <name slugifiedName="name-references">References</name>
      <references pn="section-11.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC5095" target="https://www.rfc-editor.org/info/rfc5095" quoteTitle="true" derivedAnchor="RFC5095">
          <front>
            <title>Deprecation of Type 0 Routing Headers in IPv6</title>
            <author initials="J." surname="Abley" fullname="J. Abley">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Savola" fullname="P. Savola">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Neville-Neil" fullname="G. Neville-Neil">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="December"/>
            <abstract>
              <t indent="0">The functionality provided by IPv6's Type 0 Routing Header can be exploited in order to achieve traffic amplification over a remote path for the purposes of generating denial-of-service traffic.  This document updates the IPv6 specification to deprecate the use of IPv6 Type 0 Routing Headers, in light of this security concern.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5095"/>
          <seriesInfo name="DOI" value="10.17487/RFC5095"/>
        </reference>
        <reference anchor="RFC5722" target="https://www.rfc-editor.org/info/rfc5722" quoteTitle="true" derivedAnchor="RFC5722">
          <front>
            <title>Handling of Overlapping IPv6 Fragments</title>
            <author initials="S." surname="Krishnan" fullname="S. Krishnan">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="December"/>
            <abstract>
              <t indent="0">The fragmentation and reassembly algorithm specified in the base IPv6 specification allows fragments to overlap.  This document demonstrates the security issues associated with allowing overlapping  fragments and updates the IPv6 specification to explicitly forbid  overlapping fragments.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5722"/>
          <seriesInfo name="DOI" value="10.17487/RFC5722"/>
        </reference>
        <reference anchor="RFC6946" target="https://www.rfc-editor.org/info/rfc6946" quoteTitle="true" derivedAnchor="RFC6946">
          <front>
            <title>Processing of IPv6 "Atomic" Fragments</title>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="May"/>
            <abstract>
              <t indent="0">The IPv6 specification allows packets to contain a Fragment Header without the packet being actually fragmented into multiple pieces (we refer to these packets as "atomic fragments").  Such packets are typically sent by hosts that have received an ICMPv6 "Packet Too Big" error message that advertises a Next-Hop MTU smaller than 1280 bytes, and are currently processed by some implementations as normal "fragmented traffic" (i.e., they are "reassembled" with any other queued fragments that supposedly correspond to the same original packet).  Thus, an attacker can cause hosts to employ atomic fragments by forging ICMPv6 "Packet Too Big" error messages, and then launch any fragmentation-based attacks against such traffic.  This document discusses the generation of the aforementioned atomic fragments and the corresponding security implications.  Additionally, this document formally updates RFC 2460 and RFC 5722, such that IPv6 atomic fragments are processed independently of any other fragments, thus completely eliminating the aforementioned attack vector.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6946"/>
          <seriesInfo name="DOI" value="10.17487/RFC6946"/>
        </reference>
        <reference anchor="RFC6980" target="https://www.rfc-editor.org/info/rfc6980" quoteTitle="true" derivedAnchor="RFC6980">
          <front>
            <title>Security Implications of IPv6 Fragmentation with IPv6 Neighbor Discovery</title>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="August"/>
            <abstract>
              <t indent="0">This document analyzes the security implications of employing IPv6 fragmentation with Neighbor Discovery (ND) messages.  It updates RFC 4861 such that use of the IPv6 Fragmentation Header is forbidden in all Neighbor Discovery messages, thus allowing for simple and effective countermeasures for Neighbor Discovery attacks.  Finally, it discusses the security implications of using IPv6 fragmentation with SEcure Neighbor Discovery (SEND) and formally updates RFC 3971 to provide advice regarding how the aforementioned security implications can be mitigated.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6980"/>
          <seriesInfo name="DOI" value="10.17487/RFC6980"/>
        </reference>
        <reference anchor="RFC7112" target="https://www.rfc-editor.org/info/rfc7112" quoteTitle="true" derivedAnchor="RFC7112">
          <front>
            <title>Implications of Oversized IPv6 Header Chains</title>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="V." surname="Manral" fullname="V. Manral">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Bonica" fullname="R. Bonica">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="January"/>
            <abstract>
              <t indent="0">The IPv6 specification allows IPv6 Header Chains of an arbitrary size.  The specification also allows options that can, in turn, extend each of the headers.  In those scenarios in which the IPv6 Header Chain or options are unusually long and packets are fragmented, or scenarios in which the fragment size is very small, the First Fragment of a packet may fail to include the entire IPv6 Header Chain.  This document discusses the interoperability and security problems of such traffic, and updates RFC 2460 such that the First Fragment of a packet is required to contain the entire IPv6 Header Chain.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7112"/>
          <seriesInfo name="DOI" value="10.17487/RFC7112"/>
        </reference>
        <reference anchor="RFC8021" target="https://www.rfc-editor.org/info/rfc8021" quoteTitle="true" derivedAnchor="RFC8021">
          <front>
            <title>Generation of IPv6 Atomic Fragments Considered Harmful</title>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Liu" fullname="W. Liu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Anderson" fullname="T. Anderson">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="January"/>
            <abstract>
              <t indent="0">This document discusses the security implications of the generation of IPv6 atomic fragments and a number of interoperability issues associated with IPv6 atomic fragments.  It concludes that the aforementioned functionality is undesirable and thus documents the motivation for removing this functionality from an upcoming revision of the core IPv6 protocol specification (RFC 2460).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8021"/>
          <seriesInfo name="DOI" value="10.17487/RFC8021"/>
        </reference>
        <reference anchor="RFC8200" target="https://www.rfc-editor.org/info/rfc8200" quoteTitle="true" derivedAnchor="RFC8200">
          <front>
            <title>Internet Protocol, Version 6 (IPv6) Specification</title>
            <author initials="S." surname="Deering" fullname="S. Deering">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Hinden" fullname="R. Hinden">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="July"/>
            <abstract>
              <t indent="0">This document specifies version 6 of the Internet Protocol (IPv6). It obsoletes RFC 2460.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="86"/>
          <seriesInfo name="RFC" value="8200"/>
          <seriesInfo name="DOI" value="10.17487/RFC8200"/>
        </reference>
        <reference anchor="RFC8504" target="https://www.rfc-editor.org/info/rfc8504" quoteTitle="true" derivedAnchor="RFC8504">
          <front>
            <title>IPv6 Node Requirements</title>
            <author initials="T." surname="Chown" fullname="T. Chown">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Loughney" fullname="J. Loughney">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Winters" fullname="T. Winters">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="January"/>
            <abstract>
              <t indent="0">This document defines requirements for IPv6 nodes.  It is expected that IPv6 will be deployed in a wide range of devices and situations. Specifying the requirements for IPv6 nodes allows IPv6 to function well and interoperate in a large number of situations and deployments.</t>
              <t indent="0">This document obsoletes RFC 6434, and in turn RFC 4294.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="220"/>
          <seriesInfo name="RFC" value="8504"/>
          <seriesInfo name="DOI" value="10.17487/RFC8504"/>
        </reference>
      </references>
      <references pn="section-11.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="Almeida-2020" target="https://homepages.dcc.ufmg.br/~cunha/papers/almeida20infocom-mca.pdf" quoteTitle="true" derivedAnchor="Almeida-2020">
          <front>
            <title>Classification of Load Balancing in the Internet</title>
            <author fullname="Rafael Almeida" initials="R." surname="Almeida">
              <organization abbrev="UFMG" showOnFrontPage="true"/>
            </author>
            <author fullname="Italo Cunha" initials="I." surname="Cunha">
              <organization abbrev="UFMG" showOnFrontPage="true"/>
            </author>
            <author fullname="Renata Teixeira" initials="R" surname="Teixeira">
              <organization abbrev="INRIA" showOnFrontPage="true"/>
            </author>
            <author fullname="Darryl Veitch" initials="D." surname="Veitch">
              <organization abbrev="UTS" showOnFrontPage="true"/>
            </author>
            <author fullname="Christophe Diot" initials="C." surname="Diot">
              <organization abbrev="Google" showOnFrontPage="true"/>
            </author>
            <date year="2020" month="July"/>
          </front>
          <refcontent>IEEE INFOCOM 2020</refcontent>
          <seriesInfo name="DOI" value="10.1109/INFOCOM41043.2020.9155387"/>
        </reference>
        <reference anchor="APNIC-Scudder" target="https://blog.apnic.net/2020/06/04/modern-router-architecture-and-ipv6/" quoteTitle="true" derivedAnchor="APNIC-Scudder">
          <front>
            <title>Modern router architecture and IPv6</title>
            <author initials="J." surname="Scudder" fullname="John Scudder">
              <organization showOnFrontPage="true">Juniper Networks</organization>
            </author>
            <date year="2020" month="June"/>
          </front>
          <refcontent>APNIC Blog</refcontent>
        </reference>
        <reference anchor="Atlasis2012" target="https://void.gr/kargig/ipv6/bh-eu-12-Atlasis-Attacking_IPv6-Slides.pdf" quoteTitle="true" derivedAnchor="Atlasis2012">
          <front>
            <title>Attacking IPv6 Implementation Using Fragmentation</title>
            <author initials="A." surname="Atlasis" fullname="Antonios Atlasis">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="March" year="2012"/>
          </front>
          <refcontent>Black Hat Europe 2012</refcontent>
        </reference>
        <reference anchor="Atlasis2014" target="http://www.insinuator.net/2014/05/a-novel-way-of-abusing-ipv6-extension-headers-to-evade-ipv6-security-devices/" quoteTitle="true" derivedAnchor="Atlasis2014">
          <front>
            <title>A Novel Way of Abusing IPv6 Extension Headers to Evade IPv6 Security Devices</title>
            <author initials="A." surname="Atlasis" fullname="Antonios Atlasis">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="May" year="2014"/>
          </front>
        </reference>
        <reference anchor="BH-EU-2014" target="https://www.ernw.de/download/eu-14-Atlasis-Rey-Schaefer-briefings-Evasion-of-HighEnd-IPS-Devices-wp.pdf" quoteTitle="true" derivedAnchor="BH-EU-2014">
          <front>
            <title>Evasion of High-End IDPS Devices at the IPv6 Era</title>
            <author initials="A." surname="Atlasis" fullname="Antonios Atlasis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Rey" fullname="Enno Rey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Schaefer" fullname="Rafael Schaefer">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014"/>
          </front>
          <refcontent>Black Hat Europe 2014</refcontent>
        </reference>
        <reference anchor="Bonica-NANOG58" target="https://www.nanog.org/sites/default/files/mon.general.fragmentation.bonica.pdf" quoteTitle="true" derivedAnchor="Bonica-NANOG58">
          <front>
            <title>IPv6 Fragmentation: The Case For Deprecation</title>
            <author initials="R." surname="Bonica" fullname="Ron Bonica">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="June"/>
          </front>
          <refcontent>NANOG 58</refcontent>
        </reference>
        <reference anchor="Cisco-EH-Cons" target="http://www.cisco.com/en/US/technologies/tk648/tk872/technologies_white_paper0900aecd8054d37d.pdf" quoteTitle="true" derivedAnchor="Cisco-EH-Cons">
          <front>
            <title>IPv6 Extension Headers Review and Considerations</title>
            <author>
              <organization showOnFrontPage="true">Cisco</organization>
            </author>
            <date month="October" year="2006"/>
          </front>
        </reference>
        <reference anchor="Cisco-Frag" target="http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150611-iosxr" quoteTitle="true" derivedAnchor="Cisco-Frag">
          <front>
            <title>Cisco IOS XR Software Crafted IPv6 Packet Denial of Service Vulnerability</title>
            <author>
              <organization showOnFrontPage="true">Cisco</organization>
            </author>
            <date month="June" year="2015"/>
          </front>
        </reference>
        <reference anchor="FreeBSD-SA" target="https://www.freebsd.org/security/advisories/FreeBSD-SA-20:24.ipv6.asc" quoteTitle="true" derivedAnchor="FreeBSD-SA">
          <front>
            <title>IPv6 Hop-by-Hop options use-after-free bug</title>
            <author>
              <organization showOnFrontPage="true">The FreeBSD Project</organization>
            </author>
            <date month="September" year="2020"/>
          </front>
        </reference>
        <reference anchor="I-D.wkumari-long-headers" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-wkumari-long-headers-03" derivedAnchor="HEADERS">
          <front>
            <title>Operational Issues Associated With Long IPv6 Header Chains</title>
            <author fullname="Warren Kumari">
	 </author>
            <author fullname="Joel Jaeggli">
	 </author>
            <author fullname="Ronald P Bonica">
	 </author>
            <author fullname="J. Linkova">
	 </author>
            <date month="June" day="16" year="2015"/>
            <abstract>
              <t indent="0">   This memo specifies requirements for IPv6 forwarders as they process
   packets with long header chains.  It also provides guidance for
   application developers whose applications might rely on long headers
   chains.

   As background, this memo explains how many ASIC-based IPv6 forwarders
   process packets and why processing of packets with long header chains
   might be problematic.


              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-wkumari-long-headers-03"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-wkumari-long-headers-03.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="Huston-2017" target="https://blog.apnic.net/2017/08/22/dealing-ipv6-fragmentation-dns/" quoteTitle="true" derivedAnchor="Huston-2017">
          <front>
            <title>Dealing with IPv6 fragmentation in the DNS</title>
            <author fullname="Geoff Huston" initials="G." surname="Huston">
              <organization abbrev="APNIC" showOnFrontPage="true"/>
            </author>
            <date year="2017" month="August"/>
          </front>
          <refcontent>APNIC Blog</refcontent>
        </reference>
        <reference anchor="Huston-2020" target="https://www.cmand.org/workshops/202006-v6/slides/2020-06-16-xtn-hdrs.pdf" quoteTitle="true" derivedAnchor="Huston-2020">
          <front>
            <title>Measurement of IPv6 Extension Header Support</title>
            <author fullname="Geoff Huston" initials="G." surname="Huston">
              <organization abbrev="APNIC" showOnFrontPage="true"/>
            </author>
            <date year="2020" month="June"/>
          </front>
          <refcontent>NPS/CAIDA 2020 Virtual IPv6 Workshop</refcontent>
        </reference>
        <reference anchor="IEPG94-Scudder" target="http://www.iepg.org/2015-11-01-ietf94/IEPG-RouterArchitecture-jgs.pdf" quoteTitle="true" derivedAnchor="IEPG94-Scudder">
          <front>
            <title>Modern Router Architecture for Protocol Designers</title>
            <author initials="B." surname="Petersen" fullname="Brian Petersen">
              <organization showOnFrontPage="true">Juniper Networks</organization>
            </author>
            <author initials="J." surname="Scudder" fullname="John Scudder">
              <organization showOnFrontPage="true">Juniper Networks</organization>
            </author>
            <date year="2015" month="November"/>
          </front>
          <refcontent>IEPG 94</refcontent>
        </reference>
        <reference anchor="I-D.ietf-opsec-ipv6-eh-filtering" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-ietf-opsec-ipv6-eh-filtering-08" derivedAnchor="IPV6-EH">
          <front>
            <title>Recommendations on the Filtering of IPv6 Packets Containing IPv6 Extension Headers at Transit Routers</title>
            <author initials="F" surname="Gont" fullname="Fernando Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W" surname="Liu" fullname="Will Liu">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="June" day="3"/>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-opsec-ipv6-eh-filtering-08"/>
          <format type="TXT" target="https://www.ietf.org/internet-drafts/draft-ietf-opsec-ipv6-eh-filtering-08.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="Jaeggli-2018" target="https://blog.apnic.net/2018/01/11/ipv6-flow-label-misuse-hashing/" quoteTitle="true" derivedAnchor="Jaeggli-2018">
          <front>
            <title>IPv6 flow label: misuse in hashing</title>
            <author fullname="Joel Jaeggli" initials="J." surname="Jaeggli">
    </author>
            <date year="2018" month="January"/>
          </front>
          <refcontent>APNIC Blog</refcontent>
        </reference>
        <reference anchor="Linkova-Gont-IEPG90" target="http://www.iepg.org/2014-07-20-ietf90/iepg-ietf90-ipv6-ehs-in-the-real-world-v2.0.pdf" quoteTitle="true" derivedAnchor="Linkova-Gont-IEPG90">
          <front>
            <title>IPv6 Extension Headers in the Real World v2.0</title>
            <author initials="J." surname="Linkova" fullname="Jen Linkova">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Gont" fullname="Fernando Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="July"/>
          </front>
          <refcontent>IEPG 90</refcontent>
        </reference>
        <reference anchor="Microsoft-SA" target="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-24094" quoteTitle="true" derivedAnchor="Microsoft-SA">
          <front>
            <title>Windows TCP/IP Remote Code Execution Vulnerability</title>
            <author>
              <organization showOnFrontPage="true">Microsoft</organization>
            </author>
            <date month="February" year="2021"/>
          </front>
          <refcontent>CVE-2021-24094</refcontent>
        </reference>
        <reference anchor="nmap" target="https://nmap.org/book/man-bypass-firewalls-ids.html" quoteTitle="true" derivedAnchor="nmap">
          <front>
            <title>Firewall/IDS Evasion and Spoofing</title>
            <author fullname="Gordon 'Fyodor' Lyon" initials="G." surname="Lyon">
            </author>
            <date/>
          </front>
          <refcontent>Chapter 15. Nmap Reference Guide</refcontent>
        </reference>
        <reference anchor="I-D.taylor-v6ops-fragdrop" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-taylor-v6ops-fragdrop-02" derivedAnchor="OPERATORS">
          <front>
            <title>Why Operators Filter Fragments and What It Implies</title>
            <author initials="J" surname="Jaeggli" fullname="Joel Jaeggli">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L" surname="Colitti" fullname="Lorenzo Colitti">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W" surname="Kumari" fullname="Warren Kumari">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E" surname="Vyncke" fullname="Eric Vyncke">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M" surname="Kaeo" fullname="Merike Kaeo">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T" surname="Taylor" fullname="Tom Taylor" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="December" day="3" year="2013"/>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-taylor-v6ops-fragdrop-02"/>
          <format type="TXT" target="http://www.ietf.org/internet-drafts/draft-taylor-v6ops-fragdrop-02.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="I-D.kampanakis-6man-ipv6-eh-parsing" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-kampanakis-6man-ipv6-eh-parsing-01" derivedAnchor="PARSING">
          <front>
            <title>Implementation Guidelines for Parsing IPv6 Extension Headers</title>
            <author initials="P" surname="Kampanakis" fullname="Panos Kampanakis">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="August" day="5" year="2014"/>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-kampanakis-6man-ipv6-eh-parsing-01"/>
          <format type="TXT" target="http://www.ietf.org/internet-drafts/draft-kampanakis-6man-ipv6-eh-parsing-01.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="PMTUD-Blackholes" target="http://www.nlnetlabs.nl/downloads/publications/pmtu-black-holes-msc-thesis.pdf" quoteTitle="true" derivedAnchor="PMTUD-Blackholes">
          <front>
            <title>Discovering Path MTU black holes on the Internet using RIPE Atlas</title>
            <author initials="M." surname="De Boer" fullname="Maikel De Boer">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Bosma" fullname="Jeffrey Bosma">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="July" year="2012"/>
          </front>
          <refcontent>University of Amsterdam, MSc. Systems &amp; Network Engineering</refcontent>
        </reference>
        <reference anchor="RFC2460" target="https://www.rfc-editor.org/info/rfc2460" quoteTitle="true" derivedAnchor="RFC2460">
          <front>
            <title>Internet Protocol, Version 6 (IPv6) Specification</title>
            <author initials="S." surname="Deering" fullname="S. Deering">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Hinden" fullname="R. Hinden">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1998" month="December"/>
            <abstract>
              <t indent="0">This document specifies version 6 of the Internet Protocol (IPv6), also sometimes referred to as IP Next Generation or IPng.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2460"/>
          <seriesInfo name="DOI" value="10.17487/RFC2460"/>
        </reference>
        <reference anchor="RFC5635" target="https://www.rfc-editor.org/info/rfc5635" quoteTitle="true" derivedAnchor="RFC5635">
          <front>
            <title>Remote Triggered Black Hole Filtering with Unicast Reverse Path Forwarding (uRPF)</title>
            <author initials="W." surname="Kumari" fullname="W. Kumari">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="McPherson" fullname="D. McPherson">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="August"/>
            <abstract>
              <t indent="0">Remote Triggered Black Hole (RTBH) filtering is a popular and effective technique for the mitigation of denial-of-service attacks. This document expands upon destination-based RTBH filtering by outlining a method to enable filtering by source address as well.  This  memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5635"/>
          <seriesInfo name="DOI" value="10.17487/RFC5635"/>
        </reference>
        <reference anchor="RFC6192" target="https://www.rfc-editor.org/info/rfc6192" quoteTitle="true" derivedAnchor="RFC6192">
          <front>
            <title>Protecting the Router Control Plane</title>
            <author initials="D." surname="Dugal" fullname="D. Dugal">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Pignataro" fullname="C. Pignataro">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Dunn" fullname="R. Dunn">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="March"/>
            <abstract>
              <t indent="0">This memo provides a method for protecting a router's control plane from undesired or malicious traffic.  In this approach, all legitimate router control plane traffic is identified.  Once legitimate traffic has been identified, a filter is deployed in the router's forwarding plane.  That filter prevents traffic not specifically identified as legitimate from reaching the router's control plane, or rate-limits such traffic to an acceptable level.</t>
              <t indent="0">Note that the filters described in this memo are applied only to traffic that is destined for the router, and not to all traffic that is passing through the router.  This document is not an Internet  Standards Track specification; it is published for informational  purposes.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6192"/>
          <seriesInfo name="DOI" value="10.17487/RFC6192"/>
        </reference>
        <reference anchor="RFC6437" target="https://www.rfc-editor.org/info/rfc6437" quoteTitle="true" derivedAnchor="RFC6437">
          <front>
            <title>IPv6 Flow Label Specification</title>
            <author initials="S." surname="Amante" fullname="S. Amante">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Carpenter" fullname="B. Carpenter">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Jiang" fullname="S. Jiang">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Rajahalme" fullname="J. Rajahalme">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="November"/>
            <abstract>
              <t indent="0">This document specifies the IPv6 Flow Label field and the minimum requirements for IPv6 nodes labeling flows, IPv6 nodes forwarding labeled packets, and flow state establishment methods.  Even when mentioned as examples of possible uses of the flow labeling, more detailed requirements for specific use cases are out of the scope for this document.</t>
              <t indent="0">The usage of the Flow Label field enables efficient IPv6 flow classification based only on IPv6 main header fields in fixed positions.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6437"/>
          <seriesInfo name="DOI" value="10.17487/RFC6437"/>
        </reference>
        <reference anchor="RFC6438" target="https://www.rfc-editor.org/info/rfc6438" quoteTitle="true" derivedAnchor="RFC6438">
          <front>
            <title>Using the IPv6 Flow Label for Equal Cost Multipath Routing and Link Aggregation in Tunnels</title>
            <author initials="B." surname="Carpenter" fullname="B. Carpenter">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Amante" fullname="S. Amante">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="November"/>
            <abstract>
              <t indent="0">The IPv6 flow label has certain restrictions on its use.  This document describes how those restrictions apply when using the flow label for load balancing by equal cost multipath routing and for link aggregation, particularly for IP-in-IPv6 tunneled traffic.   [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6438"/>
          <seriesInfo name="DOI" value="10.17487/RFC6438"/>
        </reference>
        <reference anchor="RFC7045" target="https://www.rfc-editor.org/info/rfc7045" quoteTitle="true" derivedAnchor="RFC7045">
          <front>
            <title>Transmission and Processing of IPv6 Extension Headers</title>
            <author initials="B." surname="Carpenter" fullname="B. Carpenter">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Jiang" fullname="S. Jiang">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="December"/>
            <abstract>
              <t indent="0">Various IPv6 extension headers have been standardised since the IPv6 standard was first published.  This document updates RFC 2460 to clarify how intermediate nodes should deal with such extension headers and with any that are defined in the future.  It also specifies how extension headers should be registered by IANA, with a corresponding minor update to RFC 2780.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7045"/>
          <seriesInfo name="DOI" value="10.17487/RFC7045"/>
        </reference>
        <reference anchor="RFC7098" target="https://www.rfc-editor.org/info/rfc7098" quoteTitle="true" derivedAnchor="RFC7098">
          <front>
            <title>Using the IPv6 Flow Label for Load Balancing in Server Farms</title>
            <author initials="B." surname="Carpenter" fullname="B. Carpenter">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Jiang" fullname="S. Jiang">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Tarreau" fullname="W. Tarreau">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="January"/>
            <abstract>
              <t indent="0">This document describes how the currently specified IPv6 flow label can be used to enhance layer 3/4 (L3/4) load distribution and balancing for large server farms.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7098"/>
          <seriesInfo name="DOI" value="10.17487/RFC7098"/>
        </reference>
        <reference anchor="RFC7113" target="https://www.rfc-editor.org/info/rfc7113" quoteTitle="true" derivedAnchor="RFC7113">
          <front>
            <title>Implementation Advice for IPv6 Router Advertisement Guard (RA-Guard)</title>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="February"/>
            <abstract>
              <t indent="0">The IPv6 Router Advertisement Guard (RA-Guard) mechanism is commonly employed to mitigate attack vectors based on forged ICMPv6 Router Advertisement messages.  Many existing IPv6 deployments rely on RA-Guard as the first line of defense against the aforementioned attack vectors.  However, some implementations of RA-Guard have been found to be prone to circumvention by employing IPv6 Extension Headers. This document describes the evasion techniques that affect the aforementioned implementations and formally updates RFC 6105, such that the aforementioned RA-Guard evasion vectors are eliminated.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7113"/>
          <seriesInfo name="DOI" value="10.17487/RFC7113"/>
        </reference>
        <reference anchor="RFC7739" target="https://www.rfc-editor.org/info/rfc7739" quoteTitle="true" derivedAnchor="RFC7739">
          <front>
            <title>Security Implications of Predictable Fragment Identification Values</title>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="February"/>
            <abstract>
              <t indent="0">IPv6 specifies the Fragment Header, which is employed for the fragmentation and reassembly mechanisms.  The Fragment Header contains an "Identification" field that, together with the IPv6 Source Address and the IPv6 Destination Address of a packet, identifies fragments that correspond to the same original datagram, such that they can be reassembled together by the receiving host. The only requirement for setting the Identification field is that the corresponding value must be different than that employed for any other fragmented datagram sent recently with the same Source Address and Destination Address.  Some implementations use a simple global counter for setting the Identification field, thus leading to predictable Identification values.  This document analyzes the security implications of predictable Identification values, and provides implementation guidance for setting the Identification field of the Fragment Header, such that the aforementioned security implications are mitigated.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7739"/>
          <seriesInfo name="DOI" value="10.17487/RFC7739"/>
        </reference>
        <reference anchor="RFC7872" target="https://www.rfc-editor.org/info/rfc7872" quoteTitle="true" derivedAnchor="RFC7872">
          <front>
            <title>Observations on the Dropping of Packets with IPv6 Extension Headers in the Real World</title>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Linkova" fullname="J. Linkova">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Chown" fullname="T. Chown">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Liu" fullname="W. Liu">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="June"/>
            <abstract>
              <t indent="0">This document presents real-world data regarding the extent to which packets with IPv6 Extension Headers (EHs) are dropped in the Internet (as originally measured in August 2014 and later in June 2015, with similar results) and where in the network such dropping occurs.  The aforementioned results serve as a problem statement that is expected to trigger operational advice on the filtering of IPv6 packets carrying IPv6 EHs so that the situation improves over time.  This document also explains how the results were obtained, such that the corresponding measurements can be reproduced by other members of the community and repeated over time to observe changes in the handling of packets with IPv6 EHs.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7872"/>
          <seriesInfo name="DOI" value="10.17487/RFC7872"/>
        </reference>
        <reference anchor="RFC8900" target="https://www.rfc-editor.org/info/rfc8900" quoteTitle="true" derivedAnchor="RFC8900">
          <front>
            <title>IP Fragmentation Considered Fragile</title>
            <author initials="R." surname="Bonica" fullname="R. Bonica">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Baker" fullname="F. Baker">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Huston" fullname="G. Huston">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Hinden" fullname="R. Hinden">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Troan" fullname="O. Troan">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="September"/>
            <abstract>
              <t indent="0">This document describes IP fragmentation and explains how it introduces fragility to Internet communication.</t>
              <t indent="0">This document also proposes alternatives to IP fragmentation and provides recommendations for developers and network operators.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="230"/>
          <seriesInfo name="RFC" value="8900"/>
          <seriesInfo name="DOI" value="10.17487/RFC8900"/>
        </reference>
        <reference anchor="RFC8955" target="https://www.rfc-editor.org/info/rfc8955" quoteTitle="true" derivedAnchor="RFC8955">
          <front>
            <title>Dissemination of Flow Specification Rules</title>
            <author initials="C." surname="Loibl" fullname="C. Loibl">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Hares" fullname="S. Hares">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Raszuk" fullname="R. Raszuk">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="McPherson" fullname="D. McPherson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Bacher" fullname="M. Bacher">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="December"/>
            <abstract>
              <t indent="0">This document defines a Border Gateway Protocol Network Layer Reachability Information (BGP NLRI) encoding format that can be used to distribute (intra-domain and inter-domain) traffic Flow Specifications for IPv4 unicast and IPv4 BGP/MPLS VPN services. This allows the routing system to propagate information regarding more specific components of the traffic aggregate defined by an IP destination prefix. </t>
              <t indent="0">It also specifies BGP Extended Community encoding formats, which can be used to propagate Traffic Filtering Actions along with the Flow Specification NLRI.  Those Traffic Filtering Actions encode actions a routing system can take if the packet matches the Flow Specification.</t>
              <t indent="0"> This document obsoletes both RFC 5575 and RFC 7674.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8955"/>
          <seriesInfo name="DOI" value="10.17487/RFC8955"/>
        </reference>
        <reference anchor="RFC8956" target="https://www.rfc-editor.org/info/rfc8956" quoteTitle="true" derivedAnchor="RFC8956">
          <front>
            <title>Dissemination of Flow Specification Rules for IPv6</title>
            <author initials="C." surname="Loibl" fullname="C. Loibl" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Raszuk" fullname="R. Raszuk" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Hares" fullname="S. Hares" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="December"/>
            <abstract>
              <t indent="0">"Dissemination of Flow Specification Rules" (RFC 8955) provides a Border Gateway Protocol (BGP) extension for the propagation of traffic flow information for the purpose of rate limiting or filtering IPv4 protocol data packets. </t>
              <t indent="0">This document extends RFC 8955 with IPv6 functionality. It also updates RFC 8955 by changing the IANA Flow Spec Component Types registry.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8956"/>
          <seriesInfo name="DOI" value="10.17487/RFC8956"/>
        </reference>
        <reference anchor="Zack-FW-Benchmark" target="https://www.ipv6hackers.org/files/meetings/ipv6-hackers-1/zack-ipv6hackers1-firewall-security-assessment-and-benchmarking.pdf" quoteTitle="true" derivedAnchor="Zack-FW-Benchmark">
          <front>
            <title abbrev="Firewall Benchmarking">Firewall Security Assessment and Benchmarking IPv6 Firewall Load Tests</title>
            <author initials="E." surname="Zack" fullname="Eldad Zack">
  </author>
            <date year="2013" month="June"/>
          </front>
          <refcontent>IPv6 Hackers Meeting #1</refcontent>
        </reference>
      </references>
    </references>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.a-1">The authors would like to thank (in alphabetical order) <contact fullname="Mikael Abrahamsson"/>, <contact fullname="Fred Baker"/>, <contact fullname="Dale W. Carder"/>, <contact fullname="Brian Carpenter"/>, <contact fullname="Tim Chown"/>, <contact fullname="Owen DeLong"/>, <contact fullname="Gorry Fairhurst"/>, <contact fullname="Guillermo Gont"/>, <contact fullname="Tom Herbert"/>, <contact fullname="Lee Howard"/>, <contact fullname="Tom Petch"/>, <contact fullname="Sander Steffann"/>, <contact fullname="Eduard Vasilenko"/>, <contact fullname="Éric Vyncke"/>, <contact fullname="Rob Wilton"/>, <contact fullname="Jingrong Xie"/>, and <contact fullname="Andrew Yourtchenko"/> for providing valuable comments on earlier draft versions of this document. </t>
      <t indent="0" pn="section-appendix.a-2"><contact fullname="Fernando Gont"/> would like to thank <contact fullname="Jan Zorz"/> / Go6 Lab <eref brackets="angle" target="https://go6lab.si/"/>, <contact fullname="Jared Mauch"/>, and <contact fullname="Sander Steffann"/> <eref brackets="angle" target="https://steffann.nl/"/> for providing access to systems and networks that were employed to perform experiments and measurements involving packets with IPv6 extension headers.</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author fullname="Fernando Gont" initials="F." surname="Gont">
        <organization abbrev="SI6 Networks" showOnFrontPage="true">SI6 Networks</organization>
        <address>
          <postal>
            <street>Segurola y Habana 4310, 7mo Piso</street>
            <city>Villa Devoto</city>
            <region>Ciudad Autonoma de Buenos Aires</region>
            <country>Argentina</country>
          </postal>
          <email>fgont@si6networks.com</email>
          <uri>https://www.si6networks.com</uri>
        </address>
      </author>
      <author fullname="Nick Hilliard" initials="N" surname="Hilliard">
        <organization showOnFrontPage="true">INEX</organization>
        <address>
          <postal>
            <street>4027 Kingswood Road</street>
            <city>Dublin</city>
            <code>24</code>
            <country>Ireland</country>
          </postal>
          <email>nick@inex.ie</email>
        </address>
      </author>
      <author fullname="Gert Doering" initials="G" surname="Doering">
        <organization showOnFrontPage="true">SpaceNet AG</organization>
        <address>
          <postal>
            <street>Joseph-Dollinger-Bogen 14</street>
            <city>Muenchen</city>
            <code>D-80807</code>
            <country>Germany</country>
          </postal>
          <email>gert@space.net</email>
        </address>
      </author>
      <author fullname="Warren Kumari" initials="W." surname="Kumari">
        <organization showOnFrontPage="true">Google</organization>
        <address>
          <postal>
            <street>1600 Amphitheatre Parkway</street>
            <city>Mountain View</city>
            <region>CA</region>
            <code>94043</code>
            <country>US</country>
          </postal>
          <email>warren@kumari.net</email>
        </address>
      </author>
      <author fullname="Geoff Huston" initials="G." surname="Huston">
        <organization abbrev="APNIC" showOnFrontPage="true"/>
        <address>
          <email>gih@apnic.net</email>
          <uri>https://www.apnic.net</uri>
        </address>
      </author>
      <author fullname="Will (Shucheng) Liu" initials="W." surname="Liu">
        <organization showOnFrontPage="true">Huawei Technologies</organization>
        <address>
          <postal>
            <street>Bantian, Longgang District</street>
            <city>Shenzhen</city>
            <code>518129</code>
            <country>China</country>
          </postal>
          <email>liushucheng@huawei.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
