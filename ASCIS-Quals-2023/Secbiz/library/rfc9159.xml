<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-6lo-blemesh-10" indexInclude="true" ipr="trust200902" number="9159" prepTime="2021-12-13T09:35:30" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="4" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-6lo-blemesh-10" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9159" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="IPv6 Mesh over Bluetooth LE">IPv6 Mesh over BLUETOOTH(R) Low Energy Using the Internet Protocol Support Profile (IPSP)</title>
    <seriesInfo name="RFC" value="9159" stream="IETF"/>
    <author initials="C." surname="Gomez" fullname="Carles Gomez">
      <organization abbrev="Universitat Politecnica de Catalunya" showOnFrontPage="true">Universitat Politecnica de Catalunya</organization>
      <address>
        <postal>
          <street>C/Esteve Terradas, 7</street>
          <code>08860</code>
          <city>Castelldefels</city>
          <country>Spain</country>
        </postal>
        <email>carlesgo@entel.upc.edu</email>
      </address>
    </author>
    <author initials="S.M." surname="Darroudi" fullname="Seyed Mahdi Darroudi">
      <organization abbrev="Universitat Politecnica de Catalunya" showOnFrontPage="true">Universitat Politecnica de Catalunya</organization>
      <address>
        <postal>
          <street>C/Esteve Terradas, 7</street>
          <code>08860</code>
          <city>Castelldefels</city>
          <country>Spain</country>
        </postal>
        <email>sm.darroudi@entel.upc.edu</email>
      </address>
    </author>
    <author initials="T." surname="Savolainen" fullname="Teemu Savolainen">
      <organization abbrev="" showOnFrontPage="true">Unaffiliated</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country/>
        </postal>
        <email>tsavo.stds@gmail.com</email>
      </address>
    </author>
    <author initials="M." surname="Spoerk" fullname="Michael Spoerk">
      <organization abbrev="Graz University of Technology" showOnFrontPage="true">Graz University of Technology</organization>
      <address>
        <postal>
          <street>Inffeldgasse 16/I</street>
          <city>Graz</city>
          <code>8010</code>
          <country>Austria</country>
        </postal>
        <email>michael.spoerk@tugraz.at</email>
      </address>
    </author>
    <date month="12" year="2021"/>
    <area>Internet</area>
    <workgroup>6Lo Working Group</workgroup>
    <keyword>Bluetooth Low Energy</keyword>
    <keyword>mesh networks</keyword>
    <keyword>6lowpan</keyword>
    <keyword>IPv6</keyword>
    <keyword>Low power</keyword>
    <keyword>IoT</keyword>
    <keyword>Internet of Things</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
         RFC 7668 describes the adaptation of IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) techniques to enable IPv6 over Bluetooth Low Energy (Bluetooth LE) networks that follow the star topology. 
         However, recent Bluetooth specifications allow the formation of extended topologies as well. This document specifies mechanisms that are needed
         to enable IPv6 mesh over Bluetooth LE links established by using the Bluetooth Internet Protocol Support Profile (IPSP). 
         This document does not specify the routing protocol to be used in an IPv6 mesh over Bluetooth LE links.
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9159" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-terminology-and-requirement">Terminology and Requirements Language</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-bluetooth-le-networks-and-t">Bluetooth LE Networks and the IPSP</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-specification-of-ipv6-mesh-">Specification of IPv6 Mesh over Bluetooth LE Links</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2">
              <li pn="section-toc.1-1.3.2.1">
                <t indent="0" pn="section-toc.1-1.3.2.1.1"><xref derivedContent="3.1" format="counter" sectionFormat="of" target="section-3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-protocol-stack">Protocol Stack</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.2">
                <t indent="0" pn="section-toc.1-1.3.2.2.1"><xref derivedContent="3.2" format="counter" sectionFormat="of" target="section-3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-subnet-model">Subnet Model</xref></t>
              </li>
              <li pn="section-toc.1-1.3.2.3">
                <t indent="0" pn="section-toc.1-1.3.2.3.1"><xref derivedContent="3.3" format="counter" sectionFormat="of" target="section-3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-link-model">Link Model</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.3.2.3.2">
                  <li pn="section-toc.1-1.3.2.3.2.1">
                    <t indent="0" pn="section-toc.1-1.3.2.3.2.1.1"><xref derivedContent="3.3.1" format="counter" sectionFormat="of" target="section-3.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stateless-address-autoconfi">Stateless Address Autoconfiguration</xref></t>
                  </li>
                  <li pn="section-toc.1-1.3.2.3.2.2">
                    <t indent="0" pn="section-toc.1-1.3.2.3.2.2.1"><xref derivedContent="3.3.2" format="counter" sectionFormat="of" target="section-3.3.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-neighbor-discovery">Neighbor Discovery</xref></t>
                  </li>
                  <li pn="section-toc.1-1.3.2.3.2.3">
                    <t indent="0" pn="section-toc.1-1.3.2.3.2.3.1"><xref derivedContent="3.3.3" format="counter" sectionFormat="of" target="section-3.3.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-header-compression">Header Compression</xref></t>
                  </li>
                  <li pn="section-toc.1-1.3.2.3.2.4">
                    <t indent="0" pn="section-toc.1-1.3.2.3.2.4.1"><xref derivedContent="3.3.4" format="counter" sectionFormat="of" target="section-3.3.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-unicast-and-multicast-mappi">Unicast and Multicast Mapping</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t indent="0" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-bluetooth-le-connection-est">Bluetooth LE Connection Establishment Example</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="Appendix B" format="default" sectionFormat="of" target="section-appendix.b"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-node-joining-procedure">Node-Joining Procedure</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.c"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.d"/><xref derivedContent="" format="title" sectionFormat="of" target="name-contributors">Contributors</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.e"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">
        Bluetooth Low Energy (hereinafter, Bluetooth LE) was first introduced
   in the Bluetooth 4.0 specification.  Bluetooth LE (which has been
   marketed as Bluetooth Smart) is a low-power wireless technology
   designed for short-range control and monitoring applications.
   Bluetooth LE is currently implemented in a wide range of consumer
   electronics devices, such as smartphones and wearable devices.  Given
   the high potential of this technology for the Internet of Things, the
   Bluetooth Special Interest Group (Bluetooth SIG) and the IETF have
   produced specifications in order to enable IPv6 over Bluetooth LE,
   such as the Internet Protocol Support Profile (IPSP) <xref target="IPSP" format="default" sectionFormat="of" derivedContent="IPSP"/> and <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668">RFC 7668</xref>, respectively.  
   Bluetooth 4.0 only supports Bluetooth LE
   networks that follow the star topology.  As a consequence, <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668">RFC 7668</xref> was
   specifically developed and optimized for that type of network
   topology.  However, the functionality described in <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668">RFC 7668</xref> is not
   sufficient and would fail to enable an IPv6 mesh over Bluetooth LE links.  This
   document specifies mechanisms that are needed to enable IPv6 mesh over Bluetooth LE links. 
   This document does not specify the routing protocol to be used in an
   IPv6 mesh over Bluetooth LE links. 
 
      </t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-1.1">
        <name slugifiedName="name-terminology-and-requirement">Terminology and Requirements Language</name>
        <t indent="0" pn="section-1.1-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
        <t indent="0" pn="section-1.1-2">
	   The terms "6LoWPAN Node" (6LN), "6LoWPAN Router" (6LR), and "6LoWPAN Border Router" (6LBR) are defined as in <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, with an addition that Bluetooth LE central and Bluetooth LE peripheral (see <xref target="blue" format="default" sectionFormat="of" derivedContent="Section 2"/>) can both be adopted by a 6LN, a 6LR, or a 6LBR.
        </t>
      </section>
    </section>
    <section numbered="true" toc="include" anchor="blue" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-bluetooth-le-networks-and-t">Bluetooth LE Networks and the IPSP</name>
      <t indent="0" pn="section-2-1">
        Bluetooth LE defines two Generic Access Profile (GAP) roles of relevance herein: the Bluetooth LE central role and the Bluetooth LE peripheral role.
In Bluetooth 4.0, a device in the central role, which is called "central" from now on, was able to manage multiple simultaneous connections with a number of devices in the peripheral role,
        called "peripherals" hereinafter. Bluetooth 4.1 (now deprecated) introduced the possibility for a peripheral to be connected to more than one central
        simultaneously, therefore allowing extended topologies beyond the star topology for a Bluetooth LE network <xref target="BTCorev4.1" format="default" sectionFormat="of" derivedContent="BTCorev4.1"/>. In addition, a device may simultaneously
        be a central in a set of link-layer connections, as well as a peripheral in others. 
      </t>
      <t indent="0" pn="section-2-2">
        On the other hand, the IPSP enables discovery of IP-enabled devices 
        and the establishment of a link-layer connection for transporting IPv6 packets. The IPSP defines the Node and Router roles for devices that 
        consume/originate IPv6 packets and for devices that can route IPv6 packets, respectively.
   Consistent with Bluetooth 4.1, Bluetooth 4.2 <xref target="BTCorev4.2" format="default" sectionFormat="of" derivedContent="BTCorev4.2"/>, and subsequent Bluetooth versions, a device may implement both roles simultaneously.
      </t>
      <t indent="0" pn="section-2-3">
        This document assumes a mesh network composed of Bluetooth LE links, where link-layer
   connections are established between neighboring IPv6-enabled
   devices (see <xref target="three-b" format="none" sectionFormat="of" derivedContent="">Section 3.3.2, item 3.b,</xref> and an example in <xref target="Appendix" format="default" sectionFormat="of" derivedContent="Appendix A"/>).  The IPv6 forwarding devices of the mesh have to implement both IPSP Node and Router roles, while simpler leaf-only nodes can implement only the Node role. In an IPv6 mesh over Bluetooth LE links, a node is a
   neighbor of another node, and vice versa, if a link-layer connection
   has been established between both by using the IPSP functionality for
   discovery and link-layer connection establishment for IPv6 packet
   transport.
      </t>
    </section>
    <section numbered="true" toc="include" anchor="spec" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-specification-of-ipv6-mesh-">Specification of IPv6 Mesh over Bluetooth LE Links</name>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-3.1">
        <name slugifiedName="name-protocol-stack">Protocol Stack</name>
        <t indent="0" pn="section-3.1-1">
 	      <xref target="fig_BLEMeshStack" format="default" sectionFormat="of" derivedContent="Figure 1"/> illustrates the protocol stack for IPv6 mesh over Bluetooth LE
   links.  The core Bluetooth LE protocol stack comprises two main sections: the Controller and the Host. The former includes the Physical Layer
   and the Link Layer, whereas the latter is composed of the Logical Link Control and Adaptation Protocol (L2CAP), the Attribute Protocol (ATT), 
   and the Generic Attribute Profile (GATT). The Host and the Controller sections are connected by means of the Host-Controller Interface (HCI). 
   A device that supports the IPSP Node role instantiates one  Internet Protocol Support Service (IPSS), which runs atop GATT. 
   The protocol stack shown in <xref target="fig_BLEMeshStack" format="default" sectionFormat="of" derivedContent="Figure 1"/> shows two main differences with the IPv6 over
	Bluetooth LE stack in <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668"/>:</t>
        <ol type="%c)" indent="adaptive" spacing="normal" start="1" pn="section-3.1-2">
	  <li pn="section-3.1-2.1" derivedCounter="a)">the adaptation layer below IPv6
	  (labeled as "6Lo for IPv6 mesh over Bluetooth LE") is now adapted for
	  IPv6 mesh over Bluetooth LE links, and</li>
          <li pn="section-3.1-2.2" derivedCounter="b)">the protocol stack for IPv6 
	  mesh over Bluetooth LE links includes IPv6 routing functionality.</li>
        </ol>
        <figure anchor="fig_BLEMeshStack" align="left" suppress-title="false" pn="figure-1">
          <name slugifiedName="name-protocol-stack-for-ipv6-mes">Protocol Stack for IPv6 Mesh over Bluetooth LE Links</name>
          <artwork name="" type="" align="left" alt="" pn="section-3.1-3.1">    
                       +------------------------------------+
                       |             Application            |
          +---------+  +------------------------------------+
          |  IPSS   |  |            UDP/TCP/other           |
          +---------+  +------------------------------------+
          |  GATT   |  |             IPv6  |routing|        |
          +---------+  +------------------------------------+
          |  ATT    |  | 6Lo for IPv6 mesh over Bluetooth LE|
          +---------+--+------------------------------------+
          |                 Bluetooth LE L2CAP              |
  HCI - - +-------------------------------------------------+ - - 
          |               Bluetooth LE Link Layer           |
          +-------------------------------------------------+
          |             Bluetooth LE Physical Layer         |
          +-------------------------------------------------+
        </artwork>
        </figure>
        <t indent="0" pn="section-3.1-4">Bluetooth 4.2 defines a default MTU for Bluetooth LE of 251 bytes.  Excluding the L2CAP header of 4 bytes, a protocol data unit (PDU)
   size of 247 bytes is available for the layer above L2CAP. (Note: Earlier Bluetooth LE versions offered a maximum amount of 23 bytes for the layer atop L2CAP.)
   The L2CAP provides a fragmentation and reassembly solution for transmitting or receiving larger PDUs. At each link, the IPSP defines means for 
   negotiating a link-layer connection that provides an MTU of 1280 octets or higher for the IPv6 layer <xref target="IPSP" format="default" sectionFormat="of" derivedContent="IPSP"/>.
   As per the present specification, the MTU size for IPv6 mesh over BLE links is 1280 octets.
        </t>
        <t indent="0" pn="section-3.1-5">
            Similarly to <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668"/>, fragmentation functionality from 6LoWPAN standards is
   not used for IPv6 mesh over Bluetooth LE links. Bluetooth LE's fragmentation support provided 
   by L2CAP is used.   
        </t>
      </section>
      <section anchor="llroles" numbered="true" toc="include" removeInRFC="false" pn="section-3.2">
        <name slugifiedName="name-subnet-model">Subnet Model</name>
        <t indent="0" pn="section-3.2-1">
            For IPv6 mesh over Bluetooth LE links, a multilink model has been
   chosen, as further illustrated in <xref target="fig_SubnetModel" format="default" sectionFormat="of" derivedContent="Figure 2"/>.  As IPv6 over Bluetooth
   LE is intended for constrained nodes and for Internet of Things use
   cases and environments, the complexity of implementing a separate
   subnet on each peripheral-central link and routing between the
   subnets appears to be excessive.  In this specification, the benefits
   of treating the collection of point-to-point links between a central
   and its connected peripherals as a single multilink subnet rather
   than a multiplicity of separate subnets are considered to outweigh
   the multilink model's drawbacks as described in <xref target="RFC4903" format="default" sectionFormat="of" derivedContent="RFC4903"/>. 
   With the multilink subnet model, the routers have to take on the responsibility of tracking the multicast state and forwarding 
   multicast in a loop-free manner.
   Note that the route-over functionality defined in <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>
   is essential to enabling the multilink subnet model for IPv6 mesh over Bluetooth LE links.

      
        </t>
        <figure anchor="fig_SubnetModel" align="left" suppress-title="false" pn="figure-2">
          <name slugifiedName="name-example-of-an-ipv6-mesh-ove">Example of an IPv6 Mesh over a Bluetooth LE Network Connected to the Internet</name>
          <artwork name="" type="" align="left" alt="" pn="section-3.2-2.1">
                                                       /
                                                      /
         6LR           6LN        6LN                /
            \             \          \              /
             \             \          \            /
    6LN ----- 6LR --------- 6LR ------ 6LBR ----- |  Internet
     &lt;--Link--&gt; &lt;---Link---&gt;/&lt;--Link-&gt;/           |      
                           /         /             \
               6LN ---- 6LR ----- 6LR               \
                                                     \
                                                      \

  &lt;------------ Subnet -----------------&gt;&lt;---- IPv6 connection --&gt;
                                               to the Internet
        </artwork>
        </figure>
        <t indent="0" pn="section-3.2-3">
        One or more 6LBRs are connected to the Internet. 6LNs are connected to the network through a 6LR or a 6LBR. 
        Note that in some scenarios and/or for some time intervals, a 6LR may remain at the edge of the network 
        (e.g., the top left node in <xref target="fig_SubnetModel" format="default" sectionFormat="of" derivedContent="Figure 2"/>). This may happen when a 6LR has no neighboring 6LNs.
        A single global unicast prefix is used on the whole subnet.
        </t>
        <t indent="0" pn="section-3.2-4">
        IPv6 mesh over Bluetooth LE links <bcp14>MUST</bcp14> follow a route-over
   approach.  This document does not specify the routing protocol to be
   used in an IPv6 mesh over Bluetooth LE links.

        </t>
      </section>
      <section anchor="deviceaddressing" numbered="true" toc="include" removeInRFC="false" pn="section-3.3">
        <name slugifiedName="name-link-model">Link Model</name>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-3.3.1">
          <name slugifiedName="name-stateless-address-autoconfi">Stateless Address Autoconfiguration</name>
          <t indent="0" pn="section-3.3.1-1">
        6LN, 6LR, and 6LBR IPv6 addresses in an IPv6 mesh over Bluetooth LE links are
   configured as per <xref target="RFC7668" sectionFormat="of" section="3.2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7668#section-3.2.2" derivedContent="RFC7668"/>.
 
          </t>
          <t indent="0" pn="section-3.3.1-2">
        Multihop Duplicate Address Detection (DAD) functionality as defined in <xref target="RFC6775" sectionFormat="of" section="8.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-8.2" derivedContent="RFC6775"/> and updated by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>, or some substitute mechanism (see <xref target="btlemtu" format="default" sectionFormat="of" derivedContent="Section 3.3.2"/>), <bcp14>MAY</bcp14> be supported. 
          </t>
        </section>
        <section anchor="btlemtu" numbered="true" toc="include" removeInRFC="false" pn="section-3.3.2">
          <name slugifiedName="name-neighbor-discovery">Neighbor Discovery</name>
          <t indent="0" pn="section-3.3.2-1">
"<xref target="RFC6775" format="title" sectionFormat="of" derivedContent="Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"/>" <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, subsequently updated 
         by "<xref target="RFC8505" format="title" sectionFormat="of" derivedContent="Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"/>" <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>,
         describes the neighbor discovery functionality adapted for use in several 6LoWPAN topologies, including the mesh topology. 
         The route-over functionality of <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> and <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> <bcp14>MUST</bcp14> be supported. 
          </t>
          <t indent="0" pn="section-3.3.2-2">
        The following aspects of the Neighbor Discovery optimizations for 6LoWPAN <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> are applicable to Bluetooth LE 6LNs: 
          </t>
          <ol indent="adaptive" spacing="normal" start="1" type="1" pn="section-3.3.2-3">
	    <li pn="section-3.3.2-3.1" derivedCounter="1.">
              <t indent="0" pn="section-3.3.2-3.1.1">
        A Bluetooth LE 6LN <bcp14>MUST</bcp14> register its non-link-local addresses with
            its routers by sending a Neighbor Solicitation (NS) message with the Extended Address Registration Option (EARO) and process the
            Neighbor Advertisement (NA) accordingly.  
            The EARO option includes a Registration Ownership Verifier (ROVR) field <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.  In the case of Bluetooth LE, by default, the ROVR field
            is filled with the 48-bit device address used by the Bluetooth LE node converted into 64-bit Modified EUI-64 format <xref target="RFC4291" format="default" sectionFormat="of" derivedContent="RFC4291"/>. 
            Optionally, a cryptographic ID (see <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928">RFC 8928</xref>) <bcp14>MAY</bcp14> be placed in the ROVR field. If a cryptographic ID is used,
            address registration and multihop DAD formats and procedures defined in <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/> <bcp14>MUST</bcp14> be used unless 
            an alternative mechanism offering equivalent protection is used. 
              </t>
              <t indent="0" pn="section-3.3.2-3.1.2"> 
         As per <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>, a 6LN link-local address does not need to be unique in the multilink subnet. A link-local address only needs to be unique
         from the perspective of the two nodes that use it to communicate (e.g., the 6LN and the 6LR in an NS/NA exchange). Therefore, the exchange 
         of Extended Duplicate Address Request (EDAR) and Extended Duplicate Address Confirmation (EDAC) messages between the 6LR and a 6LBR, which ensures that an address is unique across the domain covered by the 6LBR, does not
         need to take place for link-local addresses.
              </t>
              <t indent="0" pn="section-3.3.2-3.1.3">
     If the 6LN registers multiple addresses that are not based on the
   Bluetooth device address using the same compression context, the
   header compression efficiency may decrease, since only the last registered address can be fully elided (see <xref target="RFC7668" sectionFormat="of" section="3.2.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7668#section-3.2.4" derivedContent="RFC7668"/>).
              </t>
            </li>
            <li pn="section-3.3.2-3.2" derivedCounter="2.">
              <t indent="0" pn="section-3.3.2-3.2.1">
     For sending Router Solicitations and processing Router Advertisements, the hosts that participate in an IPv6 mesh over BLE <bcp14>MUST</bcp14>, respectively, follow Sections <xref target="RFC6775" sectionFormat="bare" section="5.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-5.3" derivedContent="RFC6775"/> and <xref target="RFC6775" sectionFormat="bare" section="5.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-5.4" derivedContent="RFC6775"/>
         of <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, and <xref target="RFC8505" sectionFormat="of" section="5.6" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8505#section-5.6" derivedContent="RFC8505"/>. 
              </t>
            </li>
            <li pn="section-3.3.2-3.3" derivedCounter="3.">
              <t indent="0" pn="section-3.3.2-3.3.1">
     The router behavior for 6LRs and 6LBRs is described in <xref target="RFC6775" sectionFormat="of" section="6" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-6" derivedContent="RFC6775"/> and updated by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>. However, as per this specification:
              </t>
              <ol type="a" indent="adaptive" spacing="normal" start="1" pn="section-3.3.2-3.3.2">
         <li pn="section-3.3.2-3.3.2.1" derivedCounter="a.">Routers <bcp14>SHALL NOT</bcp14> use multicast NSs to discover other routers' link-layer addresses.</li>
                <li anchor="three-b" pn="section-3.3.2-3.3.2.2" derivedCounter="b.">As per <xref target="RFC6775" sectionFormat="of" section="6.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-6.2" derivedContent="RFC6775"/>, in a dynamic configuration scenario, a 6LR comes up as a non-router and waits to receive a Router Advertisement 
           for configuring its own interface address first before setting its interfaces to advertising interfaces and turning into a router. 
           In order to support such an operation in an IPv6 mesh over Bluetooth LE links, a 6LR first uses the IPSP Node role only. Once the 6LR has established
           a connection with another node currently running as a router and receives a Router Advertisement from that router, the 6LR configures its own 
           interface address, turns into a router, and runs as an IPSP Router. In contrast with a 6LR, a 6LBR uses the IPSP Router role since the 6LBR
           is initialized; that is, the 6LBR uses both the IPSP Node and IPSP Router roles at all times.  See an example in <xref target="Appendix_B" format="default" sectionFormat="of" derivedContent="Appendix B"/>.</li>
              </ol>
            </li>
            <li pn="section-3.3.2-3.4" derivedCounter="4.">
              <t indent="0" pn="section-3.3.2-3.4.1">
     Border router behavior is described in <xref target="RFC6775" sectionFormat="of" section="7" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-7" derivedContent="RFC6775"/> and updated by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.
              </t>
              <t indent="0" pn="section-3.3.2-3.4.2">
       <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> defines substitutable mechanisms for distributing prefixes and context information (<xref target="RFC6775" sectionFormat="of" section="8.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-8.1" derivedContent="RFC6775"/>), as well as for
       duplicate address detection across a route-over 6LoWPAN (<xref target="RFC6775" sectionFormat="of" section="8.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-8.2" derivedContent="RFC6775"/>). <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> updates those mechanisms and the related message formats.
       Implementations of this specification <bcp14>MUST</bcp14> either support the features described in Sections <xref target="RFC6775" sectionFormat="bare" section="8.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-8.1" derivedContent="RFC6775"/> and <xref target="RFC6775" sectionFormat="bare" section="8.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-8.2" derivedContent="RFC6775"/> of <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, as updated by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>
       or some alternative ("substitute") mechanism. 
              </t>
            </li>
          </ol>
        </section>
        <section anchor="hc" numbered="true" toc="include" removeInRFC="false" pn="section-3.3.3">
          <name slugifiedName="name-header-compression">Header Compression</name>
          <t indent="0" pn="section-3.3.3-1">
        Header compression as defined in RFC 6282 <xref target="RFC6282" format="default" sectionFormat="of" derivedContent="RFC6282"/>, which specifies the compression format for IPv6 datagrams on top of IEEE 802.15.4, is <bcp14>REQUIRED</bcp14> as the basis for IPv6 header compression on top of Bluetooth LE. All headers <bcp14>MUST</bcp14> be compressed according to RFC 6282 <xref target="RFC6282" format="default" sectionFormat="of" derivedContent="RFC6282"/> encoding formats. 
          </t>
          <t indent="0" pn="section-3.3.3-2">
        To enable efficient header compression, when the 6LBR sends a Router Advertisement, it <bcp14>MAY</bcp14> include a 6LoWPAN Context Option (6CO) <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> 
        matching each address prefix advertised via a Prefix Information Option (PIO) <xref target="RFC4861" format="default" sectionFormat="of" derivedContent="RFC4861"/> for use in stateless address autoconfiguration.
        Note that 6CO is not needed for context-based compression when the context is pre-provisioned or provided by out-of-band means
        as, in these cases, the in-band indication (6CO) becomes superfluous.
 
          </t>
          <t indent="0" pn="section-3.3.3-3">
        The specific optimizations of <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668"/> for header compression, which
   exploited the star topology and Address Registration Option (ARO) (note that the latter has been updated by EARO as per <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>), cannot be generalized in an IPv6
   mesh over Bluetooth LE links.  Still, a subset of those optimizations
   can be applied in some cases in such a network.  These cases comprise link-local interactions, non-link-local packet
   transmissions originated by a 6LN (i.e., the first hop from a 6LN), and non-link-local
   packets intended for a 6LN that are originated or forwarded by a neighbor
   of that 6LN (i.e., the last hop toward a 6LN).  For all other packet transmissions, context-based compression <bcp14>MAY</bcp14> be used.
 
          </t>
          <t indent="0" pn="section-3.3.3-4">
        When a device transmits a packet to a neighbor, the sender <bcp14>MUST</bcp14> fully elide the source Interface Identifier (IID) if the source IPv6 address is the link-local address based on the sender's Bluetooth device address (SAC=0, SAM=11). The sender also <bcp14>MUST</bcp14> fully elide the destination IPv6 address if it is the link-local address based on the neighbor's Bluetooth device address (DAC=0, DAM=11). 
          </t>
          <t indent="0" pn="section-3.3.3-5">
        When a 6LN transmits a packet with a non-link-local source address
   that the 6LN has registered with EARO in the next-hop router for the
   indicated prefix, the source address <bcp14>MUST</bcp14> be fully elided if it is
   the latest address that the 6LN has registered for the indicated
   prefix (SAC=1, SAM=11).
   If the source non-link-local address is not
   the latest registered by the 6LN and the first 48 bits of the IID match
   the latest address are registered by the 6LN, then the last 16 bits of the IID
   <bcp14>SHALL</bcp14> be carried inline (SAC=1, SAM=10). Otherwise, if the first 48 bits of the IID do not match,
   then the 64 bits of the IID <bcp14>SHALL</bcp14> be fully carried inline (SAC=1, SAM=01). 

                 
          </t>
          <t indent="0" pn="section-3.3.3-6">
       When a router transmits a packet to a neighboring 6LN with a non-link-local destination address, the router <bcp14>MUST</bcp14> fully elide the
   destination IPv6 address if the destination address is the latest
   registered by the 6LN with EARO for the indicated context (DAC=1,
   DAM=11).  If the destination address is a non-link-local address and
   not the latest registered and if the first 48 bits of the IID match those of the latest registered address,
   then the last 16 bits of the IID <bcp14>SHALL</bcp14> be carried inline (DAC=1, DAM=10). Otherwise, if the first 48 bits of the IID do not match,
   then the 64 bits of the IID <bcp14>SHALL</bcp14> be fully carried in-line (DAC=1, DAM=01).
          </t>
        </section>
        <section numbered="true" toc="include" removeInRFC="false" pn="section-3.3.4">
          <name slugifiedName="name-unicast-and-multicast-mappi">Unicast and Multicast Mapping</name>
          <t indent="0" pn="section-3.3.4-1">
     The Bluetooth LE Link Layer does not support multicast.  Hence,
   traffic is always unicast between two Bluetooth LE neighboring nodes.  
   If a node needs to send a multicast packet to several neighbors, it has 
   to replicate the packet and unicast it on each link.  However, this may 
   not be energy efficient, and particular care must be taken if the node 
   is battery powered.  A router (i.e., a 6LR or a 6LBR) <bcp14>MUST</bcp14> keep track
   of neighboring multicast listeners, and it <bcp14>MUST NOT</bcp14> forward multicast 
   packets to neighbors that have not registered as listeners for multicast groups to which the packets are destined.
          </t>
        </section>
      </section>
    </section>
    <section anchor="IANA" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-4-1">
      This document has no IANA actions.
      </t>
    </section>
    <section anchor="Security" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-5-1">
      The security considerations in <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668"/> apply.
      </t>
      <t indent="0" pn="section-5-2">
     IPv6 mesh over BLE requires a routing protocol to
   find end-to-end paths.  Unfortunately, the routing protocol may
   generate additional opportunities for threats and attacks to the
   network.

      </t>
      <t indent="0" pn="section-5-3">
     <xref target="RFC7416" format="default" sectionFormat="of" derivedContent="RFC7416">RFC 7416</xref> provides a systematic overview of threats and
   attacks on the IPv6 Routing Protocol for Low-Power and Lossy Networks
   (RPL), as well as countermeasures. In that document, described threats and attacks comprise threats due to failures to authenticate, threats due to failure to keep routing information, threats and attacks on integrity, and threats and attacks on availability. Reported countermeasures comprise
confidentiality attack, integrity attack, and availability attack countermeasures.
      </t>
      <t indent="0" pn="section-5-4">
     While this specification does not
   state the routing protocol to be used in IPv6 mesh over Bluetooth LE
   links, the guidance of <xref target="RFC7416" format="default" sectionFormat="of" derivedContent="RFC7416"/> is useful when RPL is used in
   such scenarios.  Furthermore, such guidance may partly apply for
   other routing protocols as well.
      </t>
      <t indent="0" pn="section-5-5">
     The ROVR can be derived from the Bluetooth device address.  However, such a ROVR can be
   spoofed; therefore, any node connected to the subnet and aware of
   a registered-address-to-ROVR mapping could perform address theft and
   impersonation attacks. Use of Address Protected Neighbor Discovery <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/> provides protection
   against such attacks.
      </t>
    </section>
  </middle>
  <back>
    <references pn="section-6">
      <name slugifiedName="name-references">References</name>
      <references pn="section-6.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="BTCorev4.2" target="https://www.bluetooth.com/specifications/specs/core-specification-4-2/" quoteTitle="true" derivedAnchor="BTCorev4.2">
          <front>
            <title>Core Specification 4.2</title>
            <author>
              <organization showOnFrontPage="true">Bluetooth</organization>
            </author>
            <date year="2014" month="December" day="2"/>
          </front>
        </reference>
        <reference anchor="IPSP" target="https://www.bluetooth.com/specifications/specs/internet-protocol-support-profile-1-0/" quoteTitle="true" derivedAnchor="IPSP">
          <front>
            <title>Internet Protocol Support Profile 1.0</title>
            <author>
              <organization showOnFrontPage="true">Bluetooth</organization>
            </author>
            <date year="2014" month="December" day="16"/>
          </front>
        </reference>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC4291" target="https://www.rfc-editor.org/info/rfc4291" quoteTitle="true" derivedAnchor="RFC4291">
          <front>
            <title>IP Version 6 Addressing Architecture</title>
            <author initials="R." surname="Hinden" fullname="R. Hinden">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Deering" fullname="S. Deering">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="February"/>
            <abstract>
              <t indent="0">This specification defines the addressing architecture of the IP Version 6 (IPv6) protocol.  The document includes the IPv6 addressing model, text representations of IPv6 addresses, definition of IPv6 unicast addresses, anycast addresses, and multicast addresses, and an IPv6 node's required addresses.</t>
              <t indent="0">This document obsoletes RFC 3513, "IP Version 6 Addressing Architecture".   [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4291"/>
          <seriesInfo name="DOI" value="10.17487/RFC4291"/>
        </reference>
        <reference anchor="RFC4861" target="https://www.rfc-editor.org/info/rfc4861" quoteTitle="true" derivedAnchor="RFC4861">
          <front>
            <title>Neighbor Discovery for IP version 6 (IPv6)</title>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Nordmark" fullname="E. Nordmark">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Simpson" fullname="W. Simpson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Soliman" fullname="H. Soliman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="September"/>
            <abstract>
              <t indent="0">This document specifies the Neighbor Discovery protocol for IP Version 6.  IPv6 nodes on the same link use Neighbor Discovery to discover each other's presence, to determine each other's link-layer addresses, to find routers, and to maintain reachability information about the paths to active neighbors.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4861"/>
          <seriesInfo name="DOI" value="10.17487/RFC4861"/>
        </reference>
        <reference anchor="RFC6282" target="https://www.rfc-editor.org/info/rfc6282" quoteTitle="true" derivedAnchor="RFC6282">
          <front>
            <title>Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks</title>
            <author initials="J." surname="Hui" fullname="J. Hui" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Thubert" fullname="P. Thubert">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="September"/>
            <abstract>
              <t indent="0">This document updates RFC 4944, "Transmission of IPv6 Packets over IEEE 802.15.4 Networks".  This document specifies an IPv6 header compression format for IPv6 packet delivery in Low Power Wireless Personal Area Networks (6LoWPANs).  The compression format relies on shared context to allow compression of arbitrary prefixes.  How the information is maintained in that shared context is out of scope. This document specifies compression of multicast addresses and a framework for compressing next headers.  UDP header compression is specified within this framework.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6282"/>
          <seriesInfo name="DOI" value="10.17487/RFC6282"/>
        </reference>
        <reference anchor="RFC6775" target="https://www.rfc-editor.org/info/rfc6775" quoteTitle="true" derivedAnchor="RFC6775">
          <front>
            <title>Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)</title>
            <author initials="Z." surname="Shelby" fullname="Z. Shelby" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Chakrabarti" fullname="S. Chakrabarti">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Nordmark" fullname="E. Nordmark">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Bormann" fullname="C. Bormann">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="November"/>
            <abstract>
              <t indent="0">The IETF work in IPv6 over Low-power Wireless Personal Area Network (6LoWPAN) defines 6LoWPANs such as IEEE 802.15.4.  This and other similar link technologies have limited or no usage of multicast signaling due to energy conservation.  In addition, the wireless network may not strictly follow the traditional concept of IP subnets and IP links.  IPv6 Neighbor Discovery was not designed for non- transitive wireless links, as its reliance on the traditional IPv6 link concept and its heavy use of multicast make it inefficient and sometimes impractical in a low-power and lossy network.  This document describes simple optimizations to IPv6 Neighbor Discovery, its addressing mechanisms, and duplicate address detection for Low- power Wireless Personal Area Networks and similar networks.  The document thus updates RFC 4944 to specify the use of the optimizations defined here.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6775"/>
          <seriesInfo name="DOI" value="10.17487/RFC6775"/>
        </reference>
        <reference anchor="RFC7668" target="https://www.rfc-editor.org/info/rfc7668" quoteTitle="true" derivedAnchor="RFC7668">
          <front>
            <title>IPv6 over BLUETOOTH(R) Low Energy</title>
            <author initials="J." surname="Nieminen" fullname="J. Nieminen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Savolainen" fullname="T. Savolainen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Isomaki" fullname="M. Isomaki">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Patil" fullname="B. Patil">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Z." surname="Shelby" fullname="Z. Shelby">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Gomez" fullname="C. Gomez">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="October"/>
            <abstract>
              <t indent="0">Bluetooth Smart is the brand name for the Bluetooth low energy feature in the Bluetooth specification defined by the Bluetooth Special Interest Group.  The standard Bluetooth radio has been widely implemented and available in mobile phones, notebook computers, audio headsets, and many other devices.  The low-power version of Bluetooth is a specification that enables the use of this air interface with devices such as sensors, smart meters, appliances, etc.  The low-power variant of Bluetooth has been standardized since revision 4.0 of the Bluetooth specifications, although version 4.1 or newer is required for IPv6.  This document describes how IPv6 is transported over Bluetooth low energy using IPv6 over Low-power Wireless Personal Area Network (6LoWPAN) techniques.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7668"/>
          <seriesInfo name="DOI" value="10.17487/RFC7668"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8505" target="https://www.rfc-editor.org/info/rfc8505" quoteTitle="true" derivedAnchor="RFC8505">
          <front>
            <title>Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery</title>
            <author initials="P." surname="Thubert" fullname="P. Thubert" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Nordmark" fullname="E. Nordmark">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Chakrabarti" fullname="S. Chakrabarti">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Perkins" fullname="C. Perkins">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="November"/>
            <abstract>
              <t indent="0">This specification updates RFC 6775 -- the Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery specification -- to clarify the role of the protocol as a registration technique and simplify the registration operation in 6LoWPAN routers, as well as to provide enhancements to the registration capabilities and mobility detection for different network topologies, including the Routing Registrars performing routing for host routes and/or proxy Neighbor Discovery in a low-power network.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8505"/>
          <seriesInfo name="DOI" value="10.17487/RFC8505"/>
        </reference>
        <reference anchor="RFC8928" target="https://www.rfc-editor.org/info/rfc8928" quoteTitle="true" derivedAnchor="RFC8928">
          <front>
            <title>Address-Protected Neighbor Discovery for Low-Power and Lossy Networks</title>
            <author initials="P." surname="Thubert" fullname="P. Thubert" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Sarikaya" fullname="B. Sarikaya">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Sethi" fullname="M. Sethi">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Struik" fullname="R. Struik">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="November"/>
            <abstract>
              <t indent="0">This document updates the IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery (ND) protocol defined in RFCs 6775 and 8505.  The new extension is called Address-Protected Neighbor Discovery (AP-ND), and it protects the owner of an address against address theft and impersonation attacks in a Low-Power and Lossy Network (LLN).  Nodes supporting this extension compute a cryptographic identifier (Crypto-ID), and use it with one or more of their Registered Addresses. The Crypto-ID identifies the owner of the Registered Address and can be used to provide proof of ownership of the Registered Addresses. Once an address is registered with the Crypto-ID and a proof of ownership is provided, only the owner of that address can modify the registration information, thereby enforcing Source Address Validation.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8928"/>
          <seriesInfo name="DOI" value="10.17487/RFC8928"/>
        </reference>
      </references>
      <references pn="section-6.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="BTCorev4.1" target="https://www.bluetooth.com/specifications/specs/core-specification-4-1/" quoteTitle="true" derivedAnchor="BTCorev4.1">
          <front>
            <title>Core Specification 4.1</title>
            <author>
              <organization showOnFrontPage="true">Bluetooth</organization>
            </author>
            <date year="2013" month="December" day="3"/>
          </front>
        </reference>
        <reference anchor="RFC4903" target="https://www.rfc-editor.org/info/rfc4903" quoteTitle="true" derivedAnchor="RFC4903">
          <front>
            <title>Multi-Link Subnet Issues</title>
            <author initials="D." surname="Thaler" fullname="D. Thaler">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="June"/>
            <abstract>
              <t indent="0">There have been several proposals around the notion that a subnet may span multiple links connected by routers.  This memo documents the issues and potential problems that have been raised with such an approach.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4903"/>
          <seriesInfo name="DOI" value="10.17487/RFC4903"/>
        </reference>
        <reference anchor="RFC7416" target="https://www.rfc-editor.org/info/rfc7416" quoteTitle="true" derivedAnchor="RFC7416">
          <front>
            <title>A Security Threat Analysis for the Routing Protocol for Low-Power and Lossy Networks (RPLs)</title>
            <author initials="T." surname="Tsao" fullname="T. Tsao">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Alexander" fullname="R. Alexander">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Dohler" fullname="M. Dohler">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="V." surname="Daza" fullname="V. Daza">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Lozano" fullname="A. Lozano">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Richardson" fullname="M. Richardson" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="January"/>
            <abstract>
              <t indent="0">This document presents a security threat analysis for the Routing Protocol for Low-Power and Lossy Networks (RPLs).  The development builds upon previous work on routing security and adapts the assessments to the issues and constraints specific to low-power and lossy networks.  A systematic approach is used in defining and evaluating the security threats.  Applicable countermeasures are application specific and are addressed in relevant applicability statements.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7416"/>
          <seriesInfo name="DOI" value="10.17487/RFC7416"/>
        </reference>
      </references>
    </references>
    <section anchor="Appendix" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-bluetooth-le-connection-est">Bluetooth LE Connection Establishment Example</name>
      <t indent="0" pn="section-appendix.a-1">
      This appendix provides an example of Bluetooth LE connection establishment and use of IPSP roles in an IPv6 mesh over BLE that uses dynamic configuration. The example follows text in <xref target="three-b" format="none" sectionFormat="of" derivedContent="">Section 3.3.2, item 3.b</xref>. 
      </t>
      <t indent="0" pn="section-appendix.a-2">
      The example assumes a network with one 6LBR, two 6LRs, and three 6LNs, as shown in <xref target="fig_Appendix" format="default" sectionFormat="of" derivedContent="Figure 3"/>. Connectivity between the 6LNs and the 6LBR is only possible via the 6LRs.
      </t>
      <t indent="0" pn="section-appendix.a-3">
      The following text describes the different steps in the example as time evolves. Note that other sequences of events that may lead to the same final scenario are also possible.
      </t>
      <t indent="0" pn="section-appendix.a-4">
      At the beginning, the 6LBR starts running as an IPSP router, whereas the rest of devices are not yet initialized (<xref target="step1" format="none" sectionFormat="of" derivedContent="">Step 1</xref>). Next, the 6LRs start running as IPSP nodes, i.e., they use Bluetooth LE advertisement packets to announce their presence and support of IPv6 capabilities (<xref target="step2" format="none" sectionFormat="of" derivedContent="">Step 2</xref>). 
      The 6LBR (already running as an IPSP router) discovers the presence of the 6LRs and establishes one Bluetooth LE connection with each 6LR (<xref target="step3" format="none" sectionFormat="of" derivedContent="">Step 3</xref>). After establishment of those link-layer connections (and after reception of Router Advertisements from the 6LBR),  
      the 6LRs start operating as routers and also initiate the IPSP Router role (<xref target="step4" format="none" sectionFormat="of" derivedContent="">Step 4</xref>). (Note: whether the IPSP Node role is kept running simultaneously is an implementation decision). Then, 6LNs start running the IPSP Node role (<xref target="step5" format="none" sectionFormat="of" derivedContent="">Step 5</xref>). 
      Finally, the 6LRs discover the presence of the 6LNs and establish connections with the latter (<xref target="step6" format="none" sectionFormat="of" derivedContent="">Step 6</xref>).
      </t>
      <figure anchor="fig_Appendix" align="left" suppress-title="false" pn="figure-3">
        <name slugifiedName="name-example-of-connection-estab">Example of Connection Establishment and Use of IPSP Roles in an IPv6 Mesh over Bluetooth LE Links</name>
        <artwork anchor="step1" name="" type="" align="left" alt="" pn="section-appendix.a-5.1">    
Step 1
******
                                     6LBR
                                (IPSP: Router)
	

                           6LR                 6LR
                   (not initialized)     (not initialized)



             6LN                 6LN                  6LN
    (not initialized)      (not initialized)     (not initialized)
</artwork>
        <artwork anchor="step2" name="" type="" align="left" alt="" pn="section-appendix.a-5.2">    
Step 2
******
                                     6LBR
                                (IPSP: Router)
	
 
                           6LR                 6LR
                      (IPSP: Node)         (IPSP: Node)



             6LN                 6LN                  6LN
    (not initialized)      (not initialized)     (not initialized)

</artwork>
        <artwork anchor="step3" name="" type="" align="left" alt="" pn="section-appendix.a-5.3">    
Step 3
******

                                     6LBR
                                (IPSP: Router)
  Bluetooth LE connection --&gt;   /            \  			
                               /              \ 
                           6LR                 6LR
                      (IPSP: Node)         (IPSP: Node)



             6LN                 6LN                  6LN
    (not initialized)      (not initialized)     (not initialized)

</artwork>
        <artwork anchor="step4" name="" type="" align="left" alt="" pn="section-appendix.a-5.4">    
Step 4
******

                                     6LBR
                                (IPSP: Router)
	                        /            \  			
                               /              \ 
                           6LR                 6LR
                      (IPSP: Router)      (IPSP: Router)



             6LN                 6LN                  6LN
    (not initialized)      (not initialized)     (not initialized)
</artwork>
        <artwork anchor="step5" name="" type="" align="left" alt="" pn="section-appendix.a-5.5">    
Step 5
******

                                     6LBR
                                (IPSP: Router)
	                        /            \  			
                               /              \ 
                           6LR                 6LR
                      (IPSP: Router)      (IPSP: Router)



             6LN                   6LN                6LN
         (IPSP: Node)         (IPSP: Node)        (IPSP: Node)
</artwork>
        <artwork anchor="step6" name="" type="" align="left" alt="" pn="section-appendix.a-5.6">    
Step 6
******

                                     6LBR
                                (IPSP: Router)
	                        /            \  			
                               /              \ 
                           6LR                 6LR
                     (IPSP: Router)       (IPSP: Router) 
                      /           \       /            \
                     /             \     /              \
                    /               \   /                \
                 6LN                 6LN                  6LN
            (IPSP: Node)         (IPSP: Node)         (IPSP: Node)
        </artwork>
      </figure>
    </section>
    <section anchor="Appendix_B" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.b">
      <name slugifiedName="name-node-joining-procedure">Node-Joining Procedure</name>
      <t indent="0" pn="section-appendix.b-1">
      This appendix provides a diagram that illustrates the node-joining procedure. First of all, the joining node advertises its presence in order to allow establishment of Bluetooth LE connections with neighbors that already belong to a network. The neighbors typically run as a 6LR or as a 6LBR. After Bluetooth LE connection establishment, the joining node starts acting as a 6LN. 
      </t>
      <t indent="0" pn="section-appendix.b-2"><xref target="fig_AppendixB" format="default" sectionFormat="of" derivedContent="Figure 4"/> shows the sequence of messages that are exchanged by the 6LN and a neighboring 6LR that already belongs to the network after the establishment of a Bluetooth LE connection between both devices. Initially, the 6LN sends a Router Solicitation (RS) message (1). Then, the 6LR replies 
      with an RA, which includes the PIO (2). After discovering the non-link-local prefix in use in the network, the 6LN creates its non-link-local address and registers that address with EARO (3) in the 6LR, and then multihop DAD is performed (4).
      The next step is the transmission of the NA message sent by the 6LR in response to the NS previously sent by the 6LN (5). 
      If the non-link-local address of the 6LN has been successfully validated, the 6LN can operate as a member of the network it has joined.  
      </t>
      <figure anchor="fig_AppendixB" align="left" suppress-title="false" pn="figure-4">
        <name slugifiedName="name-message-exchange-diagram-fo">Message Exchange Diagram for a Joining Node</name>
        <artwork name="" type="" align="left" alt="" pn="section-appendix.b-3.1">
            (1)   		6LN ----(RS)-------&gt; 6LR
            (2)   		6LN &lt;---(RA-PIO)---- 6LR
            (3)   		6LN ----(NS-EARO)--&gt; 6LR
            (4)	                [Multihop DAD procedure] 
            (5)	          	6LN &lt;---(NA)-------- 6LR
        </artwork>
      </figure>
    </section>
    <section anchor="Acknowledgements" numbered="false" toc="include" removeInRFC="false" pn="section-appendix.c">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.c-1">
      The Bluetooth, Bluetooth Smart, and Bluetooth Smart Ready marks are registered trademarks owned by Bluetooth SIG, Inc.
      </t>
      <t indent="0" pn="section-appendix.c-2">
      The authors of this document are grateful to all authors of <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668"/>, since this document borrows many concepts (albeit with necessary extensions) from <xref target="RFC7668" format="default" sectionFormat="of" derivedContent="RFC7668"/>. 
      </t>
      <t indent="0" pn="section-appendix.c-3">
      The authors also thank  <contact fullname="Alain Michaud"/>,  <contact fullname="Mark Powell"/>,  <contact fullname="Martin Turon"/>,  <contact fullname="Bilhanan Silverajan"/>,  <contact fullname="Rahul Jadhav"/>,  <contact fullname="Pascal Thubert"/>,  <contact fullname="Acee Lindem"/>,  <contact fullname="Catherine Meadows"/>, 
      and  <contact fullname="Dominique Barthel"/> for their reviews and comments, which helped improve the document.
</t>
      <t indent="0" pn="section-appendix.c-4">
       <contact fullname="Carles Gomez"/> has been supported in part by the Spanish Government Ministerio de Economia y Competitividad through projects TEC2012-32531, 
      TEC2016-79988-P, PID2019-106808RA-I00, and FEDER and Secretaria d'Universitats i Recerca del Departament d'Empresa i Coneixement de la Generalitat
      de Catalunya 2017 through grant SGR 376.
      </t>
    </section>
    <section anchor="Contrib" numbered="false" toc="include" removeInRFC="false" pn="section-appendix.d">
      <name slugifiedName="name-contributors">Contributors</name>
      <t indent="0" pn="section-appendix.d-1">
      <contact fullname="Carlo Alberto Boano"/> (Graz University of Technology) contributed to the design and validation of this document. 
      </t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.e">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author initials="C." surname="Gomez" fullname="Carles Gomez">
        <organization abbrev="Universitat Politecnica de Catalunya" showOnFrontPage="true">Universitat Politecnica de Catalunya</organization>
        <address>
          <postal>
            <street>C/Esteve Terradas, 7</street>
            <code>08860</code>
            <city>Castelldefels</city>
            <country>Spain</country>
          </postal>
          <email>carlesgo@entel.upc.edu</email>
        </address>
      </author>
      <author initials="S.M." surname="Darroudi" fullname="Seyed Mahdi Darroudi">
        <organization abbrev="Universitat Politecnica de Catalunya" showOnFrontPage="true">Universitat Politecnica de Catalunya</organization>
        <address>
          <postal>
            <street>C/Esteve Terradas, 7</street>
            <code>08860</code>
            <city>Castelldefels</city>
            <country>Spain</country>
          </postal>
          <email>sm.darroudi@entel.upc.edu</email>
        </address>
      </author>
      <author initials="T." surname="Savolainen" fullname="Teemu Savolainen">
        <organization abbrev="" showOnFrontPage="true">Unaffiliated</organization>
        <address>
          <postal>
            <street/>
            <city/>
            <code/>
            <country/>
          </postal>
          <email>tsavo.stds@gmail.com</email>
        </address>
      </author>
      <author initials="M." surname="Spoerk" fullname="Michael Spoerk">
        <organization abbrev="Graz University of Technology" showOnFrontPage="true">Graz University of Technology</organization>
        <address>
          <postal>
            <street>Inffeldgasse 16/I</street>
            <city>Graz</city>
            <code>8010</code>
            <country>Austria</country>
          </postal>
          <email>michael.spoerk@tugraz.at</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
