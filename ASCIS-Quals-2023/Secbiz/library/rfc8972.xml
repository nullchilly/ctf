<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-ippm-stamp-option-tlv-10" indexInclude="true" ipr="trust200902" number="8972" prepTime="2021-01-21T20:29:01" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" updates="8762" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-ippm-stamp-option-tlv-10" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc8972" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="STAMP Extensions">Simple Two-Way Active Measurement Protocol Optional Extensions</title>
    <seriesInfo name="RFC" value="8972" stream="IETF"/>
    <author fullname="Greg Mirsky" initials="G." surname="Mirsky">
      <organization showOnFrontPage="true">ZTE Corp.</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country/>
        </postal>
        <email>gregimirsky@gmail.com</email>
      </address>
    </author>
    <author fullname="Xiao Min" initials="X." surname="Min">
      <organization showOnFrontPage="true">ZTE Corp.</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country/>
        </postal>
        <email>xiao.min2@zte.com.cn</email>
      </address>
    </author>
    <author fullname="Henrik Nydell" initials="H." surname="Nydell">
      <organization showOnFrontPage="true">Accedian Networks</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country/>
        </postal>
        <email>hnydell@accedian.com</email>
      </address>
    </author>
    <author initials="R." surname="Foote" fullname="Richard Foote">
      <organization showOnFrontPage="true">Nokia</organization>
      <address>
        <email>footer.foote@nokia.com</email>
      </address>
    </author>
    <author initials="A." surname="Masputra" fullname="Adi Masputra">
      <organization showOnFrontPage="true">Apple Inc.</organization>
      <address>
        <postal>
          <street>One Apple Park Way</street>
          <city>Cupertino</city>
          <region>CA</region>
          <code>95014</code>
          <country>United States of America</country>
        </postal>
        <email>adi@apple.com</email>
      </address>
    </author>
    <author fullname="Ernesto Ruffini" initials="E." surname="Ruffini">
      <organization showOnFrontPage="true">OutSys</organization>
      <address>
        <postal>
          <street>via Caracciolo, 65</street>
          <city>Milan</city>
          <code>20155</code>
          <country>Italy</country>
        </postal>
        <email>eruffini@outsys.org</email>
      </address>
    </author>
    <date month="01" year="2021"/>
    <area>Transport</area>
    <workgroup>IPPM</workgroup>
    <keyword>IPPM</keyword>
    <keyword>Performance Measurement</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
	This document describes optional extensions to Simple
	Two-way Active Measurement Protocol (STAMP) that enable
	measurement of performance metrics. The document also defines
	a STAMP Test Session Identifier and thus updates RFC 8762.
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc8972" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-conventions-used-in-this-do">Conventions Used in This Document</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2">
              <li pn="section-toc.1-1.2.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.1.1"><xref derivedContent="2.1" format="counter" sectionFormat="of" target="section-2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-acronyms">Acronyms</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.2.1"><xref derivedContent="2.2" format="counter" sectionFormat="of" target="section-2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-language">Requirements Language</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stamp-test-session-identifi">STAMP Test Session Identifier</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tlv-extensions-to-stamp">TLV Extensions to STAMP</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extra-padding-tlv">Extra Padding TLV</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-location-tlv">Location TLV</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.2.2">
                  <li pn="section-toc.1-1.4.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.1.1"><xref derivedContent="4.2.1" format="counter" sectionFormat="of" target="section-4.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-location-sub-tlvs">Location Sub-TLVs</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.2.2.2">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.2.1"><xref derivedContent="4.2.2" format="counter" sectionFormat="of" target="section-4.2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-theory-of-operation-of-loca">Theory of Operation of Location TLV</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-timestamp-information-tlv">Timestamp Information TLV</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.4">
                <t indent="0" pn="section-toc.1-1.4.2.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-class-of-service-tlv">Class of Service TLV</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.5">
                <t indent="0" pn="section-toc.1-1.4.2.5.1"><xref derivedContent="4.5" format="counter" sectionFormat="of" target="section-4.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-direct-measurement-tlv">Direct Measurement TLV</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.6">
                <t indent="0" pn="section-toc.1-1.4.2.6.1"><xref derivedContent="4.6" format="counter" sectionFormat="of" target="section-4.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-access-report-tlv">Access Report TLV</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.7">
                <t indent="0" pn="section-toc.1-1.4.2.7.1"><xref derivedContent="4.7" format="counter" sectionFormat="of" target="section-4.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-follow-up-telemetry-tlv">Follow-Up Telemetry TLV</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.8">
                <t indent="0" pn="section-toc.1-1.4.2.8.1"><xref derivedContent="4.8" format="counter" sectionFormat="of" target="section-4.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-hmac-tlv">HMAC TLV</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stamp-tlv-types-subregistry">STAMP TLV Types Subregistry</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stamp-tlv-flags-subregistry">STAMP TLV Flags Subregistry</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t indent="0" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stamp-sub-tlv-types-subregi">STAMP Sub-TLV Types Subregistry</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.4">
                <t indent="0" pn="section-toc.1-1.5.2.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stamp-synchronization-sourc">STAMP Synchronization Sources Subregistry</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.5">
                <t indent="0" pn="section-toc.1-1.5.2.5.1"><xref derivedContent="5.5" format="counter" sectionFormat="of" target="section-5.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stamp-timestamping-methods-">STAMP Timestamping Methods Subregistry</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.6">
                <t indent="0" pn="section-toc.1-1.5.2.6.1"><xref derivedContent="5.6" format="counter" sectionFormat="of" target="section-5.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-stamp-return-codes-subregis">STAMP Return Codes Subregistry</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t indent="0" pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.2">
                <t indent="0" pn="section-toc.1-1.7.2.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-contributors">Contributors</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.c"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="intro" numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">
The Simple Two-way Active Measurement Protocol (STAMP) <xref target="RFC8762" format="default" sectionFormat="of" derivedContent="RFC8762"/> defines the STAMP base functionalities.
This document specifies the use of
optional extensions that use Type-Length-Value (TLV) encoding.
Such extensions enhance the STAMP base functions,
   such as measurement of one-way and round-trip delay,
   latency, packet loss, packet duplication, and
   out-of-order delivery of test packets. This specification defines
optional STAMP extensions, their formats, and the theory of operation.
Also, a STAMP Test Session Identifier is defined
as an update of the base STAMP specification <xref target="RFC8762" format="default" sectionFormat="of" derivedContent="RFC8762"/>.
      </t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-conventions-used-in-this-do">Conventions Used in This Document</name>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1">
        <name slugifiedName="name-acronyms">Acronyms</name>
        <dl newline="false" indent="12" spacing="normal" pn="section-2.1-1">
          <dt pn="section-2.1-1.1">BDS</dt>
          <dd pn="section-2.1-1.2">BeiDou Navigation Satellite System</dd>
          <dt pn="section-2.1-1.3">BITS</dt>
          <dd pn="section-2.1-1.4">Building Integrated Timing Supply</dd>
          <dt pn="section-2.1-1.5">CoS</dt>
          <dd pn="section-2.1-1.6">Class of Service</dd>
          <dt pn="section-2.1-1.7">DSCP</dt>
          <dd pn="section-2.1-1.8">Differentiated Services Code Point</dd>
          <dt pn="section-2.1-1.9">ECN</dt>
          <dd pn="section-2.1-1.10">Explicit Congestion Notification</dd>
          <dt pn="section-2.1-1.11">GLONASS</dt>
          <dd pn="section-2.1-1.12">Global Orbiting Navigation Satellite System</dd>
          <dt pn="section-2.1-1.13">GPS</dt>
          <dd pn="section-2.1-1.14">Global Positioning System <xref target="GPS" format="default" sectionFormat="of" derivedContent="GPS"/></dd>
          <dt pn="section-2.1-1.15">HMAC</dt>
          <dd pn="section-2.1-1.16">Hashed Message Authentication Code</dd>
          <dt pn="section-2.1-1.17">LORAN-C</dt>
          <dd pn="section-2.1-1.18">Long Range Navigation System Version C</dd>
          <dt pn="section-2.1-1.19">MBZ</dt>
          <dd pn="section-2.1-1.20">Must Be Zero</dd>
          <dt pn="section-2.1-1.21">NTP</dt>
          <dd pn="section-2.1-1.22">Network Time Protocol <xref target="RFC5905" format="default" sectionFormat="of" derivedContent="RFC5905"/></dd>
          <dt pn="section-2.1-1.23">PMF</dt>
          <dd pn="section-2.1-1.24">Performance Measurement Function</dd>
          <dt pn="section-2.1-1.25">PTP</dt>
          <dd pn="section-2.1-1.26">Precision Time Protocol <xref target="IEEE.1588.2008" format="default" sectionFormat="of" derivedContent="IEEE.1588.2008"/></dd>
          <dt pn="section-2.1-1.27">RP</dt>
          <dd pn="section-2.1-1.28">Reverse Path</dd>
          <dt pn="section-2.1-1.29">SMI</dt>
          <dd pn="section-2.1-1.30">Structure of Management Information</dd>
          <dt pn="section-2.1-1.31">SSID</dt>
          <dd pn="section-2.1-1.32">STAMP Session Identifier</dd>
          <dt pn="section-2.1-1.33">SSU</dt>
          <dd pn="section-2.1-1.34">Synchronization Supply Unit</dd>
          <dt pn="section-2.1-1.35">STAMP</dt>
          <dd pn="section-2.1-1.36">Simple Two-way Active Measurement Protocol</dd>
          <dt pn="section-2.1-1.37">TLV</dt>
          <dd pn="section-2.1-1.38">Type-Length-Value</dd>
        </dl>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.2">
        <name slugifiedName="name-requirements-language">Requirements Language</name>
        <t indent="0" pn="section-2.2-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      </section>
    </section>
    <section anchor="test-identifier-sec" numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-stamp-test-session-identifi">STAMP Test Session Identifier</name>
      <t indent="0" pn="section-3-1">
The STAMP Session-Sender transmits test packets to the STAMP Session-Reflector. The STAMP Session-Reflector
receives the Session-Sender's packet and acts according to the configuration and optional control information
communicated in the Session-Sender's test packet. STAMP defines two different test packet formats: one for
   packets transmitted by the STAMP Session-Sender and one for packets
   transmitted by the STAMP Session-Reflector. STAMP supports two modes:
   unauthenticated and authenticated. Unauthenticated STAMP test packets
   are compatible on the wire with unauthenticated TWAMP-Test <xref target="RFC5357" format="default" sectionFormat="of" derivedContent="RFC5357"/>
   packets.
</t>
      <t indent="0" pn="section-3-2">
By default, STAMP uses symmetrical packets, i.e., the size of the packet
transmitted by the Session-Reflector equals the size of
the packet received by the Session-Reflector.
</t>
      <t indent="0" pn="section-3-3">
  A STAMP Session is identified by the 4-tuple (source and destination IP addresses,
  source and destination UDP port numbers). A STAMP Session-Sender
  <bcp14>MAY</bcp14> generate a locally unique STAMP Session Identifier (SSID).
  The SSID is a two-octet, non-zero unsigned integer. The SSID generation
   policy is implementation specific. <xref target="I-D.irtf-pearg-numeric-ids-generation" format="default" sectionFormat="of" derivedContent="NUM-IDS-GEN"/> thoroughly analyzes common algorithms for identifier generation and their vulnerabilities.
   For example, an implementation can use the algorithms described in <xref target="I-D.irtf-pearg-numeric-ids-generation" sectionFormat="of" section="7.1" format="default" derivedLink="https://tools.ietf.org/html/draft-irtf-pearg-numeric-ids-generation-06#section-7.1" derivedContent="NUM-IDS-GEN"/>.
   An implementation <bcp14>MUST NOT</bcp14> assign the same identifier to different STAMP test sessions.
  A Session-Sender <bcp14>MAY</bcp14> use the SSID to identify
  a STAMP test session. If the SSID is used, it <bcp14>MUST</bcp14> be present in each test packet of the given test session.
  In the unauthenticated mode, the SSID is located as displayed in <xref target="session-sender-unauthenticated-format" format="default" sectionFormat="of" derivedContent="Figure 1"/>.
      </t>
      <figure anchor="session-sender-unauthenticated-format" align="left" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-the-format-of-an-extended-s">The Format of an Extended STAMP Session-Sender Test Packet in Unauthenticated Mode</name>
        <artwork name="" type="" align="left" alt="" pn="section-3-4.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Timestamp                            |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Error Estimate        |             SSID              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                                                               |
   |                         MBZ (28 octets)                       |
   |                                                               |
   |                                                               |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            TLVs                               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
      </figure>
      <t indent="0" pn="section-3-5">
  An implementation of the STAMP Session-Reflector that supports this specification <bcp14>MUST</bcp14>
   identify a STAMP Session using the SSID in combination with elements of the usual 4-tuple
   for the session. Before a test session commences, a Session-Reflector <bcp14>MUST</bcp14> be provisioned
   with all the elements that identify the STAMP Session. A STAMP Session-Reflector <bcp14>MUST</bcp14> discard
   non-matching STAMP test packets. The means of provisioning the STAMP Session identification
   is outside the scope of this specification.

   A conforming implementation of a STAMP Session-Reflector <bcp14>MUST</bcp14> copy
  the SSID value from the received test packet and put it into the reflected packet,
  as displayed in <xref target="session-reflector-unauthenticated-format" format="default" sectionFormat="of" derivedContent="Figure 2"/>.
      </t>
      <figure anchor="session-reflector-unauthenticated-format" align="left" suppress-title="false" pn="figure-2">
        <name slugifiedName="name-the-format-of-an-extended-st">The Format of an Extended STAMP Session-Reflector Test Packet in Unauthenticated Mode</name>
        <artwork name="" type="" align="left" alt="" pn="section-3-6.1">
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sequence Number                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Timestamp                            |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Error Estimate        |           SSID                |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Receive Timestamp                    |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                 Session-Sender Sequence Number                |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                  Session-Sender Timestamp                     |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | Session-Sender Error Estimate |           MBZ                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |Ses-Sender TTL |                   MBZ                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                            TLVs                               ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
      </figure>
      <t indent="0" pn="section-3-7">
        A STAMP Session-Reflector that does not support this specification
will return the zeroed SSID field in the reflected STAMP test packet.
 The Session-Sender <bcp14>MAY</bcp14> stop the session if it receives a zeroed SSID field. An implementation
 of a Session-Sender <bcp14>MUST</bcp14> support control of its behavior in such a scenario.
 If the test session is not stopped, the Session-Sender can, for example,
 send a base STAMP packet <xref target="RFC8762" format="default" sectionFormat="of" derivedContent="RFC8762"/> or continue transmitting STAMP test packets with the SSID.
</t>
      <t indent="0" pn="section-3-8">
 The location of the SSID field in the authenticated mode
  is shown in Figures <xref target="session-sender-authenticated-format" format="counter" sectionFormat="of" derivedContent="3"/> and <xref target="session-reflector-authenticated-format" format="counter" sectionFormat="of" derivedContent="4"/>.
      </t>
      <figure anchor="session-sender-authenticated-format" align="left" suppress-title="false" pn="figure-3">
        <name slugifiedName="name-the-format-of-an-extended-sta">The Format of an Extended STAMP Session-Sender Test Packet in Authenticated Mode</name>
        <artwork name="" type="" align="left" alt="" pn="section-3-9.1">
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                      Sequence Number                          |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                      MBZ (12 octets)                          |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Timestamp                              |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |        Error Estimate         |            SSID               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                                                               ~
 |                         MBZ (68 octets)                       |
 ~                                                               ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                       HMAC (16 octets)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                            TLVs                               ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
      </figure>
      <figure anchor="session-reflector-authenticated-format" align="left" suppress-title="false" pn="figure-4">
        <name slugifiedName="name-the-format-of-an-extended-stam">The Format of an Extended STAMP Session-Reflector Test Packet in Authenticated Mode</name>
        <artwork name="" type="" align="left" alt="" pn="section-3-10.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        MBZ (12 octets)                        |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Timestamp                            |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Error Estimate        |            SSID               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        MBZ (4 octets)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Receive Timestamp                      |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        MBZ (8 octets)                         |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Session-Sender Sequence Number                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        MBZ (12 octets)                        |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Session-Sender Timestamp                      |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Session-Sender Error Estimate |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
   |                        MBZ (6 octets)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Ses-Sender TTL |                                               |
   +-+-+-+-+-+-+-+-+                                               +
   |                                                               |
   |                        MBZ (15 octets)                        |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        HMAC (16 octets)                       |
   |                                                               |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            TLVs                               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  </artwork>
      </figure>
    </section>
    <section anchor="stamp-extension-section" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-tlv-extensions-to-stamp">TLV Extensions to STAMP</name>
      <t indent="0" pn="section-4-1">
The Type-Length-Value (TLV) encoding scheme provides a flexible
extension mechanism for optional informational elements.
 TLV is an optional field in the STAMP test packet. Multiple TLVs
 <bcp14>MAY</bcp14> be placed in a STAMP test packet. Additional TLVs
may be enclosed within a given TLV, subject to the semantics of the
(outer) TLV in question.
 TLVs have a one-octet STAMP TLV Flags field, a one-octet Type field, and
  a two-octet Length field that is equal to the length of the Value field in octets.
   If a Type value for a TLV or sub-TLV is in the range for
   Private Use <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>, the length <bcp14>MUST</bcp14> be at least 4, and the first four octets
   <bcp14>MUST</bcp14> be that vendor's Structure of
   Management Information (SMI) Private Enterprise Code, as recorded in
   IANA's "SMI Network Management Private Enterprise Codes" subregistry, in network octet
   order. The rest of the Value field is private to the vendor.
The following sections describe the use of TLVs for STAMP
that extend the STAMP capability beyond its base specification.
      </t>
      <figure anchor="tlv-format" align="left" suppress-title="false" pn="figure-5">
        <name slugifiedName="name-tlv-format-in-a-stamp-exten">TLV Format in a STAMP Extended Packet</name>
        <artwork name="" type="" align="left" alt="" pn="section-4-2.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |STAMP TLV Flags|     Type      |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            Value                              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
      </figure>
      <t indent="0" pn="section-4-3">
       The fields are defined as follows:
      </t>
      <dl spacing="normal" newline="false" indent="3" pn="section-4-4">
        <dt pn="section-4-4.1">STAMP TLV Flags:</dt>
        <dd pn="section-4-4.2">An eight-bit field. The detailed format and interpretation of flags defined in this specification are below.</dd>
        <dt pn="section-4-4.3">Type:</dt>
        <dd pn="section-4-4.4">A one-octet field that characterizes the interpretation of
        the Value field. It is allocated by IANA, as specified in <xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>.</dd>
        <dt pn="section-4-4.5">Length:</dt>
        <dd pn="section-4-4.6">A two-octet field equal to the length of the Value field in octets.</dd>
        <dt pn="section-4-4.7">Value:</dt>
        <dd pn="section-4-4.8">A variable-length field. Its interpretation and encoding are determined by the value of the Type field.</dd>
      </dl>
      <t indent="0" pn="section-4-5">
       All multi-byte fields in TLVs defined in this specification are in network byte order.
      </t>
      <t indent="0" pn="section-4-6">
The format of the STAMP TLV Flags is displayed in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>, and the location of flags is defined in <xref target="iana-tlv-flags-reg" format="default" sectionFormat="of" derivedContent="Section 5.2"/>.
      </t>
      <figure anchor="tlv-flags-format" align="left" suppress-title="false" pn="figure-6">
        <name slugifiedName="name-stamp-tlv-flags-format">STAMP TLV Flags Format</name>
        <artwork name="" type="" align="left" alt="" pn="section-4-7.1">
    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |U|M|I|R|R|R|R|R|
   +-+-+-+-+-+-+-+-+
</artwork>
      </figure>
      <t indent="0" pn="section-4-8">
      The fields are defined as follows:
      </t>
      <dl newline="false" spacing="normal" indent="3" pn="section-4-9">
        <dt pn="section-4-9.1">U (Unrecognized):</dt>
        <dd pn="section-4-9.2">A one-bit flag.
        A Session-Sender <bcp14>MUST</bcp14> set the U flag to 1 before transmitting an extended STAMP test packet.
        A Session-Reflector <bcp14>MUST</bcp14> set the U flag to 1 if the Session-Reflector has not understood the TLV.
        Otherwise, the Session-Reflector <bcp14>MUST</bcp14> set the U flag in the reflected packet to 0.</dd>
        <dt pn="section-4-9.3">M (Malformed):</dt>
        <dd pn="section-4-9.4">A one-bit flag.
        A Session-Sender <bcp14>MUST</bcp14> set the M flag to 0 before transmitting an extended STAMP test packet.
        A Session-Reflector <bcp14>MUST</bcp14> set the M flag to 1 if the Session-Reflector determined the TLV is malformed,
        i.e., the Length field value is not valid for the particular type, or
        the remaining length of the extended STAMP packet is less than the size of the TLV.
        Otherwise, the Session-Reflector <bcp14>MUST</bcp14> set the M flag in the reflected packet to 0.
        </dd>
        <dt pn="section-4-9.5">I (Integrity):</dt>
        <dd pn="section-4-9.6">A one-bit flag.
        A Session-Sender <bcp14>MUST</bcp14> set the I flag to 0 before transmitting an extended STAMP test packet.
        A Session-Reflector <bcp14>MUST</bcp14> set the I flag to 1 if the STAMP extensions have failed HMAC verification (<xref target="hmac-sec" format="default" sectionFormat="of" derivedContent="Section 4.8"/>).
        Otherwise, the Session-Reflector <bcp14>MUST</bcp14> set the I flag in the reflected packet to 0.</dd>
        <dt pn="section-4-9.7">R:</dt>
        <dd pn="section-4-9.8">Reserved flags for future use. These flags <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.</dd>
      </dl>
      <t indent="0" pn="section-4-10">
A STAMP node, whether Session-Sender or Session-Reflector, receiving a test packet <bcp14>MUST</bcp14>
determine whether the packet is a base STAMP packet or whether it includes one or more TLVs.
The node <bcp14>MUST</bcp14> compare the value in the Length field of the UDP header and
the length of the base STAMP test packet in the mode, unauthenticated or authenticated, based
on the configuration of the particular STAMP test session. If the difference between the two values is
greater than the length of the UDP header, then the test packet includes one or more STAMP TLVs
that immediately follow the base STAMP test packet.
A Session-Reflector that does not support STAMP extensions will not process but
copy them into the reflected packet, as defined in <xref target="RFC8762" sectionFormat="of" section="4.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8762#section-4.3" derivedContent="RFC8762"/>.
A Session-Reflector that supports TLVs will indicate specific TLVs that
it did not process by setting the U flag to 1 in those TLVs.
</t>
      <t indent="0" pn="section-4-11">
A STAMP Session-Sender that has received a reflected STAMP test packet with extension TLVs <bcp14>MUST</bcp14> validate each TLV:
</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4-12">
        <li pn="section-4-12.1">
If the U flag is set, the STAMP system <bcp14>MUST</bcp14> skip the processing of the TLV.
</li>
        <li pn="section-4-12.2">
If the M flag is set, the STAMP system <bcp14>MUST</bcp14> stop processing the remainder of the extended STAMP packet.
</li>
        <li pn="section-4-12.3">
If the I flag is set, the STAMP system <bcp14>MUST</bcp14> discard all TLVs and
<bcp14>MUST</bcp14> stop processing the remainder of the extended STAMP packet.
</li>
        <li pn="section-4-12.4">
If an implementation of a Session-Reflector does not recognize the Type field value,
it <bcp14>MUST</bcp14> include a copy of the TLV in the reflected STAMP packet.
The Session-Reflector <bcp14>MUST</bcp14> set the U flag to 1.
The Session-Reflector <bcp14>MUST</bcp14> skip the processing of the unrecognized TLV.
 </li>
        <li pn="section-4-12.5">
If a TLV is malformed, the processing of extension TLVs <bcp14>MUST</bcp14> be
stopped. The Session-Reflector <bcp14>MUST</bcp14> copy the remainder of the received extended STAMP packet into the reflected STAMP packet.
The Session-Reflector <bcp14>MUST</bcp14> set the M flag to 1.
</li>
      </ul>
      <t indent="0" pn="section-4-13">
</t>
      <section anchor="padding-tlv-section" numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-extra-padding-tlv">Extra Padding TLV</name>
        <figure anchor="padding-tlv-figuret" align="left" suppress-title="false" pn="figure-7">
          <name slugifiedName="name-extra-padding-tlv-2">Extra Padding TLV</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.1-1.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                         Extra Padding                         ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-4.1-2"> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" newline="false" indent="3" pn="section-4.1-3">
          <dt pn="section-4.1-3.1">STAMP TLV Flags:</dt>
          <dd pn="section-4.1-3.2">An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</dd>
          <dt pn="section-4.1-3.3">Type:</dt>
          <dd pn="section-4.1-3.4">A one-octet field. Value 1 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>).</dd>
          <dt pn="section-4.1-3.5">Length:</dt>
          <dd pn="section-4.1-3.6">A two-octet field equal to the length of the Extra Padding field in octets.</dd>
          <dt pn="section-4.1-3.7">Extra Padding:</dt>
          <dd pn="section-4.1-3.8">This field <bcp14>SHOULD</bcp14> be filled by a sequence of pseudorandom numbers. The field <bcp14>MAY</bcp14> be filled with all zeros.
       An implementation <bcp14>MUST</bcp14> control the content of the Extra Padding field.</dd>
        </dl>
        <t indent="0" pn="section-4.1-4">
  The Extra Padding TLV is similar to the Packet Padding field in a TWAMP-Test packet <xref target="RFC5357" format="default" sectionFormat="of" derivedContent="RFC5357"/>.
  The use of the Extra Padding TLV is <bcp14>RECOMMENDED</bcp14> to perform a STAMP test using 
  test packets that are larger than the base STAMP packet
  <xref target="RFC8762" format="default" sectionFormat="of" derivedContent="RFC8762"/>. The length of the base STAMP packet is 44 octets
  in the unauthenticated mode or 112 octets in the authenticated mode.
  The Extra Padding TLV <bcp14>MAY</bcp14> be present more than one time in an extended STAMP test packet.
        </t>
      </section>
      <section anchor="location-info-section" numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-location-tlv">Location TLV</name>
        <t indent="0" pn="section-4.2-1">
  STAMP Session-Senders <bcp14>MAY</bcp14> include the variable-size Location TLV to query location information from the Session-Reflector.
  The Session-Sender <bcp14>MUST NOT</bcp14> fill any information fields except for the STAMP TLV Flags, Type, and Length fields.
  The Session-Reflector <bcp14>MUST</bcp14> verify that the TLV is well formed. If it is not, the Session-Reflector follows the procedure defined in <xref target="stamp-extension-section" format="default" sectionFormat="of" derivedContent="Section 4"/>
  for a malformed TLV.
        </t>
        <figure anchor="location-tlv-figuret" align="left" suppress-title="false" pn="figure-8">
          <name slugifiedName="name-location-tlv-2">Location TLV</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.2-2.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Destination Port       |          Source Port          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                         Sub-TLVs                              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-4.2-3"> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" newline="false" indent="3" pn="section-4.2-4">
          <dt pn="section-4.2-4.1">STAMP TLV Flags:</dt>
          <dd pn="section-4.2-4.2">An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</dd>
          <dt pn="section-4.2-4.3">Type:</dt>
          <dd pn="section-4.2-4.4">A one-octet field. Value 2 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>).</dd>
          <dt pn="section-4.2-4.5">Length:</dt>
          <dd pn="section-4.2-4.6">A two-octet field equal to the length of the Value field in octets.</dd>
          <dt pn="section-4.2-4.7">Destination Port:</dt>
          <dd pn="section-4.2-4.8">A two-octet UDP destination port number of the received STAMP packet.</dd>
          <dt pn="section-4.2-4.9">Source Port:</dt>
          <dd pn="section-4.2-4.10">A two-octet UDP source port number of the received STAMP packet.</dd>
          <dt pn="section-4.2-4.11">Sub-TLVs:</dt>
          <dd pn="section-4.2-4.12">A sequence of sub-TLVs, as defined further in this section. The sub-TLVs are used by the
        Session-Sender to request location information with generic sub-TLV types, and the
        Session-Reflector responds with the corresponding more-specific sub-TLVs
        for the type of address (e.g., IPv4 or IPv6) used at the Session-Reflector.</dd>
        </dl>
        <t indent="0" pn="section-4.2-5">Note that all fields not filled by either a Session-Sender or Session-Reflector are transmitted with all bits set to zero.</t>
        <section anchor="location-sub-tlv-sec" numbered="true" toc="include" removeInRFC="false" pn="section-4.2.1">
          <name slugifiedName="name-location-sub-tlvs">Location Sub-TLVs</name>
          <t indent="0" pn="section-4.2.1-1">
  A sub-TLV in the Location TLV uses the format displayed in <xref target="tlv-format" format="default" sectionFormat="of" derivedContent="Figure 5"/>.
  Handling of the U and M flags in the sub-TLV is as defined in <xref target="stamp-extension-section" format="default" sectionFormat="of" derivedContent="Section 4"/>.
  The I flag <bcp14>MUST</bcp14> be set by a Session-Sender and Session-Reflector to 0 before transmission and its value ignored on receipt.
  The following types of sub-TLVs for the Location TLV are defined in this specification
  (<xref target="sub-tlv-type-tbl" format="default" sectionFormat="of" derivedContent="Table 5"/> lists the Type values):
          </t>
          <dl newline="false" spacing="normal" indent="3" pn="section-4.2.1-2">
            <dt pn="section-4.2.1-2.1">Source MAC Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.2">A 12-octet sub-TLV.
  The Type value is 1.
  The value of the Length field <bcp14>MUST</bcp14> be equal to 8.
  The Value field is an 8-octet MBZ field that <bcp14>MUST</bcp14> be zeroed on transmission and ignored on receipt.
  </dd>
            <dt pn="section-4.2.1-2.3">
    Source EUI-48 Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.4">
              <t indent="0" pn="section-4.2.1-2.4.1">A 12-octet sub-TLV that includes the EUI-48 source MAC address.
  The Type value is 2.
  The value of the Length field <bcp14>MUST</bcp14> be equal to 8.</t>
              <figure anchor="eui-48-tlv-figure" align="left" suppress-title="false" pn="figure-9">
                <name slugifiedName="name-the-value-field-of-the-sour">The Value Field of the Source EUI-48 Address Sub-TLV</name>
                <artwork name="" type="" align="left" alt="" pn="section-4.2.1-2.4.2.1">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                        EUI-48  Address                        |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |            MBZ                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
              </figure>
              <t indent="0" pn="section-4.2.1-2.4.3"> 
  The Value field consists of the following fields (<xref target="eui-48-tlv-figure" format="default" sectionFormat="of" derivedContent="Figure 9"/>):
              </t>
              <dl spacing="normal" indent="3" newline="false" pn="section-4.2.1-2.4.4">
                <dt pn="section-4.2.1-2.4.4.1">EUI-48 Address:</dt>
                <dd pn="section-4.2.1-2.4.4.2">A six-octet field.</dd>
                <dt pn="section-4.2.1-2.4.4.3">MBZ:</dt>
                <dd pn="section-4.2.1-2.4.4.4">A two-octet field. It <bcp14>MUST</bcp14> be zeroed on transmission and ignored on receipt.</dd>
              </dl>
            </dd>
            <dt pn="section-4.2.1-2.5">Source EUI-64 Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.6">A 12-octet sub-TLV that includes the EUI-64 source MAC address.
  The Type value is 3.
  The value of the Length field <bcp14>MUST</bcp14> be equal to 8.
  The Value field consists of an eight-octet EUI-64 field.
  </dd>
            <dt pn="section-4.2.1-2.7">
        Destination IP Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.8">A 20-octet sub-TLV.
        The Type value is 4.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field consists of a 16-octet  MBZ field that <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.
        </dd>
            <dt pn="section-4.2.1-2.9">            
        Destination IPv4 Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.10">
              <t indent="0" pn="section-4.2.1-2.10.1">A 20-octet sub-TLV that includes the IPv4 destination address.
        The Type value is 5.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.</t>
              <figure anchor="ipv4-value-figure" align="left" suppress-title="false" pn="figure-10">
                <name slugifiedName="name-ipv4-address-in-a-sub-tlvs-">IPv4 Address in a Sub-TLV's Value Field</name>
                <artwork name="" type="" align="left" alt="" pn="section-4.2.1-2.10.2.1">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                         IPv4 Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
~                        MBZ (12 octets)                        ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
              </figure>
              <t indent="0" pn="section-4.2.1-2.10.3"> 
        The Value field consists of the following fields (<xref target="ipv4-value-figure" format="default" sectionFormat="of" derivedContent="Figure 10"/>):
              </t>
              <dl spacing="normal" indent="3" newline="false" pn="section-4.2.1-2.10.4">
                <dt pn="section-4.2.1-2.10.4.1">IPv4 Address:</dt>
                <dd pn="section-4.2.1-2.10.4.2">A four-octet field.</dd>
                <dt pn="section-4.2.1-2.10.4.3">MBZ:</dt>
                <dd pn="section-4.2.1-2.10.4.4">A 12-octet field. It <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.</dd>
              </dl>
            </dd>
            <dt pn="section-4.2.1-2.11">
        Destination IPv6 Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.12">A 20-octet sub-TLV that includes the IPv6 destination address.
        The Type value is 6.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field is a 16-octet IPv6 Address field.
        </dd>
            <dt pn="section-4.2.1-2.13">
        Source IP Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.14">A 20-octet sub-TLV.
        The Type value is 7.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field is a 16-octet MBZ field that <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.
        </dd>
            <dt pn="section-4.2.1-2.15">
        Source IPv4 Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.16">
              <t indent="0" pn="section-4.2.1-2.16.1">A 20-octet sub-TLV that includes the IPv4 source address.
        The Type value is 8.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field consists of the following fields (<xref target="ipv4-value-figure" format="default" sectionFormat="of" derivedContent="Figure 10"/>):</t>
              <dl spacing="normal" indent="3" newline="false" pn="section-4.2.1-2.16.2">
                <dt pn="section-4.2.1-2.16.2.1">IPv4 Address:</dt>
                <dd pn="section-4.2.1-2.16.2.2">A four-octet field.</dd>
                <dt pn="section-4.2.1-2.16.2.3">MBZ:</dt>
                <dd pn="section-4.2.1-2.16.2.4">A 12-octet field. It <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.</dd>
              </dl>
            </dd>
            <dt pn="section-4.2.1-2.17">
        Source IPv6 Address sub-TLV:</dt>
            <dd pn="section-4.2.1-2.18">A 20-octet sub-TLV that includes the IPv6 source address.
        The Type value is 9.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field is a 16-octet IPv6 Address field.
        </dd>
          </dl>
        </section>
        <section anchor="location-operation-sec" numbered="true" toc="include" removeInRFC="false" pn="section-4.2.2">
          <name slugifiedName="name-theory-of-operation-of-loca">Theory of Operation of Location TLV</name>
          <t indent="0" pn="section-4.2.2-1">

  The Session-Reflector that received an extended STAMP packet with
  the Location TLV <bcp14>MUST</bcp14> include in the reflected packet the Location TLV with a length equal
  to the Location TLV length in the received packet.
  Based on the local policy, the Session-Reflector <bcp14>MAY</bcp14> leave some fields unreported by filling them with zeroes.
  An implementation of the stateful Session-Reflector <bcp14>MUST</bcp14> provide control for managing such policies.
          </t>
          <t indent="0" pn="section-4.2.2-2">
  A Session-Sender <bcp14>MAY</bcp14> include the Source MAC Address sub-TLV in the Location TLV.
  If the Session-Reflector receives the Location TLV that includes the Source MAC Address sub-TLV, it
  <bcp14>MUST</bcp14> include the Source EUI-48 Address sub-TLV if the source MAC address of the
  received extended test packet is in EUI-48 format. And the Session-Reflector <bcp14>MUST</bcp14>
  copy the value of the source MAC address in the EUI-48 field.
  Otherwise, the Session-Reflector <bcp14>MUST</bcp14> use the Source EUI-64 Address sub-TLV and <bcp14>MUST</bcp14> copy the value
  of the Source MAC Address from the received packet into the EUI-64 field.
  If the received extended STAMP test packet does not have the Source MAC Address,
  the Session-Reflector <bcp14>MUST</bcp14> zero the EUI-64 field before transmitting the reflected packet.
          </t>
          <t indent="0" pn="section-4.2.2-3">
  A Session-Sender <bcp14>MAY</bcp14> include the Destination IP Address sub-TLV in the Location TLV.
  If the Session-Reflector receives the Location TLV that includes the Destination IP Address sub-TLV, it
  <bcp14>MUST</bcp14> include the Destination IPv4 Address sub-TLV if the source IP address of the
  received extended test packet is of the IPv4 address family. And the Session-Reflector <bcp14>MUST</bcp14>
  copy the value of the destination IP address in the IPv4 Address field.
  Otherwise, the Session-Reflector <bcp14>MUST</bcp14> use the Destination IPv6 Address sub-TLV and <bcp14>MUST</bcp14> copy the value
  of the destination IP address from the received packet into the IPv6 Address field.
          </t>
          <t indent="0" pn="section-4.2.2-4">
  A Session-Sender <bcp14>MAY</bcp14> include the Source IP Address sub-TLV in the Location TLV.
  If the Session-Reflector receives the Location TLV that includes the Source IP Address sub-TLV, it
  <bcp14>MUST</bcp14> include the Source IPv4 Address sub-TLV if the source IP address of the
  received extended test packet is of the IPv4 address family. And the Session-Reflector <bcp14>MUST</bcp14>
  copy the value of the source IP address in the IPv4 Address field.
  Otherwise, the Session-Reflector <bcp14>MUST</bcp14> use the Source IPv6 Address sub-TLV and <bcp14>MUST</bcp14> copy the value
  of the source IP address from the received packet into the IPv6 Address field.
          </t>
          <t indent="0" pn="section-4.2.2-5">
The Location TLV <bcp14>MAY</bcp14> be used to determine the last-hop IP addresses, ports, and
  last-hop MAC address for STAMP packets. The MAC address can indicate a path switch
  on the last hop. The IP addresses and UDP ports will indicate
  if there is a NAT router on the path. It allows the Session-Sender to identify the IP address
  of the Session-Reflector behind the NAT and detect changes in the NAT mapping that could result in sending the STAMP packets to the wrong Session-Reflector.
          </t>
        </section>
      </section>
      <section anchor="timestamp-info-section" numbered="true" toc="include" removeInRFC="false" pn="section-4.3">
        <name slugifiedName="name-timestamp-information-tlv">Timestamp Information TLV</name>
        <t indent="0" pn="section-4.3-1">
  The STAMP Session-Sender <bcp14>MAY</bcp14> include the Timestamp Information TLV to request information from the Session-Reflector.
  The Session-Sender <bcp14>MUST NOT</bcp14> fill any information fields except for STAMP TLV Flags, Type, and Length.
  All other fields <bcp14>MUST</bcp14> be filled with zeroes.
  The Session-Reflector <bcp14>MUST</bcp14> validate the Length value of the TLV.
  If the value of the Length field is invalid, the Session-Reflector follows the procedure defined in <xref target="stamp-extension-section" format="default" sectionFormat="of" derivedContent="Section 4"/> for a malformed TLV.
  
        </t>
        <figure anchor="timestamp-tlv-figuret" align="left" suppress-title="false" pn="figure-11">
          <name slugifiedName="name-timestamp-information-tlv-2">Timestamp Information TLV</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.3-2.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Sync Src In  | Timestamp In  | Sync Src Out  | Timestamp Out |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                    Optional sub-TLVs                          ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-4.3-3"> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" indent="3" newline="false" pn="section-4.3-4">
          <dt pn="section-4.3-4.1">STAMP TLV Flags:</dt>
          <dd pn="section-4.3-4.2">An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</dd>
          <dt pn="section-4.3-4.3">Type:</dt>
          <dd pn="section-4.3-4.4">A one-octet field. Value 3 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>).</dd>
          <dt pn="section-4.3-4.5">Length:</dt>
          <dd pn="section-4.3-4.6">A two-octet field, set equal to the length of the Value field in octets (<xref target="tlv-format" format="default" sectionFormat="of" derivedContent="Figure 5"/>).</dd>
          <dt pn="section-4.3-4.7">Sync Src In:</dt>
          <dd pn="section-4.3-4.8">A one-octet field that characterizes the source of clock synchronization at the ingress of a Session-Reflector. 
       There are several methods for synchronizing the clock, e.g., the Network Time Protocol (NTP) <xref target="RFC5905" format="default" sectionFormat="of" derivedContent="RFC5905"/>.

       <xref target="ssync-source-new-tbl" format="default" sectionFormat="of" derivedContent="Table 7"/> lists the possible values.</dd>
          <dt pn="section-4.3-4.9">Timestamp In:</dt>
          <dd pn="section-4.3-4.10">A one-octet field that characterizes the
       method by which the ingress of the Session-Reflector obtained the timestamp T2.
       A timestamp may be obtained with hardware assistance via a software API from a local wall clock or from a remote clock (the latter is referred to as a "control plane").
<xref target="timestamp-method-new-tbl" format="default" sectionFormat="of" derivedContent="Table 9"/> lists the possible values.</dd>
          <dt pn="section-4.3-4.11">Sync Src Out:</dt>
          <dd pn="section-4.3-4.12">A one-octet field that characterizes the source of clock synchronization at the egress of the Session-Reflector. 
<xref target="ssync-source-new-tbl" format="default" sectionFormat="of" derivedContent="Table 7"/> lists the possible values.</dd>
          <dt pn="section-4.3-4.13">Timestamp Out:</dt>
          <dd pn="section-4.3-4.14">A one-octet field that characterizes the
       method by which the egress of the Session-Reflector obtained the timestamp T3.
<xref target="timestamp-method-new-tbl" format="default" sectionFormat="of" derivedContent="Table 9"/> lists the possible values.</dd>
          <dt pn="section-4.3-4.15">Optional sub-TLVs:</dt>
          <dd pn="section-4.3-4.16">An optional variable-length field.</dd>
        </dl>
      </section>
      <section anchor="cos-info-section" numbered="true" toc="include" removeInRFC="false" pn="section-4.4">
        <name slugifiedName="name-class-of-service-tlv">Class of Service TLV</name>
        <t indent="0" pn="section-4.4-1">
  The STAMP Session-Sender <bcp14>MAY</bcp14> include  a Class of Service (CoS) TLV in the STAMP test packet.
  The format of the CoS TLV is presented in <xref target="cos-tlv-figure" format="default" sectionFormat="of" derivedContent="Figure 12"/>.

        </t>
        <figure anchor="cos-tlv-figure" align="left" suppress-title="false" pn="figure-12">
          <name slugifiedName="name-class-of-service-tlv-2">Class of Service TLV</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.4-2.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |   DSCP1   |   DSCP2   |ECN| RP|          Reserved             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-4.4-3"> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" indent="3" newline="false" pn="section-4.4-4">
          <dt pn="section-4.4-4.1">STAMP TLV Flags:</dt>
          <dd pn="section-4.4-4.2">An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</dd>
          <dt pn="section-4.4-4.3">Type:</dt>
          <dd pn="section-4.4-4.4">A one-octet field. Value 4 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>).</dd>
          <dt pn="section-4.4-4.5">Length:</dt>
          <dd pn="section-4.4-4.6">A two-octet field, set equal to the value 4.</dd>
          <dt pn="section-4.4-4.7">DSCP1:</dt>
          <dd pn="section-4.4-4.8">The Differentiated Services Code Point (DSCP) intended by the Session-Sender
        to be used as the DSCP value of the reflected test packet.</dd>
          <dt pn="section-4.4-4.9">DSCP2:</dt>
          <dd pn="section-4.4-4.10">The received value in the DSCP field at the ingress of the Session-Reflector.</dd>
          <dt pn="section-4.4-4.11">ECN:</dt>
          <dd pn="section-4.4-4.12">The received value in the ECN field at the ingress of the Session-Reflector.</dd>
          <dt pn="section-4.4-4.13">RP (Reverse Path):</dt>
          <dd pn="section-4.4-4.14">A two-bit field. A Session-Sender <bcp14>MUST</bcp14> set the value of the RP field to 0 on transmission.</dd>
          <dt pn="section-4.4-4.15">Reserved:</dt>
          <dd pn="section-4.4-4.16">A 16-bit field that <bcp14>MUST</bcp14> be zeroed on transmission and ignored on receipt.</dd>
        </dl>
        <t indent="0" pn="section-4.4-5">
  A STAMP Session-Reflector that receives a test packet with the CoS TLV <bcp14>MUST</bcp14> include
  the CoS TLV in the reflected test packet. Also, the Session-Reflector <bcp14>MUST</bcp14> copy
  the value of the DSCP and ECN fields of the IP header of the received STAMP test packet into the DSCP2 field in
  the reflected test packet. Finally, the Session-Reflector <bcp14>MUST</bcp14> use the local policy to verify whether
  the CoS corresponding to the value of the DSCP1 field is permitted in the domain. If it is, the Session-Reflector
  <bcp14>MUST</bcp14> set the DSCP field's value in the IP header
  of the reflected test packet equal to the value of the DSCP1 field of the received test packet. Otherwise, the Session-Reflector <bcp14>MUST</bcp14> use
  the DSCP value of the received STAMP packet and set the value of the RP field to 1.
  Upon receiving the reflected packet, if the value of the RP field is 0,
  the Session-Sender will save the DSCP and ECN values for analysis of the CoS in the reverse direction.
  If the value of the RP field in the received reflected packet is 1, only CoS in the forward direction can be analyzed.
        </t>
        <t indent="0" pn="section-4.4-6">
Re-mapping of CoS can be used to provide multiple services (e.g., 2G, 3G, LTE in mobile backhaul networks)
over the same network.  But if it is misconfigured, then it is often difficult to diagnose the root cause of
excessive packet drops of higher-level service while packet drops
for lower service packets are at a normal level.  Using a CoS TLV in
STAMP testing helps to troubleshoot the existing problem and also verify
whether Diffserv policies are processing CoS as required by the configuration.
        </t>
      </section>
      <section anchor="direct-measurement-section" numbered="true" toc="include" removeInRFC="false" pn="section-4.5">
        <name slugifiedName="name-direct-measurement-tlv">Direct Measurement TLV</name>
        <t indent="0" pn="section-4.5-1">
  The Direct Measurement TLV enables collection of the number of in-profile packets,
  i.e., packets that form a specific data flow, that had been transmitted and received
  by the Session-Sender and Session-Reflector, respectively. The definition of "in-profile packet" is outside the
  scope of this document and is left to the test operators to determine.
        </t>
        <figure anchor="direct-tlv-figuret" align="left" suppress-title="false" pn="figure-13">
          <name slugifiedName="name-direct-measurement-tlv-2">Direct Measurement TLV</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.5-2.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              Session-Sender Tx counter  (S_TxC)               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Session-Reflector Rx counter  (R_RxC)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Session-Reflector Tx counter  (R_TxC)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-4.5-3"> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" newline="false" indent="3" pn="section-4.5-4">
          <dt pn="section-4.5-4.1">STAMP TLV Flags:</dt>
          <dd pn="section-4.5-4.2">An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</dd>
          <dt pn="section-4.5-4.3">Type:</dt>
          <dd pn="section-4.5-4.4">A one-octet field. Value 5 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>).</dd>
          <dt pn="section-4.5-4.5">Length:</dt>
          <dd pn="section-4.5-4.6">A two-octet field equal to the length of the Value field in octets. The Length field value <bcp14>MUST</bcp14> equal 12 octets.</dd>
          <dt pn="section-4.5-4.7">Session-Sender Tx counter (S_TxC):</dt>
          <dd pn="section-4.5-4.8">A four-octet field. The Session-Sender <bcp14>MUST</bcp14> set its value equal to the number of the transmitted in-profile packets.</dd>
          <dt pn="section-4.5-4.9">Session-Reflector Rx counter (R_RxC):</dt>
          <dd pn="section-4.5-4.10">A four-octet field. It <bcp14>MUST</bcp14> be zeroed  by the Session-Sender on transmit and
       ignored by the Session-Reflector on receipt. The Session-Reflector <bcp14>MUST</bcp14> fill it with the value of in-profile packets received.</dd>
          <dt pn="section-4.5-4.11">Session-Reflector Tx counter (R_TxC):</dt>
          <dd pn="section-4.5-4.12">A four-octet field. It <bcp14>MUST</bcp14> be zeroed by the Session-Sender and ignored by the Session-Reflector on receipt.
       The Session-Reflector <bcp14>MUST</bcp14> fill it with the value of the transmitted in-profile packets.</dd>
        </dl>
        <t indent="0" pn="section-4.5-5">
    A Session-Sender <bcp14>MAY</bcp14> include the Direct Measurement TLV in a STAMP test packet.
    If the received STAMP test packet includes the Direct Measurement TLV, the Session-Reflector <bcp14>MUST</bcp14> include it in the reflected test packet.
    The Session-Reflector <bcp14>MUST</bcp14> copy the value from the S_TxC field of the received test packet into the same field of the reflected packet before its transmission.
        </t>
      </section>
      <section anchor="access-avail-sec" numbered="true" toc="include" removeInRFC="false" pn="section-4.6">
        <name slugifiedName="name-access-report-tlv">Access Report TLV</name>
        <t indent="0" pn="section-4.6-1">
    A STAMP Session-Sender <bcp14>MAY</bcp14> include an Access Report TLV (<xref target="access-tlv-fig" format="default" sectionFormat="of" derivedContent="Figure 14"/>) to indicate
  changes to the access network status to the Session-Reflector. The
  definition of an access network is outside the scope of this document.
        </t>
        <figure anchor="access-tlv-fig" align="left" suppress-title="false" pn="figure-14">
          <name slugifiedName="name-access-report-tlv-2">Access Report TLV</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.6-2.1">
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAMP TLV Flags|     Type      |           Length              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   ID  |  Resv |  Return Code  |          Reserved             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-4.6-3"> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" newline="false" indent="3" pn="section-4.6-4">
          <dt pn="section-4.6-4.1">STAMP TLV Flags:</dt>
          <dd pn="section-4.6-4.2">An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</dd>
          <dt pn="section-4.6-4.3">Type:</dt>
          <dd pn="section-4.6-4.4">A one-octet field. Value 6 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>).</dd>
          <dt pn="section-4.6-4.5">Length:</dt>
          <dd pn="section-4.6-4.6">A two-octet field, set equal to the value 4.</dd>
          <dt pn="section-4.6-4.7">ID (Access ID):</dt>
          <dd pn="section-4.6-4.8">
            <t indent="0" pn="section-4.6-4.8.1">A four-bit field that identifies the access network,
     e.g., 3GPP (Radio Access Technologies specified by 3GPP) or non-3GPP
     (accesses that are not specified by 3GPP) <xref target="TS23501" format="default" sectionFormat="of" derivedContent="TS23501"/>.
     The value is one of the following:</t>
            <dl spacing="normal" newline="false" indent="3" pn="section-4.6-4.8.2">
              <dt pn="section-4.6-4.8.2.1">1:</dt>
              <dd pn="section-4.6-4.8.2.2">3GPP Network</dd>
              <dt pn="section-4.6-4.8.2.3">2:</dt>
              <dd pn="section-4.6-4.8.2.4">Non-3GPP Network</dd>
            </dl>
            <t indent="0" pn="section-4.6-4.8.3">
     All other values are invalid; a TLV that contains values other than '1' or '2' <bcp14>MUST</bcp14> be discarded.</t>
          </dd>
          <dt pn="section-4.6-4.9">Resv:</dt>
          <dd pn="section-4.6-4.10">A four-bit field that <bcp14>MUST</bcp14> be zeroed on transmission
      and ignored on receipt.</dd>
          <dt pn="section-4.6-4.11">Return Code:</dt>
          <dd pn="section-4.6-4.12">A one-octet field that identifies the report signal,
     e.g., available or unavailable. The value is supplied to the STAMP
     endpoint through some mechanism that is outside the scope of this document.
<xref target="iana-return-code-reg" format="default" sectionFormat="of" derivedContent="Section 5.6"/> lists the possible values.</dd>
          <dt pn="section-4.6-4.13">Reserved:</dt>
          <dd pn="section-4.6-4.14">A two-octet field that <bcp14>MUST</bcp14> be zeroed on transmission
      and ignored on receipt.</dd>
        </dl>
        <t indent="0" pn="section-4.6-5">
           The STAMP Session-Sender that includes the Access Report TLV sets
   the value of the Access ID field according to the type of access network it reports on.
   Also, the Session-Sender sets the value of the Return Code field to reflect the operational state of the
   access network. The mechanism to determine the state of the access network is outside the scope
   of this specification.  A STAMP Session-Reflector
   that received the test packet with the Access Report TLV <bcp14>MUST</bcp14> include
   the Access Report TLV in the reflected test packet.  The Session-Reflector <bcp14>MUST</bcp14> set the value of the Access ID and Return Code fields
   equal to the values of the corresponding fields from the test packet
   it has received.
        </t>
        <t indent="0" pn="section-4.6-6">
   The Session-Sender <bcp14>MUST</bcp14> also arm a retransmission timer after sending
   a test packet that includes the Access Report TLV.  This timer <bcp14>MUST</bcp14>
   be disarmed upon reception of the reflected
   STAMP test packet that includes the Access Report TLV.
   In the event the timer expires before such a packet
   is received, the Session-Sender <bcp14>MUST</bcp14> retransmit the STAMP test packet
   that contains the Access Report TLV. This retransmission <bcp14>SHOULD</bcp14> be
   repeated up to four times before the procedure is aborted. Setting the value
   for the retransmission timer is based on local policies and the network environment.
   The default value of the retransmission timer for the Access Report TLV
   <bcp14>SHOULD</bcp14> be three seconds. An implementation <bcp14>MUST</bcp14> provide control
   of the retransmission timer value and the number of retransmissions.
        </t>
        <t indent="0" pn="section-4.6-7">
  The Access Report TLV is used by the Performance Measurement
   Function (PMF) components of the Access Steering, Switching, and
   Splitting feature for 5G networks <xref target="TS23501" format="default" sectionFormat="of" derivedContent="TS23501"/>.  The PMF
   component in the User Equipment acts as the STAMP Session-Sender,
   and the PMF component in the User Plane Function
   acts as the STAMP Session-Reflector.
        </t>
      </section>
      <section anchor="follow-up-tlv" numbered="true" toc="include" removeInRFC="false" pn="section-4.7">
        <name slugifiedName="name-follow-up-telemetry-tlv">Follow-Up Telemetry TLV</name>
        <t indent="0" pn="section-4.7-1">
    A Session-Reflector might be able to put only an "SW Local"
    (see <xref target="timestamp-method-new-tbl" format="default" sectionFormat="of" derivedContent="Table 9"/>) timestamp in the Follow-Up Timestamp field. But the hosting
    system might provide a timestamp closer to the start of the actual packet transmission
    even though it is not possible to deliver the information to the Session-Sender in time for the packet itself.
    This timestamp might nevertheless be important for the Session-Sender, as it
    improves the accuracy of network delay measurement by minimizing the impact of egress queuing delays
    on the measurement.
        </t>
        <t indent="0" pn="section-4.7-2">
  A STAMP Session-Sender <bcp14>MAY</bcp14> include the Follow-Up Telemetry TLV to
   request information from the Session-Reflector. The Session-Sender
   <bcp14>MUST</bcp14> set the Follow-Up Telemetry Type and Length fields to their appropriate values.
   The Sequence Number and Follow-Up Timestamp fields <bcp14>MUST</bcp14> be zeroed on transmission by the Session-Sender
   and ignored by the Session-Reflector upon receipt of the STAMP test packet that includes the Follow-Up Telemetry TLV.
   The Session-Reflector <bcp14>MUST</bcp14> validate the Length value of the STAMP
   test packet.  If the value of the Length field is invalid, the
   Session-Reflector <bcp14>MUST</bcp14> zero the Sequence Number and Follow-Up Timestamp fields and set the M flag in the STAMP TLV Flags field
   in the reflected packet. If the Session-Reflector is in the
   stateless mode (defined in <xref target="RFC8762" sectionFormat="of" section="4.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8762#section-4.2" derivedContent="RFC8762"/>),
   it <bcp14>MUST</bcp14> zero the Sequence Number and Follow-Up Timestamp fields.
        </t>
        <figure anchor="follow-up-tlv-fig" align="left" suppress-title="false" pn="figure-15">
          <name slugifiedName="name-follow-up-telemetry-tlv-2">Follow-Up Telemetry TLV</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.7-3.1">
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAMP TLV Flags|      Type     |           Length              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sequence Number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Follow-Up Timestamp                      |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Timestamp M  |                     Reserved                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-4.7-4"> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" indent="3" newline="false" pn="section-4.7-5">
          <dt pn="section-4.7-5.1">STAMP TLV Flags:</dt>
          <dd pn="section-4.7-5.2">An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</dd>
          <dt pn="section-4.7-5.3">Type:</dt>
          <dd pn="section-4.7-5.4">A one-octet field. Value 7 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>).</dd>
          <dt pn="section-4.7-5.5">Length:</dt>
          <dd pn="section-4.7-5.6">A two-octet field, set equal to the value 16 octets.</dd>
          <dt pn="section-4.7-5.7">
        Sequence Number:</dt>
          <dd pn="section-4.7-5.8">A four-octet field indicating the sequence
number of the last packet reflected in the same STAMP test session.
Since the Session-Reflector runs in the stateful mode
(defined in <xref target="RFC8762" sectionFormat="of" section="4.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8762#section-4.2" derivedContent="RFC8762"/>),
it is the Session-Reflector's Sequence Number of the previous reflected packet.
</dd>
          <dt pn="section-4.7-5.9">
     Follow-Up Timestamp:</dt>
          <dd pn="section-4.7-5.10">An eight-octet field, with the format indicated by
      the Z flag of the Error Estimate field of the STAMP base packet, which is contained
      in this reflected test packet transmitted by a Session-Reflector,
      as described in <xref target="RFC8762" sectionFormat="of" section="4.2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8762#section-4.2.1" derivedContent="RFC8762"/>.
      It carries the timestamp when the reflected packet with the
      specified sequence number was sent.
</dd>
          <dt pn="section-4.7-5.11">
Timestamp M(ode):</dt>
          <dd pn="section-4.7-5.12">A one-octet field that characterizes the
method by which the entity that transmits a reflected STAMP packet obtained the Follow-Up Timestamp.
<xref target="timestamp-method-new-tbl" format="default" sectionFormat="of" derivedContent="Table 9"/> lists the possible values.
</dd>
          <dt pn="section-4.7-5.13">Reserved:</dt>
          <dd pn="section-4.7-5.14">A three-octet field. Its value <bcp14>MUST</bcp14> be zeroed on transmission and ignored on receipt.</dd>
        </dl>
      </section>
      <section anchor="hmac-sec" numbered="true" toc="include" removeInRFC="false" pn="section-4.8">
        <name slugifiedName="name-hmac-tlv">HMAC TLV</name>
        <t indent="0" pn="section-4.8-1">
The STAMP authenticated mode protects the integrity of data collected in the STAMP base packet.
STAMP extensions are designed to provide valuable information about the condition of a network,
and protecting the integrity of that data is also essential. 
All authenticated STAMP base packets (per Sections <xref target="RFC8762" sectionFormat="bare" section="4.2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8762#section-4.2.2" derivedContent="RFC8762"/> and <xref target="RFC8762" sectionFormat="bare" section="4.3.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8762#section-4.3.2" derivedContent="RFC8762"/> of <xref target="RFC8762" format="default" sectionFormat="of" derivedContent="RFC8762"/>)
compatible with this specification <bcp14>MUST</bcp14> additionally authenticate the
optional TLVs by including the keyed Hashed Message Authentication Code (HMAC) TLV, with the sole exception of when
there is only one TLV present and it is the Extended Padding TLV.
The HMAC TLV <bcp14>MUST</bcp14> follow all TLVs included in a STAMP test packet except for the Extra Padding TLV.
If the HMAC TLV appears in any other position in a STAMP extended test packet, then the situation
<bcp14>MUST</bcp14> be processed as HMAC verification failure, as defined below in this section.
The HMAC TLV <bcp14>MAY</bcp14> be used to protect the integrity of STAMP extensions in the STAMP unauthenticated mode.
An implementation of STAMP extensions <bcp14>MUST</bcp14> provide controls to enable
the integrity protection of STAMP extensions in the STAMP unauthenticated mode.
</t>
        <t indent="0" pn="section-4.8-2">
        </t>
        <figure anchor="hmac-tlv-fig" align="left" suppress-title="false" pn="figure-16">
          <name slugifiedName="name-hmac-tlv-2">HMAC TLV</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.8-3.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |STAMP TLV Flags|      Type     |             Length            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                              HMAC                             |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-4.8-4"> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" indent="3" newline="false" pn="section-4.8-5">
          <dt pn="section-4.8-5.1">STAMP TLV Flags:</dt>
          <dd pn="section-4.8-5.2">An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</dd>
          <dt pn="section-4.8-5.3">Type:</dt>
          <dd pn="section-4.8-5.4">A one-octet field. Value 8 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default" sectionFormat="of" derivedContent="Section 5.1"/>).</dd>
          <dt pn="section-4.8-5.5">Length:</dt>
          <dd pn="section-4.8-5.6">A two-octet field, set equal to the value 16 octets.</dd>
          <dt pn="section-4.8-5.7">HMAC:</dt>
          <dd pn="section-4.8-5.8">A 16-octet field that carries the HMAC digest of the text of all preceding TLVs.</dd>
        </dl>
        <t indent="0" pn="section-4.8-6">
As defined in <xref target="RFC8762" format="default" sectionFormat="of" derivedContent="RFC8762"/>, STAMP uses HMAC-SHA-256 truncated to 128 bits (see <xref target="RFC4868" format="default" sectionFormat="of" derivedContent="RFC4868"/>).
All considerations regarding using the key listed in <xref target="RFC8762" sectionFormat="of" section="4.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8762#section-4.4" derivedContent="RFC8762"/>
are fully applicable to the use of the HMAC TLV. Key management and the mechanisms to
distribute the HMAC key are outside the scope of this specification.
The HMAC TLV is anticipated to track updates in the base STAMP protocol <xref target="RFC8762" format="default" sectionFormat="of" derivedContent="RFC8762"/>,
including the use of more advanced cryptographic algorithms. HMAC is calculated as defined in <xref target="RFC2104" format="default" sectionFormat="of" derivedContent="RFC2104"/>
over text as the concatenation of the Sequence Number field of the base STAMP packet and
all  preceding TLVs. The digest then <bcp14>MUST</bcp14> be truncated to 128 bits and written into the HMAC field.
If the HMAC TLV is present in the extended STAMP test packet, e.g., in the authenticated mode,
HMAC <bcp14>MUST</bcp14> be verified before using any data in the included STAMP TLVs. If HMAC verification
by the Session-Reflector fails, then the Session-Reflector <bcp14>MUST</bcp14> stop processing the received extended STAMP test packet.
The Session-Reflector <bcp14>MUST</bcp14> copy the TLVs from the received  STAMP test packet into the
reflected packet. The Session-Reflector <bcp14>MUST</bcp14> set the I flag in each TLV copied over into
the reflected packet to 1 before transmitting the reflected test packet.
If the Session-Sender receives the extended STAMP test packet with I flag set to 1,
then the Session-Sender <bcp14>MUST</bcp14> stop processing TLVs in the reflected test packet.
If HMAC verification by the Session-Sender fails, then the Session-Sender <bcp14>MUST</bcp14>
stop processing TLVs in the reflected extended STAMP packet.
</t>
      </section>
    </section>
    <section anchor="iana-consider" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-5-1">IANA has created the following subregistries under the "Simple Two-way Active Measurement Protocol (STAMP) TLV Types" registry.</t>
      <section anchor="iana-stamp-tlv-registry" numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-stamp-tlv-types-subregistry">STAMP TLV Types Subregistry</name>
        <t indent="0" pn="section-5.1-1">
   IANA has created the "STAMP TLV Types" subregistry. The code
   points in this registry are allocated according to the registration
   procedures <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/> described in <xref target="iana-stamp-type-tbl" format="default" sectionFormat="of" derivedContent="Table 1"/>.
        </t>
        <table anchor="iana-stamp-type-tbl" align="center" pn="table-1">
          <name slugifiedName="name-registration-procedures-for">Registration Procedures for the STAMP TLV Types Subregistry</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Range</th>
              <th align="center" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">1 - 175</td>
              <td align="center" colspan="1" rowspan="1">IETF Review</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">176 - 239</td>
              <td align="center" colspan="1" rowspan="1">First Come First Served</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">240 - 251</td>
              <td align="center" colspan="1" rowspan="1">Experimental Use</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">252 - 254</td>
              <td align="center" colspan="1" rowspan="1">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-5.1-3">Per this document, IANA has allocated the following values in the "STAMP TLV Types" subregistry:
</t>
        <table anchor="stamp-new-type-tbl" align="center" pn="table-2">
          <name slugifiedName="name-stamp-tlv-types">STAMP TLV Types</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="center" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="center" colspan="1" rowspan="1">Extra Padding</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="center" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="center" colspan="1" rowspan="1">Timestamp Information</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="center" colspan="1" rowspan="1">Class of Service</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">5</td>
              <td align="center" colspan="1" rowspan="1">Direct Measurement</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">6</td>
              <td align="center" colspan="1" rowspan="1">Access Report</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">7</td>
              <td align="center" colspan="1" rowspan="1">Follow-Up Telemetry</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">8</td>
              <td align="center" colspan="1" rowspan="1">HMAC</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">255</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-tlv-flags-reg" numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-stamp-tlv-flags-subregistry">STAMP TLV Flags Subregistry</name>
        <t indent="0" pn="section-5.2-1">
      IANA has created the "STAMP TLV Flags" subregistry.
      The registration procedure is "IETF Review" <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>. The flags are 8 bits.
      Per this document, IANA has allocated the following bit positions in the "STAMP TLV Flags" subregistry.
        </t>
        <table anchor="tlv-flags-new-tbl" align="center" pn="table-3">
          <name slugifiedName="name-stamp-tlv-flags">STAMP TLV Flags</name>
          <thead>
            <tr>
              <th align="center" colspan="1" rowspan="1">Bit position</th>
              <th align="center" colspan="1" rowspan="1">Symbol</th>
              <th align="center" colspan="1" rowspan="1">Description</th>
              <th align="center" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" colspan="1" rowspan="1">0</td>
              <td align="center" colspan="1" rowspan="1">U</td>
              <td align="center" colspan="1" rowspan="1">Unrecognized TLV</td>
              <td align="center" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="center" colspan="1" rowspan="1">1</td>
              <td align="center" colspan="1" rowspan="1">M</td>
              <td align="center" colspan="1" rowspan="1">Malformed TLV</td>
              <td align="center" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="center" colspan="1" rowspan="1">2</td>
              <td align="center" colspan="1" rowspan="1">I</td>
              <td align="center" colspan="1" rowspan="1">Integrity check failed</td>
              <td align="center" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-sub-tlv-registry" numbered="true" toc="include" removeInRFC="false" pn="section-5.3">
        <name slugifiedName="name-stamp-sub-tlv-types-subregi">STAMP Sub-TLV Types Subregistry</name>
        <t indent="0" pn="section-5.3-1">
   IANA has created the "STAMP Sub-TLV Types" subregistry.
   The code points in this registry are allocated according to the
   registration procedures <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/> described
   in <xref target="iana-sub-type-tbl" format="default" sectionFormat="of" derivedContent="Table 4"/>.
        </t>
        <table anchor="iana-sub-type-tbl" align="center" pn="table-4">
          <name slugifiedName="name-registration-procedures-for-">Registration Procedures for the STAMP Sub-TLV Types Subregistry</name>
          <thead>
            <tr>
              <th align="center" colspan="1" rowspan="1">Range</th>
              <th align="center" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">1 - 175</td>
              <td align="center" colspan="1" rowspan="1">IETF Review</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">176 - 239</td>
              <td align="center" colspan="1" rowspan="1">First Come First Served</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">240 - 251</td>
              <td align="center" colspan="1" rowspan="1">Experimental Use</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">252 - 254</td>
              <td align="center" colspan="1" rowspan="1">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-5.3-3">Per this document, IANA has allocated the following values in the "STAMP Sub-TLV Types" subregistry:</t>
        <table anchor="sub-tlv-type-tbl" align="center" pn="table-5">
          <name slugifiedName="name-stamp-sub-tlv-types">STAMP Sub-TLV Types</name>
          <thead>
            <tr>
              <th align="center" colspan="1" rowspan="1">Value</th>
              <th align="center" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">TLV Used</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="center" colspan="1" rowspan="1">Source MAC Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="center" colspan="1" rowspan="1">Source EUI-48 Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="center" colspan="1" rowspan="1">Source EUI-64 Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="center" colspan="1" rowspan="1">Destination IP Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">5</td>
              <td align="center" colspan="1" rowspan="1">Destination IPv4 Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">6</td>
              <td align="center" colspan="1" rowspan="1">Destination IPv6 Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">7</td>
              <td align="center" colspan="1" rowspan="1">Source IP Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">8</td>
              <td align="center" colspan="1" rowspan="1">Source IPv4 Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">9</td>
              <td align="center" colspan="1" rowspan="1">Source IPv6 Address</td>
              <td align="left" colspan="1" rowspan="1">Location</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">255</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-sync-source-reg" numbered="true" toc="include" removeInRFC="false" pn="section-5.4">
        <name slugifiedName="name-stamp-synchronization-sourc">STAMP Synchronization Sources Subregistry</name>
        <t indent="0" pn="section-5.4-1">
   IANA has created the "STAMP Synchronization Sources" subregistry.
The code points in this registry are allocated according
   to the registration procedures
<xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/> described in 
<xref target="iana-sync-source-tbl" format="default" sectionFormat="of" derivedContent="Table 6"/>.
        </t>
        <table anchor="iana-sync-source-tbl" align="center" pn="table-6">
          <name slugifiedName="name-registration-procedures-for-t">Registration Procedures for the STAMP Synchronization Sources Subregistry</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Range</th>
              <th align="center" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">1 - 127</td>
              <td align="center" colspan="1" rowspan="1">IETF Review</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">128 - 239</td>
              <td align="center" colspan="1" rowspan="1">First Come First Served</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">240 - 249</td>
              <td align="center" colspan="1" rowspan="1">Experimental Use</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">250 - 254</td>
              <td align="center" colspan="1" rowspan="1">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-5.4-3">Per this document, IANA has allocated the following values in the "STAMP Synchronization Sources" subregistry:
</t>
        <table anchor="ssync-source-new-tbl" align="center" pn="table-7">
          <name slugifiedName="name-stamp-synchronization-source">STAMP Synchronization Sources</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="center" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="center" colspan="1" rowspan="1">NTP</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="center" colspan="1" rowspan="1">PTP</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="center" colspan="1" rowspan="1">SSU/BITS</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="center" colspan="1" rowspan="1">GPS/GLONASS/LORAN-C/BDS/Galileo</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">5</td>
              <td align="center" colspan="1" rowspan="1">Local free-running</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">255</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-tiemstamp-methog-reg" numbered="true" toc="include" removeInRFC="false" pn="section-5.5">
        <name slugifiedName="name-stamp-timestamping-methods-">STAMP Timestamping Methods Subregistry</name>
        <t indent="0" pn="section-5.5-1">
   IANA has created the "STAMP Timestamping Methods" subregistry.
The code points in this registry are allocated
   according to the registration procedures
<xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>
described in
<xref target="iana-timestamp-method-tbl" format="default" sectionFormat="of" derivedContent="Table 8"/>.
        </t>
        <table anchor="iana-timestamp-method-tbl" align="center" pn="table-8">
          <name slugifiedName="name-registration-procedures-for-th">Registration Procedures for the STAMP Timestamping Methods Subregistry</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Range</th>
              <th align="center" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">1 - 127</td>
              <td align="center" colspan="1" rowspan="1">IETF Review</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">128 - 239</td>
              <td align="center" colspan="1" rowspan="1">First Come First Served</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">240 - 249</td>
              <td align="center" colspan="1" rowspan="1">Experimental Use</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">250 - 254</td>
              <td align="center" colspan="1" rowspan="1">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-5.5-3">Per this document, IANA has allocated the following values in the "STAMP Timestamping Methods" subregistry:</t>
        <table anchor="timestamp-method-new-tbl" align="center" pn="table-9">
          <name slugifiedName="name-stamp-timestamping-methods">STAMP Timestamping Methods</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="center" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="center" colspan="1" rowspan="1">HW Assist</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="center" colspan="1" rowspan="1">SW Local</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="center" colspan="1" rowspan="1">Control Plane</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">255</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-return-code-reg" numbered="true" toc="include" removeInRFC="false" pn="section-5.6">
        <name slugifiedName="name-stamp-return-codes-subregis">STAMP Return Codes Subregistry</name>
        <t indent="0" pn="section-5.6-1">
   IANA has created the "STAMP Return Codes" subregistry.
The code points in this registry are allocated
   according to the registration procedures <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/> described in
<xref target="iana-return-code-tbl" format="default" sectionFormat="of" derivedContent="Table 10"/>.
        </t>
        <table anchor="iana-return-code-tbl" align="center" pn="table-10">
          <name slugifiedName="name-registration-procedures-for-the">Registration Procedures for the STAMP Return Codes Subregistry</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Range</th>
              <th align="center" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">1 - 127</td>
              <td align="center" colspan="1" rowspan="1">IETF Review</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">128 - 239</td>
              <td align="center" colspan="1" rowspan="1">First Come First Served</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">240 - 249</td>
              <td align="center" colspan="1" rowspan="1">Experimental Use</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">250 - 254</td>
              <td align="center" colspan="1" rowspan="1">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-5.6-3">Per this document, IANA has allocated the following values in the "STAMP Return Codes" subregistry:</t>
        <table anchor="return-code-new-tbl" align="center" pn="table-11">
          <name slugifiedName="name-stamp-return-codes">STAMP Return Codes</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="center" colspan="1" rowspan="1">Description</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="center" colspan="1" rowspan="1">Network available</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="center" colspan="1" rowspan="1">Network unavailable</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">255</td>
              <td align="center" colspan="1" rowspan="1">Reserved</td>
              <td align="left" colspan="1" rowspan="1">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section anchor="security" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-6-1">
This document defines extensions to STAMP <xref target="RFC8762" format="default" sectionFormat="of" derivedContent="RFC8762"/> and inherits all the security considerations
applicable to the base protocol. Additionally, the HMAC TLV is defined in this document.
Though the HMAC TLV protects the integrity of STAMP extensions, it does not protect against a replay attack.
The use of the HMAC TLV is discussed in detail in <xref target="hmac-sec" format="default" sectionFormat="of" derivedContent="Section 4.8"/>.
      </t>
      <t indent="0" pn="section-6-2">
     To protect against a malformed TLV, an implementation of a Session-Sender and Session-Reflector <bcp14>MUST</bcp14>:
      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-6-3">
        <li pn="section-6-3.1">check the setting of the M flag and</li>
        <li pn="section-6-3.2">validate the Length field value.</li>
      </ul>
      <t indent="0" pn="section-6-4">
     As this specification defines the mechanism to test DSCP mapping,
   this document inherits all the security considerations discussed in <xref target="RFC2474" format="default" sectionFormat="of" derivedContent="RFC2474"/>.
   Monitoring and optional control of DSCP using the CoS TLV may be used across the Internet so that
     the Session-Sender and the Session-Reflector are located in domains that use different CoS profiles. Thus,
     it is essential that an operator verify the set of CoS values that is used in the Session-Reflector's domain.
     Also, an implementation of a Session-Reflector <bcp14>SHOULD</bcp14> support a local policy to confirm whether the value sent by the Session-Sender
     can be used as the value of the DSCP field. <xref target="cos-info-section" format="default" sectionFormat="of" derivedContent="Section 4.4"/> defines the use of that local policy.
      </t>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.irtf-pearg-numeric-ids-generation" to="NUM-IDS-GEN"/>
    <references pn="section-7">
      <name slugifiedName="name-references">References</name>
      <references pn="section-7.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2104" target="https://www.rfc-editor.org/info/rfc2104" quoteTitle="true" derivedAnchor="RFC2104">
          <front>
            <title>HMAC: Keyed-Hashing for Message Authentication</title>
            <author initials="H." surname="Krawczyk" fullname="H. Krawczyk">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Bellare" fullname="M. Bellare">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Canetti" fullname="R. Canetti">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="February"/>
            <abstract>
              <t indent="0">This document describes HMAC, a mechanism for message authentication using cryptographic hash functions. HMAC can be used with any iterative cryptographic hash function, e.g., MD5, SHA-1, in combination with a secret shared key.  The cryptographic strength of HMAC depends on the properties of the underlying hash function.  This memo provides information for the Internet community.  This memo does not specify an Internet standard of any kind</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2104"/>
          <seriesInfo name="DOI" value="10.17487/RFC2104"/>
        </reference>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <author initials="M." surname="Cotton" fullname="M. Cotton">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="June"/>
            <abstract>
              <t indent="0">Many protocols make use of points of extensibility that use constants to identify various protocol parameters.  To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper.  For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
              <t indent="0">To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed.  This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
              <t indent="0">This is the third edition of this document; it obsoletes RFC 5226.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="26"/>
          <seriesInfo name="RFC" value="8126"/>
          <seriesInfo name="DOI" value="10.17487/RFC8126"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8762" target="https://www.rfc-editor.org/info/rfc8762" quoteTitle="true" derivedAnchor="RFC8762">
          <front>
            <title>Simple Two-Way Active Measurement Protocol</title>
            <author initials="G." surname="Mirsky" fullname="G. Mirsky">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Jun" fullname="G. Jun">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Nydell" fullname="H. Nydell">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Foote" fullname="R. Foote">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="March"/>
            <abstract>
              <t indent="0">This document describes the Simple Two-way Active Measurement Protocol (STAMP), which enables the measurement of both one-way and round-trip performance metrics, like delay, delay variation, and packet loss.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8762"/>
          <seriesInfo name="DOI" value="10.17487/RFC8762"/>
        </reference>
      </references>
      <references pn="section-7.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="GPS" quoteTitle="true" derivedAnchor="GPS">
          <front>
            <title>Global Positioning System (GPS) Standard Positioning Service (SPS) Performance Standard</title>
            <author>
              <organization showOnFrontPage="true"/>
            </author>
            <date month="April" year="2020"/>
          </front>
          <seriesInfo name="GPS SPS" value="5th Edition"/>
        </reference>
        <reference anchor="IEEE.1588.2008" quoteTitle="true" target="https://doi.org/10.1109/IEEESTD.2008.4579760" derivedAnchor="IEEE.1588.2008">
          <front>
            <title>IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems</title>
            <author>
              <organization showOnFrontPage="true"/>
            </author>
            <date month="July" year="2008"/>
          </front>
          <seriesInfo name="IEEE Std." value="1588-2008"/>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2008.4579760"/>
        </reference>
        <reference anchor="I-D.irtf-pearg-numeric-ids-generation" quoteTitle="true" target="https://tools.ietf.org/html/draft-irtf-pearg-numeric-ids-generation-06" derivedAnchor="NUM-IDS-GEN">
          <front>
            <title>On the Generation of Transient Numeric Identifiers</title>
            <author initials="F." surname="Gont" fullname="Fernando Gont">
              <organization showOnFrontPage="true">SI6 Networks</organization>
            </author>
            <author initials="I." surname="Arce" fullname="Ivan Arce">
              <organization showOnFrontPage="true">Quarkslab</organization>
            </author>
            <date month="January" day="13" year="2021"/>
            <abstract>
              <t indent="0">   This document performs an analysis of the security and privacy
   implications of different types of "transient numeric identifiers"
   used in IETF protocols, and tries to categorize them based on their
   interoperability requirements and their associated failure severity
   when such requirements are not met.  Subsequently, it provides advice
   on possible algorithms that could be employed to satisfy the
   interoperability requirements of each identifier category, while
   minimizing the negative security and privacy implications, thus
   providing guidance to protocol designers and protocol implementers.
   Finally, it describes a number of algorithms that have been employed
   in real implementations to generate transient numeric identifiers,
   and analyzes their security and privacy properties.  This document is
   a product of the Privacy Enhancement and Assessment Research Group
   (PEARG) in the IRTF.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-irtf-pearg-numeric-ids-generation-06"/>
          <format type="TXT" target="https://www.ietf.org/internet-drafts/draft-irtf-pearg-numeric-ids-generation-06.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="RFC2474" target="https://www.rfc-editor.org/info/rfc2474" quoteTitle="true" derivedAnchor="RFC2474">
          <front>
            <title>Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</title>
            <author initials="K." surname="Nichols" fullname="K. Nichols">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Blake" fullname="S. Blake">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Baker" fullname="F. Baker">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Black" fullname="D. Black">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1998" month="December"/>
            <abstract>
              <t indent="0">This document defines the IP header field, called the DS (for differentiated services) field.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2474"/>
          <seriesInfo name="DOI" value="10.17487/RFC2474"/>
        </reference>
        <reference anchor="RFC4868" target="https://www.rfc-editor.org/info/rfc4868" quoteTitle="true" derivedAnchor="RFC4868">
          <front>
            <title>Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec</title>
            <author initials="S." surname="Kelly" fullname="S. Kelly">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Frankel" fullname="S. Frankel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="May"/>
            <abstract>
              <t indent="0">This specification describes the use of Hashed Message Authentication Mode (HMAC) in conjunction with the SHA-256, SHA-384, and SHA-512 algorithms in IPsec.  These algorithms may be used as the basis for data origin authentication and integrity verification mechanisms for the Authentication Header (AH), Encapsulating Security Payload (ESP), Internet Key Exchange Protocol (IKE), and IKEv2 protocols, and also as Pseudo-Random Functions (PRFs) for IKE and IKEv2.  Truncated output lengths are specified for the authentication-related variants, with the corresponding algorithms designated as HMAC-SHA-256-128, HMAC-SHA-384-192, and HMAC-SHA-512-256.  The PRF variants are not truncated, and are called PRF-HMAC-SHA-256, PRF-HMAC-SHA-384, and PRF-HMAC-SHA-512.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4868"/>
          <seriesInfo name="DOI" value="10.17487/RFC4868"/>
        </reference>
        <reference anchor="RFC5357" target="https://www.rfc-editor.org/info/rfc5357" quoteTitle="true" derivedAnchor="RFC5357">
          <front>
            <title>A Two-Way Active Measurement Protocol (TWAMP)</title>
            <author initials="K." surname="Hedayat" fullname="K. Hedayat">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Krzanowski" fullname="R. Krzanowski">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Morton" fullname="A. Morton">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Yum" fullname="K. Yum">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Babiarz" fullname="J. Babiarz">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="October"/>
            <abstract>
              <t indent="0">The One-way Active Measurement Protocol (OWAMP), specified in RFC 4656, provides a common protocol for measuring one-way metrics between network devices.  OWAMP can be used bi-directionally to measure one-way metrics in both directions between two network elements.  However, it does not accommodate round-trip or two-way measurements.  This memo specifies a Two-Way Active Measurement Protocol (TWAMP), based on the OWAMP, that adds two-way or round-trip measurement capabilities.  The TWAMP measurement architecture is usually comprised of two hosts with specific roles, and this allows for some protocol simplifications, making it an attractive alternative in some circumstances.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5357"/>
          <seriesInfo name="DOI" value="10.17487/RFC5357"/>
        </reference>
        <reference anchor="RFC5905" target="https://www.rfc-editor.org/info/rfc5905" quoteTitle="true" derivedAnchor="RFC5905">
          <front>
            <title>Network Time Protocol Version 4: Protocol and Algorithms Specification</title>
            <author initials="D." surname="Mills" fullname="D. Mills">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Martin" fullname="J. Martin" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Burbank" fullname="J. Burbank">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Kasch" fullname="W. Kasch">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="June"/>
            <abstract>
              <t indent="0">The Network Time Protocol (NTP) is widely used to synchronize computer clocks in the Internet.  This document describes NTP version 4 (NTPv4), which is backwards compatible with NTP version 3 (NTPv3), described in RFC 1305, as well as previous versions of the protocol. NTPv4 includes a modified protocol header to accommodate the Internet Protocol version 6 address family.  NTPv4 includes fundamental improvements in the mitigation and discipline algorithms that extend the potential accuracy to the tens of microseconds with modern workstations and fast LANs.  It includes a dynamic server discovery scheme, so that in many cases, specific server configuration is not required.  It corrects certain errors in the NTPv3 design and implementation and includes an optional extension mechanism.   [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5905"/>
          <seriesInfo name="DOI" value="10.17487/RFC5905"/>
        </reference>
        <reference anchor="TS23501" quoteTitle="true" derivedAnchor="TS23501">
          <front>
            <title>Technical Specification Group Services and System Aspects; System Architecture for the 5G System (5GS); Stage 2 (Release 16)</title>
            <author>
              <organization showOnFrontPage="true">3GPP</organization>
            </author>
            <date year="2019"/>
          </front>
          <seriesInfo name="3GPP TS" value="23.501"/>
        </reference>
      </references>
    </references>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.a-1">
         The authors very much appreciate the thorough review and thoughtful comments received from <contact fullname="Tianran Zhou"/>, <contact fullname="Rakesh Gandhi"/>, <contact fullname="Yuezhong Song"/>, and <contact fullname="Yali Wang"/>.
         The authors express their gratitude to <contact fullname="Al Morton"/> for his comments and valuable suggestions.
         The authors greatly appreciate the comments and thoughtful suggestions received from <contact fullname="Martin Duke"/>.
      </t>
    </section>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.b">
      <name slugifiedName="name-contributors">Contributors</name>
      <t indent="0" pn="section-appendix.b-1">
 The following individual contributed text to this document:
      </t>
      <contact fullname="Guo Jun">
        <organization showOnFrontPage="true">ZTE Corporation</organization>
        <address>
          <postal>
            <street>68# Zijinghua Road</street>
            <city>Nanjing</city>
            <region>Jiangsu</region>
            <code>210012</code>
            <country>China</country>
          </postal>
          <phone>+86 18105183663</phone>
          <email>guo.jun2@zte.com.cn</email>
        </address>
      </contact>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.c">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author fullname="Greg Mirsky" initials="G." surname="Mirsky">
        <organization showOnFrontPage="true">ZTE Corp.</organization>
        <address>
          <postal>
            <street/>
            <city/>
            <code/>
            <country/>
          </postal>
          <email>gregimirsky@gmail.com</email>
        </address>
      </author>
      <author fullname="Xiao Min" initials="X." surname="Min">
        <organization showOnFrontPage="true">ZTE Corp.</organization>
        <address>
          <postal>
            <street/>
            <city/>
            <code/>
            <country/>
          </postal>
          <email>xiao.min2@zte.com.cn</email>
        </address>
      </author>
      <author fullname="Henrik Nydell" initials="H." surname="Nydell">
        <organization showOnFrontPage="true">Accedian Networks</organization>
        <address>
          <postal>
            <street/>
            <city/>
            <code/>
            <country/>
          </postal>
          <email>hnydell@accedian.com</email>
        </address>
      </author>
      <author initials="R." surname="Foote" fullname="Richard Foote">
        <organization showOnFrontPage="true">Nokia</organization>
        <address>
          <email>footer.foote@nokia.com</email>
        </address>
      </author>
      <author initials="A." surname="Masputra" fullname="Adi Masputra">
        <organization showOnFrontPage="true">Apple Inc.</organization>
        <address>
          <postal>
            <street>One Apple Park Way</street>
            <city>Cupertino</city>
            <region>CA</region>
            <code>95014</code>
            <country>United States of America</country>
          </postal>
          <email>adi@apple.com</email>
        </address>
      </author>
      <author fullname="Ernesto Ruffini" initials="E." surname="Ruffini">
        <organization showOnFrontPage="true">OutSys</organization>
        <address>
          <postal>
            <street>via Caracciolo, 65</street>
            <city>Milan</city>
            <code>20155</code>
            <country>Italy</country>
          </postal>
          <email>eruffini@outsys.org</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
