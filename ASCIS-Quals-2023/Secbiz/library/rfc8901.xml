<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="info" consensus="true" docName="draft-ietf-dnsop-multi-provider-dnssec-05" indexInclude="true" ipr="trust200902" number="8901" prepTime="2020-09-24T14:27:46" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="4" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-multi-provider-dnssec-05" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc8901" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="Multi-Signer DNSSEC Models">Multi-Signer DNSSEC Models</title>
    <seriesInfo name="RFC" value="8901" stream="IETF"/>
    <author fullname="Shumon Huque" initials="S." surname="Huque">
      <organization showOnFrontPage="true">Salesforce</organization>
      <address>
        <postal>
          <street>415 Mission Street, 3rd Floor</street>
          <city>San Francisco</city>
          <region>CA</region>
          <code>94105</code>
          <country>United States of America</country>
        </postal>
        <email>shuque@gmail.com</email>
      </address>
    </author>
    <author fullname="Pallavi Aras" initials="P." surname="Aras">
      <organization showOnFrontPage="true">Salesforce</organization>
      <address>
        <postal>
          <street>415 Mission Street, 3rd Floor</street>
          <city>San Francisco</city>
          <region>CA</region>
          <code>94105</code>
          <country>United States of America</country>
        </postal>
        <email>paras@salesforce.com</email>
      </address>
    </author>
    <author fullname="John Dickinson" initials="J." surname="Dickinson">
      <organization showOnFrontPage="true">Sinodun IT</organization>
      <address>
        <postal>
          <street>Magdalen Centre</street>
          <street>Oxford Science Park</street>
          <city>Oxford</city>
          <code>OX4 4GA</code>
          <country>United Kingdom</country>
        </postal>
        <email>jad@sinodun.com</email>
      </address>
    </author>
    <author fullname="Jan Vcelak" initials="J." surname="Vcelak">
      <organization showOnFrontPage="true">NS1</organization>
      <address>
        <postal>
          <street>55 Broad Street, 19th Floor</street>
          <city>New York</city>
          <region>NY</region>
          <code>10004</code>
          <country>United States of America</country>
        </postal>
        <email>jvcelak@ns1.com</email>
      </address>
    </author>
    <author fullname="David Blacka" initials="D." surname="Blacka">
      <organization showOnFrontPage="true">Verisign</organization>
      <address>
        <postal>
          <street>12061 Bluemont Way</street>
          <city>Reston</city>
          <region>VA</region>
          <code>20190</code>
          <country>United States of America</country>
        </postal>
        <email>davidb@verisign.com</email>
      </address>
    </author>
    <date month="09" year="2020"/>
    <area>General</area>
    <workgroup>Internet Engineering Task Force</workgroup>
    <keyword>DNSSEC</keyword>
    <keyword>Multiple</keyword>
    <keyword>Provider</keyword>
    <keyword>Signer</keyword>
    <keyword>Models</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
        Many enterprises today employ the service of multiple DNS
        providers to distribute their authoritative DNS service.
        Deploying DNSSEC in such an environment may present some
        challenges, depending on the configuration and feature set
        in use. In particular, when each DNS provider independently
        signs zone data with their own keys, additional key-management
        mechanisms are necessary. This document presents deployment
        models that accommodate this scenario and describes these
	key-management requirements. These models do not require any changes
        to the behavior of validating resolvers, nor do they impose the
        new key-management requirements on authoritative servers not
        involved in multi-signer configurations.
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.  
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841. 
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc8901" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction-and-motivation">Introduction and Motivation</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-deployment-models">Deployment Models</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2">
              <li pn="section-toc.1-1.2.2.1">
                <t indent="0" pn="section-toc.1-1.2.2.1.1"><xref derivedContent="2.1" format="counter" sectionFormat="of" target="section-2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-multiple-signer-models">Multiple-Signer Models</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2.1.2">
                  <li pn="section-toc.1-1.2.2.1.2.1">
                    <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.1.2.1.1"><xref derivedContent="2.1.1" format="counter" sectionFormat="of" target="section-2.1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-model-1-common-ksk-set-uniq">Model 1: Common KSK Set, Unique ZSK Set per Provider</xref></t>
                  </li>
                  <li pn="section-toc.1-1.2.2.1.2.2">
                    <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.1.2.2.1"><xref derivedContent="2.1.2" format="counter" sectionFormat="of" target="section-2.1.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-model-2-unique-ksk-set-and-">Model 2: Unique KSK Set and ZSK Set per Provider</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-validating-resolver-behavio">Validating Resolver Behavior</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-signing-algorithm-considera">Signing-Algorithm Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-authenticated-denial-consid">Authenticated-Denial Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-single-method">Single Method</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-mixing-methods">Mixing Methods</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-rollover-considerations">Key Rollover Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-model-1-common-ksk-unique-z">Model 1: Common KSK, Unique ZSK per Provider</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t indent="0" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-model-2-unique-ksk-and-zsk-">Model 2: Unique KSK and ZSK per Provider</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-using-combined-signing-keys">Using Combined Signing Keys</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-use-of-cds-and-cdnskey">Use of CDS and CDNSKEY</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-key-management-mechanism-re">Key-Management-Mechanism Requirements</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-dns-response-size-considera">DNS Response-Size Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="12" format="counter" sectionFormat="of" target="section-12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="13" format="counter" sectionFormat="of" target="section-13"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.2">
              <li pn="section-toc.1-1.13.2.1">
                <t indent="0" pn="section-toc.1-1.13.2.1.1"><xref derivedContent="13.1" format="counter" sectionFormat="of" target="section-13.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.2">
                <t indent="0" pn="section-toc.1-1.13.2.2.1"><xref derivedContent="13.2" format="counter" sectionFormat="of" target="section-13.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.14">
            <t indent="0" pn="section-toc.1-1.14.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.15">
            <t indent="0" pn="section-toc.1-1.15.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction-and-motivation">Introduction and Motivation</name>
      <t indent="0" pn="section-1-1">
        Many enterprises today employ the service of multiple Domain Name
        System (DNS) <xref target="RFC1034" format="default" sectionFormat="of" derivedContent="RFC1034"/> <xref target="RFC1035" format="default" sectionFormat="of" derivedContent="RFC1035"/>
        providers to distribute their authoritative DNS service. This is
        primarily done for redundancy and availability, and it allows the DNS
        service to survive a complete, catastrophic failure of any single
        provider. Additionally, enterprises or providers occasionally have
        requirements that preclude standard zone-transfer techniques
        <xref target="RFC1995" format="default" sectionFormat="of" derivedContent="RFC1995"/><xref target="RFC5936" format="default" sectionFormat="of" derivedContent="RFC5936"/>: either nonstandardized DNS features are in use
	that are incompatible with zone transfer, or operationally a provider
        must be able to (re-)sign DNS records using their own keys.
        This document outlines some possible models of DNSSEC
        <xref target="RFC4033" format="default" sectionFormat="of" derivedContent="RFC4033"/> <xref target="RFC4034" format="default" sectionFormat="of" derivedContent="RFC4034"/> <xref target="RFC4035" format="default" sectionFormat="of" derivedContent="RFC4035"/> deployment
	in such an environment.
      </t>
      <t indent="0" pn="section-1-2">
        This document assumes a reasonable level of familiarity with
        DNS operations and protocol terms. Much of the terminology
        is explained in further detail in <xref target="RFC8499" format="default" sectionFormat="of" derivedContent="RFC8499">
        "DNS Terminology"</xref>.
      </t>
    </section>
    <section anchor="models" numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-deployment-models">Deployment Models</name>
      <t indent="0" pn="section-2-1">
        If a zone owner can use standard zone-transfer techniques, then
        the presence of multiple providers does not require modifications
        to the normal deployment models. In these deployments, there is a
        single signing entity (which may be the zone owner, one of the
        providers, or a separate entity), while the providers act as secondary
        authoritative servers for the zone.
      </t>
      <t indent="0" pn="section-2-2">
        Occasionally, however, standard zone-transfer techniques
        cannot be used.  This could be due to the use of nonstandard
        DNS features or the operational requirements of a given
        provider (e.g., a provider that only supports "online
        signing").  In these scenarios, the multiple providers each act
        like primary servers, independently signing data received from
        the zone owner and serving it to DNS queriers. This configuration
        presents some novel challenges and requirements.
      </t>
      <section anchor="multi-sign" numbered="true" toc="include" removeInRFC="false" pn="section-2.1">
        <name slugifiedName="name-multiple-signer-models">Multiple-Signer Models</name>
        <t indent="0" pn="section-2.1-1">
        In this category of models, multiple providers each
        independently sign and serve the same zone. The zone owner
        typically uses provider-specific APIs to update zone content
        identically at each of the providers and relies on the provider
        to perform signing of the data. A key requirement here is to
        manage the contents of the DNSKEY and Delegation Signer (DS) RRsets
        in such a way that validating resolvers always have a viable path
        to authenticate the DNSSEC signature chain, no matter which
        provider is queried. This requirement is achieved by having
        each provider import the public Zone Signing Keys (ZSKs) of
        all other providers into their DNSKEY RRsets.
        </t>
        <t indent="0" pn="section-2.1-2">
        These models can support DNSSEC even for the nonstandard
        features mentioned previously, if the DNS providers have the
        capability of signing the response data generated by those
        features. Since these responses are often generated
        dynamically at query time, one method is for the provider to
        perform online signing (also known as on-the-fly signing). However,
        another possible approach is to precompute all the possible
        response sets and associated signatures and then algorithmically
        determine at query time which response set and signature need
        to be returned.
        </t>
        <t indent="0" pn="section-2.1-3">
        In the models presented, the function of coordinating the DNSKEY or
        DS RRset does not involve the providers communicating directly with
        each other. Feedback from several commercial managed-DNS providers
        indicates that they may be unlikely to directly communicate, since
        they typically have a contractual relationship only with the zone
        owner. However, if the parties involved are agreeable, it may be
        possible to devise a protocol mechanism by which the providers
        directly communicate to share keys. Details of such a protocol are
        deferred to a future specification document, should there be interest.
        </t>
        <t indent="0" pn="section-2.1-4">
        In the descriptions below, the Key Signing Key (KSK) and Zone
        Signing Key (ZSK) correspond to the definitions in
        <xref target="RFC8499" format="default" sectionFormat="of" derivedContent="RFC8499"/>, with the caveat that the KSK not
        only signs the zone apex DNSKEY RRset but also serves as the
        Secure Entry Point (SEP) into the zone.
        </t>
        <section anchor="model1" numbered="true" toc="include" removeInRFC="false" pn="section-2.1.1">
          <name slugifiedName="name-model-1-common-ksk-set-uniq">Model 1: Common KSK Set, Unique ZSK Set per Provider</name>
          <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-2.1.1-1">
            <li pn="section-2.1.1-1.1">The zone owner holds the KSK set, manages the DS record set,
           and is responsible for signing the DNSKEY RRset and distributing
           it to the providers.</li>
            <li pn="section-2.1.1-1.2">Each provider has their own ZSK set, which is used to sign data
           in the zone.</li>
            <li pn="section-2.1.1-1.3">The providers have an API that the zone owner uses to query the ZSK
           public keys and insert a combined DNSKEY RRset that includes
           the ZSK sets of each provider and the KSK set, signed by the KSK.</li>
            <li pn="section-2.1.1-1.4">Note that even if the contents of the DNSKEY RRset do not change,
           the zone owner needs to periodically re-sign it as signature
           expiration approaches. The provider API is also used
           to thus periodically redistribute the refreshed DNSKEY RRset.</li>
            <li pn="section-2.1.1-1.5">Key rollovers need coordinated participation of the zone
           owner to update the DNSKEY RRset (for KSK or ZSK) and the
           DS RRset (for KSK).</li>
            <li pn="section-2.1.1-1.6">(One specific variant of this model that may be interesting is
           a configuration in which there is only a single provider. A
           possible use case for this is where the zone owner wants to
           outsource the signing and operation of their DNS zone to a single
           third-party provider but still control the KSK, so that they can
           authorize and/or revoke the use of specific zone signing keys.)</li>
          </ul>
        </section>
        <section anchor="model2" numbered="true" toc="include" removeInRFC="false" pn="section-2.1.2">
          <name slugifiedName="name-model-2-unique-ksk-set-and-">Model 2: Unique KSK Set and ZSK Set per Provider</name>
          <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-2.1.2-1">
            <li pn="section-2.1.2-1.1">Each provider has their own KSK and ZSK sets.</li>
            <li pn="section-2.1.2-1.2">Each provider offers an API that the zone owner uses to import
           the ZSK sets of the other providers into their DNSKEY RRset.</li>
            <li pn="section-2.1.2-1.3">The DNSKEY RRset is signed independently by each provider using
           their own KSK.</li>
            <li pn="section-2.1.2-1.4">The zone owner manages the DS RRset located in the parent zone.
           This is comprised of DS records corresponding to the KSKs of
           each provider.</li>
            <li pn="section-2.1.2-1.5">Key rollovers need coordinated participation of the zone
           owner to update the DS RRset (for KSK) and the DNSKEY
           RRset (for ZSK).</li>
          </ul>
        </section>
      </section>
    </section>
    <section anchor="resolver" numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-validating-resolver-behavio">Validating Resolver Behavior</name>
      <t indent="0" pn="section-3-1">
        The central requirement for both of the <xref target="multi-sign" format="default" sectionFormat="of" derivedContent="Section 2.1">multiple-signer models</xref> is to ensure
        that the ZSKs from all providers are present in each
        provider's apex DNSKEY RRset and vouched for by either the
        single KSK (in Model 1) or each provider's KSK (in Model 2.)

        If this is not done, the following situation can arise (assuming
        two providers, A and B):

      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-3-2">
        <li pn="section-3-2.1">The validating resolver follows a referral (i.e., secure delegation)
        to the zone in question.</li>
        <li pn="section-3-2.2">It retrieves the zone's DNSKEY RRset from one of Provider
        A's nameservers, authenticates it against the parent DS RRset,
        and caches it.</li>
        <li pn="section-3-2.3">At some point in time, the resolver attempts to resolve a
        name in the zone while the DNSKEY RRset received from Provider A
        is still viable in its cache.</li>
        <li pn="section-3-2.4">It queries one of Provider B's nameservers to resolve the
        name and obtains a response that is signed by Provider B's
        ZSK, which it cannot authenticate because this ZSK is not present
        in its cached DNSKEY RRset for the zone that it received from
        Provider A.</li>
        <li pn="section-3-2.5">The resolver will not accept this response. It may still
        be able to ultimately authenticate the name by querying other
        nameservers for the zone until it elicits a response from one
        of Provider A's nameservers. But it has incurred the penalty
        of additional round trips with other nameservers, with the
        corresponding latency and processing costs. The exact number
        of additional round trips depends on details of the resolver's
        nameserver-selection algorithm and the number of nameservers
        configured at Provider B.</li>
        <li pn="section-3-2.6">It may also be the case that a resolver is unable to
        provide an authenticated response, because it gave up after
        a certain number of retries or a certain amount of delay; or it is
	possible that downstream clients of the resolver that originated the
        query timed out waiting for a response.
        </li>
      </ul>
      <t indent="0" pn="section-3-3">

        Hence, it is important that the DNSKEY RRset at each provider is
        maintained with the active ZSKs of all participating providers.
        This ensures that resolvers can validate a response no matter
        which provider's nameservers it came from.
      </t>
      <t indent="0" pn="section-3-4">
        Details of how the DNSKEY RRset itself is validated differ.
        In <xref target="model1" format="default" sectionFormat="of" derivedContent="Section 2.1.1">Model 1</xref>, one unique KSK
        managed by the zone owner signs an identical DNSKEY RRset
        deployed at each provider, and the signed DS record in the
        parent zone refers to this KSK. In <xref target="model2" format="default" sectionFormat="of" derivedContent="Section 2.1.2">Model 2</xref>, each provider has a
        distinct KSK and signs the DNSKEY RRset with it.  The zone
        owner deploys a DS RRset at the parent zone that contains
        multiple DS records, each referring to a distinct provider's
        KSK. Hence, it does not matter which provider's nameservers the
        resolver obtains the DNSKEY RRset from; the signed DS record
        in each model can authenticate the associated KSK.
      </t>
    </section>
    <section anchor="algorithms" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-signing-algorithm-considera">Signing-Algorithm Considerations</name>
      <t indent="0" pn="section-4-1">
        DNS providers participating in multi-signer models need to use
        a common DNSSEC signing algorithm (or a common set of algorithms
        if several are in use). This is because the current specifications
        require that if there are multiple algorithms in the DNSKEY RRset,
        then RRsets in the zone need to be signed with at least one DNSKEY
        of each algorithm, as described in <xref target="RFC4035" sectionFormat="comma" section="2.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4035#section-2.2" derivedContent="RFC4035"/>. If providers
        employ distinct signing algorithms, then this requirement cannot
        be satisfied.
      </t>
    </section>
    <section anchor="nsec" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-authenticated-denial-consid">Authenticated-Denial Considerations</name>
      <t indent="0" pn="section-5-1">
        Authenticated denial of existence enables a resolver to validate that
        a record does not exist. For this purpose, an authoritative server
        presents, in a response to the resolver, signed NSEC (<xref target="RFC4035" sectionFormat="of" section="3.1.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4035#section-3.1.3" derivedContent="RFC4035"/>) or NSEC3
	(<xref target="RFC5155" sectionFormat="of" section="7.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5155#section-7.2" derivedContent="RFC5155"/>) records
	that provide cryptographic proof of
        this nonexistence. The NSEC3 method enhances NSEC by
        providing opt-out for signing insecure delegations and also adds
        limited protection against zone-enumeration attacks.
      </t>
      <t indent="0" pn="section-5-2">
        An authoritative server response carrying records for authenticated
        denial is always self-contained, and the receiving resolver doesn't
        need to send additional queries to complete the proof of denial.
        For this reason, no rollover is needed when switching between NSEC
        and NSEC3 for a signed zone.
      </t>
      <t indent="0" pn="section-5-3">
        Since authenticated-denial responses are self-contained, NSEC and
        NSEC3 can be used by different providers to serve the same zone.
        Doing so, however, defeats the protection against zone enumeration
        provided by NSEC3 (because an adversary can trivially enumerate
        the zone by just querying the providers that employ NSEC). A
        better configuration involves multiple providers using different
        authenticated denial-of-existence mechanisms that all provide
	zone-enumeration defense, such as precomputed NSEC3,
        <xref target="RFC7129" format="default" sectionFormat="of" derivedContent="RFC7129">NSEC3 white lies</xref>,
        <xref target="I-D.valsorda-dnsop-black-lies" format="default" sectionFormat="of" derivedContent="BLACKLIES">NSEC
	black lies</xref>, etc. Note, however,
        that having multiple providers offering different authenticated-denial
        mechanisms may impact how effectively resolvers are able to make
        use of the caching of negative responses.
      </t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-single-method">Single Method</name>
        <t indent="0" pn="section-5.1-1">
          Usually, the NSEC and NSEC3 methods are used exclusively (i.e., the
          methods are not used at the same time by different servers). This
          configuration is preferred, because the behavior is well defined and
          closest to current operational practice.
        </t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-mixing-methods">Mixing Methods</name>
        <t indent="0" pn="section-5.2-1">
          Compliant resolvers should be able to validate zone data when
          different authoritative servers for the same zone respond with
          different authenticated-denial methods, because this is normally
          observed when NSEC and NSEC3 are being switched or when NSEC3PARAM
          is updated.
        </t>
        <t indent="0" pn="section-5.2-2">
          Resolver software may, however, be designed to handle a single
          transition between two authenticated denial configurations more
          optimally than a permanent setup with mixed authenticated-denial
          methods. This could make caching on the resolver side less
          efficient, and the authoritative servers may observe a higher number
          of queries. This aspect should be considered especially in the
          context of <xref target="RFC8198" format="default" sectionFormat="of" derivedContent="RFC8198">"Aggressive Use of DNSSEC-Validated
          Cache"</xref>.
        </t>
        <t indent="0" pn="section-5.2-3">
          In case all providers cannot be configured with the same
          authenticated-denial mechanism, it is recommended to limit
          the distinct configurations to the lowest number feasible.
        </t>
        <t indent="0" pn="section-5.2-4">
          Note that NSEC3 configuration on all providers with
          different NSEC3PARAM values is considered a mixed setup.
        </t>
      </section>
    </section>
    <section anchor="keyrollover" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-key-rollover-considerations">Key Rollover Considerations</name>
      <t indent="0" pn="section-6-1">
        The <xref target="multi-sign" format="default" sectionFormat="of" derivedContent="Section 2.1">multiple-signer</xref> models
        introduce some new requirements for DNSSEC key rollovers.
        Since this process necessarily involves coordinated actions on
        the part of providers and the zone owner, one reasonable
        strategy is for the zone owner to initiate key-rollover
        operations. But other operationally plausible models may also
        suit, such as a DNS provider initiating a key rollover and
        signaling their intent to the zone owner in some manner. The
        mechanism to communicate this intent could be some secure
        out-of-band channel that has been agreed upon, or the provider
        could offer an API function that could be periodically polled
        by the zone owner.
      </t>
      <t indent="0" pn="section-6-2">
        For simplicity, the descriptions in this section assume two DNS
	providers. They also assume that KSK rollovers employ
        the commonly used Double-Signature KSK rollover method and
        that ZSK rollovers employ the Pre-Publish ZSK rollover
        method, as described in detail in <xref target="RFC6781" format="default" sectionFormat="of" derivedContent="RFC6781"/>.
        With minor modifications, they can be easily adapted to
        other models, such as Double-DS KSK rollover or Double-Signature ZSK
	rollover, if desired. Key-use timing should
        follow the recommendations outlined in <xref target="RFC6781" format="default" sectionFormat="of" derivedContent="RFC6781"/>,
        but taking into account the additional operations needed by
        the multi-signer models. For example, "time to propagate data
        to all the authoritative servers" now includes the time to import
        the new ZSKs into each provider.
      </t>
      <section anchor="krc-model1" numbered="true" toc="include" removeInRFC="false" pn="section-6.1">
        <name slugifiedName="name-model-1-common-ksk-unique-z">Model 1: Common KSK, Unique ZSK per Provider</name>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-6.1-1">
          <li pn="section-6.1-1.1">
          Key Signing Key Rollover: In this model, the two managed-DNS
          providers share a common KSK (public key) in their respective
          zones, and the zone owner has sole access to the private key portion of the KSK. To
          initiate the rollover, the zone owner generates a new KSK and obtains
          the DNSKEY RRset of each DNS provider using their respective APIs.
          The new KSK is added to each provider's DNSKEY RRset, and the RRset
          is re-signed with both the new and the old KSK. This new DNSKEY RRset
          is then transferred to each provider. The zone owner then updates
          the DS RRset in the parent zone to point to the new KSK and, after
          the necessary DS record TTL period has expired, proceeds with
          updating the DNSKEY RRset to remove the old KSK.
        </li>
          <li pn="section-6.1-1.2">
          Zone Signing Key Rollover: In this model, each DNS provider has
          separate Zone Signing Keys. Each provider can choose to roll their
          ZSK independently by coordinating with the zone owner. Provider A
          would generate a new ZSK and communicate their intent to perform a
          rollover (note that Provider A cannot immediately insert this new
          ZSK into their DNSKEY RRset, because the RRset has to be signed by
          the zone owner). The zone owner obtains the new ZSK from
          Provider A. It then obtains the current DNSKEY RRset from each
          provider (including Provider A), inserts the new ZSK into each DNSKEY
          RRset, re-signs the DNSKEY RRset, and sends it back to each provider
          for deployment via their respective key-management APIs. Once the
          necessary time period has elapsed (i.e., all zone data has been
          re-signed by the new ZSK and propagated to all authoritative servers
          for the zone, plus the maximum zone-TTL value of any of the data in
          the zone that has been signed by the old ZSK), Provider A and the
          zone owner can initiate the next phase of removing the old ZSK and
          re-signing the resulting new DNSKEY RRset.
        </li>
        </ul>
      </section>
      <section anchor="krc-model2" numbered="true" toc="include" removeInRFC="false" pn="section-6.2">
        <name slugifiedName="name-model-2-unique-ksk-and-zsk-">Model 2: Unique KSK and ZSK per Provider</name>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-6.2-1">
          <li pn="section-6.2-1.1">
          Key Signing Key Rollover: In Model 2, each managed-DNS provider
          has their own KSK. A KSK roll for Provider A does not require any
          change in the DNSKEY RRset of Provider B but does require
          co-ordination with the zone owner in order to get the DS record
          set in the parent zone updated. The KSK roll starts with Provider
          A generating a new KSK and including it in their DNSKEY RRSet.
          The DNSKey RRset would then be signed by both the new and old KSK.
          The new KSK is communicated to the zone owner, after which the zone
          owner updates the DS RRset to replace the DS record for the old KSK
          with a DS record for the new KSK. After the necessary DS RRset TTL
          period has elapsed, the old KSK can be removed from Provider A's
          DNSKEY RRset.
        </li>
          <li pn="section-6.2-1.2">
          Zone Signing Key Rollover: In Model 2, each managed-DNS provider
          has their own ZSK. The ZSK roll for Provider A would start with
          them generating a new ZSK, including it in their DNSKEY RRset, and
          re-signing the new DNSKEY RRset with their KSK. The new ZSK of
          Provider A would then be communicated to the zone owner, who would
          initiate the process of importing this ZSK into the DNSKEY RRsets
          of the other providers, using their respective APIs. Before
	  signing zone data with the new ZSK, Provider A should wait
	  for the DNSKEY TTL plus the time to import the ZSK into
	  Provider B, plus the time to propagate the DNSKEY RRset to
	  all authoritative servers of both providers.  Once the
          necessary Pre-Publish key-rollover time periods have elapsed,
          Provider A and the zone owner can initiate the process of removing
          the old ZSK from the DNSKEY RRsets of all providers.
        </li>
        </ul>
      </section>
    </section>
    <section anchor="CSK" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-using-combined-signing-keys">Using Combined Signing Keys</name>
      <t indent="0" pn="section-7-1">
        A Combined Signing Key (CSK) is one in which the same key serves the
        purposes of both being the secure entry point (SEP) key for the zone
        and signing all the zone data, including the DNSKEY RRset
        (i.e., there is no KSK/ZSK split).
      </t>
      <t indent="0" pn="section-7-2">
        Model 1 is not compatible with CSKs because the zone owner would then
        hold the sole signing key, and providers would not be able to sign
        their own zone data.
      </t>
      <t indent="0" pn="section-7-3">
        Model 2 can accommodate CSKs without issue. In this case, any or all
        of the providers could employ a CSK. The DS record in the parent zone
        would reference the provider's CSK instead of KSK, and the public
        CSK would need to be imported into the DNSKEY RRsets of all of the other
        providers. A CSK key rollover for such a provider would involve the
        following: The provider generates a new CSK, installs the new CSK
        into the DNSKEY RRset, and signs it with both the old and new CSKs.
        The new CSK is communicated to the zone owner. The zone owner exports
        this CSK into the other provider's DNSKEY RRsets and replaces the DS
        record referencing the old CSK with one referencing the new one in
        the parent DS RRset. Once all the zone data has been re-signed with
        the new CSK, the old CSK is removed from the DNSKEY RRset, and the
        latter is re-signed with only the new CSK. Finally, the old CSK is
        removed from the DNSKEY RRsets of the other providers.
      </t>
    </section>
    <section anchor="CDS-CDNSKEY" numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-use-of-cds-and-cdnskey">Use of CDS and CDNSKEY</name>
      <t indent="0" pn="section-8-1">
        CDS and CDNSKEY records <xref target="RFC7344" format="default" sectionFormat="of" derivedContent="RFC7344"/><xref target="RFC8078" format="default" sectionFormat="of" derivedContent="RFC8078"/>
        are used to facilitate automated updates
        of DNSSEC secure-entry-point keys between parent and child
        zones. Multi-signer DNSSEC configurations can support this, too.
        In Model 1, CDS/CDNSKEY changes are centralized at the zone owner.
        However, the zone owner will still need to push down updated
        signed CDNS/DNSKEY RRsets to the providers via the key-management
        mechanism. In Model 2, the key-management mechanism needs to
        support cross-importation of the CDS/CDNSKEY records, so that a
        common view of the RRset can be constructed at each provider and
        is visible to the parent zone attempting to update the DS RRset.
      </t>
    </section>
    <section anchor="Key-Management" numbered="true" toc="include" removeInRFC="false" pn="section-9">
      <name slugifiedName="name-key-management-mechanism-re">Key-Management-Mechanism Requirements</name>
      <t indent="0" pn="section-9-1">
        Managed-DNS providers typically have their own proprietary zone
        configuration and data-management APIs, commonly utilizing
        HTTPS and Representational State Transfer (REST) interfaces. So, rather
	than outlining a new API for
        key management here, we describe the specific functions that the
        provider API needs to support in order to enable the multi-signer
        models. The zone owner is expected to use these API functions to
        perform key-management tasks. Other mechanisms that can partly
        offer these functions, if supported by the providers, include the
        <xref target="RFC2136" format="default" sectionFormat="of" derivedContent="RFC2136">DNS UPDATE protocol</xref> and
        <xref target="RFC5731" format="default" sectionFormat="of" derivedContent="RFC5731">Extensible Provisioning
	Protocol (EPP)</xref>.
      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-9-2">
        <li pn="section-9-2.1">The API must offer a way to query the current DNSKEY RRset
           of the provider.</li>
        <li pn="section-9-2.2">For Model 1, the API must offer a way to import a signed
           DNSKEY RRset and replace the current one at the provider.
           Additionally, if CDS/CDNSKEY is supported, the API must also
           offer a way to import a signed CDS/CDNSKEY RRset.</li>
        <li pn="section-9-2.3">For Model 2, the API must offer a way to import a DNSKEY
           record from an external provider into the current DNSKEY
           RRset. Additionally, if CDS/CDNSKEY is supported, the
           API must offer a mechanism to import individual CDS/CDNSKEY
           records from an external provider.</li>
      </ul>
      <t indent="0" pn="section-9-3">
        In Model 2, once initially bootstrapped with each other's zone-signing
	keys via these API mechanisms, providers could, if desired,
        periodically query each other's DNSKEY RRsets, authenticate their
        signatures,  and automatically import or withdraw ZSKs in the keyset
        as key-rollover events happen.
      </t>
    </section>
    <section anchor="Response-Size" numbered="true" toc="include" removeInRFC="false" pn="section-10">
      <name slugifiedName="name-dns-response-size-considera">DNS Response-Size Considerations</name>
      <t indent="0" pn="section-10-1">
        The multi-signer models result in larger DNSKEY RRsets, so the size
        of a response to a query for the DNSKEY RRset will be larger. The
        actual size increase depends on multiple factors: DNSKEY algorithm
        and keysize choices, the number of providers, whether additional keys
        are prepublished, how many simultaneous key rollovers are in progress,
        etc. Newer elliptic-curve algorithms produce keys small enough that the
        responses will typically be far below the common Internet-path MTU.
        Thus, operational concerns related to IP fragmentation or truncation
        and TCP fallback are unlikely to be encountered. In any case, DNS
        operators need to ensure that they can emit and process large DNS UDP
        responses when necessary, and a future migration to alternative
        transports like <xref target="RFC7858" format="default" sectionFormat="of" derivedContent="RFC7858">DNS over TLS</xref> or
        <xref target="RFC8484" format="default" sectionFormat="of" derivedContent="RFC8484">DNS over HTTPS</xref> may make this topic moot.
      </t>
    </section>
    <section anchor="IANA" numbered="true" toc="include" removeInRFC="false" pn="section-11">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-11-1">This document has no IANA actions.</t>
    </section>
    <section anchor="Security" numbered="true" toc="include" removeInRFC="false" pn="section-12">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-12-1">
        The multi-signer models necessarily involve third-party providers
        holding the private keys that sign the zone-owner's data. Obviously,
        this means that the zone owner has decided to place a great deal
        of trust in these providers. By contrast, the more traditional
        model in which the zone owner runs a hidden master and uses the
	zone-transfer protocol with the providers is arguably more secure,
	because
        only the zone owner holds the private signing keys, and the third-party
        providers cannot serve bogus data without detection by validating
        resolvers.
      </t>
      <t indent="0" pn="section-12-2">
	The zone-key import and export APIs required by these models
        need to be strongly authenticated to prevent tampering of key
        material by malicious third parties. Many providers today
        offer REST/HTTPS APIs that utilize a number of
        client-authentication mechanisms (username/password, API keys etc) and
	whose HTTPS layer provides transport
        security and server authentication.  Multifactor
        authentication could be used to further strengthen security.
        If DNS protocol mechanisms like UPDATE are being used for key
        insertion and deletion, they should similarly be strongly
        authenticated -- e.g., by employing <xref target="RFC2845" format="default" sectionFormat="of" derivedContent="RFC2845">
        Transaction Signatures (TSIG)</xref>.
        Key generation and other general security-related operations
        should follow the guidance specified in <xref target="RFC6781" format="default" sectionFormat="of" derivedContent="RFC6781"/>.
      </t>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.valsorda-dnsop-black-lies" to="BLACKLIES"/>
    <references pn="section-13">
      <name slugifiedName="name-references">References</name>
      <references pn="section-13.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC1034" target="https://www.rfc-editor.org/info/rfc1034" quoteTitle="true" derivedAnchor="RFC1034">
          <front>
            <title>Domain names - concepts and facilities</title>
            <author initials="P.V." surname="Mockapetris" fullname="P.V. Mockapetris">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1987" month="November"/>
            <abstract>
              <t indent="0">This RFC is the revised basic definition of The Domain Name System.  It obsoletes RFC-882.  This memo describes the domain style names and their used for host address look up and electronic mail forwarding.  It discusses the clients and servers in the domain name system and the protocol used between them.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="13"/>
          <seriesInfo name="RFC" value="1034"/>
          <seriesInfo name="DOI" value="10.17487/RFC1034"/>
        </reference>
        <reference anchor="RFC1035" target="https://www.rfc-editor.org/info/rfc1035" quoteTitle="true" derivedAnchor="RFC1035">
          <front>
            <title>Domain names - implementation and specification</title>
            <author initials="P.V." surname="Mockapetris" fullname="P.V. Mockapetris">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1987" month="November"/>
            <abstract>
              <t indent="0">This RFC is the revised specification of the protocol and format used in the implementation of the Domain Name System.  It obsoletes RFC-883. This memo documents the details of the domain name client - server communication.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="13"/>
          <seriesInfo name="RFC" value="1035"/>
          <seriesInfo name="DOI" value="10.17487/RFC1035"/>
        </reference>
        <reference anchor="RFC2845" target="https://www.rfc-editor.org/info/rfc2845" quoteTitle="true" derivedAnchor="RFC2845">
          <front>
            <title>Secret Key Transaction Authentication for DNS (TSIG)</title>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Gudmundsson" fullname="O. Gudmundsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Wellington" fullname="B. Wellington">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2000" month="May"/>
            <abstract>
              <t indent="0">This protocol allows for transaction level authentication using shared secrets and one way hashing.  It can be used to authenticate dynamic updates as coming from an approved client, or to authenticate responses as coming from an approved recursive name server.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2845"/>
          <seriesInfo name="DOI" value="10.17487/RFC2845"/>
        </reference>
        <reference anchor="RFC4033" target="https://www.rfc-editor.org/info/rfc4033" quoteTitle="true" derivedAnchor="RFC4033">
          <front>
            <title>DNS Security Introduction and Requirements</title>
            <author initials="R." surname="Arends" fullname="R. Arends">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Austein" fullname="R. Austein">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Larson" fullname="M. Larson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Massey" fullname="D. Massey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Rose" fullname="S. Rose">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="March"/>
            <abstract>
              <t indent="0">The Domain Name System Security Extensions (DNSSEC) add data origin authentication and data integrity to the Domain Name System.  This document introduces these extensions and describes their capabilities and limitations.  This document also discusses the services that the DNS security extensions do and do not provide.  Last, this document describes the interrelationships between the documents that collectively describe DNSSEC.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4033"/>
          <seriesInfo name="DOI" value="10.17487/RFC4033"/>
        </reference>
        <reference anchor="RFC4034" target="https://www.rfc-editor.org/info/rfc4034" quoteTitle="true" derivedAnchor="RFC4034">
          <front>
            <title>Resource Records for the DNS Security Extensions</title>
            <author initials="R." surname="Arends" fullname="R. Arends">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Austein" fullname="R. Austein">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Larson" fullname="M. Larson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Massey" fullname="D. Massey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Rose" fullname="S. Rose">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="March"/>
            <abstract>
              <t indent="0">This document is part of a family of documents that describe the DNS Security Extensions (DNSSEC).  The DNS Security Extensions are a collection of resource records and protocol modifications that provide source authentication for the DNS.  This document defines the public key (DNSKEY), delegation signer (DS), resource record digital signature (RRSIG), and authenticated denial of existence (NSEC) resource records.  The purpose and format of each resource record is described in detail, and an example of each resource record is given. </t>
              <t indent="0"> This document obsoletes RFC 2535 and incorporates changes from all updates to RFC 2535.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4034"/>
          <seriesInfo name="DOI" value="10.17487/RFC4034"/>
        </reference>
        <reference anchor="RFC4035" target="https://www.rfc-editor.org/info/rfc4035" quoteTitle="true" derivedAnchor="RFC4035">
          <front>
            <title>Protocol Modifications for the DNS Security Extensions</title>
            <author initials="R." surname="Arends" fullname="R. Arends">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Austein" fullname="R. Austein">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Larson" fullname="M. Larson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Massey" fullname="D. Massey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Rose" fullname="S. Rose">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="March"/>
            <abstract>
              <t indent="0">This document is part of a family of documents that describe the DNS Security Extensions (DNSSEC).  The DNS Security Extensions are a collection of new resource records and protocol modifications that add data origin authentication and data integrity to the DNS.  This document describes the DNSSEC protocol modifications.  This document defines the concept of a signed zone, along with the requirements for serving and resolving by using DNSSEC.  These techniques allow a security-aware resolver to authenticate both DNS resource records and authoritative DNS error indications. </t>
              <t indent="0"> This document obsoletes RFC 2535 and incorporates changes from all updates to RFC 2535.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4035"/>
          <seriesInfo name="DOI" value="10.17487/RFC4035"/>
        </reference>
        <reference anchor="RFC5155" target="https://www.rfc-editor.org/info/rfc5155" quoteTitle="true" derivedAnchor="RFC5155">
          <front>
            <title>DNS Security (DNSSEC) Hashed Authenticated Denial of Existence</title>
            <author initials="B." surname="Laurie" fullname="B. Laurie">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Sisson" fullname="G. Sisson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Arends" fullname="R. Arends">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Blacka" fullname="D. Blacka">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="March"/>
            <abstract>
              <t indent="0">The Domain Name System Security (DNSSEC) Extensions introduced the NSEC resource record (RR) for authenticated denial of existence. This document introduces an alternative resource record, NSEC3, which similarly provides authenticated denial of existence.  However, it also provides measures against zone enumeration and permits gradual expansion of delegation-centric zones.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5155"/>
          <seriesInfo name="DOI" value="10.17487/RFC5155"/>
        </reference>
        <reference anchor="RFC6781" target="https://www.rfc-editor.org/info/rfc6781" quoteTitle="true" derivedAnchor="RFC6781">
          <front>
            <title>DNSSEC Operational Practices, Version 2</title>
            <author initials="O." surname="Kolkman" fullname="O. Kolkman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Mekking" fullname="W. Mekking">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Gieben" fullname="R. Gieben">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="December"/>
            <abstract>
              <t indent="0">This document describes a set of practices for operating the DNS with security extensions (DNSSEC).  The target audience is zone administrators deploying DNSSEC.</t>
              <t indent="0">The document discusses operational aspects of using keys and signatures in the DNS.  It discusses issues of key generation, key storage, signature generation, key rollover, and related policies.</t>
              <t indent="0">This document obsoletes RFC 4641, as it covers more operational ground and gives more up-to-date requirements with respect to key sizes and the DNSSEC operations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6781"/>
          <seriesInfo name="DOI" value="10.17487/RFC6781"/>
        </reference>
        <reference anchor="RFC7344" target="https://www.rfc-editor.org/info/rfc7344" quoteTitle="true" derivedAnchor="RFC7344">
          <front>
            <title>Automating DNSSEC Delegation Trust Maintenance</title>
            <author initials="W." surname="Kumari" fullname="W. Kumari">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Gudmundsson" fullname="O. Gudmundsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Barwood" fullname="G. Barwood">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="September"/>
            <abstract>
              <t indent="0">This document describes a method to allow DNS Operators to more easily update DNSSEC Key Signing Keys using the DNS as a communication channel.  The technique described is aimed at delegations in which it is currently hard to move information from the Child to Parent.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7344"/>
          <seriesInfo name="DOI" value="10.17487/RFC7344"/>
        </reference>
        <reference anchor="RFC8078" target="https://www.rfc-editor.org/info/rfc8078" quoteTitle="true" derivedAnchor="RFC8078">
          <front>
            <title>Managing DS Records from the Parent via CDS/CDNSKEY</title>
            <author initials="O." surname="Gudmundsson" fullname="O. Gudmundsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Wouters" fullname="P. Wouters">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="March"/>
            <abstract>
              <t indent="0">RFC 7344 specifies how DNS trust can be maintained across key rollovers in-band between parent and child.  This document elevates RFC 7344 from Informational to Standards Track.  It also adds a method for initial trust setup and removal of a secure entry point.</t>
              <t indent="0">Changing a domain's DNSSEC status can be a complicated matter involving multiple unrelated parties.  Some of these parties, such as the DNS operator, might not even be known by all the organizations involved.  The inability to disable DNSSEC via in-band signaling is seen as a problem or liability that prevents some DNSSEC adoption at a large scale.  This document adds a method for in-band signaling of these DNSSEC status changes.</t>
              <t indent="0">This document describes reasonable policies to ease deployment of the initial acceptance of new secure entry points (DS records).</t>
              <t indent="0">It is preferable that operators collaborate on the transfer or move of a domain.  The best method is to perform a Key Signing Key (KSK) plus Zone Signing Key (ZSK) rollover.  If that is not possible, the method using an unsigned intermediate state described in this document can be used to move the domain between two parties.  This leaves the domain temporarily unsigned and vulnerable to DNS spoofing, but that is preferred over the alternative of validation failures due to a mismatched DS and DNSKEY record.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8078"/>
          <seriesInfo name="DOI" value="10.17487/RFC8078"/>
        </reference>
        <reference anchor="RFC8198" target="https://www.rfc-editor.org/info/rfc8198" quoteTitle="true" derivedAnchor="RFC8198">
          <front>
            <title>Aggressive Use of DNSSEC-Validated Cache</title>
            <author initials="K." surname="Fujiwara" fullname="K. Fujiwara">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Kato" fullname="A. Kato">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Kumari" fullname="W. Kumari">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="July"/>
            <abstract>
              <t indent="0">The DNS relies upon caching to scale; however, the cache lookup generally requires an exact match.  This document specifies the use of NSEC/NSEC3 resource records to allow DNSSEC-validating resolvers to generate negative answers within a range and positive answers from wildcards.  This increases performance, decreases latency, decreases resource utilization on both authoritative and recursive servers, and increases privacy.  Also, it may help increase resilience to certain DoS attacks in some circumstances.</t>
              <t indent="0">This document updates RFC 4035 by allowing validating resolvers to generate negative answers based upon NSEC/NSEC3 records and positive answers in the presence of wildcards.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8198"/>
          <seriesInfo name="DOI" value="10.17487/RFC8198"/>
        </reference>
      </references>
      <references pn="section-13.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="I-D.valsorda-dnsop-black-lies" quoteTitle="true" target="https://tools.ietf.org/html/draft-valsorda-dnsop-black-lies-00" derivedAnchor="BLACKLIES">
          <front>
            <title>Compact DNSSEC Denial of Existence or Black Lies</title>
            <author fullname="Filippo Valsorda">
	 </author>
            <author fullname="Olafur Gudmundsson">
	 </author>
            <date month="March" day="21" year="2016"/>
            <abstract>
              <t indent="0">   This document describes a technique to generate valid DNSSEC answers
   on demand for non-existing names by claiming the name exists and
   returning a NSEC record for it.  These answers require only one NSEC
   record and allow live-signing servers to minimize signing operations,
   packet size, disclosure of zone contents and required knowledge of
   the zone layout.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-valsorda-dnsop-black-lies-00"/>
          <format type="TXT" target="https://www.ietf.org/internet-drafts/draft-valsorda-dnsop-black-lies-00.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="RFC1995" target="https://www.rfc-editor.org/info/rfc1995" quoteTitle="true" derivedAnchor="RFC1995">
          <front>
            <title>Incremental Zone Transfer in DNS</title>
            <author initials="M." surname="Ohta" fullname="M. Ohta">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1996" month="August"/>
            <abstract>
              <t indent="0">This document proposes extensions to the DNS protocols to provide an incremental zone transfer (IXFR) mechanism.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="1995"/>
          <seriesInfo name="DOI" value="10.17487/RFC1995"/>
        </reference>
        <reference anchor="RFC2136" target="https://www.rfc-editor.org/info/rfc2136" quoteTitle="true" derivedAnchor="RFC2136">
          <front>
            <title>Dynamic Updates in the Domain Name System (DNS UPDATE)</title>
            <author initials="P." surname="Vixie" fullname="P. Vixie" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Thomson" fullname="S. Thomson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Rekhter" fullname="Y. Rekhter">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Bound" fullname="J. Bound">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="April"/>
            <abstract>
              <t indent="0">Using this specification of the UPDATE opcode, it is possible to add or delete RRs or RRsets from a specified zone.  Prerequisites are specified separately from update operations, and can specify a dependency upon either the previous existence or nonexistence of an RRset, or the existence of a single RR.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2136"/>
          <seriesInfo name="DOI" value="10.17487/RFC2136"/>
        </reference>
        <reference anchor="RFC5731" target="https://www.rfc-editor.org/info/rfc5731" quoteTitle="true" derivedAnchor="RFC5731">
          <front>
            <title>Extensible Provisioning Protocol (EPP) Domain Name Mapping</title>
            <author initials="S." surname="Hollenbeck" fullname="S. Hollenbeck">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="August"/>
            <abstract>
              <t indent="0">This document describes an Extensible Provisioning Protocol (EPP) mapping for the provisioning and management of Internet domain names stored in a shared central repository.  Specified in XML, the mapping defines EPP command syntax and semantics as applied to domain names. This document obsoletes RFC 4931.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="69"/>
          <seriesInfo name="RFC" value="5731"/>
          <seriesInfo name="DOI" value="10.17487/RFC5731"/>
        </reference>
        <reference anchor="RFC5936" target="https://www.rfc-editor.org/info/rfc5936" quoteTitle="true" derivedAnchor="RFC5936">
          <front>
            <title>DNS Zone Transfer Protocol (AXFR)</title>
            <author initials="E." surname="Lewis" fullname="E. Lewis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Hoenes" fullname="A. Hoenes" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2010" month="June"/>
            <abstract>
              <t indent="0">The standard means within the Domain Name System protocol for maintaining coherence among a zone's authoritative name servers consists of three mechanisms.  Authoritative Transfer (AXFR) is one of the mechanisms and is defined in RFC 1034 and RFC 1035.</t>
              <t indent="0">The definition of AXFR has proven insufficient in detail, thereby forcing implementations intended to be compliant to make assumptions, impeding interoperability.  Yet today we have a satisfactory set of implementations that do interoperate.  This document is a new definition of AXFR -- new in the sense that it records an accurate definition of an interoperable AXFR mechanism.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5936"/>
          <seriesInfo name="DOI" value="10.17487/RFC5936"/>
        </reference>
        <reference anchor="RFC7129" target="https://www.rfc-editor.org/info/rfc7129" quoteTitle="true" derivedAnchor="RFC7129">
          <front>
            <title>Authenticated Denial of Existence in the DNS</title>
            <author initials="R." surname="Gieben" fullname="R. Gieben">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Mekking" fullname="W. Mekking">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="February"/>
            <abstract>
              <t indent="0">Authenticated denial of existence allows a resolver to validate that a certain domain name does not exist.  It is also used to signal that a domain name exists but does not have the specific resource record (RR) type you were asking for.  When returning a negative DNS Security Extensions (DNSSEC) response, a name server usually includes up to two NSEC records.  With NSEC version 3 (NSEC3), this amount is three.</t>
              <t indent="0">This document provides additional background commentary and some context for the NSEC and NSEC3 mechanisms used by DNSSEC to provide authenticated denial-of-existence responses.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7129"/>
          <seriesInfo name="DOI" value="10.17487/RFC7129"/>
        </reference>
        <reference anchor="RFC7858" target="https://www.rfc-editor.org/info/rfc7858" quoteTitle="true" derivedAnchor="RFC7858">
          <front>
            <title>Specification for DNS over Transport Layer Security (TLS)</title>
            <author initials="Z." surname="Hu" fullname="Z. Hu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Zhu" fullname="L. Zhu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Heidemann" fullname="J. Heidemann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Mankin" fullname="A. Mankin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Wessels" fullname="D. Wessels">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="May"/>
            <abstract>
              <t indent="0">This document describes the use of Transport Layer Security (TLS) to provide privacy for DNS.  Encryption provided by TLS eliminates opportunities for eavesdropping and on-path tampering with DNS queries in the network, such as discussed in RFC 7626.  In addition, this document specifies two usage profiles for DNS over TLS and provides advice on performance considerations to minimize overhead from using TCP and TLS with DNS.</t>
              <t indent="0">This document focuses on securing stub-to-recursive traffic, as per the charter of the DPRIVE Working Group.  It does not prevent future applications of the protocol to recursive-to-authoritative traffic.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7858"/>
          <seriesInfo name="DOI" value="10.17487/RFC7858"/>
        </reference>
        <reference anchor="RFC8484" target="https://www.rfc-editor.org/info/rfc8484" quoteTitle="true" derivedAnchor="RFC8484">
          <front>
            <title>DNS Queries over HTTPS (DoH)</title>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="McManus" fullname="P. McManus">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="October"/>
            <abstract>
              <t indent="0">This document defines a protocol for sending DNS queries and getting DNS responses over HTTPS.  Each DNS query-response pair is mapped into an HTTP exchange.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8484"/>
          <seriesInfo name="DOI" value="10.17487/RFC8484"/>
        </reference>
        <reference anchor="RFC8499" target="https://www.rfc-editor.org/info/rfc8499" quoteTitle="true" derivedAnchor="RFC8499">
          <front>
            <title>DNS Terminology</title>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Sullivan" fullname="A. Sullivan">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Fujiwara" fullname="K. Fujiwara">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="January"/>
            <abstract>
              <t indent="0">The Domain Name System (DNS) is defined in literally dozens of different RFCs.  The terminology used by implementers and developers of DNS protocols, and by operators of DNS systems, has sometimes changed in the decades since the DNS was first defined.  This document gives current definitions for many of the terms used in the DNS in a single document.</t>
              <t indent="0">This document obsoletes RFC 7719 and updates RFC 2308.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="219"/>
          <seriesInfo name="RFC" value="8499"/>
          <seriesInfo name="DOI" value="10.17487/RFC8499"/>
        </reference>
      </references>
    </references>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.a-1">
        The initial version of this document benefited from discussions
        with and review from <contact fullname="Duane Wessels"/>. Additional helpful comments
        were provided by <contact fullname="Steve Crocker"/>, <contact fullname="Ulrich Wisser"/>, <contact fullname="Tony Finch"/>, <contact fullname="Olafur Gudmundsson"/>, <contact fullname="Matthijs  Mekking"/>, <contact fullname="Daniel Migault"/>, and <contact fullname="Ben Kaduk"/>.
      </t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author fullname="Shumon Huque" initials="S." surname="Huque">
        <organization showOnFrontPage="true">Salesforce</organization>
        <address>
          <postal>
            <street>415 Mission Street, 3rd Floor</street>
            <city>San Francisco</city>
            <region>CA</region>
            <code>94105</code>
            <country>United States of America</country>
          </postal>
          <email>shuque@gmail.com</email>
        </address>
      </author>
      <author fullname="Pallavi Aras" initials="P." surname="Aras">
        <organization showOnFrontPage="true">Salesforce</organization>
        <address>
          <postal>
            <street>415 Mission Street, 3rd Floor</street>
            <city>San Francisco</city>
            <region>CA</region>
            <code>94105</code>
            <country>United States of America</country>
          </postal>
          <email>paras@salesforce.com</email>
        </address>
      </author>
      <author fullname="John Dickinson" initials="J." surname="Dickinson">
        <organization showOnFrontPage="true">Sinodun IT</organization>
        <address>
          <postal>
            <street>Magdalen Centre</street>
            <street>Oxford Science Park</street>
            <city>Oxford</city>
            <code>OX4 4GA</code>
            <country>United Kingdom</country>
          </postal>
          <email>jad@sinodun.com</email>
        </address>
      </author>
      <author fullname="Jan Vcelak" initials="J." surname="Vcelak">
        <organization showOnFrontPage="true">NS1</organization>
        <address>
          <postal>
            <street>55 Broad Street, 19th Floor</street>
            <city>New York</city>
            <region>NY</region>
            <code>10004</code>
            <country>United States of America</country>
          </postal>
          <email>jvcelak@ns1.com</email>
        </address>
      </author>
      <author fullname="David Blacka" initials="D." surname="Blacka">
        <organization showOnFrontPage="true">Verisign</organization>
        <address>
          <postal>
            <street>12061 Bluemont Way</street>
            <city>Reston</city>
            <region>VA</region>
            <code>20190</code>
            <country>United States of America</country>
          </postal>
          <email>davidb@verisign.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
