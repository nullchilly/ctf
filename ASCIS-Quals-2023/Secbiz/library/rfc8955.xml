<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-idr-rfc5575bis-25" indexInclude="true" ipr="trust200902" number="8955" obsoletes="5575, 7674" prepTime="2020-12-31T13:26:32" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-idr-rfc5575bis-25" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc8955" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="Flow Specification">Dissemination of Flow Specification Rules</title>
    <seriesInfo name="RFC" value="8955" stream="IETF"/>
    <author fullname="Christoph Loibl" initials="C." surname="Loibl">
      <organization showOnFrontPage="true">next layer Telekom GmbH</organization>
      <address>
        <postal>
          <street>Mariahilfer Guertel 37/7</street>
          <city>Vienna</city>
          <region/>
          <code>1150</code>
          <country>Austria</country>
        </postal>
        <phone>+43 664 1176414</phone>
        <email>cl@tix.at</email>
      </address>
    </author>
    <author fullname="Susan Hares" initials="S." surname="Hares">
      <organization showOnFrontPage="true">Huawei</organization>
      <address>
        <postal>
          <street>7453 Hickory Hill</street>
          <city>Saline</city>
          <region>MI</region>
          <code>48176</code>
          <country>United States of America</country>
        </postal>
        <email>shares@ndzh.com</email>
      </address>
    </author>
    <author fullname="Robert Raszuk" initials="R." surname="Raszuk">
      <organization showOnFrontPage="true">NTT Network Innovations</organization>
      <address>
        <postal>
          <street>940 Stewart Dr</street>
          <city>Sunnyvale</city>
          <region>CA</region>
          <code>94085</code>
          <country>United States of America</country>
        </postal>
        <email>robert@raszuk.net</email>
      </address>
    </author>
    <author fullname="Danny McPherson" initials="D." surname="McPherson">
      <organization showOnFrontPage="true">Verisign</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country>United States of America</country>
        </postal>
        <email>dmcpherson@verisign.com</email>
      </address>
    </author>
    <author fullname="Martin Bacher" initials="M." surname="Bacher">
      <organization showOnFrontPage="true">T-Mobile Austria</organization>
      <address>
        <postal>
          <street>Rennweg 97-99</street>
          <city>Vienna</city>
          <region/>
          <code>1030</code>
          <country>Austria</country>
        </postal>
        <email>mb.ietf@gmail.com</email>
      </address>
    </author>
    <date month="12" year="2020"/>
    <area>Routing</area>
    <workgroup>IDR</workgroup>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
  This document defines a Border Gateway Protocol Network Layer
  Reachability Information (BGP NLRI) encoding format that can be used
  to distribute (intra-domain and inter-domain) traffic Flow Specifications
  for IPv4 unicast and IPv4 BGP/MPLS VPN services. This allows the routing
  system to propagate information regarding more specific components of
  the traffic aggregate defined by an IP destination prefix.
      </t>
      <t indent="0" pn="section-abstract-2">
    It also specifies BGP Extended Community encoding formats, which can
    be used to propagate Traffic Filtering Actions along with the Flow
    Specification NLRI.  Those Traffic Filtering Actions encode actions a
    routing system can take if the packet matches the Flow Specification.
      </t>
      <t indent="0" pn="section-abstract-3">
    This document obsoletes both RFC 5575 and RFC 7674.
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc8955" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-definitions-of-terms-used-i">Definitions of Terms Used in This Memo</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-flow-specifications">Flow Specifications</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-dissemination-of-ipv4-flow-">Dissemination of IPv4 Flow Specification Information</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-length-encoding">Length Encoding</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-nlri-value-encoding">NLRI Value Encoding</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.2.2">
                  <li pn="section-toc.1-1.4.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.1.1"><xref derivedContent="4.2.1" format="counter" sectionFormat="of" target="section-4.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-operators">Operators</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.2.2.2">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.2.1"><xref derivedContent="4.2.2" format="counter" sectionFormat="of" target="section-4.2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-components">Components</xref></t>
                    <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.2.2.2.2">
                      <li pn="section-toc.1-1.4.2.2.2.2.2.1">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.1.1"><xref derivedContent="4.2.2.1" format="counter" sectionFormat="of" target="section-4.2.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-1-destination-prefix">Type 1 - Destination Prefix</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.2">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.2.1"><xref derivedContent="4.2.2.2" format="counter" sectionFormat="of" target="section-4.2.2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-2-source-prefix">Type 2 - Source Prefix</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.3">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.3.1"><xref derivedContent="4.2.2.3" format="counter" sectionFormat="of" target="section-4.2.2.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-3-ip-protocol">Type 3 - IP Protocol</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.4">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.4.1"><xref derivedContent="4.2.2.4" format="counter" sectionFormat="of" target="section-4.2.2.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-4-port">Type 4 - Port</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.5">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.5.1"><xref derivedContent="4.2.2.5" format="counter" sectionFormat="of" target="section-4.2.2.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-5-destination-port">Type 5 - Destination Port</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.6">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.6.1"><xref derivedContent="4.2.2.6" format="counter" sectionFormat="of" target="section-4.2.2.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-6-source-port">Type 6 - Source Port</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.7">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.7.1"><xref derivedContent="4.2.2.7" format="counter" sectionFormat="of" target="section-4.2.2.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-7-icmp-type">Type 7 - ICMP Type</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.8">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.8.1"><xref derivedContent="4.2.2.8" format="counter" sectionFormat="of" target="section-4.2.2.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-8-icmp-code">Type 8 - ICMP Code</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.9">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.9.1"><xref derivedContent="4.2.2.9" format="counter" sectionFormat="of" target="section-4.2.2.9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-type-9-tcp-flags">Type 9 - TCP Flags</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.10">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.10.1"><xref derivedContent="4.2.2.10" format="counter" sectionFormat="of" target="section-4.2.2.10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-type-10-packet-length">Type 10 - Packet Length</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.11">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.11.1"><xref derivedContent="4.2.2.11" format="counter" sectionFormat="of" target="section-4.2.2.11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-type-11-dscp-diffserv-code-">Type 11 - DSCP (Diffserv Code Point)</xref></t>
                      </li>
                      <li pn="section-toc.1-1.4.2.2.2.2.2.12">
                        <t indent="0" pn="section-toc.1-1.4.2.2.2.2.2.12.1"><xref derivedContent="4.2.2.12" format="counter" sectionFormat="of" target="section-4.2.2.12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-type-12-fragment">Type 12 - Fragment</xref></t>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-examples-of-encodings">Examples of Encodings</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-traffic-filtering">Traffic Filtering</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ordering-of-flow-specificat">Ordering of Flow Specifications</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-validation-procedure">Validation Procedure</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-traffic-filtering-actions">Traffic Filtering Actions</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t indent="0" pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-traffic-rate-in-bytes-traff">Traffic Rate in Bytes (traffic-rate-bytes) Sub-Type 0x06</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.2">
                <t indent="0" pn="section-toc.1-1.7.2.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-traffic-rate-in-packets-tra">Traffic Rate in Packets (traffic-rate-packets) Sub-Type 0x0c</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.3">
                <t indent="0" pn="section-toc.1-1.7.2.3.1"><xref derivedContent="7.3" format="counter" sectionFormat="of" target="section-7.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-traffic-action-traffic-acti">Traffic-Action (traffic-action) Sub-Type 0x07</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.4">
                <t indent="0" pn="section-toc.1-1.7.2.4.1"><xref derivedContent="7.4" format="counter" sectionFormat="of" target="section-7.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rt-redirect-rt-redirect-sub">RT Redirect (rt-redirect) Sub-Type 0x08</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.5">
                <t indent="0" pn="section-toc.1-1.7.2.5.1"><xref derivedContent="7.5" format="counter" sectionFormat="of" target="section-7.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-traffic-marking-traffic-mar">Traffic Marking (traffic-marking) Sub-Type 0x09</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.6">
                <t indent="0" pn="section-toc.1-1.7.2.6.1"><xref derivedContent="7.6" format="counter" sectionFormat="of" target="section-7.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-interaction-with-other-filt">Interaction with Other Filtering Mechanisms in Routers</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.7">
                <t indent="0" pn="section-toc.1-1.7.2.7.1"><xref derivedContent="7.7" format="counter" sectionFormat="of" target="section-7.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-considerations-on-traffic-f">Considerations on Traffic Filtering Action Interference</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-dissemination-of-traffic-fi">Dissemination of Traffic Filtering in BGP/MPLS VPN Networks</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-traffic-monitoring">Traffic Monitoring</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-error-handling">Error Handling</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.11.2">
              <li pn="section-toc.1-1.11.2.1">
                <t indent="0" pn="section-toc.1-1.11.2.1.1"><xref derivedContent="11.1" format="counter" sectionFormat="of" target="section-11.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-afi-safi-definitions">AFI/SAFI Definitions</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.2">
                <t indent="0" pn="section-toc.1-1.11.2.2.1"><xref derivedContent="11.2" format="counter" sectionFormat="of" target="section-11.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-flow-component-definitions">Flow Component Definitions</xref></t>
              </li>
              <li pn="section-toc.1-1.11.2.3">
                <t indent="0" pn="section-toc.1-1.11.2.3.1"><xref derivedContent="11.3" format="counter" sectionFormat="of" target="section-11.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-community-flow-spe">Extended Community Flow Specification Actions</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="12" format="counter" sectionFormat="of" target="section-12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="13" format="counter" sectionFormat="of" target="section-13"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.2">
              <li pn="section-toc.1-1.13.2.1">
                <t indent="0" pn="section-toc.1-1.13.2.1.1"><xref derivedContent="13.1" format="counter" sectionFormat="of" target="section-13.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.2">
                <t indent="0" pn="section-toc.1-1.13.2.2.1"><xref derivedContent="13.2" format="counter" sectionFormat="of" target="section-13.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.14">
            <t indent="0" pn="section-toc.1-1.14.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-python-code-flow_ru">Example Python code: flow_rule_cmp</xref></t>
          </li>
          <li pn="section-toc.1-1.15">
            <t indent="0" pn="section-toc.1-1.15.1"><xref derivedContent="Appendix B" format="default" sectionFormat="of" target="section-appendix.b"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-comparison-with-rfc-5575">Comparison with RFC 5575</xref></t>
          </li>
          <li pn="section-toc.1-1.16">
            <t indent="0" pn="section-toc.1-1.16.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.c"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.17">
            <t indent="0" pn="section-toc.1-1.17.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.d"/><xref derivedContent="" format="title" sectionFormat="of" target="name-contributors">Contributors</xref></t>
          </li>
          <li pn="section-toc.1-1.18">
            <t indent="0" pn="section-toc.1-1.18.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.e"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="intro" numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">This document obsoletes <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575">"Dissemination of Flow Specification Rules"</xref> (see <xref target="rfc5575differences" format="default" sectionFormat="of" derivedContent="Appendix B"/> for the
      differences). This document also obsoletes <xref target="RFC7674" format="default" sectionFormat="of" derivedContent="RFC7674">"Clarification of the Flowspec Redirect Extended Community"</xref>, since it
      incorporates the encoding of the BGP Flow Specification Redirect
      Extended Community in <xref target="rt_redirect_action_subtype" format="default" sectionFormat="of" derivedContent="Section 7.4"/>.</t>
      <t indent="0" pn="section-1-2">
    Modern IP routers have the capability to forward traffic
    and to classify, shape, rate limit,
    filter, or redirect packets based on administratively defined
    policies.
    These traffic policy mechanisms allow the operator to define match
    rules that operate on multiple fields of the packet header.  Actions,
    such as the ones described above, can be associated with each rule.
      </t>
      <t indent="0" pn="section-1-3">
    The n-tuple consisting of the matching criteria defines an aggregate
    traffic Flow Specification. The matching criteria can include
    elements such as source and destination address prefixes, IP
    protocol, and transport protocol port numbers.
      </t>
      <t indent="0" pn="section-1-4"><xref target="dissemination_ipv4_flowspec" format="default" sectionFormat="of" derivedContent="Section 4"/> of this
      document defines a general procedure to encode Flow Specifications for
      aggregated traffic flows so that they can be distributed as a BGP <xref target="RFC4271" format="default" sectionFormat="of" derivedContent="RFC4271"/> NLRI. Additionally, <xref target="traffic_filtering_actions" format="default" sectionFormat="of" derivedContent="Section 7"/> of this 
 document defines the required Traffic Filtering Actions BGP Extended
 Communities and mechanisms to use BGP for intra- and inter-provider
 distribution of traffic filtering rules in order to mitigate DoS and 
 DDoS attacks.
      </t>
      <t indent="0" pn="section-1-5">
	By expanding routing information with Flow Specifications, the
	routing system can take advantage of the ACL (Access Control List) or
	firewall capabilities in the router's forwarding path.  Flow
	Specifications can be seen as more specific routing entries to a
	unicast prefix and are expected to depend upon the existing unicast
	data information.
      </t>
      <t indent="0" pn="section-1-6">A Flow Specification received from an external autonomous system will
      need to be validated against unicast routing before being accepted
      (<xref target="validation_procedure" format="default" sectionFormat="of" derivedContent="Section 6"/>). The Flow
      Specification received from an internal BGP peer within the same
      autonomous system <xref target="RFC4271" format="default" sectionFormat="of" derivedContent="RFC4271"/> is assumed
      to have been validated prior to transmission within the internal BGP
      (iBGP) mesh of an autonomous system. If the aggregate traffic flow
      defined by the unicast destination prefix is forwarded to a given BGP
      peer, then the local system can install more specific Flow
      Specifications that may result in different forwarding behavior, as
      requested by this system.</t>
      <t indent="0" pn="section-1-7">From an operational perspective, the utilization of BGP as the
      carrier for this information allows a network service provider to reuse
      both internal route distribution infrastructure (e.g., route reflector
      or confederation design) and existing external relationships (e.g.,
      inter-domain BGP sessions to a customer network).</t>
      <t indent="0" pn="section-1-8">
   While it is certainly possible to address this problem using other
   mechanisms, this solution has been utilized in deployments because of the
   substantial advantage of being an incremental addition to already
   deployed mechanisms.
      </t>
      <t indent="0" pn="section-1-9">
  Possible applications of that extension are:
  Automated inter-domain coordination of traffic filtering, such as what 
  is required in order to mitigate DoS and DDoS attacks
  or traffic filtering in the context of a BGP/MPLS VPN service. Other
  applications (e.g., centralized control of traffic in a
  Software-Defined Networking (SDN) or Network Function Virtualization
  (NFV) context) are also possible.
      </t>
      <t indent="0" pn="section-1-10">In current deployments, the information distributed by this
   extension is originated both manually as well as automatically, the
   latter by systems that are able to detect malicious traffic flows.
   When automated systems are used, care should be taken
   to ensure the correctness of the automated system. The
   limitations of the receiving systems that need to process
   these automated Flow Specifications need to be taken in consideration
   as well (see also <xref target="security_considerations" format="default" sectionFormat="of" derivedContent="Section 12"/>).
      </t>
      <t indent="0" pn="section-1-11">
   This specification defines required protocol extensions to address
   most common applications of IPv4 unicast and VPNv4 unicast filtering.
   The same mechanism can be reused and new match criteria added to
   address similar filtering needs for other BGP address families, such as
   IPv6 families <xref target="RFC8956" format="default" sectionFormat="of" derivedContent="RFC8956"/>.
      </t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-definitions-of-terms-used-i">Definitions of Terms Used in This Memo</name>
      <dl newline="false" spacing="normal" indent="10" pn="section-2-1">
        <dt pn="section-2-1.1">AFI:</dt>
        <dd pn="section-2-1.2">Address Family Identifier</dd>
        <dt pn="section-2-1.3">AS:</dt>
        <dd pn="section-2-1.4">Autonomous System</dd>
        <dt pn="section-2-1.5">Loc-RIB:</dt>
        <dd pn="section-2-1.6">The Loc-RIB contains the routes that have been selected by the
	local BGP speaker's Decision Process <xref target="RFC4271" format="default" sectionFormat="of" derivedContent="RFC4271"/>.</dd>
        <dt pn="section-2-1.7">NLRI:</dt>
        <dd pn="section-2-1.8">Network Layer Reachability Information</dd>
        <dt pn="section-2-1.9">PE:</dt>
        <dd pn="section-2-1.10">Provider Edge router</dd>
        <dt pn="section-2-1.11">RIB:</dt>
        <dd pn="section-2-1.12">Routing Information Base</dd>
        <dt pn="section-2-1.13">SAFI:</dt>
        <dd pn="section-2-1.14">Subsequent Address Family Identifier</dd>
        <dt pn="section-2-1.15">VRF:</dt>
        <dd pn="section-2-1.16">Virtual Routing and Forwarding</dd>
      </dl>
      <t indent="0" pn="section-2-2">The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
	"<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>",
	"<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
	"<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document
	are to be interpreted as described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/>  when, and only when, they
	appear in all capitals, as shown here.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-flow-specifications">Flow Specifications</name>
      <t indent="0" pn="section-3-1">A Flow Specification is an n-tuple consisting of several matching
      criteria that can be applied to IP traffic.  A given IP packet is said
      to match the defined Flow Specification if it matches all the specified
      criteria. This n-tuple is encoded into a BGP NLRI defined below.</t>
      <t indent="0" pn="section-3-2">A given Flow Specification may be associated with a set of
      attributes, depending on the particular application; such attributes may
      or may not include reachability information (i.e., NEXT_HOP).
      Well-known or AS-specific community attributes can be used to encode a
      set of predetermined actions.</t>
      <t indent="0" pn="section-3-3">A particular application is identified by a specific (Address Family
      Identifier, Subsequent Address Family Identifier (AFI, SAFI)) pair <xref target="RFC4760" format="default" sectionFormat="of" derivedContent="RFC4760"/> and corresponds to a distinct set of
      RIBs.  Those RIBs should be treated independently from each other in
      order to assure noninterference between distinct applications.</t>
      <t indent="0" pn="section-3-4">BGP itself treats the NLRI as a key to an entry in its databases.
      Entries that are placed in the Loc-RIB are then associated with a given
      set of semantics, which is application dependent.  This is consistent
      with existing BGP applications.  For instance, IP unicast routing
      (AFI=1, SAFI=1) and IP multicast reverse-path information (AFI=1,
      SAFI=2) are handled by BGP without any particular semantics being
      associated with them until installed in the Loc-RIB.</t>
      <t indent="0" pn="section-3-5">
    Standard BGP policy mechanisms, such as UPDATE filtering by NLRI
    prefix as well as community matching, must apply to
    the Flow specification defined NLRI-type.
    Network operators can also control propagation of such
    routing updates by enabling or disabling the exchange of a particular
    (AFI, SAFI) pair on a given BGP peering session.
      </t>
    </section>
    <section anchor="dissemination_ipv4_flowspec" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-dissemination-of-ipv4-flow-">Dissemination of IPv4 Flow Specification Information</name>
      <t indent="0" pn="section-4-1">This document defines a Flow Specification NLRI type (<xref target="fs_nlri" format="default" sectionFormat="of" derivedContent="Figure 1"/>) that may include several components,
      such as destination prefix, source prefix, protocol, ports, and others
      (see <xref target="nlri_value_encoding" format="default" sectionFormat="of" derivedContent="Section 4.2"/> below).</t>
      <t indent="0" pn="section-4-2">This NLRI information is encoded using MP_REACH_NLRI and
      MP_UNREACH_NLRI attributes, as defined in  <xref target="RFC4760" format="default" sectionFormat="of" derivedContent="RFC4760"/>. When advertising Flow Specifications, the Length of the
      Next-Hop Network Address <bcp14>MUST</bcp14> be set to 0. The Network
      Address of the Next-Hop field <bcp14>MUST</bcp14> be ignored.</t>
      <t indent="0" pn="section-4-3">The NLRI field of the MP_REACH_NLRI and MP_UNREACH_NLRI is encoded as
      one or more 2-tuples of the form &lt;length, NLRI value&gt;. It consists
      of a 1- or 2-octet length field followed by a variable-length NLRI
      value. The length is expressed in octets.</t>
      <figure anchor="fs_nlri" align="left" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-flow-specification-nlri-for">Flow Specification NLRI for IPv4</name>
        <artwork name="" type="" align="left" alt="" pn="section-4-4.1">
                  +-------------------------------+
                  |    length (0xnn or 0xfnnn)    |
                  +-------------------------------+
                  |    NLRI value   (variable)    |
                  +-------------------------------+
	</artwork>
      </figure>
      <t indent="0" pn="section-4-5">Implementations wishing to exchange Flow Specification
      <bcp14>MUST</bcp14> use BGP's Capability Advertisement facility to
      exchange the Multiprotocol Extension Capability Code (Code 1), as defined
      in <xref target="RFC4760" format="default" sectionFormat="of" derivedContent="RFC4760"/>. The (AFI, SAFI) pair
      carried in the Multiprotocol Extension Capability <bcp14>MUST</bcp14> be
      (AFI=1, SAFI=133) for IPv4 Flow Specification and (AFI=1, SAFI=134) for
      VPNv4 Flow Specification.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-length-encoding">Length Encoding</name>
        <t indent="0" pn="section-4.1-1">
	  The length field indicates the length in octets of the variable NLRI value:
        </t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4.1-2">
          <li pn="section-4.1-2.1">If the NLRI length is smaller than 240 (0xf0 hex) octets, the
	  length field can be encoded as a single octet.  </li>
          <li pn="section-4.1-2.2">Otherwise, it is encoded as an extended-length 2-octet value in
	  which the most significant nibble has the hex value 0xf.</li>
        </ul>
        <t indent="0" pn="section-4.1-3">In <xref target="fs_nlri" format="default" sectionFormat="of" derivedContent="Figure 1"/> above, values
	less than 240 are encoded using two hex digits (0xnn).  Values above
	239 are encoded using 3 hex digits (0xfnnn).  The highest value that
	can be represented with this encoding is 4095. For example, the length
	value of 239 is encoded as 0xef (single octet), while 240 is encoded as
	0xf0f0 (2 octets).</t>
      </section>
      <section anchor="nlri_value_encoding" numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-nlri-value-encoding">NLRI Value Encoding</name>
        <t indent="0" pn="section-4.2-1">
    The Flow Specification NLRI value consists of a list of optional
   components and is encoded as follows:
        </t>
        <t indent="0" pn="section-4.2-2">Encoding: &lt;[component]+&gt;</t>
        <t indent="0" pn="section-4.2-3">A specific packet is considered to match the Flow Specification
	when it matches the intersection (AND) of all the components present
	in the Flow Specification.</t>
        <t indent="0" pn="section-4.2-4">Components <bcp14>MUST</bcp14> follow strict type ordering by
	increasing numerical order. A given component type <bcp14>MAY</bcp14>
	(exactly once) be present in the Flow Specification. If present, it
	<bcp14>MUST</bcp14> precede any component of higher numeric type
	value.</t>
        <t indent="0" pn="section-4.2-5">All combinations of components within a single Flow Specification
	are allowed. However, some combinations cannot match any packets
	(e.g., "ICMP Type AND Port" will never match any packets) and thus
	<bcp14>SHOULD NOT</bcp14> be propagated by BGP.</t>
        <t indent="0" pn="section-4.2-6">An NLRI value not encoded as specified here, including an NLRI that
        contains an unknown component type, is considered malformed
	and error handling according to <xref target="errorhandling" format="default" sectionFormat="of" derivedContent="Section 10"/> is performed.</t>
        <section anchor="operators" numbered="true" toc="include" removeInRFC="false" pn="section-4.2.1">
          <name slugifiedName="name-operators">Operators</name>
          <t indent="0" pn="section-4.2.1-1">Most of the components described below make use of comparison
	  operators. Which of the two operators is used is defined by the
	  components in <xref target="flowspec_components" format="default" sectionFormat="of" derivedContent="Section 4.2.2"/>. The operators are encoded as a single octet.</t>
          <section anchor="numeric_operator" numbered="true" toc="exclude" removeInRFC="false" pn="section-4.2.1.1">
            <name slugifiedName="name-numeric-operator-numeric_op">Numeric Operator (numeric_op)</name>
            <t indent="0" pn="section-4.2.1.1-1">This operator is encoded as shown in <xref target="figure_numeric_operator" format="default" sectionFormat="of" derivedContent="Figure 2"/>.</t>
            <figure anchor="figure_numeric_operator" align="left" suppress-title="false" pn="figure-2">
              <name slugifiedName="name-numeric-operator-numeric_op-2">Numeric Operator (numeric_op)</name>
              <artwork name="" type="" align="left" alt="" pn="section-4.2.1.1-2.1">
                    0   1   2   3   4   5   6   7
                  +---+---+---+---+---+---+---+---+
                  | e | a |  len  | 0 |lt |gt |eq |
                  +---+---+---+---+---+---+---+---+
</artwork>
            </figure>
            <dl newline="false" spacing="normal" indent="6" pn="section-4.2.1.1-3">
              <dt pn="section-4.2.1.1-3.1">e (end-of-list bit):</dt>
              <dd pn="section-4.2.1.1-3.2">Set in the last {op, value} pair in the list</dd>
              <dt pn="section-4.2.1.1-3.3">a (AND bit):</dt>
              <dd pn="section-4.2.1.1-3.4">If unset, the result of the previous {op, value}
	      pair is logically ORed with the current one.  If set, the
	      operation is a logical AND. In the first operator octet of a
	      sequence, it <bcp14>MUST</bcp14> be encoded as unset and
	      <bcp14>MUST</bcp14> be treated as always unset on decoding. The
	      AND operator has higher priority than OR for the purposes of
	      evaluating logical expressions.</dd>
              <dt pn="section-4.2.1.1-3.5">len (length):</dt>
              <dd pn="section-4.2.1.1-3.6">The length of the value field for this operator
	      given as (1 &lt;&lt; len). This encodes 1 (len=00), 2 (len=01),
	      4 (len=10), and 8 (len=11) octets.</dd>
              <dt pn="section-4.2.1.1-3.7">0:</dt>
              <dd pn="section-4.2.1.1-3.8">
                <bcp14>MUST</bcp14> be set to 0 on NLRI encoding and
	      <bcp14>MUST</bcp14> be ignored during decoding</dd>
              <dt pn="section-4.2.1.1-3.9">lt:</dt>
              <dd pn="section-4.2.1.1-3.10">less-than comparison between data and value</dd>
              <dt pn="section-4.2.1.1-3.11">gt:</dt>
              <dd pn="section-4.2.1.1-3.12">greater-than comparison between data and value</dd>
              <dt pn="section-4.2.1.1-3.13">eq:</dt>
              <dd pn="section-4.2.1.1-3.14">equality between data and value</dd>
            </dl>
            <t indent="0" pn="section-4.2.1.1-4">The bits lt, gt, and eq can be combined to produce common
	    relational operators, such as "less or equal", "greater or equal",
	    and "not equal to", as shown in <xref target="table_comparison_operator" format="default" sectionFormat="of" derivedContent="Table 1"/>.</t>
            <table anchor="table_comparison_operator" align="center" pn="table-1">
              <name slugifiedName="name-comparison-operation-combin">Comparison Operation Combinations</name>
              <thead>
                <tr>
                  <th align="center" colspan="1" rowspan="1">lt</th>
                  <th align="center" colspan="1" rowspan="1">gt</th>
                  <th align="center" colspan="1" rowspan="1">eq</th>
                  <th align="left" colspan="1" rowspan="1">Resulting operation</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1"> false (independent of the value)</td>
                </tr>
                <tr>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1"> == (equal) </td>
                </tr>
                <tr>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1"> &gt; (greater than) </td>
                </tr>
                <tr>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1"> &gt;= (greater than or equal)</td>
                </tr>
                <tr>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1"> &lt; (less than)</td>
                </tr>
                <tr>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1"> &lt;= (less than or equal)</td>
                </tr>
                <tr>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="center" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1"> != (not equal value)</td>
                </tr>
                <tr>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="center" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1"> true (independent of the value)</td>
                </tr>
              </tbody>
            </table>
          </section>
          <section anchor="bitmask_operator" numbered="true" toc="exclude" removeInRFC="false" pn="section-4.2.1.2">
            <name slugifiedName="name-bitmask-operator-bitmask_op">Bitmask Operator (bitmask_op)</name>
            <t indent="0" pn="section-4.2.1.2-1">This operator is encoded as shown in <xref target="figure_bitmask_operator" format="default" sectionFormat="of" derivedContent="Figure 3"/>.
</t>
            <figure anchor="figure_bitmask_operator" align="left" suppress-title="false" pn="figure-3">
              <name slugifiedName="name-bitmask-operator-bitmask_op-2">Bitmask Operator (bitmask_op)</name>
              <artwork name="" type="" align="left" alt="" pn="section-4.2.1.2-2.1">
                    0   1   2   3   4   5   6   7
                  +---+---+---+---+---+---+---+---+
                  | e | a |  len  | 0 | 0 |not| m |
                  +---+---+---+---+---+---+---+---+
</artwork>
            </figure>
            <dl newline="false" spacing="normal" indent="6" pn="section-4.2.1.2-3">
              <dt pn="section-4.2.1.2-3.1">e, a, len (end-of-list bit, AND bit, and
	      length field):</dt>
              <dd pn="section-4.2.1.2-3.2">Most significant nibble; defined in the Numeric Operator format in
	      <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>.</dd>
              <dt pn="section-4.2.1.2-3.3">not (NOT bit):</dt>
              <dd pn="section-4.2.1.2-3.4">If set, logical negation of operation.</dd>
              <dt pn="section-4.2.1.2-3.5">m (Match bit):</dt>
              <dd pn="section-4.2.1.2-3.6">If set, this is a bitwise match operation defined as "(data
	      AND value) == value"; if unset, (data AND value) evaluates to
	      TRUE if any of the bits in the value mask are set in the
	      data.</dd>
              <dt pn="section-4.2.1.2-3.7">0 (all 0 bits):</dt>
              <dd pn="section-4.2.1.2-3.8">
                <bcp14>MUST</bcp14> be set to 0 on NLRI encoding and
	      <bcp14>MUST</bcp14> be ignored during decoding</dd>
            </dl>
          </section>
        </section>
        <section anchor="flowspec_components" numbered="true" toc="include" removeInRFC="false" pn="section-4.2.2">
          <name slugifiedName="name-components">Components</name>
          <t indent="0" pn="section-4.2.2-1">
     The encoding of each of the components begins with a type field
     (1 octet) followed by a variable length parameter. The following sections
     define component types and parameter encodings for the IPv4 IP layer and
     transport layer headers. IPv6 NLRI component types are described
     in <xref target="RFC8956" format="default" sectionFormat="of" derivedContent="RFC8956"/>.
          </t>
          <section anchor="type_1" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.1">
            <name slugifiedName="name-type-1-destination-prefix">Type 1 - Destination Prefix</name>
            <t indent="0" pn="section-4.2.2.1-1">Encoding: &lt;type (1 octet), length (1 octet), prefix
	    (variable)&gt;</t>
            <t indent="0" pn="section-4.2.2.1-2">Defines the destination prefix to match. The length and prefix
	    fields are encoded as in BGP UPDATE messages <xref target="RFC4271" format="default" sectionFormat="of" derivedContent="RFC4271"/>.</t>
          </section>
          <section anchor="type_2" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.2">
            <name slugifiedName="name-type-2-source-prefix">Type 2 - Source Prefix</name>
            <t indent="0" pn="section-4.2.2.2-1">Encoding: &lt;type (1 octet), length (1 octet), prefix (variable)&gt;</t>
            <t indent="0" pn="section-4.2.2.2-2">Defines the source prefix to match. The length and prefix
	    fields are encoded as in BGP UPDATE messages <xref target="RFC4271" format="default" sectionFormat="of" derivedContent="RFC4271"/>.</t>
          </section>
          <section anchor="type_3" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.3">
            <name slugifiedName="name-type-3-ip-protocol">Type 3 - IP Protocol</name>
            <t indent="0" pn="section-4.2.2.3-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;</t>
            <t indent="0" pn="section-4.2.2.3-2">Contains a list of {numeric_op, value} pairs that are used to
	    match the IP protocol value octet in IP packet header (see <xref target="RFC0791" sectionFormat="of" section="3.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc791#section-3.1" derivedContent="RFC0791"/>).</t>
            <t indent="0" pn="section-4.2.2.3-3">This component uses the Numeric Operator (numeric_op) described
	    in <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>. Type 3
	    component values <bcp14>SHOULD</bcp14> be encoded as single octet
	    (numeric_op len=00).</t>
          </section>
          <section anchor="type_4" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.4">
            <name slugifiedName="name-type-4-port">Type 4 - Port</name>
            <t indent="0" pn="section-4.2.2.4-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;</t>
            <t indent="0" pn="section-4.2.2.4-2">Defines a list of {numeric_op, value} pairs that match source
	    OR destination TCP/UDP ports (see <xref target="RFC0793" sectionFormat="of" section="3.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc793#section-3.1" derivedContent="RFC0793"/> and the "Format" section of
	    <xref target="RFC0768" format="default" sectionFormat="of" derivedContent="RFC0768"/>). This component matches
	    if 
	    either the destination port OR the source port of an IP packet
	    matches the value.</t>
            <t indent="0" pn="section-4.2.2.4-3">This component uses the Numeric Operator (numeric_op) described
	    in <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>. Type 4
	    component values <bcp14>SHOULD</bcp14> be encoded as 1- or 2-octet
	    quantities (numeric_op len=00 or len=01).</t>
            <t indent="0" pn="section-4.2.2.4-4">In case of the presence of the port (destination-port (<xref target="type_5" format="default" sectionFormat="of" derivedContent="Section 4.2.2.5"/>), source-port (<xref target="type_6" format="default" sectionFormat="of" derivedContent="Section 4.2.2.6"/>)) component, only TCP or UDP
	    packets can match the entire Flow Specification. The port
	    component, if present, never matches when the packet's IP protocol
	    value is not 6 (TCP) or 17 (UDP), if the packet is fragmented and
	    this is not the first fragment, or if the system is unable to
	    locate the transport header. Different implementations may or may
	    not be able to decode the transport header in the presence of IP
	    options or Encapsulating Security Payload (ESP) NULL <xref target="RFC4303" format="default" sectionFormat="of" derivedContent="RFC4303"/> encryption.</t>
          </section>
          <section anchor="type_5" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.5">
            <name slugifiedName="name-type-5-destination-port">Type 5 - Destination Port</name>
            <t indent="0" pn="section-4.2.2.5-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;</t>
            <t indent="0" pn="section-4.2.2.5-2"> Defines a list of {numeric_op, value} pairs used to match the
	    destination port of a TCP or UDP packet (see also <xref target="RFC0793" sectionFormat="of" section="3.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc793#section-3.1" derivedContent="RFC0793"/> and the
	    "Format" section of <xref target="RFC0768" format="default" sectionFormat="of" derivedContent="RFC0768"/>.</t>
            <t indent="0" pn="section-4.2.2.5-3">This component uses the Numeric Operator (numeric_op) described
	    in <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>. Type 5
	    component values <bcp14>SHOULD</bcp14> be encoded as 1- or 2-octet
	    quantities (numeric_op len=00 or len=01).</t>
            <t indent="0" pn="section-4.2.2.5-4">The last paragraph of <xref target="type_4" format="default" sectionFormat="of" derivedContent="Section 4.2.2.4"/>
	    also applies to this component.</t>
          </section>
          <section anchor="type_6" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.6">
            <name slugifiedName="name-type-6-source-port">Type 6 - Source Port</name>
            <t indent="0" pn="section-4.2.2.6-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;</t>
            <t indent="0" pn="section-4.2.2.6-2">Defines a list of {numeric_op, value} pairs used to match the
	    source port of a TCP or UDP packet (see also <xref target="RFC0793" sectionFormat="of" section="3.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc793#section-3.1" derivedContent="RFC0793"/> and the
	    "Format" section of <xref target="RFC0768" format="default" sectionFormat="of" derivedContent="RFC0768"/>.</t>
            <t indent="0" pn="section-4.2.2.6-3">This component uses the Numeric Operator (numeric_op) described
	    in <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>. Type 6
	    component values <bcp14>SHOULD</bcp14> be encoded as 1- or 2-octet
	    quantities (numeric_op len=00 or len=01).</t>
            <t indent="0" pn="section-4.2.2.6-4">The last paragraph of <xref target="type_4" format="default" sectionFormat="of" derivedContent="Section 4.2.2.4"/>
	    also applies to this component.</t>
          </section>
          <section anchor="type_7" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.7">
            <name slugifiedName="name-type-7-icmp-type">Type 7 - ICMP Type</name>
            <t indent="0" pn="section-4.2.2.7-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;</t>
            <t indent="0" pn="section-4.2.2.7-2">Defines a list of {numeric_op, value} pairs used to match the
	    type field of an ICMP packet (see also the "Message Formats"
	    section of <xref target="RFC0792" format="default" sectionFormat="of" derivedContent="RFC0792"/>).</t>
            <t indent="0" pn="section-4.2.2.7-3">This component uses the Numeric Operator (numeric_op) described
	    in <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>. Type 7
	    component values <bcp14>SHOULD</bcp14> be encoded as single octet
	    (numeric_op len=00).</t>
            <t indent="0" pn="section-4.2.2.7-4">
    In case of the presence of the ICMP type
    component, only ICMP packets can match the entire Flow Specification.
    The ICMP type component, if present, never matches when the packet's IP
    protocol value is not 1 (ICMP), if the packet is fragmented
    and this is not the first fragment, or if the system is unable to
    locate the transport header. Different implementations may or may not be
    able to decode the transport header in the presence of IP
    options or Encapsulating Security Payload (ESP) NULL
    <xref target="RFC4303" format="default" sectionFormat="of" derivedContent="RFC4303"/> encryption.
</t>
          </section>
          <section anchor="type_8" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.8">
            <name slugifiedName="name-type-8-icmp-code">Type 8 - ICMP Code</name>
            <t indent="0" pn="section-4.2.2.8-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;</t>
            <t indent="0" pn="section-4.2.2.8-2">Defines a list of {numeric_op, value} pairs used to match the
	    code field of an ICMP packet (see also the "Message Formats"
	    section of <xref target="RFC0792" format="default" sectionFormat="of" derivedContent="RFC0792"/>).</t>
            <t indent="0" pn="section-4.2.2.8-3">This component uses the Numeric Operator (numeric_op) described
	    in <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>. Type 8
	    component values <bcp14>SHOULD</bcp14> be encoded as single octet
	    (numeric_op len=00).</t>
            <t indent="0" pn="section-4.2.2.8-4">
    In case of the presence of the ICMP code
    component, only ICMP packets can match the entire Flow Specification.
    The ICMP code component, if present, never matches when the packet's IP
    protocol value is not 1 (ICMP), if the packet is fragmented
    and this is not the first fragment, or if the system is unable to
    locate the transport header. Different implementations may or may not be
    able to decode the transport header in the presence of IP
    options or Encapsulating Security Payload (ESP) NULL
    <xref target="RFC4303" format="default" sectionFormat="of" derivedContent="RFC4303"/> encryption.
</t>
          </section>
          <section anchor="type_9" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.9">
            <name slugifiedName="name-type-9-tcp-flags">Type 9 - TCP Flags</name>
            <t indent="0" pn="section-4.2.2.9-1">Encoding: &lt;type (1 octet), [bitmask_op, bitmask]+&gt;</t>
            <t indent="0" pn="section-4.2.2.9-2">Defines a list of {bitmask_op, bitmask} pairs used to match TCP
	    control bits (see also <xref target="RFC0793" sectionFormat="of" section="3.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc793#section-3.1" derivedContent="RFC0793"/>).</t>
            <t indent="0" pn="section-4.2.2.9-3">This component uses the Bitmask Operator (bitmask_op) described
	    in <xref target="bitmask_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.2"/>. Type 9
	    component bitmasks <bcp14>MUST</bcp14> be encoded as 1- or 2-octet
	    bitmask (bitmask_op len=00 or len=01).</t>
            <t indent="0" pn="section-4.2.2.9-4">When a single octet (bitmask_op len=00) is specified, it
	    matches octet 14 of the TCP header (see also <xref target="RFC0793" sectionFormat="of" section="3.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc793#section-3.1" derivedContent="RFC0793"/>), which
	    contains the TCP control bits. When a 2-octet (bitmask_op len=01)
	    encoding is used, it matches octets 13 and 14 of the TCP header
	    with the data offset (leftmost 4 bits) always treated as 0.</t>
            <t indent="0" pn="section-4.2.2.9-5">
    In case of the presence of the TCP flags
    component, only TCP packets can match the entire Flow Specification.
    The TCP flags component, if present, never matches when the packet's IP
    protocol value is not 6 (TCP), if the packet is fragmented
    and this is not the first fragment, or if the system is unable to
    locate the transport header. Different implementations may or may not be
    able to decode the transport header in the presence of IP
    options or Encapsulating Security Payload (ESP) NULL
    <xref target="RFC4303" format="default" sectionFormat="of" derivedContent="RFC4303"/> encryption.
</t>
          </section>
          <section anchor="type_10" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.10">
            <name slugifiedName="name-type-10-packet-length">Type 10 - Packet Length</name>
            <t indent="0" pn="section-4.2.2.10-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;</t>
            <t indent="0" pn="section-4.2.2.10-2">Defines a list of {numeric_op, value} pairs used to match on
	    the total IP packet length (excluding Layer 2 but including IP
	    header).</t>
            <t indent="0" pn="section-4.2.2.10-3">This component uses the Numeric Operator (numeric_op) described
	    in <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>. Type 10
	    component values <bcp14>SHOULD</bcp14> be encoded as 1- or 2-octet
	    quantities (numeric_op len=00 or len=01).</t>
          </section>
          <section anchor="type_11" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.11">
            <name slugifiedName="name-type-11-dscp-diffserv-code-">Type 11 - DSCP (Diffserv Code Point)</name>
            <t indent="0" pn="section-4.2.2.11-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;</t>
            <t indent="0" pn="section-4.2.2.11-2"> Defines a list of {numeric_op, value} pairs used to match the
	    6-bit DSCP field (see also <xref target="RFC2474" format="default" sectionFormat="of" derivedContent="RFC2474"/>).</t>
            <t indent="0" pn="section-4.2.2.11-3">This component uses the Numeric Operator (numeric_op) described
	    in <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/>. Type 11
	    component values <bcp14>MUST</bcp14> be encoded as single octet
	    (numeric_op len=00).</t>
            <t indent="0" pn="section-4.2.2.11-4">The six least significant bits contain the DSCP value. All
	    other bits <bcp14>SHOULD</bcp14> be treated as 0.</t>
          </section>
          <section anchor="type_12" toc="include" numbered="true" removeInRFC="false" pn="section-4.2.2.12">
            <name slugifiedName="name-type-12-fragment">Type 12 - Fragment</name>
            <t indent="0" pn="section-4.2.2.12-1">Encoding: &lt;type (1 octet), [bitmask_op, bitmask]+&gt;</t>
            <t indent="0" pn="section-4.2.2.12-2"> Defines a list of {bitmask_op, bitmask} pairs used to match
	    specific IP fragments.</t>
            <t indent="0" pn="section-4.2.2.12-3">This component uses the Bitmask Operator (bitmask_op) described
	    in <xref target="bitmask_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.2"/>. The Type 12
	    component bitmask <bcp14>MUST</bcp14> be encoded as single octet
	    bitmask (bitmask_op len=00).</t>
            <figure anchor="figure_fragment_bitmask_operand" align="left" suppress-title="false" pn="figure-4">
              <name slugifiedName="name-fragment-bitmask-operand">Fragment Bitmask Operand</name>
              <artwork name="" type="" align="left" alt="" pn="section-4.2.2.12-4.1">
                   0   1   2   3   4   5   6   7
                 +---+---+---+---+---+---+---+---+
                 | 0 | 0 | 0 | 0 |LF |FF |IsF|DF |
                 +---+---+---+---+---+---+---+---+
</artwork>
            </figure>
            <t indent="0" pn="section-4.2.2.12-5">Bitmask values:</t>
            <dl newline="false" spacing="normal" indent="6" pn="section-4.2.2.12-6">
              <dt pn="section-4.2.2.12-6.1">DF (Don't Fragment):</dt>
              <dd pn="section-4.2.2.12-6.2">match if IP Header Flags Bit-1 (DF) <xref target="RFC0791" format="default" sectionFormat="of" derivedContent="RFC0791"/> is 1</dd>
              <dt pn="section-4.2.2.12-6.3">IsF (Is a fragment other than the first):</dt>
              <dd pn="section-4.2.2.12-6.4">match if the <xref target="RFC0791" format="default" sectionFormat="of" derivedContent="RFC0791"/> IP Header Fragment Offset is not 0</dd>
              <dt pn="section-4.2.2.12-6.5">FF (First Fragment):</dt>
              <dd pn="section-4.2.2.12-6.6">match if the <xref target="RFC0791" format="default" sectionFormat="of" derivedContent="RFC0791"/> IP Header Fragment
	      Offset  is 0 AND Flags
	      Bit-2 (MF) is 1</dd>
              <dt pn="section-4.2.2.12-6.7">LF (Last Fragment):</dt>
              <dd pn="section-4.2.2.12-6.8">match if the <xref target="RFC0791" format="default" sectionFormat="of" derivedContent="RFC0791"/> IP Header Fragment Offset 
	       is not 0 AND Flags
	      Bit-2 (MF) is 0</dd>
              <dt pn="section-4.2.2.12-6.9">0:</dt>
              <dd pn="section-4.2.2.12-6.10">
                <bcp14>MUST</bcp14> be set to 0 on NLRI encoding and
	      <bcp14>MUST</bcp14> be ignored during decoding</dd>
            </dl>
          </section>
        </section>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.3">
        <name slugifiedName="name-examples-of-encodings">Examples of Encodings</name>
        <section toc="exclude" numbered="true" removeInRFC="false" pn="section-4.3.1">
          <name slugifiedName="name-example-1">Example 1</name>
          <t indent="0" pn="section-4.3.1-1">An example of a Flow Specification NLRI encoding for: "all
	  packets to 192.0.2.0/24 and TCP port 25".</t>
          <table anchor="ex-1" align="center" pn="table-2">
            <thead>
              <tr>
                <th align="left" colspan="1" rowspan="1">length</th>
                <th align="left" colspan="1" rowspan="1">destination</th>
                <th align="left" colspan="1" rowspan="1">protocol</th>
                <th align="left" colspan="1" rowspan="1">port</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x0b</td>
                <td align="left" colspan="1" rowspan="1">01 18 c0 00 02</td>
                <td align="left" colspan="1" rowspan="1">03 81 06</td>
                <td align="left" colspan="1" rowspan="1">04 81 19</td>
              </tr>
            </tbody>
          </table>
          <t indent="0" pn="section-4.3.1-3">Decoded:</t>
          <table anchor="ex-1-decoded" align="center" pn="table-3">
            <thead>
              <tr>
                <th align="left" colspan="1" rowspan="1">Value</th>
                <th rowspan="1" colspan="2" align="left"/>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x0b</td>
                <td align="left" colspan="1" rowspan="1">length</td>
                <td align="left" colspan="1" rowspan="1"> 11 octets (if len&lt;240, 1 octet)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x01</td>
                <td align="left" colspan="1" rowspan="1">type</td>
                <td align="left" colspan="1" rowspan="1">Type 1 - Destination Prefix</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x18</td>
                <td align="left" colspan="1" rowspan="1">length</td>
                <td align="left" colspan="1" rowspan="1">24 bit</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0xc0</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">192</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x00</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x02</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">2</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x03</td>
                <td align="left" colspan="1" rowspan="1">type</td>
                <td align="left" colspan="1" rowspan="1">Type 3 - IP Protocol</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x81</td>
                <td align="left" colspan="1" rowspan="1">numeric_op</td>
                <td align="left" colspan="1" rowspan="1">end-of-list, value size=1, ==</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x06</td>
                <td align="left" colspan="1" rowspan="1">value</td>
                <td align="left" colspan="1" rowspan="1">6 (TCP)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x04</td>
                <td align="left" colspan="1" rowspan="1">type</td>
                <td align="left" colspan="1" rowspan="1">Type 4 - Port</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x81</td>
                <td align="left" colspan="1" rowspan="1">numeric_op</td>
                <td align="left" colspan="1" rowspan="1">end-of-list, value size=1, ==</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x19</td>
                <td align="left" colspan="1" rowspan="1">value</td>
                <td align="left" colspan="1" rowspan="1">25</td>
              </tr>
            </tbody>
          </table>
          <t indent="0" pn="section-4.3.1-5">This constitutes an NLRI with an NLRI length of 11 octets.</t>
        </section>
        <section toc="exclude" numbered="true" removeInRFC="false" pn="section-4.3.2">
          <name slugifiedName="name-example-2">Example 2</name>
          <t indent="0" pn="section-4.3.2-1">An example of a Flow Specification NLRI encoding for: "all
	  packets to 192.0.2.0/24 from 203.0.113.0/24 and port {range [137,
	  139] or 8080}".</t>
          <table anchor="ex-2" align="center" pn="table-4">
            <thead>
              <tr>
                <th align="left" colspan="1" rowspan="1">length</th>
                <th align="left" colspan="1" rowspan="1">destination</th>
                <th align="left" colspan="1" rowspan="1">source</th>
                <th align="left" colspan="1" rowspan="1">port</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x12</td>
                <td align="left" colspan="1" rowspan="1">01 18 c0 00 02</td>
                <td align="left" colspan="1" rowspan="1">02 18 cb 00 71</td>
                <td align="left" colspan="1" rowspan="1">04 03 89 45 8b 91 1f 90</td>
              </tr>
            </tbody>
          </table>
          <t indent="0" pn="section-4.3.2-3">Decoded:</t>
          <table anchor="ex-2-decoded" align="center" pn="table-5">
            <thead>
              <tr>
                <th align="left" colspan="1" rowspan="1">Value</th>
                <th rowspan="1" colspan="2" align="left"/>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x12</td>
                <td align="left" colspan="1" rowspan="1">length</td>
                <td align="left" colspan="1" rowspan="1">18 octets (if len&lt;240, 1 octet)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x01</td>
                <td align="left" colspan="1" rowspan="1">type</td>
                <td align="left" colspan="1" rowspan="1">Type 1 - Destination Prefix</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x18</td>
                <td align="left" colspan="1" rowspan="1">length</td>
                <td align="left" colspan="1" rowspan="1">24 bit</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0xc0</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">192</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x00</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x02</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">2</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x02</td>
                <td align="left" colspan="1" rowspan="1">type</td>
                <td align="left" colspan="1" rowspan="1">Type 2 - Source Prefix</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x18</td>
                <td align="left" colspan="1" rowspan="1">length</td>
                <td align="left" colspan="1" rowspan="1"> 24 bit</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0xcb</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">203</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x00</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x71</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">113</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x04</td>
                <td align="left" colspan="1" rowspan="1">type</td>
                <td align="left" colspan="1" rowspan="1">Type 4 - Port</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x03</td>
                <td align="left" colspan="1" rowspan="1">numeric_op</td>
                <td align="left" colspan="1" rowspan="1">value size=1, &gt;=</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x89</td>
                <td align="left" colspan="1" rowspan="1">value</td>
                <td align="left" colspan="1" rowspan="1">137</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x45</td>
                <td align="left" colspan="1" rowspan="1">numeric_op</td>
                <td align="left" colspan="1" rowspan="1">"AND", value size=1, &lt;=</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x8b</td>
                <td align="left" colspan="1" rowspan="1">value</td>
                <td align="left" colspan="1" rowspan="1">139</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x91</td>
                <td align="left" colspan="1" rowspan="1">numeric_op</td>
                <td align="left" colspan="1" rowspan="1">end-of-list, value size=2, ==</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x1f90</td>
                <td align="left" colspan="1" rowspan="1">value</td>
                <td align="left" colspan="1" rowspan="1">8080</td>
              </tr>
            </tbody>
          </table>
          <t indent="0" pn="section-4.3.2-5">This constitutes an NLRI with an NLRI length of 18 octets.</t>
        </section>
        <section toc="exclude" numbered="true" removeInRFC="false" pn="section-4.3.3">
          <name slugifiedName="name-example-3">Example 3</name>
          <t indent="0" pn="section-4.3.3-1">An example of a Flow Specification NLRI encoding for: "all
	  packets to 192.0.2.1/32 and fragment { DF or FF } (matching packet
	  with DF bit set or First Fragments)</t>
          <table anchor="ex-3" align="center" pn="table-6">
            <thead>
              <tr>
                <th align="left" colspan="1" rowspan="1">length</th>
                <th align="left" colspan="1" rowspan="1">destination</th>
                <th align="left" colspan="1" rowspan="1">fragment</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x09</td>
                <td align="left" colspan="1" rowspan="1">01 20 c0 00 02 01</td>
                <td align="left" colspan="1" rowspan="1">0c 80 05</td>
              </tr>
            </tbody>
          </table>
          <t indent="0" pn="section-4.3.3-3">Decoded:</t>
          <table align="center" pn="table-7">
            <thead>
              <tr>
                <th align="left" colspan="1" rowspan="1">Value</th>
                <th rowspan="1" colspan="2" align="left"/>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x09</td>
                <td align="left" colspan="1" rowspan="1">length</td>
                <td align="left" colspan="1" rowspan="1">9 octets (if len&lt;240, 1 octet)</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x01</td>
                <td align="left" colspan="1" rowspan="1">type</td>
                <td align="left" colspan="1" rowspan="1">Type 1 - Destination Prefix</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x20</td>
                <td align="left" colspan="1" rowspan="1">length</td>
                <td align="left" colspan="1" rowspan="1"> 32 bit</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0xc0</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">192</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x00</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x02</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">2</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x01</td>
                <td align="left" colspan="1" rowspan="1">prefix</td>
                <td align="left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x0c</td>
                <td align="left" colspan="1" rowspan="1">type</td>
                <td align="left" colspan="1" rowspan="1">Type 12 - Fragment</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x80</td>
                <td align="left" colspan="1" rowspan="1">bitmask_op</td>
                <td align="left" colspan="1" rowspan="1">end-of-list, value size=1</td>
              </tr>
              <tr>
                <td align="left" colspan="1" rowspan="1">0x05</td>
                <td align="left" colspan="1" rowspan="1">bitmask</td>
                <td align="left" colspan="1" rowspan="1">DF=1, FF=1</td>
              </tr>
            </tbody>
          </table>
          <t indent="0" pn="section-4.3.3-5">This constitutes an NLRI with an NLRI length of 9 octets.</t>
        </section>
      </section>
    </section>
    <section anchor="traffic_filtering" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-traffic-filtering">Traffic Filtering</name>
      <t indent="0" pn="section-5-1">Traffic filtering policies have been traditionally considered to be
      relatively static.  Limitations of these static mechanisms caused this
      new dynamic mechanism to be designed for the three new applications of
      traffic filtering:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5-2">
        <li pn="section-5-2.1">Prevention of traffic-based, denial-of-service (DoS) attacks</li>
        <li pn="section-5-2.2">Traffic filtering in the context of BGP/MPLS VPN service</li>
        <li pn="section-5-2.3">Centralized traffic control for SDN/NFV networks</li>
      </ul>
      <t indent="0" pn="section-5-3">These applications require coordination among service providers
      and/or coordination among the AS within a service provider.</t>
      <t indent="0" pn="section-5-4">The Flow Specification NLRI defined in <xref target="dissemination_ipv4_flowspec" format="default" sectionFormat="of" derivedContent="Section 4"/> conveys
      information about traffic filtering rules for traffic that should be
      discarded or handled in a manner specified by a set of predefined
      actions (which are defined in BGP Extended Communities). This mechanism
      is primarily designed to allow an upstream autonomous system to perform
      inbound filtering in their ingress routers of traffic that a given
      downstream AS wishes to drop.</t>
      <t indent="0" pn="section-5-5">In order to achieve this goal, this document specifies two
      application-specific NLRI identifiers that provide traffic filters and
      a set of actions encoding in BGP Extended Communities.  The two
      application-specific NLRI identifiers are:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5-6">
        <li pn="section-5-6.1">IPv4 Flow Specification identifier (AFI=1, SAFI=133) along with
	specific semantic rules for IPv4 routes and</li>
        <li pn="section-5-6.2">VPNv4 Flow Specification identifier (AFI=1, SAFI=134) value, which
	can be used to propagate traffic filtering information in a BGP/MPLS
	VPN environment.</li>
      </ul>
      <t indent="0" pn="section-5-7">
       Encoding of the NLRI is described in <xref target="dissemination_ipv4_flowspec" format="default" sectionFormat="of" derivedContent="Section 4"/> for IPv4 Flow Specification and   in
       <xref target="traffic_filtering_vpn" format="default" sectionFormat="of" derivedContent="Section 8"/> for VPNv4 Flow Specification. The filtering actions are described
       in <xref target="traffic_filtering_actions" format="default" sectionFormat="of" derivedContent="Section 7"/>.
      </t>
      <section anchor="ordering_of_flow_spec" numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-ordering-of-flow-specificat">Ordering of Flow Specifications</name>
        <t indent="0" pn="section-5.1-1">More than one Flow Specification may match a particular traffic
	flow.  Thus, it is necessary to define the order in which Flow
	Specifications get matched and actions being applied to a particular
	traffic flow. This ordering function is such that it does not depend
	on the arrival order of the Flow Specification via BGP and thus is
	consistent in the network.</t>
        <t indent="0" pn="section-5.1-2">The relative order of two Flow Specifications is determined by
	comparing their respective components. The algorithm starts by
	comparing the left-most components (lowest component type value) of
	the Flow Specifications.  If the types differ, the Flow Specification
	with lowest numeric type value has higher precedence (and thus will
	match before) than the Flow Specification that doesn't contain that
	component type. If the component types are the same, then a
	type-specific comparison is performed (see below). If the types are
	equal, the algorithm continues with the next component.</t>
        <t indent="0" pn="section-5.1-3">For IP prefix values (IP destination or source prefix), if one of
	the two prefixes to compare is a more specific prefix of the other,
	the more specific prefix has higher precedence. Otherwise, the one with
	the lowest IP value has higher precedence.</t>
        <t indent="0" pn="section-5.1-4">For all other component types, unless otherwise specified, the
	comparison is performed by comparing the component data as a binary
	string using the memcmp() function as defined by <xref target="ISO_IEC_9899" format="default" sectionFormat="of" derivedContent="ISO_IEC_9899"/>. For strings with equal
	lengths, the lowest string (memcmp) has higher precedence. For strings
	of different lengths, the common prefix is compared. If the common
	prefix is not equal, the string with the lowest prefix has higher
	precedence. If the common prefix is equal, the longest string is
	considered to have higher precedence than the shorter one.</t>
        <t indent="0" pn="section-5.1-5">The code in <xref target="flow_rule_cmp_src" format="default" sectionFormat="of" derivedContent="Appendix A"/>
	shows a Python3 implementation of the comparison algorithm. The full
	code was tested with Python 3.6.3 and can be obtained at <eref brackets="angle" target="https://github.com/stoffi92/rfc5575bis/tree/master/flowspec-cmp"/>.</t>
      </section>
    </section>
    <section anchor="validation_procedure" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-validation-procedure">Validation Procedure</name>
      <t indent="0" pn="section-6-1">Flow Specifications received from a BGP peer that are accepted in the
      respective Adj-RIB-In are used as input to the route selection process.
      Although the forwarding attributes of two routes for the same Flow
      Specification prefix may be the same, BGP is still required to perform
      its path selection algorithm in order to select the correct set of
      attributes to advertise.</t>
      <t indent="0" pn="section-6-2">The first step of the BGP Route Selection procedure (<xref target="RFC4271" sectionFormat="of" section="9.1.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4271#section-9.1.2" derivedContent="RFC4271"/>) is to exclude from
      the selection procedure routes that are considered unfeasible. 
      In the
      context of IP routing information, this step is used to validate that
      the NEXT_HOP attribute of a given route is resolvable.</t>
      <t indent="0" pn="section-6-3">
   The concept can be extended, in the case of the Flow Specification NLRI,
   to allow other validation procedures.
</t>
      <t indent="0" pn="section-6-4">
    The validation process described below validates Flow Specifications against
    unicast routes received over the same AFI but the associated unicast routing
    information SAFI:
</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-6-5">
        <li pn="section-6-5.1">Flow Specification received over SAFI=133 will be validated
	against routes received over SAFI=1.</li>
        <li pn="section-6-5.2">Flow Specification received over SAFI=134 will be validated
	against routes received over SAFI=128.</li>
      </ul>
      <t indent="0" pn="section-6-6">In the absence of explicit configuration, a Flow Specification NLRI
      <bcp14>MUST</bcp14> be validated such that it is considered feasible if
      and only if all of the conditions below are true:</t>
      <ol spacing="normal" type="%c)" indent="adaptive" start="1" pn="section-6-7">
        <li pn="section-6-7.1" derivedCounter="a)">A destination prefix component is embedded in the Flow Specification.</li>
        <li pn="section-6-7.2" derivedCounter="b)">The originator of the Flow Specification matches the originator of
	the best-match unicast route for the destination prefix embedded in
	the Flow Specification (this is the unicast route with the longest
	possible prefix length covering the destination prefix embedded in the
	Flow Specification).</li>
        <li pn="section-6-7.3" derivedCounter="c)">There are no "more-specific" unicast routes, when compared with
	the flow destination prefix, that have been received from a different
	neighboring AS than the best-match unicast route, which has been
	determined in rule b.</li>
      </ol>
      <t indent="0" pn="section-6-8">However, rule a <bcp14>MAY</bcp14> be relaxed by explicit
      configuration, permitting Flow Specifications that include no
      destination prefix component. If such is the case, rules b and c are
      moot and <bcp14>MUST</bcp14> be disregarded.</t>
      <t indent="0" pn="section-6-9">By "originator" of a BGP route, we mean either the address of the
      originator in the ORIGINATOR_ID Attribute <xref target="RFC4456" format="default" sectionFormat="of" derivedContent="RFC4456"/> or the source IP address of the BGP peer, if this
      path attribute is not present.</t>
      <t indent="0" pn="section-6-10">BGP implementations <bcp14>MUST</bcp14> also enforce that the AS_PATH
      attribute of a route received via the External Border Gateway Protocol
      (eBGP) contains the neighboring AS in the left-most position of the
      AS_PATH attribute.  While this rule is optional in the BGP
      specification, it becomes necessary to enforce it here for security
      reasons.</t>
      <t indent="0" pn="section-6-11">The best-match unicast route may change over the time independently
      of the Flow Specification NLRI. Therefore, a revalidation of the Flow
      Specification NLRI <bcp14>MUST</bcp14> be performed whenever unicast
      routes change. Revalidation is defined as retesting rules a to c as
      described above.</t>
      <t indent="0" pn="section-6-12">Explanation:</t>
      <t indent="0" pn="section-6-13">The underlying concept is that the neighboring AS that advertises the
      best unicast route for a destination is allowed to advertise Flow
      Specification information that conveys a destination prefix that is more
      or equally specific. Thus, as long as there are no "more-specific"
      unicast routes received from a different neighboring AS, which would be
      affected by that Flow Specification, the Flow Specification is validated
      successfully.</t>
      <t indent="0" pn="section-6-14">The neighboring AS is the immediate destination of the traffic
      described by the Flow Specification.  If it requests these flows to be
      dropped, that request can be honored without concern that it represents
      a denial of service in itself.  The reasoning is that this is as if the
      traffic is being dropped by the downstream autonomous system, and there
      is no added value in carrying the traffic to it.</t>
    </section>
    <section anchor="traffic_filtering_actions" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-traffic-filtering-actions">Traffic Filtering Actions</name>
      <t indent="0" pn="section-7-1">This document defines a minimum set of Traffic Filtering Actions that
      it standardizes as BGP Extended Communities <xref target="RFC4360" format="default" sectionFormat="of" derivedContent="RFC4360"/>. This is not meant to be an inclusive list of all the
      possible actions but only a subset that can be interpreted consistently
      across the network. Additional actions can be defined as either
      requiring standards or as vendor specific.</t>
      <t indent="0" pn="section-7-2">The default action for a matching Flow Specification is to accept the
      packet (treat the packet according to the normal forwarding behavior of
      the system).</t>
      <t indent="0" pn="section-7-3">This document defines the following Extended Communities values shown
      in <xref target="traffic_extended_communities" format="default" sectionFormat="of" derivedContent="Table 8"/> in the
      form 0xttss, where tt indicates the type and ss indicates the sub-type
      of the Extended Community. Encodings for these Extended Communities are
      described below.</t>
      <table anchor="traffic_extended_communities" align="center" pn="table-8">
        <name slugifiedName="name-traffic-filtering-action-ex">Traffic Filtering Action Extended Communities</name>
        <thead>
          <tr>
            <th align="left" colspan="1" rowspan="1">community 0xttss</th>
            <th align="left" colspan="1" rowspan="1">action</th>
            <th align="left" colspan="1" rowspan="1">encoding</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" colspan="1" rowspan="1">0x8006</td>
            <td align="left" colspan="1" rowspan="1">traffic-rate-bytes (<xref target="traffic_rate_in_bytes" format="default" sectionFormat="of" derivedContent="Section 7.1"/>)</td>
            <td align="left" colspan="1" rowspan="1">2-octet AS, 4-octet float</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">0x800c</td>
            <td align="left" colspan="1" rowspan="1">traffic-rate-packets (<xref target="traffic_rate_in_packets" format="default" sectionFormat="of" derivedContent="Section 7.2"/>)</td>
            <td align="left" colspan="1" rowspan="1">2-octet AS, 4-octet float</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">0x8007</td>
            <td align="left" colspan="1" rowspan="1">traffic-action (<xref target="traffic_action_subtype" format="default" sectionFormat="of" derivedContent="Section 7.3"/>)</td>
            <td align="left" colspan="1" rowspan="1">bitmask</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">0x8008</td>
            <td align="left" colspan="1" rowspan="1">rt-redirect AS-2octet (<xref target="rt_redirect_action_subtype" format="default" sectionFormat="of" derivedContent="Section 7.4"/>)</td>
            <td align="left" colspan="1" rowspan="1">2-octet AS, 4-octet value</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">0x8108</td>
            <td align="left" colspan="1" rowspan="1">rt-redirect IPv4 (<xref target="rt_redirect_action_subtype" format="default" sectionFormat="of" derivedContent="Section 7.4"/>)</td>
            <td align="left" colspan="1" rowspan="1">4-octet IPv4 address, 2-octet value</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">0x8208</td>
            <td align="left" colspan="1" rowspan="1">rt-redirect AS-4octet (<xref target="rt_redirect_action_subtype" format="default" sectionFormat="of" derivedContent="Section 7.4"/>)</td>
            <td align="left" colspan="1" rowspan="1">4-octet AS, 2-octet value</td>
          </tr>
          <tr>
            <td align="left" colspan="1" rowspan="1">0x8009</td>
            <td align="left" colspan="1" rowspan="1">traffic-marking (<xref target="traffic_marking_subtype" format="default" sectionFormat="of" derivedContent="Section 7.5"/>)</td>
            <td align="left" colspan="1" rowspan="1">DSCP value</td>
          </tr>
        </tbody>
      </table>
      <t indent="0" pn="section-7-5">Multiple Traffic Filtering Actions defined in this document may be
      present for a single Flow Specification and <bcp14>SHOULD</bcp14> be
      applied to the traffic flow (for example, traffic-rate-bytes and
      rt-redirect can be applied to packets at the same time). If not all of
      the Traffic Filtering Actions can be applied to a traffic flow, they
      should be treated as interfering Traffic Filtering Actions (see
      below).</t>
      <t indent="0" pn="section-7-6">Some Traffic Filtering Actions may interfere with each other or even
      contradict. <xref target="rules_action_interference" format="default" sectionFormat="of" derivedContent="Section 7.7"/>
      of this document provides general considerations on such Traffic
      Filtering Action interference. Any additional definition of Traffic
      Filtering Actions <bcp14>SHOULD</bcp14> specify the action to take if
      those Traffic Filtering Actions interfere (also with existing Traffic
      Filtering Actions).</t>
      <t indent="0" pn="section-7-7">All Traffic Filtering Actions are specified as transitive BGP
      Extended Communities.</t>
      <section anchor="traffic_rate_in_bytes" numbered="true" toc="include" removeInRFC="false" pn="section-7.1">
        <name slugifiedName="name-traffic-rate-in-bytes-traff">Traffic Rate in Bytes (traffic-rate-bytes) Sub-Type 0x06</name>
        <t indent="0" pn="section-7.1-1">The traffic-rate-bytes Extended Community uses the following
	Extended Community encoding:</t>
        <t indent="0" pn="section-7.1-2">
 The first two octets carry the 2-octet id, which can be
 assigned from a 2-octet AS number.  When a 4-octet AS number is
 locally present, the 2 least significant octets of such an AS
 number can be used.  This value is purely informational and
 <bcp14>SHOULD NOT</bcp14> be interpreted by the implementation.
</t>
        <t indent="0" pn="section-7.1-3">The remaining 4 octets carry the maximum rate information in IEEE
	floating point <xref target="IEEE.754.1985" format="default" sectionFormat="of" derivedContent="IEEE.754.1985"/> format,
	units being bytes per second.  A traffic-rate of 0 should result on
	all traffic for the particular flow to be discarded. On encoding, the
	traffic-rate <bcp14>MUST NOT</bcp14> be negative. On decoding, negative
	values <bcp14>MUST</bcp14> be treated as zero (discard all
	traffic).</t>
        <t indent="0" pn="section-7.1-4">Interferes with: May interfere with the traffic-rate-packets (see
	<xref target="traffic_rate_in_packets" format="default" sectionFormat="of" derivedContent="Section 7.2"/>). A policy
	may allow both filtering by traffic-rate-packets and
	traffic-rate-bytes. If the policy does not allow this, these two
	actions will conflict.</t>
      </section>
      <section anchor="traffic_rate_in_packets" numbered="true" toc="include" removeInRFC="false" pn="section-7.2">
        <name slugifiedName="name-traffic-rate-in-packets-tra">Traffic Rate in Packets (traffic-rate-packets) Sub-Type 0x0c</name>
        <t indent="0" pn="section-7.2-1">The traffic-rate-packets Extended Community uses the same encoding
	as the traffic-rate-bytes Extended Community. The floating point value
	carries the maximum packet rate in packets per second. A
	traffic-rate-packets of 0 should result in all traffic for the
	particular flow to be discarded. On encoding, the traffic-rate-packets
	<bcp14>MUST NOT</bcp14> be negative. On decoding, negative values
	<bcp14>MUST</bcp14> be treated as zero (discard all traffic).</t>
        <t indent="0" pn="section-7.2-2">Interferes with: May interfere with the traffic-rate-bytes (see
	<xref target="traffic_rate_in_bytes" format="default" sectionFormat="of" derivedContent="Section 7.1"/>). A policy may
	allow both filtering by traffic-rate-packets and
	traffic-rate-bytes. If the policy does not allow this, these two
	actions will conflict.</t>
      </section>
      <section anchor="traffic_action_subtype" numbered="true" toc="include" removeInRFC="false" pn="section-7.3">
        <name slugifiedName="name-traffic-action-traffic-acti">Traffic-Action (traffic-action) Sub-Type 0x07</name>
        <t indent="0" pn="section-7.3-1">The traffic-action Extended Community consists of 6
      octets of which only the 2 least significant bits of the 6th octet
      (from left to right) are defined by this document, as shown in
     <xref target="figure_traffic_action_encoding" format="default" sectionFormat="of" derivedContent="Figure 5"/>.
</t>
        <figure anchor="figure_traffic_action_encoding" align="left" suppress-title="false" pn="figure-5">
          <name slugifiedName="name-traffic-action-extended-com">Traffic-Action Extended Community Encoding</name>
          <artwork name="" type="" align="left" alt="" pn="section-7.3-2.1">
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Traffic Action Field                                          |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Tr. Action Field (cont.)  |S|T|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <t indent="0" pn="section-7.3-3">S and T are defined as:</t>
        <dl newline="false" spacing="normal" indent="6" pn="section-7.3-4">
          <dt pn="section-7.3-4.1">T</dt>
          <dd pn="section-7.3-4.2">Terminal Action (bit 47): When this bit is set, the traffic
	  filtering engine will evaluate any subsequent Flow Specifications
	  (as defined by the ordering procedure <xref target="ordering_of_flow_spec" format="default" sectionFormat="of" derivedContent="Section 5.1"/>). If not set, the
	  evaluation of the traffic filters stops when this Flow Specification
	  is evaluated.</dd>
          <dt pn="section-7.3-4.3">S</dt>
          <dd pn="section-7.3-4.4">Sample (bit 46): Enables traffic sampling and logging for this
	  Flow Specification (only effective when set).</dd>
          <dt pn="section-7.3-4.5">Traffic Action Field:</dt>
          <dd pn="section-7.3-4.6">Other Traffic Action Field (see <xref target="IANA" format="default" sectionFormat="of" derivedContent="Section 11"/>) bits unused in this
	  specification. These bits <bcp14>MUST</bcp14> be set to 0 on
	  encoding and <bcp14>MUST</bcp14> be ignored during decoding.</dd>
        </dl>
        <t indent="0" pn="section-7.3-5">The use of the Terminal Action (bit 47) may result in more than one
	Flow Specification matching a particular traffic flow. All the Traffic
	Filtering Actions from these Flow Specifications shall be collected
	and applied. In case of interfering Traffic Filtering Actions, it is an
	implementation decision which Traffic Filtering Actions are
	selected. See also <xref target="rules_action_interference" format="default" sectionFormat="of" derivedContent="Section 7.7"/>.</t>
        <t indent="0" pn="section-7.3-6">Interferes with: No other BGP Flow Specification Traffic Filtering
	Action in this document.</t>
      </section>
      <section anchor="rt_redirect_action_subtype" numbered="true" toc="include" removeInRFC="false" pn="section-7.4">
        <name slugifiedName="name-rt-redirect-rt-redirect-sub">RT Redirect (rt-redirect) Sub-Type 0x08</name>
        <t indent="0" pn="section-7.4-1">The redirect Extended Community allows the traffic to be redirected
	to a VRF routing instance that lists the specified route-target in its
	import policy. If several local instances match this criteria, the
	choice between them is a local matter (for example, the instance with
	the lowest Route Distinguisher value can be elected).</t>
        <t indent="0" pn="section-7.4-2">This Extended Community allows 3 different encodings formats for
	the route-target (type 0x80, 0x81, 0x82). It uses the same encoding as
	the Route Target Extended Community in Sections <xref target="RFC4360" section="3.1" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4360#section-3.1" derivedContent="RFC4360"/> (type 0x80: 2-octet AS, 4-octet
	value), <xref target="RFC4360" section="3.2" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4360#section-3.2" derivedContent="RFC4360"/>
	(type 0x81: 4-octet IPv4 address, 2-octet value), and <xref target="RFC4360" section="4" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4360#section-4" derivedContent="RFC4360"/> of <xref target="RFC4360" format="default" sectionFormat="of" derivedContent="RFC4360"/> and <xref target="RFC5668" sectionFormat="of" section="2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc5668#section-2" derivedContent="RFC5668"/> (type 0x82: 4-octet AS,
	2-octet value) with the high-order octet of the Type field 0x80, 0x81,
	0x82 respectively and the low-order octet of the Type field (Sub-Type)
	always 0x08.</t>
        <t indent="0" pn="section-7.4-3">Interferes with: No other BGP Flow Specification Traffic Filtering
	Action in this document.</t>
      </section>
      <section anchor="traffic_marking_subtype" numbered="true" toc="include" removeInRFC="false" pn="section-7.5">
        <name slugifiedName="name-traffic-marking-traffic-mar">Traffic Marking (traffic-marking) Sub-Type 0x09</name>
        <t indent="0" pn="section-7.5-1"> The traffic marking Extended Community instructs a system to
	modify the DSCP bits in the IP header (<xref target="RFC2474" sectionFormat="of" section="3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc2474#section-3" derivedContent="RFC2474"/>) of a transiting IP packet to the
	corresponding value encoded in the 6 least significant bits of the
	Extended Community value, as shown in <xref target="figure_traffic_marking_encoding" format="default" sectionFormat="of" derivedContent="Figure 6"/>.</t>
        <t indent="0" pn="section-7.5-2">The Extended Community is encoded as follows:</t>
        <figure anchor="figure_traffic_marking_encoding" align="left" suppress-title="false" pn="figure-6">
          <name slugifiedName="name-traffic-marking-extended-co">Traffic Marking Extended Community Encoding</name>
          <artwork name="" type="" align="left" alt="" pn="section-7.5-3.1">
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   reserved    |   reserved    |   reserved    |   reserved    |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   reserved    | r.|    DSCP   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
        <dl newline="false" spacing="normal" indent="6" pn="section-7.5-4">
          <dt pn="section-7.5-4.1">DSCP:</dt>
          <dd pn="section-7.5-4.2">new DSCP value for the transiting IP packet</dd>
          <dt pn="section-7.5-4.3">reserved (r):</dt>
          <dd pn="section-7.5-4.4">
            <bcp14>MUST</bcp14> be set to 0 on encoding and
	  <bcp14>MUST</bcp14> be ignored during decoding</dd>
        </dl>
        <t indent="0" pn="section-7.5-5">Interferes with: No other BGP Flow Specification Traffic Filtering
	Action in this document.</t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-7.6">
        <name slugifiedName="name-interaction-with-other-filt">Interaction with Other Filtering Mechanisms in Routers</name>
        <t indent="0" pn="section-7.6-1">
   Implementations should provide mechanisms that map an arbitrary BGP
   community value (normal or extended) to Traffic Filtering Actions that
   require different mappings on different systems in the network.  For
   instance, providing packets with a worse-than-best-effort per-hop
   behavior is a functionality that is likely to be implemented
   differently in different systems and for which no standard behavior
   is currently known.  Rather than attempting to define it here, this
   can be accomplished by mapping a user-defined community value to
   platform-/network-specific behavior via user configuration.
        </t>
      </section>
      <section anchor="rules_action_interference" numbered="true" toc="include" removeInRFC="false" pn="section-7.7">
        <name slugifiedName="name-considerations-on-traffic-f">Considerations on Traffic Filtering Action Interference</name>
        <t indent="0" pn="section-7.7-1">Since Traffic Filtering Actions are represented as BGP extended
	community values, Traffic Filtering Actions may interfere with each
	other (e.g., there may be more than one conflicting traffic-rate-bytes
	Traffic Filtering Action associated with a single Flow
	Specification). Traffic Filtering Action interference has no impact on
	BGP propagation of Flow Specifications (all communities are propagated
	according to policies).</t>
        <t indent="0" pn="section-7.7-2">If a Flow Specification associated with interfering Traffic
	Filtering Actions is selected for packet forwarding, it is an
	implementation decision which of the interfering Traffic Filtering
	Actions are selected. Implementors of this specification
	<bcp14>SHOULD</bcp14> document the behavior of their implementation in
	such cases.</t>
        <t indent="0" pn="section-7.7-3">Operators are encouraged to make use of the BGP policy framework
	supported by their implementation in order to achieve a predictable
	behavior. See also <xref target="security_considerations" format="default" sectionFormat="of" derivedContent="Section 12"/>.</t>
      </section>
    </section>
    <section anchor="traffic_filtering_vpn" numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-dissemination-of-traffic-fi">Dissemination of Traffic Filtering in BGP/MPLS VPN Networks</name>
      <t indent="0" pn="section-8-1">
   Provider-based Layer 3 VPN networks, such as the ones using a BGP/ MPLS IP
   VPN <xref target="RFC4364" format="default" sectionFormat="of" derivedContent="RFC4364"/> control plane, may have different traffic
   filtering requirements than Internet service providers. But also Internet
   service providers may use those VPNs for scenarios like having the Internet
   routing table in a VRF, resulting in the same traffic filtering requirements
   as defined for the global routing table environment within this document.
   This document defines an additional BGP NLRI type (AFI=1, SAFI=134) value,
   which can be used to propagate Flow Specification in a BGP/MPLS
   VPN environment.
      </t>
      <t indent="0" pn="section-8-2">
   The NLRI format for this address family consists of a fixed-length Route
   Distinguisher field (8 octets) followed by the Flow Specification NLRI value (<xref target="nlri_value_encoding" format="default" sectionFormat="of" derivedContent="Section 4.2"/>).
   The NLRI length field shall include both the 8 octets of the Route
   Distinguisher as well as the subsequent Flow Specification NLRI value.
   The resulting encoding is shown in <xref target="figure_fs_nlri_mpls" format="default" sectionFormat="of" derivedContent="Figure 7"/>.
</t>
      <figure anchor="figure_fs_nlri_mpls" align="left" suppress-title="false" pn="figure-7">
        <name slugifiedName="name-flow-specification-nlri-for-">Flow Specification NLRI for MPLS</name>
        <artwork name="" type="" align="left" alt="" pn="section-8-3.1">
                 +--------------------------------+
                 | length (0xnn or 0xfnnn)        |
                 +--------------------------------+
                 | Route Distinguisher (8 octets) |
                 +--------------------------------+
                 |    NLRI value  (variable)      |
                 +--------------------------------+
  </artwork>
      </figure>
      <t indent="0" pn="section-8-4">
   Propagation of this NLRI is controlled by matching Route Target
   extended communities associated with the BGP path advertisement with
   the VRF import policy, using the same mechanism as described in BGP/
   MPLS IP VPNs <xref target="RFC4364" format="default" sectionFormat="of" derivedContent="RFC4364"/>.
</t>
      <t indent="0" pn="section-8-5">
   Flow Specifications received via this NLRI apply only to traffic
   that belongs to the VRF(s) in which it is imported. By default,
   traffic received from a remote PE is switched via an MPLS forwarding
   decision and is not subject to filtering.
</t>
      <t indent="0" pn="section-8-6">Contrary to the behavior specified for the non-VPN NLRI, Flow
      Specifications are accepted by default, when received from remote PE
      routers.</t>
      <t indent="0" pn="section-8-7">The validation procedure (<xref target="validation_procedure" format="default" sectionFormat="of" derivedContent="Section 6"/>) and Traffic Filtering Actions (<xref target="traffic_filtering_actions" format="default" sectionFormat="of" derivedContent="Section 7"/>) are the same as
      for IPv4.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-9">
      <name slugifiedName="name-traffic-monitoring">Traffic Monitoring</name>
      <t indent="0" pn="section-9-1">
   Traffic filtering applications require monitoring and traffic
   statistics facilities.  While this is an implementation specific
   choice, implementations <bcp14>SHOULD</bcp14> provide:
      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-9-2">
        <li pn="section-9-2.1">A mechanism to log the packet header of filtered traffic.</li>
        <li pn="section-9-2.2">A mechanism to count the number of matches for a given Flow
	Specification rule.</li>
      </ul>
    </section>
    <section anchor="errorhandling" numbered="true" toc="include" removeInRFC="false" pn="section-10">
      <name slugifiedName="name-error-handling">Error Handling</name>
      <t indent="0" pn="section-10-1">
      Error handling according to <xref target="RFC7606" format="default" sectionFormat="of" derivedContent="RFC7606"/> and
      <xref target="RFC4760" format="default" sectionFormat="of" derivedContent="RFC4760"/> applies to this specification.
      </t>
      <t indent="0" pn="section-10-2">
        This document introduces Traffic Filtering Action Extended Communities.
        Malformed Traffic Filtering Action Extended Communities in the sense
	of <xref target="RFC7606" sectionFormat="of" section="7.14" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7606#section-7.14" derivedContent="RFC7606"/>
        are Extended Community values that cannot be decoded according
        to <xref target="traffic_filtering_actions" format="default" sectionFormat="of" derivedContent="Section 7"/> of this document.
      </t>
    </section>
    <section anchor="IANA" numbered="true" toc="include" removeInRFC="false" pn="section-11">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-11-1">
    This section complies with <xref target="RFC7153" format="default" sectionFormat="of" derivedContent="RFC7153"/>.
      </t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-11.1">
        <name slugifiedName="name-afi-safi-definitions">AFI/SAFI Definitions</name>
        <t indent="0" pn="section-11.1-1">
      IANA maintains a registry entitled "SAFI Values". For the purpose of this
      work, IANA has updated the following SAFIs as shown in the table below.
         (Note: This document obsoletes both <xref target="RFC7674" format="default" sectionFormat="of" derivedContent="RFC7674"/> and <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>, and all references
      to those documents have been deleted from the registry.)
        </t>
        <table anchor="iana_safi" align="center" pn="table-9">
          <name slugifiedName="name-registry-safi-values">Registry: SAFI Values</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">133</td>
              <td align="left" colspan="1" rowspan="1">Dissemination of Flow Specification rules</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">134</td>
              <td align="left" colspan="1" rowspan="1">L3VPN Dissemination of Flow Specification rules</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-11.1-3">The above textual changes generalize the definition of the SAFIs
	rather than change its underlying meaning. Therefore, based on <xref target="RFC7950" format="default" sectionFormat="of" derivedContent="RFC7950">"The YANG 1.1 Data Modeling Language"</xref>, the above text means that the following YANG
	enums from <xref target="RFC8294" format="default" sectionFormat="of" derivedContent="RFC8294">"Common YANG Data Types for the Routing Area"</xref> have had their names and
	descriptions at <eref brackets="angle" target="https://www.iana.org/assignments/iana-routing-types"/> changed to:</t>
        <sourcecode name="" type="yang" markers="true" pn="section-11.1-4">
   enum flow-spec-safi {
          value 133;
          description
            "Dissemination of Flow Specification rules SAFI.";
        }
   enum l3vpn-flow-spec-safi {
          value 134;
          description
            "L3VPN Dissemination of Flow Specification rules SAFI.";
        }
</sourcecode>
        <t indent="0" pn="section-11.1-5">A new revision statement has been added to the module as follows:</t>
        <sourcecode name="" type="yang" markers="true" pn="section-11.1-6">
   revision 2020-12-31 {
     description "Non-backwards-compatible change of SAFI names
                  (SAFI values 133, 134).";
     reference
       "RFC 8955: Dissemination of Flow Specification Rules.";
  }
</sourcecode>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-11.2">
        <name slugifiedName="name-flow-component-definitions">Flow Component Definitions</name>
        <t indent="0" pn="section-11.2-1">
      A Flow Specification consists of a sequence of flow components, which
      are identified by an 8-bit component type. IANA has created and maintains
      a registry entitled "Flow Spec Component Types". IANA has
      updated the reference for this registry to RFC 8955. Furthermore, the
      references to the values have been updated according to the table below
      (Note: This document obsoletes both <xref target="RFC7674" format="default" sectionFormat="of" derivedContent="RFC7674"/> and <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>, and all references
      to those documents have been deleted from the registry.)
        </t>
        <table anchor="iana_flow_component_types" align="center" pn="table-10">
          <name slugifiedName="name-registry-flow-spec-componen">Registry: Flow Spec Component Types</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Value</th>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">Destination Prefix</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">2</td>
              <td align="left" colspan="1" rowspan="1">Source Prefix</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">3</td>
              <td align="left" colspan="1" rowspan="1">IP Protocol</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">4</td>
              <td align="left" colspan="1" rowspan="1">Port</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">5</td>
              <td align="left" colspan="1" rowspan="1">Destination port</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">6</td>
              <td align="left" colspan="1" rowspan="1">Source port</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">7</td>
              <td align="left" colspan="1" rowspan="1">ICMP type</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">8</td>
              <td align="left" colspan="1" rowspan="1">ICMP code</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">9</td>
              <td align="left" colspan="1" rowspan="1">TCP flags</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">10</td>
              <td align="left" colspan="1" rowspan="1">Packet length</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">11</td>
              <td align="left" colspan="1" rowspan="1">DSCP</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">12</td>
              <td align="left" colspan="1" rowspan="1">Fragment</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-11.2-3">In order to manage the limited number space and accommodate several
	usages, the following policies defined by <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/> are used:</t>
        <table anchor="iana_flow_component_types_policies" align="center" pn="table-11">
          <name slugifiedName="name-flow-spec-component-types-p">Flow Spec Component Types Policies</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Type Values</th>
              <th align="left" colspan="1" rowspan="1">Policy</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="left" colspan="1" rowspan="1">Reserved</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">[1 .. 127]</td>
              <td align="left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">[128 .. 254]</td>
              <td align="left" colspan="1" rowspan="1">Expert Review</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">255</td>
              <td align="left" colspan="1" rowspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
        <dl newline="true" indent="3" spacing="normal" pn="section-11.2-5">
          <dt pn="section-11.2-5.1">Guidance for Experts:</dt>
          <dd pn="section-11.2-5.2">
         The registration policy for the range 128-254 is Expert Review.  The
         experts are expected to check the clarity of purpose and use of
         the requested code points.  The experts must also verify that
         any specification produced in the IETF that requests one of
         these code points has been made available for review by the IDR
         Working Group and that any specification produced outside the
         IETF does not conflict with work that is active or already
         published within the IETF.  It must be pointed out that
         introducing new component types may break interoperability with
         existing implementations of this protocol.
</dd>
        </dl>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-11.3">
        <name slugifiedName="name-extended-community-flow-spe">Extended Community Flow Specification Actions</name>
        <t indent="0" pn="section-11.3-1">The Extended Community Flow Specification Action types defined in
	this document consist of two parts:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-11.3-2">
          <li pn="section-11.3-2.1">Type (BGP Transitive Extended Community Type)</li>
          <li pn="section-11.3-2.2">Sub-Type</li>
        </ul>
        <t indent="0" pn="section-11.3-3">For the type part, IANA maintains a registry entitled "BGP
	Transitive Extended Community Types". For the purpose of this work
	(<xref target="traffic_filtering_actions" format="default" sectionFormat="of" derivedContent="Section 7"/>), IANA has
	updated the references as shown in the table below. (Note: This document obsoletes both <xref target="RFC7674" format="default" sectionFormat="of" derivedContent="RFC7674"/> and
	<xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>, and all references to those
	documents have been deleted in the 
	registry.)</t>
        <table anchor="iana_ext_comm_types" align="center" pn="table-12">
          <name slugifiedName="name-registry-bgp-transitive-ext">Registry: BGP Transitive Extended Community Types</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Type Value</th>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x81</td>
              <td align="left" colspan="1" rowspan="1">
           Generic Transitive Experimental Use Extended Community Part 2
           (Sub-Types are defined in the "Generic Transitive Experimental Use
           Extended Community Part 2 Sub-Types" Registry)
         </td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x82</td>
              <td align="left" colspan="1" rowspan="1">
           Generic Transitive Experimental Use Extended Community Part 3
           (Sub-Types are defined in the "Generic Transitive Experimental Use
           Extended Community Part 3 Sub-Types" Registry)
         </td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-11.3-5">For the sub-type part of the Extended Community Traffic Filtering
	Actions, IANA maintains the following registries. IANA has 
	updated all names and references according to the tables below and
	assign a new value for the "Flow spec traffic-rate-packets" Sub-Type.
	(Note: This document obsoletes both <xref target="RFC7674" format="default" sectionFormat="of" derivedContent="RFC7674"/> and <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>, and
	all references to those documents have been deleted from the
	registries below.) </t>
        <table anchor="iana_ext_comm_subtypes" align="center" pn="table-13">
          <name slugifiedName="name-registry-generic-transitive">Registry: Generic Transitive Experimental Use Extended
          Community Sub-Types</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Sub-Type Value</th>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x06</td>
              <td align="left" colspan="1" rowspan="1">Flow spec traffic-rate-bytes</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x0c</td>
              <td align="left" colspan="1" rowspan="1">Flow spec traffic-rate-packets</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x07</td>
              <td align="left" colspan="1" rowspan="1">Flow spec traffic-action (Use of the "Value"
	      field is defined in the "Traffic Action Fields" registry)</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x08</td>
              <td align="left" colspan="1" rowspan="1">
           Flow spec rt-redirect AS-2octet format
         </td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x09</td>
              <td align="left" colspan="1" rowspan="1">
           Flow spec traffic-remarking
         </td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
        <table anchor="iana_ext_comm_subtypes2" align="center" pn="table-14">
          <name slugifiedName="name-registry-generic-transitive-">Registry: Generic Transitive Experimental Use Extended
	  Community Part 2 Sub-Types</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Sub-Type Value</th>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x08</td>
              <td align="left" colspan="1" rowspan="1">
           Flow spec rt-redirect IPv4 format
         </td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
        <table anchor="iana_ext_comm_subtypes3" align="center" pn="table-15">
          <name slugifiedName="name-registry-generic-transitive-e">Registry: Generic Transitive Experimental Use Extended
	  Community Part 3 Sub-Types</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Sub-Type Value</th>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0x08</td>
              <td align="left" colspan="1" rowspan="1">
           Flow spec rt-redirect AS-4octet format
         </td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-11.3-9">
   Furthermore, IANA has updated the reference for the registries
   "Generic Transitive Experimental Use Extended Community Part 2 Sub-Types" and
   "Generic Transitive Experimental Use Extended Community Part 3 Sub-Types"
   to RFC 8955.
        </t>
        <t indent="0" pn="section-11.3-10">The "traffic-action" Extended Community (<xref target="traffic_action_subtype" format="default" sectionFormat="of" derivedContent="Section 7.3"/>) defined in this
	document has 46 unused bits, which can be used to convey additional
	meaning. IANA created and maintains a registry entitled "Traffic
	Action Fields".  IANA has updated the reference for this
	registry to RFC 8955. Furthermore, IANA has updated
	the references according to the table below. These values should be
	assigned via IETF Review rules only. (Note: This document obsoletes
	both <xref target="RFC7674" format="default" sectionFormat="of" derivedContent="RFC7674"/> and <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>, and all references to those
	documents have been deleted from the registry.)</t>
        <table anchor="iana_traffic_action_subtype" align="center" pn="table-16">
          <name slugifiedName="name-registry-traffic-action-fie">Registry: Traffic Action Fields</name>
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Bit</th>
              <th align="left" colspan="1" rowspan="1">Name</th>
              <th align="left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">47</td>
              <td align="left" colspan="1" rowspan="1">Terminal Action</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">46</td>
              <td align="left" colspan="1" rowspan="1">Sample</td>
              <td align="left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section anchor="security_considerations" numbered="true" toc="include" removeInRFC="false" pn="section-12">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-12-1"> As long as Flow Specifications are restricted to match the
      corresponding unicast routing paths for the relevant prefixes (<xref target="validation_procedure" format="default" sectionFormat="of" derivedContent="Section 6"/>), the security
      characteristics of this proposal are equivalent to the existing security
      properties of BGP unicast routing. Any relaxation of the validation
      procedure described in <xref target="validation_procedure" format="default" sectionFormat="of" derivedContent="Section 6"/> may allow unwanted Flow Specifications to be
      propagated, and thus unwanted Traffic Filtering Actions may be applied to
      flows.</t>
      <t indent="0" pn="section-12-2">Where the above mechanisms are not in place, this could open the door
      to further denial-of-service attacks, such as unwanted traffic
      filtering, remarking, or redirection.</t>
      <t indent="0" pn="section-12-3">
   Deployment of specific relaxations of the validation within an
   administrative boundary of a network are useful in some networks for quickly
   distributing filters to prevent denial-of-service attacks.
    For a network to utilize this relaxation, the BGP policies must
    support additional filtering since the origin AS field is empty.
    Specifications relaxing the validation restrictions <bcp14>MUST</bcp14>
    contain security considerations that provide details on the
    required additional filtering.
    For example, the use of origin validation can provide
    enhanced filtering within an AS confederation.
      </t>
      <t indent="0" pn="section-12-4">
       Inter-provider routing is based on a web of trust. Neighboring
   autonomous systems are trusted to advertise valid reachability
   information. If this trust model is violated, a neighboring
   autonomous system may cause a denial-of-service attack by advertising
   reachability information for a given prefix for which it does not
   provide service (unfiltered address space hijack). Since validation of
   the Flow Specification is tied to the announcement of the best unicast
   route, the failure in the validation of best path route may prevent the
   Flow Specification from being used by a local router. Possible
   mitigations are <xref target="RFC6811" format="default" sectionFormat="of" derivedContent="RFC6811"/> and
   <xref target="RFC8205" format="default" sectionFormat="of" derivedContent="RFC8205"/>.
      </t>
      <t indent="0" pn="section-12-5">On Internet Exchange Points (IXPs), routes are often exchanged via
      route servers that do not extend the AS_PATH. In such cases, it is not
      possible to enforce the left-most AS in the AS_PATH to be the neighbor
      AS (the AS of the route server). Since the validation of Flow
      Specification (<xref target="validation_procedure" format="default" sectionFormat="of" derivedContent="Section 6"/>)
      depends on this, additional care must be taken. It is advised to use a
      strict inbound route policy in such scenarios.</t>
      <t indent="0" pn="section-12-6"> Enabling firewall-like capabilities in routers without centralized
      management could make certain failures harder to diagnose.  For example,
      it is possible to allow TCP packets to pass between a pair of addresses
      but not ICMP packets.  It is also possible to permit packets smaller
      than 900 or greater than 1000 octets to pass between a pair of addresses
      but not packets whose length is in the range 900-1000.  Such behavior
      may be confusing, and these capabilities should be used with care whether
      manually configured or coordinated through the protocol extensions
      described in this document.</t>
      <t indent="0" pn="section-12-7">Flow Specification BGP speakers (e.g., automated DDoS controllers) not
      properly programmed, algorithms that are not performing as expected, or
      simply rogue systems may announce unintended Flow Specifications, send
      updates at a high rate, or generate a high number of Flow
      Specifications. This may stress the receiving systems, exceed their
      capacity, or lead to unwanted Traffic Filtering Actions being applied to
      flows.</t>
      <t indent="0" pn="section-12-8">
  Systems may not be able to locate all header values
  required to identify a packet. This can be especially problematic
  in the case of fragmented packets that are not the first fragment
  and thus lack upper-layer protocol headers or Encapsulating Security
  Payload (ESP) NULL <xref target="RFC4303" format="default" sectionFormat="of" derivedContent="RFC4303"/> encryption.
      </t>
      <t indent="0" pn="section-12-9"> While the general verification of the Flow Specification NLRI is
      specified in this document (<xref target="validation_procedure" format="default" sectionFormat="of" derivedContent="Section 6"/>), the Traffic Filtering Actions received by a third
      party may need custom verification or filtering. In particular, all
      non-traffic-rate actions may allow a third party to modify packet
      forwarding 
      properties and potentially gain access to other routing-tables/VPNs or
      undesired queues. This can be avoided by proper filtering/screening of
      the Traffic Filtering Action communities at network borders and only
      exposing a predefined subset of Traffic Filtering Actions (see <xref target="traffic_filtering_actions" format="default" sectionFormat="of" derivedContent="Section 7"/>) to third
      parties. One way to achieve this is by mapping user-defined communities,
      which can be set by the third party, to Traffic Filtering Actions and not
      accepting Traffic Filtering Action extended communities from third
      parties.</t>
      <t indent="0" pn="section-12-10">This extension adds additional information to Internet routers.
          These are limited in terms of the maximum number of data elements
          they can hold as well as the number of events they are able to
          process in a given unit of time. Service providers need to consider
          the maximum capacity of their devices and may need to limit the
          number of Flow Specifications accepted and processed.
      </t>
    </section>
  </middle>
  <back>
    <references pn="section-13">
      <name slugifiedName="name-references">References</name>
      <references pn="section-13.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="IEEE.754.1985" quoteTitle="true" target="https://doi.org/10.1109/IEEESTD.2019.8766229" derivedAnchor="IEEE.754.1985">
          <front>
            <title>Standard for Binary Floating-Point Arithmetic</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="August" year="1985"/>
          </front>
          <seriesInfo name="IEEE" value="754-1985"/>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2019.8766229"/>
        </reference>
        <reference anchor="ISO_IEC_9899" quoteTitle="true" derivedAnchor="ISO_IEC_9899">
          <front>
            <title>Information technology -- Programming languages -- C</title>
            <seriesInfo name="ISO/IEC" value="9899:2018"/>
            <author>
              <organization showOnFrontPage="true">ISO</organization>
            </author>
            <date month="June" year="2018"/>
          </front>
        </reference>
        <reference anchor="RFC0768" target="https://www.rfc-editor.org/info/rfc768" quoteTitle="true" derivedAnchor="RFC0768">
          <front>
            <title>User Datagram Protocol</title>
            <author initials="J." surname="Postel" fullname="J. Postel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1980" month="August"/>
          </front>
          <seriesInfo name="STD" value="6"/>
          <seriesInfo name="RFC" value="768"/>
          <seriesInfo name="DOI" value="10.17487/RFC0768"/>
        </reference>
        <reference anchor="RFC0791" target="https://www.rfc-editor.org/info/rfc791" quoteTitle="true" derivedAnchor="RFC0791">
          <front>
            <title>Internet Protocol</title>
            <author initials="J." surname="Postel" fullname="J. Postel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1981" month="September"/>
          </front>
          <seriesInfo name="STD" value="5"/>
          <seriesInfo name="RFC" value="791"/>
          <seriesInfo name="DOI" value="10.17487/RFC0791"/>
        </reference>
        <reference anchor="RFC0792" target="https://www.rfc-editor.org/info/rfc792" quoteTitle="true" derivedAnchor="RFC0792">
          <front>
            <title>Internet Control Message Protocol</title>
            <author initials="J." surname="Postel" fullname="J. Postel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1981" month="September"/>
          </front>
          <seriesInfo name="STD" value="5"/>
          <seriesInfo name="RFC" value="792"/>
          <seriesInfo name="DOI" value="10.17487/RFC0792"/>
        </reference>
        <reference anchor="RFC0793" target="https://www.rfc-editor.org/info/rfc793" quoteTitle="true" derivedAnchor="RFC0793">
          <front>
            <title>Transmission Control Protocol</title>
            <author initials="J." surname="Postel" fullname="J. Postel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1981" month="September"/>
          </front>
          <seriesInfo name="STD" value="7"/>
          <seriesInfo name="RFC" value="793"/>
          <seriesInfo name="DOI" value="10.17487/RFC0793"/>
        </reference>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC2474" target="https://www.rfc-editor.org/info/rfc2474" quoteTitle="true" derivedAnchor="RFC2474">
          <front>
            <title>Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</title>
            <author initials="K." surname="Nichols" fullname="K. Nichols">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Blake" fullname="S. Blake">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Baker" fullname="F. Baker">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Black" fullname="D. Black">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1998" month="December"/>
            <abstract>
              <t indent="0">This document defines the IP header field, called the DS (for differentiated services) field.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2474"/>
          <seriesInfo name="DOI" value="10.17487/RFC2474"/>
        </reference>
        <reference anchor="RFC4271" target="https://www.rfc-editor.org/info/rfc4271" quoteTitle="true" derivedAnchor="RFC4271">
          <front>
            <title>A Border Gateway Protocol 4 (BGP-4)</title>
            <author initials="Y." surname="Rekhter" fullname="Y. Rekhter" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Li" fullname="T. Li" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Hares" fullname="S. Hares" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="January"/>
            <abstract>
              <t indent="0">This document discusses the Border Gateway Protocol (BGP), which is an inter-Autonomous System routing protocol.</t>
              <t indent="0">The primary function of a BGP speaking system is to exchange network reachability information with other BGP systems.  This network reachability information includes information on the list of Autonomous Systems (ASes) that reachability information traverses. This information is sufficient for constructing a graph of AS connectivity for this reachability from which routing loops may be pruned, and, at the AS level, some policy decisions may be enforced.</t>
              <t indent="0">BGP-4 provides a set of mechanisms for supporting Classless Inter-Domain Routing (CIDR).  These mechanisms include support for advertising a set of destinations as an IP prefix, and eliminating the concept of network "class" within BGP.  BGP-4 also introduces mechanisms that allow aggregation of routes, including aggregation of AS paths.</t>
              <t indent="0">This document obsoletes RFC 1771.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4271"/>
          <seriesInfo name="DOI" value="10.17487/RFC4271"/>
        </reference>
        <reference anchor="RFC4360" target="https://www.rfc-editor.org/info/rfc4360" quoteTitle="true" derivedAnchor="RFC4360">
          <front>
            <title>BGP Extended Communities Attribute</title>
            <author initials="S." surname="Sangli" fullname="S. Sangli">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Tappan" fullname="D. Tappan">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Rekhter" fullname="Y. Rekhter">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="February"/>
            <abstract>
              <t indent="0">This document describes the "extended community" BGP-4 attribute.  This attribute provides a mechanism for labeling information carried in BGP-4.  These labels can be used to control the distribution of this information, or for other applications.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4360"/>
          <seriesInfo name="DOI" value="10.17487/RFC4360"/>
        </reference>
        <reference anchor="RFC4364" target="https://www.rfc-editor.org/info/rfc4364" quoteTitle="true" derivedAnchor="RFC4364">
          <front>
            <title>BGP/MPLS IP Virtual Private Networks (VPNs)</title>
            <author initials="E." surname="Rosen" fullname="E. Rosen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Rekhter" fullname="Y. Rekhter">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="February"/>
            <abstract>
              <t indent="0">This document describes a method by which a Service Provider may use an IP backbone to provide IP Virtual Private Networks (VPNs) for its customers.  This method uses a "peer model", in which the customers' edge routers (CE routers) send their routes to the Service Provider's edge routers (PE routers); there is no "overlay" visible to the customer's routing algorithm, and CE routers at different sites do not peer with each other.  Data packets are tunneled through the backbone, so that the core routers do not need to know the VPN routes.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4364"/>
          <seriesInfo name="DOI" value="10.17487/RFC4364"/>
        </reference>
        <reference anchor="RFC4456" target="https://www.rfc-editor.org/info/rfc4456" quoteTitle="true" derivedAnchor="RFC4456">
          <front>
            <title>BGP Route Reflection: An Alternative to Full Mesh Internal BGP (IBGP)</title>
            <author initials="T." surname="Bates" fullname="T. Bates">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Chen" fullname="E. Chen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Chandra" fullname="R. Chandra">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2006" month="April"/>
            <abstract>
              <t indent="0">The Border Gateway Protocol (BGP) is an inter-autonomous system routing protocol designed for TCP/IP internets.  Typically, all BGP speakers within a single AS must be fully meshed so that any external routing information must be re-distributed to all other routers within that Autonomous System (AS).  This represents a serious scaling problem that has been well documented with several alternatives proposed.</t>
              <t indent="0">This document describes the use and design of a method known as "route reflection" to alleviate the need for "full mesh" Internal BGP (IBGP).</t>
              <t indent="0">This document obsoletes RFC 2796 and RFC 1966.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4456"/>
          <seriesInfo name="DOI" value="10.17487/RFC4456"/>
        </reference>
        <reference anchor="RFC4760" target="https://www.rfc-editor.org/info/rfc4760" quoteTitle="true" derivedAnchor="RFC4760">
          <front>
            <title>Multiprotocol Extensions for BGP-4</title>
            <author initials="T." surname="Bates" fullname="T. Bates">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Chandra" fullname="R. Chandra">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Katz" fullname="D. Katz">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Rekhter" fullname="Y. Rekhter">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="January"/>
            <abstract>
              <t indent="0">This document defines extensions to BGP-4 to enable it to carry routing information for multiple Network Layer protocols (e.g., IPv6, IPX, L3VPN, etc.).  The extensions are backward compatible - a router that supports the extensions can interoperate with a router that doesn't support the extensions.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4760"/>
          <seriesInfo name="DOI" value="10.17487/RFC4760"/>
        </reference>
        <reference anchor="RFC5668" target="https://www.rfc-editor.org/info/rfc5668" quoteTitle="true" derivedAnchor="RFC5668">
          <front>
            <title>4-Octet AS Specific BGP Extended Community</title>
            <author initials="Y." surname="Rekhter" fullname="Y. Rekhter">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Sangli" fullname="S. Sangli">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Tappan" fullname="D. Tappan">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="October"/>
            <abstract>
              <t indent="0">This document defines a new type of a BGP extended community, which carries a 4-octet Autonomous System (AS) number.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5668"/>
          <seriesInfo name="DOI" value="10.17487/RFC5668"/>
        </reference>
        <reference anchor="RFC7153" target="https://www.rfc-editor.org/info/rfc7153" quoteTitle="true" derivedAnchor="RFC7153">
          <front>
            <title>IANA Registries for BGP Extended Communities</title>
            <author initials="E." surname="Rosen" fullname="E. Rosen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Rekhter" fullname="Y. Rekhter">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="March"/>
            <abstract>
              <t indent="0">This document reorganizes the IANA registries for the type values and sub-type values of the BGP Extended Communities attribute and the BGP IPv6-Address-Specific Extended Communities attribute.  This is done in order to remove interdependencies among the registries, thus making it easier for IANA to determine which codepoints are available for assignment in which registries.  This document also clarifies the information that must be provided to IANA when requesting an allocation from one or more of these registries.  These changes are compatible with the existing allocations and thus do not affect protocol implementations.  The changes will, however, impact the "IANA Considerations" sections of future protocol specifications. This document updates RFC 4360 and RFC 5701.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7153"/>
          <seriesInfo name="DOI" value="10.17487/RFC7153"/>
        </reference>
        <reference anchor="RFC7606" target="https://www.rfc-editor.org/info/rfc7606" quoteTitle="true" derivedAnchor="RFC7606">
          <front>
            <title>Revised Error Handling for BGP UPDATE Messages</title>
            <author initials="E." surname="Chen" fullname="E. Chen" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Scudder" fullname="J. Scudder" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Mohapatra" fullname="P. Mohapatra">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Patel" fullname="K. Patel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="August"/>
            <abstract>
              <t indent="0">According to the base BGP specification, a BGP speaker that receives an UPDATE message containing a malformed attribute is required to reset the session over which the offending attribute was received. This behavior is undesirable because a session reset would impact not only routes with the offending attribute but also other valid routes exchanged over the session.  This document partially revises the error handling for UPDATE messages and provides guidelines for the authors of documents defining new attributes.  Finally, it revises the error handling procedures for a number of existing attributes.</t>
              <t indent="0">This document updates error handling for RFCs 1997, 4271, 4360, 4456, 4760, 5543, 5701, and 6368.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7606"/>
          <seriesInfo name="DOI" value="10.17487/RFC7606"/>
        </reference>
        <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <author initials="M." surname="Cotton" fullname="M. Cotton">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="June"/>
            <abstract>
              <t indent="0">Many protocols make use of points of extensibility that use constants to identify various protocol parameters.  To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper.  For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
              <t indent="0">To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed.  This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
              <t indent="0">This is the third edition of this document; it obsoletes RFC 5226.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="26"/>
          <seriesInfo name="RFC" value="8126"/>
          <seriesInfo name="DOI" value="10.17487/RFC8126"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
      </references>
      <references pn="section-13.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="RFC4303" target="https://www.rfc-editor.org/info/rfc4303" quoteTitle="true" derivedAnchor="RFC4303">
          <front>
            <title>IP Encapsulating Security Payload (ESP)</title>
            <author initials="S." surname="Kent" fullname="S. Kent">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="December"/>
            <abstract>
              <t indent="0">This document describes an updated version of the Encapsulating Security Payload (ESP) protocol, which is designed to provide a mix of security services in IPv4 and IPv6.  ESP is used to provide confidentiality, data origin authentication, connectionless integrity, an anti-replay service (a form of partial sequence integrity), and limited traffic flow confidentiality.  This document obsoletes RFC 2406 (November 1998).  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4303"/>
          <seriesInfo name="DOI" value="10.17487/RFC4303"/>
        </reference>
        <reference anchor="RFC5575" target="https://www.rfc-editor.org/info/rfc5575" quoteTitle="true" derivedAnchor="RFC5575">
          <front>
            <title>Dissemination of Flow Specification Rules</title>
            <author initials="P." surname="Marques" fullname="P. Marques">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="N." surname="Sheth" fullname="N. Sheth">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Raszuk" fullname="R. Raszuk">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Greene" fullname="B. Greene">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Mauch" fullname="J. Mauch">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="McPherson" fullname="D. McPherson">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2009" month="August"/>
            <abstract>
              <t indent="0">This document defines a new Border Gateway Protocol Network Layer Reachability Information (BGP NLRI) encoding format that can be used to distribute traffic flow specifications.  This allows the routing system to propagate information regarding more specific components of the traffic aggregate defined by an IP destination prefix.</t>
              <t indent="0">Additionally, it defines two applications of that encoding format: one that can be used to automate inter-domain coordination of traffic filtering, such as what is required in order to mitigate (distributed) denial-of-service attacks, and a second application to provide traffic filtering in the context of a BGP/MPLS VPN service.</t>
              <t indent="0">The information is carried via the BGP, thereby reusing protocol algorithms, operational experience, and administrative processes such as inter-provider peering agreements.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5575"/>
          <seriesInfo name="DOI" value="10.17487/RFC5575"/>
        </reference>
        <reference anchor="RFC6811" target="https://www.rfc-editor.org/info/rfc6811" quoteTitle="true" derivedAnchor="RFC6811">
          <front>
            <title>BGP Prefix Origin Validation</title>
            <author initials="P." surname="Mohapatra" fullname="P. Mohapatra">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Scudder" fullname="J. Scudder">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Ward" fullname="D. Ward">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Bush" fullname="R. Bush">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Austein" fullname="R. Austein">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="January"/>
            <abstract>
              <t indent="0">To help reduce well-known threats against BGP including prefix mis- announcing and monkey-in-the-middle attacks, one of the security requirements is the ability to validate the origination Autonomous System (AS) of BGP routes.  More specifically, one needs to validate that the AS number claiming to originate an address prefix (as derived from the AS_PATH attribute of the BGP route) is in fact authorized by the prefix holder to do so.  This document describes a simple validation mechanism to partially satisfy this requirement. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6811"/>
          <seriesInfo name="DOI" value="10.17487/RFC6811"/>
        </reference>
        <reference anchor="RFC7674" target="https://www.rfc-editor.org/info/rfc7674" quoteTitle="true" derivedAnchor="RFC7674">
          <front>
            <title>Clarification of the Flowspec Redirect Extended Community</title>
            <author initials="J." surname="Haas" fullname="J. Haas" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="October"/>
            <abstract>
              <t indent="0">This document updates RFC 5575 ("Dissemination of Flow Specification                      Rules") to clarify the formatting of the BGP Flowspec Redirect Extended Community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7674"/>
          <seriesInfo name="DOI" value="10.17487/RFC7674"/>
        </reference>
        <reference anchor="RFC7950" target="https://www.rfc-editor.org/info/rfc7950" quoteTitle="true" derivedAnchor="RFC7950">
          <front>
            <title>The YANG 1.1 Data Modeling Language</title>
            <author initials="M." surname="Bjorklund" fullname="M. Bjorklund" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="August"/>
            <abstract>
              <t indent="0">YANG is a data modeling language used to model configuration data, state data, Remote Procedure Calls, and notifications for network management protocols.  This document describes the syntax and semantics of version 1.1 of the YANG language.  YANG version 1.1 is a maintenance release of the YANG language, addressing ambiguities and defects in the original specification.  There are a small number of backward incompatibilities from YANG version 1.  This document also specifies the YANG mappings to the Network Configuration Protocol (NETCONF).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7950"/>
          <seriesInfo name="DOI" value="10.17487/RFC7950"/>
        </reference>
        <reference anchor="RFC8205" target="https://www.rfc-editor.org/info/rfc8205" quoteTitle="true" derivedAnchor="RFC8205">
          <front>
            <title>BGPsec Protocol Specification</title>
            <author initials="M." surname="Lepinski" fullname="M. Lepinski" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Sriram" fullname="K. Sriram" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="September"/>
            <abstract>
              <t indent="0">This document describes BGPsec, an extension to the Border Gateway Protocol (BGP) that provides security for the path of Autonomous Systems (ASes) through which a BGP UPDATE message passes.  BGPsec is implemented via an optional non-transitive BGP path attribute that carries digital signatures produced by each AS that propagates the UPDATE message.  The digital signatures provide confidence that every AS on the path of ASes listed in the UPDATE message has explicitly authorized the advertisement of the route.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8205"/>
          <seriesInfo name="DOI" value="10.17487/RFC8205"/>
        </reference>
        <reference anchor="RFC8294" target="https://www.rfc-editor.org/info/rfc8294" quoteTitle="true" derivedAnchor="RFC8294">
          <front>
            <title>Common YANG Data Types for the Routing Area</title>
            <author initials="X." surname="Liu" fullname="X. Liu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Y." surname="Qu" fullname="Y. Qu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Lindem" fullname="A. Lindem">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Hopps" fullname="C. Hopps">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Berger" fullname="L. Berger">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="December"/>
            <abstract>
              <t indent="0">This document defines a collection of common data types using the YANG data modeling language.  These derived common types are designed to be imported by other modules defined in the routing area.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8294"/>
          <seriesInfo name="DOI" value="10.17487/RFC8294"/>
        </reference>
        <reference anchor="RFC8956" target="https://www.rfc-editor.org/info/rfc8956" quoteTitle="true" derivedAnchor="RFC8956">
          <front>
            <title>Dissemination of Flow Specification Rules for IPv6</title>
            <author initials="C" surname="Loibl" fullname="Christoph Loibl" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R" surname="Raszuk" fullname="Robert Raszuk" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S" surname="Hares" fullname="Susan Hares" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="December" year="2020"/>
          </front>
          <seriesInfo name="RFC" value="8956"/>
          <seriesInfo name="DOI" value="10.17487/RFC8956"/>
        </reference>
      </references>
    </references>
    <section anchor="flow_rule_cmp_src" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-example-python-code-flow_ru">Example Python code: flow_rule_cmp</name>
      <sourcecode name="" type="python" markers="true" pn="section-appendix.a-1">
"""
Copyright (c) 2020 IETF Trust and the persons identified as
authors of the code.  All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, is permitted pursuant to, and subject to the license
terms contained in, the Simplified BSD License set forth in Section
4.c of the IETF Trust's Legal Provisions Relating to IETF Documents
(https://trustee.ietf.org/license-info).
"""

import itertools
import collections
import ipaddress


EQUAL = 0
A_HAS_PRECEDENCE = 1
B_HAS_PRECEDENCE = 2
IP_DESTINATION = 1
IP_SOURCE = 2

FS_component = collections.namedtuple('FS_component',
                                      'component_type op_value')


class FS_nlri(object):
    """
    FS_nlri class implementation that allows sorting.

    By calling .sort() on an array of FS_nlri objects these will be
    sorted according to the flow_rule_cmp algorithm.

    Example:
    nlri = [ FS_nlri(components=[
             FS_component(component_type=IP_DESTINATION,
                    op_value=ipaddress.ip_network('10.1.0.0/16') ),
             FS_component(component_type=4,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             ]),
             FS_nlri(components=[
             FS_component(component_type=5,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             FS_component(component_type=6,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             ]),
           ]
    nlri.sort() # sorts the array according to the algorithm
    """
    def __init__(self, components = None):
        """
        components: list of type FS_component
        """
        self.components = components

    def __lt__(self, other):
        # use the below algorithm for sorting
        result = flow_rule_cmp(self, other)
        if result == B_HAS_PRECEDENCE:
            return True
        else:
            return False


def flow_rule_cmp(a, b):
    """
    Example of the flowspec comparison algorithm.
    """
    for comp_a, comp_b in itertools.zip_longest(a.components,
                                           b.components):
        # If a component type does not exist in one rule
        # this rule has lower precedence
        if not comp_a:
            return B_HAS_PRECEDENCE
        if not comp_b:
            return A_HAS_PRECEDENCE
        # Higher precedence for lower component type
        if comp_a.component_type &lt; comp_b.component_type:
            return A_HAS_PRECEDENCE
        if comp_a.component_type &gt; comp_b.component_type:
            return B_HAS_PRECEDENCE
        # component types are equal -&gt; type specific comparison
        if comp_a.component_type in (IP_DESTINATION, IP_SOURCE):
            # assuming comp_a.op_value, comp_b.op_value of
            # type ipaddress.IPv4Network
            if comp_a.op_value.overlaps(comp_b.op_value):
                # longest prefixlen has precedence
                if comp_a.op_value.prefixlen &gt; \
                        comp_b.op_value.prefixlen:
                    return A_HAS_PRECEDENCE
                if comp_a.op_value.prefixlen &lt; \
                        comp_b.op_value.prefixlen:
                    return B_HAS_PRECEDENCE
                # components equal -&gt; continue with next component
            elif comp_a.op_value &gt; comp_b.op_value:
                return B_HAS_PRECEDENCE
            elif comp_a.op_value &lt; comp_b.op_value:
                return A_HAS_PRECEDENCE
        else:
            # assuming comp_a.op_value, comp_b.op_value of type
            # bytearray
            if len(comp_a.op_value) == len(comp_b.op_value):
                if comp_a.op_value &gt; comp_b.op_value:
                    return B_HAS_PRECEDENCE
                if comp_a.op_value &lt; comp_b.op_value:
                    return A_HAS_PRECEDENCE
                # components equal -&gt; continue with next component
            else:
                common = min(len(comp_a.op_value),
                             len(comp_b.op_value))
                if comp_a.op_value[:common] &gt; \
                   comp_b.op_value[:common]:
                    return B_HAS_PRECEDENCE
                elif comp_a.op_value[:common] &lt; \
                        comp_b.op_value[:common]:
                    return A_HAS_PRECEDENCE
                # the first common bytes match
                elif len(comp_a.op_value) &gt; len(comp_b.op_value):
                    return A_HAS_PRECEDENCE
                else:
                    return B_HAS_PRECEDENCE
    return EQUAL
</sourcecode>
    </section>
    <section anchor="rfc5575differences" numbered="true" toc="include" removeInRFC="false" pn="section-appendix.b">
      <name slugifiedName="name-comparison-with-rfc-5575">Comparison with RFC 5575</name>
      <t indent="0" pn="section-appendix.b-1">This document includes numerous editorial changes to <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>. It also completely incorporates the
      redirect action clarification document <xref target="RFC7674" format="default" sectionFormat="of" derivedContent="RFC7674"/>. It is recommended to read the entire document. The
      authors, however, want to point out the following technical changes to
      <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-appendix.b-2">
        <li pn="section-appendix.b-2.1">
          <xref target="intro" format="default" sectionFormat="of" derivedContent="Section 1"/> introduces the Flow
	Specification NLRI. In <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>, BGP 
	treats this NLRI as an opaque key to an entry in its databases. This specification
	has removed all references to an opaque key property. BGP
	implementations are able to understand the NLRI encoding.</li>
        <li pn="section-appendix.b-2.2">
          <xref target="numeric_operator" format="default" sectionFormat="of" derivedContent="Section 4.2.1.1"/> defines a
	numeric operator and comparison bit combinations. In <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>, the meaning of those bit
	combination was not explicitly defined and left open to the
	reader.</li>
        <li pn="section-appendix.b-2.3">Sections <xref target="type_3" format="counter" sectionFormat="of" derivedContent="4.2.2.3"/> - <xref target="type_8" format="counter" sectionFormat="of" derivedContent="4.2.2.8"/>, <xref target="type_10" format="counter" sectionFormat="of" derivedContent="4.2.2.10"/>, and <xref target="type_11" format="counter" sectionFormat="of" derivedContent="4.2.2.11"/> make use of the above numeric
	operator. The allowed length of the comparison value was not
	consistently defined in <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>.</li>
        <li pn="section-appendix.b-2.4">
          <xref target="traffic_filtering_actions" format="default" sectionFormat="of" derivedContent="Section 7"/>
	defines all Traffic Filtering Action Extended Communities as
	transitive Extended Communities. <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/> defined the traffic-rate action to be
	non-transitive and did not define the transitivity of the other
	Traffic Filtering Action communities at all.</li>
        <li pn="section-appendix.b-2.5">
          <xref target="traffic_rate_in_packets" format="default" sectionFormat="of" derivedContent="Section 7.2"/>
	introduces a new Traffic Filtering Action (traffic-rate-packets). This
	action did not exist in <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>.</li>
        <li pn="section-appendix.b-2.6">
          <xref target="rt_redirect_action_subtype" format="default" sectionFormat="of" derivedContent="Section 7.4"/>
	contains the same redirect actions already defined in <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>, however, these actions have been
	renamed  to "rt-redirect" to make it clearer that the redirection is
	based on route-target. This section also completely incorporates the
	<xref target="RFC7674" format="default" sectionFormat="of" derivedContent="RFC7674"/> clarifications of the
	Flowspec Redirect Extended Community.</li>
        <li pn="section-appendix.b-2.7">
          <xref target="rules_action_interference" format="default" sectionFormat="of" derivedContent="Section 7.7"/>
	contains general considerations on interfering traffic actions. <xref target="traffic_action_subtype" format="default" sectionFormat="of" derivedContent="Section 7.3"/> also
	cross-references <xref target="rules_action_interference" format="default" sectionFormat="of" derivedContent="Section 7.7"/>. <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/> did not
	mention this.</li>
        <li pn="section-appendix.b-2.8">
          <xref target="errorhandling" format="default" sectionFormat="of" derivedContent="Section 10"/> contains new error
	handling.</li>
      </ul>
    </section>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.c">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.c-1">The authors would like to thank <contact fullname="Yakov Rekhter"/>,
      <contact fullname="Dennis Ferguson"/>, <contact fullname="Chris       Morrow"/>, <contact fullname="Charlie Kaufman"/>, and <contact fullname="David Smith"/> for their comments on the
      original <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>.  <contact fullname="Chaitanya Kodeboyina"/> helped design the flow validation
      procedure, and <contact fullname="Steven Lin"/> and <contact fullname="Jim Washburn"/> ironed out all the details necessary to
      produce a working implementation in the original <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/>.</t>
      <t indent="0" pn="section-appendix.c-2">A packet rate Traffic Filtering Action was also described in a Flow
      Specification extension draft and the authors would like to thank <contact fullname="Wesley Eddy"/>, <contact fullname="Justin Dailey"/>, and
      <contact fullname="Gilbert Clark"/> for their work.</t>
      <t indent="0" pn="section-appendix.c-3">Additionally, the authors would like to thank <contact fullname="Alexander Mayrhofer"/>, <contact fullname="Nicolas Fevrier"/>,
      <contact fullname="Job Snijders"/>, <contact fullname="Jeffrey Haas"/>,
      and <contact fullname="Adam Chappell"/> for their comments and
      review.</t>
    </section>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.d">
      <name slugifiedName="name-contributors">Contributors</name>
      <t indent="0" pn="section-appendix.d-1"><contact fullname="Barry Greene"/>,  <contact fullname="Pedro       Marques"/>, <contact fullname="Jared Mauch"/>, and <contact fullname="Nischal Sheth were"/> authors on <xref target="RFC5575" format="default" sectionFormat="of" derivedContent="RFC5575"/> and, therefore, are contributing authors on this
      document.</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.e">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author fullname="Christoph Loibl" initials="C." surname="Loibl">
        <organization showOnFrontPage="true">next layer Telekom GmbH</organization>
        <address>
          <postal>
            <street>Mariahilfer Guertel 37/7</street>
            <city>Vienna</city>
            <region/>
            <code>1150</code>
            <country>Austria</country>
          </postal>
          <phone>+43 664 1176414</phone>
          <email>cl@tix.at</email>
        </address>
      </author>
      <author fullname="Susan Hares" initials="S." surname="Hares">
        <organization showOnFrontPage="true">Huawei</organization>
        <address>
          <postal>
            <street>7453 Hickory Hill</street>
            <city>Saline</city>
            <region>MI</region>
            <code>48176</code>
            <country>United States of America</country>
          </postal>
          <email>shares@ndzh.com</email>
        </address>
      </author>
      <author fullname="Robert Raszuk" initials="R." surname="Raszuk">
        <organization showOnFrontPage="true">NTT Network Innovations</organization>
        <address>
          <postal>
            <street>940 Stewart Dr</street>
            <city>Sunnyvale</city>
            <region>CA</region>
            <code>94085</code>
            <country>United States of America</country>
          </postal>
          <email>robert@raszuk.net</email>
        </address>
      </author>
      <author fullname="Danny McPherson" initials="D." surname="McPherson">
        <organization showOnFrontPage="true">Verisign</organization>
        <address>
          <postal>
            <street/>
            <city/>
            <code/>
            <country>United States of America</country>
          </postal>
          <email>dmcpherson@verisign.com</email>
        </address>
      </author>
      <author fullname="Martin Bacher" initials="M." surname="Bacher">
        <organization showOnFrontPage="true">T-Mobile Austria</organization>
        <address>
          <postal>
            <street>Rennweg 97-99</street>
            <city>Vienna</city>
            <region/>
            <code>1030</code>
            <country>Austria</country>
          </postal>
          <email>mb.ietf@gmail.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
