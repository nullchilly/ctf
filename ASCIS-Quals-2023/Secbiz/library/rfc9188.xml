<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="exp" docName="draft-zhu-intarea-gma-14" indexInclude="true" ipr="trust200902" number="9188" prepTime="2022-02-10T23:05:48" scripts="Common,Latin" sortRefs="true" submissionType="independent" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-zhu-intarea-gma-14" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9188" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="GMA Encapsulation Protocol">Generic Multi-Access (GMA) Encapsulation Protocol</title>
    <seriesInfo name="RFC" value="9188" stream="independent"/>
    <author initials="J." surname="Zhu" fullname="Jing Zhu">
      <organization showOnFrontPage="true">Intel</organization>
      <address>
        <email>jing.z.zhu@intel.com</email>
      </address>
    </author>
    <author initials="S." surname="Kanugovi" fullname="Satish Kanugovi">
      <organization showOnFrontPage="true">Nokia</organization>
      <address>
        <email>satish.k@nokia.com</email>
      </address>
    </author>
    <date month="02" year="2022"/>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
   A device can be simultaneously connected to multiple networks, e.g., Wi-Fi,
   LTE, 5G, and DSL. It is desirable to seamlessly combine the connectivity
   over these networks below the transport layer (L4) to improve the quality
   of experience for applications that do not have built-in multi-path
   capabilities. Such optimization requires additional control information,
   e.g., a sequence number, in each packet. This document presents a new
   lightweight and flexible encapsulation protocol for this need. The solution
   has been developed by the authors based on their experiences in multiple
   standards bodies including the IETF and 3GPP. However, this document is not
   an Internet Standard and does not represent the consensus opinion of
   the IETF. This document will enable other developers to build interoperable
   implementations in order to experiment with the protocol.</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for examination, experimental implementation, and
            evaluation.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document defines an Experimental Protocol for the Internet
            community.  This is a contribution to the RFC Series,
            independently of any other RFC stream.  The RFC Editor has chosen to publish this
            document at its discretion and makes no statement about its value
            for implementation or deployment.  Documents approved for publication
            by the RFC Editor are not candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9188" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-scope-of-experiment">Scope of Experiment</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-conventions-used-in-this-do">Conventions Used in This Document</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-use-case">Use Case</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-gma-encapsulation-methods">GMA Encapsulation Methods</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-trailer-based-ip-encapsulat">Trailer-Based IP Encapsulation</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-header-based-ip-encapsulati">Header-Based IP Encapsulation</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-header-based-non-ip-encapsu">Header-Based Non-IP Encapsulation</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.4">
                <t indent="0" pn="section-toc.1-1.4.2.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-ip-protocol-identifier">IP Protocol Identifier</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-fragmentation">Fragmentation</xref></t>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-concatenation">Concatenation</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2">
              <li pn="section-toc.1-1.9.2.1">
                <t indent="0" pn="section-toc.1-1.9.2.1.1"><xref derivedContent="9.1" format="counter" sectionFormat="of" target="section-9.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.2">
                <t indent="0" pn="section-toc.1-1.9.2.2.1"><xref derivedContent="9.2" format="counter" sectionFormat="of" target="section-9.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="sect-1" numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">
   A device can be simultaneously connected to multiple networks,
   e.g., Wi-Fi, LTE, 5G, and DSL. It is desirable to seamlessly
   combine the connectivity over these networks below the transport
   layer (L4) to improve the quality of experience for applications that
   do not have built-in multi-path capabilities.</t>
      <t indent="0" pn="section-1-2">
   <xref target="Fig1" format="default" sectionFormat="of" derivedContent="Figure 1"/> shows the Multi-Access Management Service (MAMS) user-plane
   protocol stack <xref target="RFC8743" format="default" sectionFormat="of" derivedContent="MAMS"/>, which has been used in today's
   multi-access solutions <xref target="ATSSS" format="default" sectionFormat="of" derivedContent="ATSSS"/> <xref target="LWIPEP" format="default" sectionFormat="of" derivedContent="LWIPEP"/> <xref target="RFC2890" format="default" sectionFormat="of" derivedContent="GRE1"/> <xref target="RFC8157" format="default" sectionFormat="of" derivedContent="GRE2"/>. It
   consists of two layers: convergence and adaptation.</t>
      <t indent="0" pn="section-1-3">
   The convergence layer is responsible for multi-access operations, including
   multi-link (path) aggregation, splitting/reordering, lossless
   switching/retransmission, fragmentation, concatenation, etc. It operates on
   top of the adaptation layer in the protocol stack. From the perspective of
   a transmitter, a User Payload (e.g., IP packet) is processed by the
   convergence layer first and then by the adaptation layer before being
   transported over a delivery connection; from the receiver's perspective, an
   IP packet received over a delivery connection is processed by the
   adaptation layer first and then by the convergence layer.</t>
      <figure anchor="Fig1" align="left" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-mams-user-plane-protocol-st">MAMS User-Plane Protocol Stack</name>
        <artwork name="" type="" align="left" alt="" pn="section-1-4.1">
       +-----------------------------------------------------+
       |   User Payload, e.g., IP Protocol Data Unit (PDU)   |
       +-----------------------------------------------------+
    +-----------------------------------------------------------+
    |  +-----------------------------------------------------+  |
    |  | Multi-Access (MX) Convergence Layer                 |  |
    |  +-----------------------------------------------------+  |
    |  +-----------------------------------------------------+  |
    |  | MX Adaptation   | MX Adaptation   | MX Adaptation   |  |
    |  | Layer           | Layer           | Layer           |  |
    |  +-----------------+-----------------+-----------------+  |
    |  | Access #1 IP    | Access #2 IP    | Access #3 IP    |  |
    |  +-----------------------------------------------------+  |
    |                            MAMS User-Plane Protocol Stack |
    +-----------------------------------------------------------+
</artwork>
      </figure>
      <t indent="0" pn="section-1-5">
   GRE (Generic Routing Encapsulation) <xref target="LWIPEP" format="default" sectionFormat="of" derivedContent="LWIPEP"/> <xref target="RFC2890" format="default" sectionFormat="of" derivedContent="GRE1"/> <xref target="RFC8157" format="default" sectionFormat="of" derivedContent="GRE2"/> can be used as
   the encapsulation protocol at the convergence layer to encode additional
   control information, e.g., key and sequence number.  However, there are two
   main drawbacks with this approach:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-1-6">
        <li pn="section-1-6.1">It is difficult to introduce new control fields because the
     GRE header formats are already defined, and</li>
        <li pn="section-1-6.2">IP-over-IP tunneling (required for GRE) leads to higher
     overhead especially for small packets.</li>
      </ul>
      <t indent="0" pn="section-1-7">
   For example, the overhead of IP-over-IP/GRE tunneling with both
   key and sequence Number is 32 bytes (20-byte IP header + 12-byte
   GRE header), which is 80% of a 40-byte TCP ACK packet.</t>
      <t indent="0" pn="section-1-8">
   This document presents a lightweight Generic Multi-Access (GMA)
   encapsulation protocol for the convergence layer. It supports three
   encapsulation methods: trailer-based IP encapsulation, header-based IP
   encapsulation, and non-IP encapsulation.  Particularly, the IP
   encapsulation methods avoid IP-over-IP tunneling overhead (20 bytes), which
   is 50% of a 40-byte TCP ACK packet. Moreover, it introduces new control
   fields to support fragmentation and concatenation, which are not available
   in GRE-based solutions <xref target="LWIPEP" format="default" sectionFormat="of" derivedContent="LWIPEP"/> <xref target="RFC2890" format="default" sectionFormat="of" derivedContent="GRE1"/> <xref target="RFC8157" format="default" sectionFormat="of" derivedContent="GRE2"/>.</t>
      <t indent="0" pn="section-1-9">
   The GMA protocol only operates between endpoints that have been configured
   to use GMA. This configuration can be through any control messages and
   procedures, including, for example, Multi-Access Management Services <xref target="RFC8743" format="default" sectionFormat="of" derivedContent="MAMS"/>. Moreover, UDP or IPsec tunneling can
   be used at the adaptation sublayer to protect GMA operation from
   intermediate nodes.</t>
      <t indent="0" pn="section-1-10">
   The solution described in this document was developed by the authors based
   on their experiences in multiple standards bodies including the IETF and
   3GPP. However, this document is not an Internet Standard and does not
   represent the consensus opinion of the IETF.  This document presents the
   protocol specification to enable experimentation as described in <xref target="sect-1.1" format="default" sectionFormat="of" derivedContent="Section 1.1"/> and to facilitate other interoperable
   implementations.</t>
      <section anchor="sect-1.1" numbered="true" toc="include" removeInRFC="false" pn="section-1.1">
        <name slugifiedName="name-scope-of-experiment">Scope of Experiment</name>
        <t indent="0" pn="section-1.1-1">
   The protocol described in this document is an experiment. The
   objective of the experiment is to determine whether the protocol
   meets the requirements, can be safely used, and has support for
   deployment.</t>
        <t indent="0" pn="section-1.1-2">
   <xref target="sect-4" format="default" sectionFormat="of" derivedContent="Section 4"/> describes three possible encapsulation methods that are
   enabled by this protocol. Part of this experiment is to assess
   whether all three mechanisms are necessary or whether, for
   example, all implementations are able to support the main
   "trailer-based" IP encapsulation method. Similarly, the experiment
   will investigate the relative merits of the IP and non-IP
   encapsulation methods.</t>
        <t indent="0" pn="section-1.1-3">
   It is expected that this protocol experiment can be conducted on the
   Internet since the GMA packets are identified by an IP protocol number and
   the protocol is intended for single-hop propagation; devices should not be
   forwarding packets, and if they do, they will not need to examine the payload,
   while destination systems that do not support this protocol should not
   receive such packets and will handle them as unknown payloads according to
   normal IP processing. Thus, experimentation is conducted between consenting
   end systems that have been mutually configured to participate in the
   experiment as described in <xref target="sect-7" format="default" sectionFormat="of" derivedContent="Section 7"/>.</t>
        <t indent="0" pn="section-1.1-4">
   Note that this experiment "reuses" the IP protocol identifier 114
   as described in <xref target="sect-4.4" format="default" sectionFormat="of" derivedContent="Section 4.4"/>. Part of this experiment is to assess
   the safety of doing this. The experiment should consider the
   following safety mechanisms:</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-1.1-5">
          <li pn="section-1.1-5.1">GMA endpoints <bcp14>SHOULD</bcp14> detect non-GMA IP packets that also use
     114 and log an error to report the situation (although such
     error logging <bcp14>MUST</bcp14> be subject to rate limits).</li>
          <li pn="section-1.1-5.2">GMA endpoints <bcp14>SHOULD</bcp14> stop using 114 and switch to non-IP encapsulation,
i.e., UDP encapsulation (<xref target="Fig7" format="default" sectionFormat="of" derivedContent="Figure 7"/>), after detecting any non-GMA usage of 114.
</li>
        </ul>
        <t indent="0" pn="section-1.1-6">
   The experiment <bcp14>SHOULD</bcp14> use a packet tracing tool, e.g.,
   WireShark or TCPDUMP, to monitor both ingress and egress traffic at GMA
   endpoints and ensure the above safety mechanisms are implemented.</t>
        <t indent="0" pn="section-1.1-7">
   Path quality measurements (one-way delay, loss, etc.) and congestion
   detection are performed by the receiver based on the GMA control fields,
   e.g., Sequence Number, Timestamp, etc. The receiver will then dynamically
   control how to split or steer traffic over multiple delivery connections
   accordingly. The GMA control protocol <xref target="I-D.zhu-intarea-gma-control" format="default" sectionFormat="of" derivedContent="GMAC"/> <bcp14>MAY</bcp14>
   be used for signaling between GMA endpoints. Another objective of the
   experiment is to evaluate the usage of various receiver-based algorithms
   <xref target="GCC" format="default" sectionFormat="of" derivedContent="GCC"/> <xref target="MPIP" format="default" sectionFormat="of" derivedContent="MPIP"/>
   in multi-path traffic management and the impact on the End-to-End (E2E)
   performance (throughput, delay, etc.) of higher-layer (transport)
   protocols, e.g., TCP, QUIC, WebRTC, etc.</t>
        <t indent="0" pn="section-1.1-8">
   The authors will continually assess the progress of this
   experiment and encourage other implementers to contact them to
   report the status of their implementations and their experiences
   with the protocol.</t>
      </section>
    </section>
    <section anchor="sect-2" numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-conventions-used-in-this-do">Conventions Used in This Document</name>
      <t indent="0" pn="section-2-1">
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
    "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>",
    "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are
    to be interpreted as described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/>
        <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> when, and only when, they appear in all capitals,
    as shown here.
      </t>
    </section>
    <section anchor="sect-3" numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-use-case">Use Case</name>
      <t indent="0" pn="section-3-1">
   As shown in <xref target="Fig2" format="default" sectionFormat="of" derivedContent="Figure 2"/>, a client device (e.g., smartphone,
   laptop, etc.) may connect to the Internet via both Wi-Fi and LTE
   connections, one of which (e.g., LTE) may operate as the anchor connection,
   and the other (e.g., Wi-Fi) may operate as the delivery connection. The
   anchor connection provides the IP address and connectivity for end-to-end
   Internet access, and the delivery connection provides an additional path
   between the client and Multi-Access Gateway for multi-access optimizations.</t>
      <figure anchor="Fig2" align="left" suppress-title="false" pn="figure-2">
        <name slugifiedName="name-gma-based-multi-access-aggr">GMA-Based Multi-Access Aggregation</name>
        <artwork name="" type="" align="left" alt="" pn="section-3-2.1">
                     Multi-Access Aggregation

                 +---+                        +---+
                 | |A|--- LTE Connection -----|C| |
                 |U|-|                        |-|S| Internet
                 | |B|--- Wi-Fi Connection ---|D| |
                 +---+                        +---+
                client                Multi-Access Gateway
</artwork>
      </figure>
      <dl indent="4" newline="false" spacing="normal" pn="section-3-3">
        <dt pn="section-3-3.1">A:</dt>
        <dd pn="section-3-3.2"> The adaptation-layer endpoint of the LTE connection
	resides in the client.</dd>
        <dt pn="section-3-3.3">B:</dt>
        <dd pn="section-3-3.4"> The adaptation-layer endpoint of the Wi-Fi connection
	resides in the client.</dd>
        <dt pn="section-3-3.5">C:</dt>
        <dd pn="section-3-3.6"> The adaptation-layer endpoint of the LTE connection
	resides in the Multi-Access Gateway, aka N-MADP (Network
	Multi-Access Data Proxy) in <xref target="RFC8743" format="default" sectionFormat="of" derivedContent="MAMS"/>.</dd>
        <dt pn="section-3-3.7">D:</dt>
        <dd pn="section-3-3.8"> The adaptation-layer endpoint of the Wi-Fi connection
	resides in the Multi-Access Gateway.</dd>
        <dt pn="section-3-3.9">U:</dt>
        <dd pn="section-3-3.10"> The convergence-layer endpoint resides in the client.</dd>
        <dt pn="section-3-3.11">S:</dt>
        <dd pn="section-3-3.12"> The convergence-layer endpoint resides in the Multi-Access
	Gateway.</dd>
      </dl>
      <t indent="0" pn="section-3-4">
   For example, per-packet aggregation allows a single IP flow to use the
   combined bandwidth of the two connections. In another example, packets lost
   due to a temporary link outage may be retransmitted. Moreover, packets may
   be duplicated over multiple connections to achieve high reliability and low
   latency, where duplicated packets are eliminated by the receiving
   side. Such multi-access optimization requires additional control
   information, e.g., a sequence number, in each packet, which can be
   supported by the GMA encapsulation protocol described in this document.</t>
      <t indent="0" pn="section-3-5">
   The GMA protocol described in this document is designed for multiple
   connections, but it may also be used when there is only one connection
   between two endpoints. For example, it may be used for loss detection and
   recovery. In another example, it may be used to concatenate multiple small
   packets and reduce per-packet overhead.</t>
    </section>
    <section anchor="sect-4" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-gma-encapsulation-methods">GMA Encapsulation Methods</name>
      <t indent="0" pn="section-4-1">
   The GMA encapsulation protocol supports the following three
   methods:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4-2">
        <li pn="section-4-2.1">Trailer-based IP Encapsulation (<xref target="sect-4.1" format="default" sectionFormat="of" derivedContent="Section 4.1"/>)</li>
        <li pn="section-4-2.2">Header-based IP Encapsulation (<xref target="sect-4.2" format="default" sectionFormat="of" derivedContent="Section 4.2"/>)</li>
        <li pn="section-4-2.3">Header-based non-IP Encapsulation (<xref target="sect-4.3" format="default" sectionFormat="of" derivedContent="Section 4.3"/>)</li>
      </ul>
      <t indent="0" pn="section-4-3">
   Non-IP encapsulation <bcp14>MUST</bcp14> be used if the original IP packet is
   IPv6.</t>
      <t indent="0" pn="section-4-4">
   Trailer-based IP encapsulation <bcp14>MUST</bcp14> be used if it is supported by
   GMA endpoints and the original IP packet is IPv4.</t>
      <t indent="0" pn="section-4-5">
   Header-based encapsulation <bcp14>MUST</bcp14> be used if the trailer-based
   method is not supported by either the client or Multi-Access Gateway.
   In this case, if the adaptation layer, e.g., UDP tunneling,
   supports non-IP packet format, non-IP encapsulation <bcp14>MUST</bcp14> be used;
   otherwise, header-based IP encapsulation <bcp14>MUST</bcp14> be used.</t>
      <t indent="0" pn="section-4-6">
   If non-IP encapsulation is configured, a GMA header <bcp14>MUST</bcp14> be
   present in every packet. In comparison, if IP encapsulation is configured,
   a GMA header or trailer may be added dynamically on a per-packet basis, and
   it indicates the presence of a GMA header (or trailer) to set the protocol
   type of the GMA PDU to "114" (see <xref target="sect-4.4" format="default" sectionFormat="of" derivedContent="Section 4.4"/>).</t>
      <t indent="0" pn="section-4-7">
   The GMA endpoints <bcp14>MAY</bcp14> configure the GMA encapsulation method through
   control signaling or pre-configuration. For example, the "MX UP Setup
   Configuration Request" message as specified in Multi-Access Management
   Service <xref target="RFC8743" format="default" sectionFormat="of" derivedContent="MAMS"/> includes "MX Convergence Method Parameters",
   which provides the list of parameters to configure the convergence layer,
   and can be extended to indicate the GMA encapsulation method.</t>
      <t indent="0" pn="section-4-8">
   GMA endpoint <bcp14>MUST</bcp14> discard a received packet and <bcp14>MAY</bcp14> log an error
   to report the situation (although such error logging <bcp14>MUST</bcp14> be
   subject to rate limits) under any of the following conditions:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4-9">
        <li pn="section-4-9.1">The GMA version number in the GMA header (or trailer) is not
     understood or supported by the GMA endpoint.</li>
        <li pn="section-4-9.2">A flag bit in the GMA header (or trailer) not understood or
     supported by the GMA endpoint is set to "1".</li>
      </ul>
      <section anchor="sect-4.1" numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-trailer-based-ip-encapsulat">Trailer-Based IP Encapsulation</name>
        <figure anchor="Fig3" align="left" suppress-title="false" pn="figure-3">
          <name slugifiedName="name-gma-pdu-format-with-trailer">GMA PDU Format with Trailer-based IP Encapsulation</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.1-1.1">
       |&lt;---------------------GMA PDU -----------------------&gt;|
       +------------------------------------------------------+
       | IP hdr |        IP payload             | GMA Trailer |
       +------------------------------------------------------+
       |&lt;------- GMA SDU (user payload)--------&gt;|
</artwork>
        </figure>
        <t indent="0" pn="section-4.1-2">
   This method <bcp14>SHALL NOT</bcp14> be used if the original IP packet (GMA
   service data unit (GMA SDU)) is IPv6.</t>
        <t indent="0" pn="section-4.1-3">
   <xref target="Fig3" format="default" sectionFormat="of" derivedContent="Figure 3"/> shows the trailer-based IP encapsulation GMA protocol
   data unit (GMA PDU) format. A (GMA) PDU may carry one or multiple IP
   packets, aka (GMA) SDUs, in the payload, or a fragment of the SDU.</t>
        <t indent="0" pn="section-4.1-4">
   The protocol type field in the IP header of the GMA PDU <bcp14>MUST</bcp14> be
   changed to 114 (Any 0-Hop Protocol) (see <xref target="sect-4.4" format="default" sectionFormat="of" derivedContent="Section 4.4"/>) to indicate
   the presence of the GMA trailer.</t>
        <t indent="0" pn="section-4.1-5">
   The following three IP header fields <bcp14>MUST</bcp14> be changed:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-4.1-6">
          <dt pn="section-4.1-6.1">IP Length:</dt>
          <dd pn="section-4.1-6.2"> Add the length of "GMA Trailer" to the length of the
     original IP packet.</dd>
          <dt pn="section-4.1-6.3">Time To Live (TTL):</dt>
          <dd pn="section-4.1-6.4"> Set to "1".</dd>
          <dt pn="section-4.1-6.5">IP checksum:</dt>
          <dd pn="section-4.1-6.6"> Recalculate after changing "protocol
          type", "TTL", and "IP Length".</dd>
        </dl>
        <t indent="0" pn="section-4.1-7">
   The GMA (Generic Multi-Access) trailer <bcp14>MUST</bcp14> consist of two
   mandatory fields (the last 3 bytes): Next Header and Flags.
        </t>
        <t indent="0" pn="section-4.1-8">
   This is defined as follows:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-4.1-9">
          <dt pn="section-4.1-9.1">Next Header (1 byte):</dt>
          <dd pn="section-4.1-9.2"> This is the IP protocol type of the (first) SDU
     in a PDU; it stores the value before it was overwritten to
     114.</dd>
          <dt pn="section-4.1-9.3">Flags (2 bytes):</dt>
          <dd pn="section-4.1-9.4">
            <t indent="0" pn="section-4.1-9.4.1"> Bit 0 is the most significant bit (MSB), and
	    bit 15 is the least significant bit (LSB).
            </t>
            <dl indent="3" newline="false" spacing="normal" pn="section-4.1-9.4.2">
              <dt pn="section-4.1-9.4.2.1">Checksum Present (bit 0):</dt>
              <dd pn="section-4.1-9.4.2.2"> If the Checksum Present
              bit is set to 1, then the Checksum field is present.</dd>
              <dt pn="section-4.1-9.4.2.3">Concatenation Present (bit 1):</dt>
              <dd pn="section-4.1-9.4.2.4"> If the Concatenation
              Present bit is set to 1, then the PDU carries multiple SDUs, and
              the First SDU Length field is present.</dd>
              <dt pn="section-4.1-9.4.2.5">Connection ID Present (bit 2):</dt>
              <dd pn="section-4.1-9.4.2.6"> If the Connection ID
              Present bit is set to 1, then the Connection ID field is
              present.</dd>
              <dt pn="section-4.1-9.4.2.7">Flow ID Present (bit 3):</dt>
              <dd pn="section-4.1-9.4.2.8"> If the Flow ID Present bit
              is set to 1, then the Flow ID field is present.</dd>
              <dt pn="section-4.1-9.4.2.9">Fragmentation Present (bit 4):</dt>
              <dd pn="section-4.1-9.4.2.10">If the Fragmentation
              Present bit is set to 1, then the PDU carry a fragment of the
              SDU and the Fragmentation Control field is present.</dd>
              <dt pn="section-4.1-9.4.2.11">Delivery SN Present (bit 5):</dt>
              <dd pn="section-4.1-9.4.2.12"> If the Delivery SN
              (Sequence Number) Present bit is set to 1, then the Delivery SN
              field is present and contains the valid information.</dd>
              <dt pn="section-4.1-9.4.2.13">Flow SN Present (bit 6):</dt>
              <dd pn="section-4.1-9.4.2.14"> If the Flow SN Present bit
              is set to 1, then the Sequence Number field is present.</dd>
              <dt pn="section-4.1-9.4.2.15">Timestamp Present (bit 7):</dt>
              <dd pn="section-4.1-9.4.2.16"> If the Timestamp Present
              bit is set to 1, then the Timestamp field is present.</dd>
              <dt pn="section-4.1-9.4.2.17">TTL Present (bit 8):</dt>
              <dd pn="section-4.1-9.4.2.18"> If the TTL Present bit is set
              to 1, then the TTL field is present.</dd>
              <dt pn="section-4.1-9.4.2.19">Reserved (bit 9-12):</dt>
              <dd pn="section-4.1-9.4.2.20"> This is set to "0" and ignored
              on receipt.</dd>
              <dt pn="section-4.1-9.4.2.21">Version (bit 13~15):</dt>
              <dd pn="section-4.1-9.4.2.22"> This is the GMA version
              number; it is set to 0 for the GMA encapsulation protocol specified in
              this document.</dd>
            </dl>
          </dd>
        </dl>
        <t indent="0" pn="section-4.1-10">
   The Flags field is at the end of the PDU, and the Next Header field is the
   second last. The receiver <bcp14>SHOULD</bcp14> first decode the Flags
   field to determine the length of the GMA trailer and then decode each
   optional field accordingly. The Generic Multi-Access (GMA) trailer
   <bcp14>MAY</bcp14> consist of the following optional fields:</t>
        <dl indent="3" newline="false" spacing="normal" pn="section-4.1-11">
          <dt pn="section-4.1-11.1">Checksum (1 byte):</dt>
          <dd pn="section-4.1-11.2"> This contains the (one's
          complement) checksum sum of all 8 bits in the trailer. For purposes
          of computing the checksum, the value of the Checksum field is
          zero. This field is present only if the Checksum Present bit is set
          to 1.</dd>
          <dt pn="section-4.1-11.3">First SDU Length (2 bytes):</dt>
          <dd pn="section-4.1-11.4"> This is the length of the
          first IP packet in the PDU, only included if a PDU contains multiple
          IP packets. This field is present only if the Concatenation Present
          bit is set to 1.</dd>
          <dt pn="section-4.1-11.5">Connection ID (1 byte):</dt>
          <dd pn="section-4.1-11.6">
            <t indent="0" pn="section-4.1-11.6.1"> This contains an unsigned integer to identify the
     anchor and delivery connection of the GMA PDU. This field is
     present only if the Connection ID Present bit is set to 1.
            </t>
            <dl indent="3" newline="false" spacing="normal" pn="section-4.1-11.6.2">
              <dt pn="section-4.1-11.6.2.1">Anchor Connection ID (MSB 4 bits):</dt>
              <dd pn="section-4.1-11.6.2.2"> This contains an
              unsigned integer to identify the anchor connection.</dd>
              <dt pn="section-4.1-11.6.2.3">Delivery Connection ID (LSB 4 bits):</dt>
              <dd pn="section-4.1-11.6.2.4"> This contains
              an unsigned integer to identify the delivery connection.</dd>
            </dl>
          </dd>
          <dt pn="section-4.1-11.7">Flow ID (1 byte):</dt>
          <dd pn="section-4.1-11.8"> This contains an unsigned integer to identify the
          IP flow that a PDU belongs to, for example Data Radio Bearer (DRB)
          ID <xref target="LWIPEP" format="default" sectionFormat="of" derivedContent="LWIPEP"/> for a cellular (e.g., LTE)
          connection. This field is present only if the Flow ID Present bit is
          set to 1.</dd>
          <dt pn="section-4.1-11.9">Fragmentation Control (FC) (1 byte):</dt>
          <dd pn="section-4.1-11.10"> This provides
          necessary information for reassembly, only needed if a PDU carries
          fragments. This field is present only if the Fragmentation Present
          bit is set to 1. Please refer to <xref target="sect-5" format="default" sectionFormat="of" derivedContent="Section 5"/> for its
          detailed format and usage.</dd>
          <dt pn="section-4.1-11.11">Delivery SN (1 byte):</dt>
          <dd pn="section-4.1-11.12"> This contains an auto-incremented integer to
          indicate the GMA PDU transmission order on a delivery connection.
          Delivery SN is needed to measure packet loss of each delivery
          connection and therefore generated per delivery connection per
          flow. This field is present only if the Delivery SN Present bit is
          set to 1.</dd>
          <dt pn="section-4.1-11.13">Flow SN (3 bytes):</dt>
          <dd pn="section-4.1-11.14"> This contains an auto-incremented
          integer to indicate the GMA SDU (IP packet) order of a flow. Flow SN
          is needed for retransmission, reordering, and fragmentation. It
          <bcp14>SHALL</bcp14> be generated per flow. This field is present
          only if the Flow SN Present bit is set to 1.</dd>
          <dt pn="section-4.1-11.15">Timestamp (4 bytes):</dt>
          <dd pn="section-4.1-11.16"> This contains the
          current value of the timestamp clock of the transmitter in the unit
          of 1 millisecond. This field is present only if the Timestamp
          Present bit is set to 1.</dd>
          <dt pn="section-4.1-11.17">TTL (1 byte):</dt>
          <dd pn="section-4.1-11.18"> This contains the TTL value of
          the original IP header if the GMA SDU is IPv4, or the Hop-Limit
          value of the IP header if the GMA SDU is IPv6. This field is present
          only if the TTL Present bit is set to 1.</dd>
        </dl>
        <t indent="0" pn="section-4.1-12">
   <xref target="Fig4" format="default" sectionFormat="of" derivedContent="Figure 4"/> shows the GMA trailer format with all the fields present,
   and the order of the GMA control fields <bcp14>SHALL</bcp14> follow the bit order
   in the Flags field. Note that the bits in the Flags field are
   ordered with the first bit transmitted being bit 0 (MSB). All
   fields are transmitted in regular network byte order and appear in
   reverse order to their corresponding flag bits. If a flag bit is
   clear, the corresponding optional field is absent.</t>
        <t indent="0" pn="section-4.1-13">
   For example, bit 0 (the MSB) of the Flags field is the Checksum Present
   bit, and the Checksum field is the last in the trailer with the exception
   of the two mandatory fields. Bit 1 is the Concatenation Present bit, and
   the FSL field is the second last.</t>
        <figure anchor="Fig4" align="left" suppress-title="false" pn="figure-4">
          <name slugifiedName="name-gma-trailer-format-with-all">GMA Trailer Format with All Optional Fields Present</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.1-14.1">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     TTL       |                   Timestamp
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                |                   Flow SN                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Delivery SN  |    FC         |   Flow ID     | Connection ID |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      First SDU Length (FSL)   |   Checksum    |  Next Header  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Flags                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
        </figure>
      </section>
      <section anchor="sect-4.2" numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-header-based-ip-encapsulati">Header-Based IP Encapsulation</name>
        <t indent="0" pn="section-4.2-1">
   This method <bcp14>SHALL NOT</bcp14> be used if the original IP packet (GMA SDU)
   is IPv6.</t>
        <t indent="0" pn="section-4.2-2">
   <xref target="Fig5" format="default" sectionFormat="of" derivedContent="Figure 5"/> shows the header-based IP encapsulation format. Here, the
   GMA header is inserted right after the IP header of the GMA SDU,
   and the IP header fields of the GMA PDU <bcp14>MUST</bcp14> be changed the same
   way as in trailer-based IP encapsulation.</t>
        <figure anchor="Fig5" align="left" suppress-title="false" pn="figure-5">
          <name slugifiedName="name-gma-pdu-format-with-header-">GMA PDU Format with Header-Based IP Encapsulation</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.2-3.1">
       +-----------------------------------------------+
       |IP hdr | GMA Header  |       IP payload        |
       +-----------------------------------------------+
</artwork>
        </figure>
        <t indent="0" pn="section-4.2-4">
   <xref target="Fig6" format="default" sectionFormat="of" derivedContent="Figure 6"/> shows the GMA header format. In comparison to the GMA
   trailer, the only difference is that the Flags field is now in the front so
   that the receiver can first decode the Flags field to determine the GMA
   header length.</t>
        <t indent="0" pn="section-4.2-5">
   The "TTL" field <bcp14>MUST</bcp14> be included and the "TTL" bit in the
   GMA header (or Trailer) <bcp14>MUST</bcp14> be set to 1 if (trailer- or
   header-based) IP encapsulation is used.</t>
        <figure anchor="Fig6" align="left" suppress-title="false" pn="figure-6">
          <name slugifiedName="name-gma-header-format">GMA Header Format</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.2-6.1">
    +------------------------------------------------------+
    | Flags | other fields (TTL, Timestamp, Flow SN, etc.) |
    +------------------------------------------------------+
</artwork>
        </figure>
      </section>
      <section anchor="sect-4.3" numbered="true" toc="include" removeInRFC="false" pn="section-4.3">
        <name slugifiedName="name-header-based-non-ip-encapsu">Header-Based Non-IP Encapsulation</name>
        <t indent="0" pn="section-4.3-1">
   <xref target="Fig7" format="default" sectionFormat="of" derivedContent="Figure 7"/> shows the header-based non-IP encapsulation format. Here,
   "UDP Tunneling" is configured at the MX adaptation layer. The
   ports for "UDP Tunneling" at the client are chosen from the Dynamic
   Port range, and the ports for "UDP Tunneling" at the Multi-Access
   Gateway are configured and provided to the client through additional
   control messages, e.g., <xref target="RFC8743" format="default" sectionFormat="of" derivedContent="MAMS"/>.</t>
        <t indent="0" pn="section-4.3-2">
   "TTL", "FSL", and "Next Header" are no longer needed and <bcp14>MUST</bcp14> not
   be included. Moreover, the IP header fields of the GMA SDU remain
   unchanged.</t>
        <figure anchor="Fig7" align="left" suppress-title="false" pn="figure-7">
          <name slugifiedName="name-gma-pdu-format-with-non-ip-">GMA PDU Format with Non-IP Encapsulation</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.3-3.1">
 +-------------------------------------------------------------+
 | IP hdr | UDP hdr  | GMA Header | IP hdr |    IP payload     |
 +-------------------------------------------------------------+
                                 |&lt;------- GMA SDU------------&gt;|
                     |&lt;------------------- GMA PDU------------&gt;|
</artwork>
        </figure>
      </section>
      <section anchor="sect-4.4" numbered="true" toc="include" removeInRFC="false" pn="section-4.4">
        <name slugifiedName="name-ip-protocol-identifier">IP Protocol Identifier</name>
        <t indent="0" pn="section-4.4-1">
   As described in <xref target="sect-4.1" format="default" sectionFormat="of" derivedContent="Section 4.1"/>, IP-encapsulated GMA PDUs are
   indicated using the IP protocol type 114. This is designated and
   recorded by IANA <xref target="IANA" format="default" sectionFormat="of" derivedContent="IANA"/> to indicate "any 0-Hop Protocol". No
   reference is given in the IANA registry for the definition of this
   protocol type, and IANA has no record of why the assignment was
   made or how it is used, although it was probably assigned before
   1999 <xref target="IANA1999" format="default" sectionFormat="of" derivedContent="IANA1999"/>.</t>
        <t indent="0" pn="section-4.4-2">
   There is some risk associated with "reusing" protocol type 114
   because there may be implementations of other protocols also using
   this protocol type. However, because the protocol described in
   this document is used only between adjacent devices specifically
   configured for this purpose, the use of protocol type 114 should
   be safe.</t>
        <t indent="0" pn="section-4.4-3">
   As described in <xref target="sect-1.1" format="default" sectionFormat="of" derivedContent="Section 1.1"/>, one of the purposes of the experiment
   described in this document is to verify the safety of using this
   protocol type. Deployments should be aware of the risk of a clash
   with other uses of this protocol type.</t>
      </section>
    </section>
    <section anchor="sect-5" numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-fragmentation">Fragmentation</name>
      <t indent="0" pn="section-5-1">
   If the MTU size of the anchor connection (for GMA SDU) is configured such
   that the corresponding GMA PDU length adding the GMA header (or trailer)
   and other overhead (UDP tunneling) <bcp14>MAY</bcp14> exceed the MTU of a
   delivery connection, GMA endpoints <bcp14>MUST</bcp14> be configured to
   support fragmentation through additional control messages <xref target="RFC8743" format="default" sectionFormat="of" derivedContent="MAMS"/>.</t>
      <t indent="0" pn="section-5-2">
   The fragmentation procedure at the convergence sublayer is similar
   to IP fragmentation <xref target="RFC0791" format="default" sectionFormat="of" derivedContent="RFC0791"/> in principle, but with the following
   two differences for less overhead:</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5-3">
        <li pn="section-5-3.1">The fragment offset field is expressed in number of fragments.</li>
        <li pn="section-5-3.2">The maximum number of fragments per SDU is 2<sup>7</sup> (=128).</li>
      </ul>
      <t indent="0" pn="section-5-4">
   The Fragmentation Control (FC) field in the GMA trailer (or
   header) contains the following bits:</t>
      <dl indent="3" newline="false" spacing="normal" pn="section-5-5">
        <dt pn="section-5-5.1">Bit 7:</dt>
        <dd pn="section-5-5.2"> a More Fragment (MF) flag to indicate if the fragment
     is the last one (0) or not (1)</dd>
        <dt pn="section-5-5.3">Bit 0-6:</dt>
        <dd pn="section-5-5.4"> Fragment Offset (in units of fragments) to specify
     the offset of a particular fragment relative to the beginning
     of the SDU</dd>
      </dl>
      <t indent="0" pn="section-5-6">
   A PDU carries a whole SDU without fragmentation if the FC field is
   set to all "0"s or the FC field is not present in the trailer.
   Otherwise, the PDU contains a fragment of the SDU.</t>
      <t indent="0" pn="section-5-7">
   The Flow SN field in the trailer is used to distinguish the
   fragments of one SDU from those of another. The Fragment Offset
   (FO) field tells the receiver the position of a fragment in the
   original SDU. The More Fragment (MF) flag indicates the last
   fragment.</t>
      <t indent="0" pn="section-5-8">
   To fragment a long SDU, the transmitter creates n PDUs and copies the
   content of the IP header fields from the long PDU into the IP header of all
   the PDUs. The length field in the IP header of the PDU
   <bcp14>SHOULD</bcp14> be changed to the length of the PDU, and the protocol
   type <bcp14>SHOULD</bcp14> be changed to 114.</t>
      <t indent="0" pn="section-5-9">
   The data of the long SDU is divided into n portions based on the
   MTU size of the delivery connection. The first portion of the data
   is placed in the first PDU. The MF flag is set to "1", and the FO
   field is set to "0". The i-th portion of the data is placed in the
   i-th PDU. The MF flag is set to "0" if it is the last fragment and
   set to "1" otherwise. The FO field is set to i-1.</t>
      <t indent="0" pn="section-5-10">
   To assemble the fragments of an SDU, the receiver combines PDUs
   that all have the same Flow SN. The combination is done by placing
   the data portion of each fragment in the relative order indicated
   by the Fragment Offset in that fragment's GMA trailer (or header).
   The first fragment will have the Fragment Offset set to "0", and
   the last fragment will have the More Fragment flag set to "0".</t>
      <t indent="0" pn="section-5-11">
   GMA fragmentation operates above the IP layer of individual access
   connection (Wi-Fi, LTE) and between the two endpoints of convergence
   layer. The convergence layer endpoints (client, Multi-access Gateway)
   <bcp14>SHOULD</bcp14> obtain the MTU of individual connection through
   either manual configuration or implementing Path MTU Discovery (PMTUD) as
   suggested in <xref target="RFC8900" format="default" sectionFormat="of" derivedContent="RFC8900"/>.</t>
    </section>
    <section anchor="sect-6" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-concatenation">Concatenation</name>
      <t indent="0" pn="section-6-1">
   The convergence sublayer <bcp14>MAY</bcp14> support concatenation if a delivery
   connection has a larger maximum transmission unit (MTU) than the
   original IP packet (SDU). Only the SDUs with the same client IP
   address and the same Flow ID <bcp14>MAY</bcp14> be concatenated.</t>
      <t indent="0" pn="section-6-2">
   If the (trailer- or header-based) IP encapsulation method is used,
   the First SDU Length (FSL) field <bcp14>SHOULD</bcp14> be included in the GMA
   trailer (or header) to indicate the length of the first SDU.
   Otherwise, the FSL field <bcp14>SHOULD</bcp14> not be included.</t>
      <figure anchor="Fig8" align="left" suppress-title="false" pn="figure-8">
        <name slugifiedName="name-example-of-gma-pdu-format-w">Example of GMA PDU Format with Concatenation and Trailer-Based IP Encapsulation</name>
        <artwork name="" type="" align="left" alt="" pn="section-6-3.1">
  +-----------------------------------------------------------+
  |IP hdr| IP payload    |IP hdr|   IP payload  | GMA Trailer |
  +-----------------------------------------------------------+
</artwork>
      </figure>
      <t indent="0" pn="section-6-4">
   To concatenate two or more SDUs, the transmitter creates one PDU
   and copies the content of the IP header field from the first SDU
   into the IP header of the PDU. The data of the first SDU is placed
   in the first portion of the data of the PDU. The whole second SDU
   is then placed in the second portion of the data of the PDU
   (<xref target="Fig8" format="default" sectionFormat="of" derivedContent="Figure 8"/>). The procedure continues until the PDU size reaches the
   MTU of the delivery connection. If the FSL field is present, the
   IP Length field of the PDU <bcp14>SHOULD</bcp14> be updated to include all
   concatenated SDUs and the trailer (or header), and the IP checksum
   field <bcp14>SHOULD</bcp14> be recalculated if the packet is IPv4.</t>
      <t indent="0" pn="section-6-5">
   To disaggregate a PDU, if the (header- or trailer-based) IP
   encapsulation method is used, the receiver first obtains the
   length of the first SDU from the FSL field and decodes the first
   SDU. The receiver then obtains the length of the second SDU based
   on the length field in the second SDU IP header and decodes the
   second SDU. The procedure continues until no byte is left in the
   PDU. If the non-IP encapsulation method (<xref target="Fig7" format="default" sectionFormat="of" derivedContent="Figure 7"/>) is used, the IP
   header of the first SDU will not change during the encapsulation
   process, and the receiver <bcp14>SHOULD</bcp14> obtain the length of the first
   SDU directly from its IP header (<xref target="Fig9" format="default" sectionFormat="of" derivedContent="Figure 9"/>).</t>
      <figure anchor="Fig9" align="left" suppress-title="false" pn="figure-9">
        <name slugifiedName="name-example-of-gma-pdu-format-wi">Example of GMA PDU Format with Concatenation and Header-Based Non-IP (UDP) Encapsulation</name>
        <artwork name="" type="" align="left" alt="" pn="section-6-6.1">
                                 |&lt;-------1st GMA SDU------------
+---------------------------------------------------------------+
| IP hdr | UDP hdr  | GMA Header | IP hdr |       IP payload    |
+---------------------------------------------------------------+
         | IP hdr |           IP payload    |
+-------------------------------------------+
--------&gt;|&lt;-------2nd GMA SDU---------------&gt;
</artwork>
      </figure>
      <t indent="0" pn="section-6-7">
   If a PDU contains multiple SDUs, the Flow SN field is for the last
   SDU, and the Flow SN of other SDUs carried by the same PDU can be
   obtained according to its order in the PDU. For example, if the SN
   field is 6 and a PDU contains 3 SDUs (IP packets), the SN is 4, 5,
   and 6 for the first, second, and last SDU, respectively.</t>
      <t indent="0" pn="section-6-8">
   GMA concatenation can be used for packing small packets of a
   single application, e.g., TCP ACKs, or from multiple applications.
   Notice that a single GMA flow may carry multiple application flows
   (TCP, UDP, etc.).</t>
      <t indent="0" pn="section-6-9">
   GMA endpoints <bcp14>MUST NOT</bcp14> perform concatenation and
   fragmentation in a single PDU. If a GMA PDU carries a fragmented SDU, it
   <bcp14>MUST NOT</bcp14> carry any other (fragmented or whole) SDU.</t>
    </section>
    <section anchor="sect-7" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-7-1">
   Security in a network using GMA should be relatively similar to security in
   a normal IP network. GMA is unaware of IP- or higher-layer end-to-end
   security as it carries the IP packets as opaque payload. Deployers are
   encouraged to not consider that GMA adds any form of security and to
   continue to use IP- or higher-layer security as well as link-layer
   security.</t>
      <t indent="0" pn="section-7-2">
   The GMA protocol at the convergence sublayer is a 0-hop protocol and relies
   on the security of the underlying network transport paths. When this cannot
   be assumed, appropriate security protocols (IPsec, DTLS, etc.)
   <bcp14>SHOULD</bcp14> be configured at the adaptation sublayer. On the
   other hand, packet filtering requires either that a firewall looks inside
   the GMA packet or that the filtering is done on the GMA endpoints. In those
   environments in which this is considered to be a security issue, it may be
   desirable to terminate the GMA operation at the firewall.</t>
      <t indent="0" pn="section-7-3">
   Local-only packet leak prevention (HL=0, TTL=1) <bcp14>SHOULD</bcp14> be on
   preventing the leak of the local-only GMA PDUs outside the "local domain"
   to the Internet or to another domain that could use the same IP protocol
   type, i.e., 114.</t>
    </section>
    <section anchor="sect-8" numbered="true" toc="include" removeInRFC="false" pn="section-8">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-8-1">
	This document has no IANA actions.
      </t>
    </section>
  </middle>
  <back>
    <displayreference target="RFC2890" to="GRE1"/>
    <displayreference target="RFC8157" to="GRE2"/>
    <displayreference target="I-D.zhu-intarea-gma-control" to="GMAC"/>
    <displayreference target="RFC8743" to="MAMS"/>
    <references pn="section-9">
      <name slugifiedName="name-references">References</name>
      <references pn="section-9.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2890" target="https://www.rfc-editor.org/info/rfc2890" quoteTitle="true" derivedAnchor="GRE1">
          <front>
            <title>Key and Sequence Number Extensions to GRE</title>
            <author initials="G." surname="Dommety" fullname="G. Dommety">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2000" month="September"/>
            <abstract>
              <t indent="0">This document describes extensions by which two fields, Key and Sequence Number, can be optionally carried in the GRE Header.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2890"/>
          <seriesInfo name="DOI" value="10.17487/RFC2890"/>
        </reference>
        <reference anchor="RFC8157" target="https://www.rfc-editor.org/info/rfc8157" quoteTitle="true" derivedAnchor="GRE2">
          <front>
            <title>Huawei's GRE Tunnel Bonding Protocol</title>
            <author initials="N." surname="Leymann" fullname="N. Leymann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Heidemann" fullname="C. Heidemann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Zhang" fullname="M. Zhang">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Sarikaya" fullname="B. Sarikaya">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Cullen" fullname="M. Cullen">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">There is an emerging demand for solutions that provide redundancy and load-sharing across wired and cellular links from a single Service Provider, so that a single subscriber is provided with bonded access to heterogeneous connections at the same time.</t>
              <t indent="0">In this document, GRE (Generic Routing Encapsulation) Tunnel Bonding is specified as an enabling approach for bonded access to a wired and a wireless network in customer premises, e.g., homes.  In GRE Tunnel Bonding, two GRE tunnels, one per network connection, are set up and bonded together to form a single GRE tunnel for a subscriber. Compared with each subconnection, the bonded connections promise increased access capacity and improved reliability.  The solution described in this document is currently implemented by Huawei and deployed by Deutsche Telekom AG.  This document will enable other developers to build interoperable implementations.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8157"/>
          <seriesInfo name="DOI" value="10.17487/RFC8157"/>
        </reference>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
      </references>
      <references pn="section-9.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="ATSSS" target="https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=3254" quoteTitle="true" derivedAnchor="ATSSS">
          <front>
            <title>Study on access traffic steering, switch and splitting support in the 5G System (5GS) architecture</title>
            <author>
              <organization showOnFrontPage="true">3GPP</organization>
            </author>
            <date month="December" year="2018"/>
          </front>
          <seriesInfo name="3GPP TR" value="23.793"/>
          <refcontent>Release 16</refcontent>
        </reference>
        <reference anchor="GCC" target="https://datatracker.ietf.org/doc/html/draft-ietf-rmcat-gcc-02" derivedAnchor="GCC" quoteTitle="true">
          <front>
            <title>A Google Congestion Control Algorithm for Real-Time Communication</title>
            <author initials="S" surname="Holmer" fullname="Stefan Holmer">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H" surname="Lundin" fullname="Henrik Lundin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G" surname="Carlucci" fullname="Gaetano Carlucci">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L" surname="De Cicco" fullname="Luca De Cicco">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S" surname="Mascolo" fullname="Saverio Mascolo">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="July" day="8" year="2016"/>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-rmcat-gcc-02"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="I-D.zhu-intarea-gma-control" quoteTitle="true" target="https://datatracker.ietf.org/doc/html/draft-zhu-intarea-gma-control-00" derivedAnchor="GMAC">
          <front>
            <title>UDP-based Generic Multi-Access (GMA) Control Protocol</title>
            <author fullname="Jing Zhu">
              <organization showOnFrontPage="true">Intel</organization>
            </author>
            <author fullname="Menglei Zhang">
              <organization showOnFrontPage="true">Intel</organization>
            </author>
            <date month="October" day="13" year="2021"/>
            <abstract>
              <t indent="0">   A device can be simultaneously connected to multiple networks,
   e.g., Wi-Fi, LTE, 5G, and DSL. It is desirable to seamlessly
   combine the connectivity over these networks below the transport
   layer (L4) to improve quality of experience for applications that
   do not have built in multi-path capabilities. This document
   presents a new control protocol to manage traffic steering,
   splitting, and duplicating across multiple connections. The
   solution has been developed by the authors based on their
   experiences in multiple standards bodies including the IETF and
   3GPP, is not an Internet Standard and does not represent the
   consensus opinion of the IETF. This document will enable other
   developers to build interoperable implementations in order to
   experiment with the protocol.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-zhu-intarea-gma-control-00"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-zhu-intarea-gma-control-00.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="IANA" target="https://www.iana.org/assignments/protocol-numbers" quoteTitle="true" derivedAnchor="IANA">
          <front>
            <title>Protocol Numbers</title>
            <author>
              <organization showOnFrontPage="true">IANA</organization>
            </author>
          </front>
        </reference>
        <reference anchor="IANA1999" target="https://web.archive.org/web/19990203044112/http://www.isi.edu:80/in-notes/iana/assignments/protocol-numbers" quoteTitle="false" derivedAnchor="IANA1999">
          <front>
            <title>Wayback Machine archive of "Protocol Numbers"</title>
            <author>
              <organization showOnFrontPage="true">IANA</organization>
            </author>
            <date month="February" year="1999"/>
          </front>
        </reference>
        <reference anchor="LWIPEP" target="https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=3037" quoteTitle="true" derivedAnchor="LWIPEP">
          <front>
            <title>Evolved Universal Terrestrial Radio Access (E-UTRA); LTE-WLAN Radio Level Integration Using Ipsec Tunnel (LWIP) encapsulation; Protocol specification</title>
            <author>
              <organization showOnFrontPage="true">3GPP</organization>
            </author>
            <date month="July" year="2020"/>
          </front>
          <seriesInfo name="3GPP TS" value="36.361"/>
          <refcontent>Release 13</refcontent>
        </reference>
        <reference anchor="RFC8743" target="https://www.rfc-editor.org/info/rfc8743" quoteTitle="true" derivedAnchor="MAMS">
          <front>
            <title>Multiple Access Management Services Multi-Access Management Services (MAMS)</title>
            <author initials="S." surname="Kanugovi" fullname="S. Kanugovi">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Baboescu" fullname="F. Baboescu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Zhu" fullname="J. Zhu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Seo" fullname="S. Seo">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="March"/>
            <abstract>
              <t indent="0">In multiconnectivity scenarios, the clients can simultaneously connect to multiple networks based on different access technologies and network architectures like Wi-Fi, LTE, and DSL.  Both the quality of experience of the users and the overall network utilization and efficiency may be improved through the smart selection and combination of access and core network paths that can dynamically adapt to changing network conditions.</t>
              <t indent="0">This document presents a unified problem statement and introduces a solution for managing multiconnectivity.  The solution has been developed by the authors based on their experiences in multiple standards bodies, including the IETF and the 3GPP.  However, this document is not an Internet Standards Track specification, and it does not represent the consensus opinion of the IETF.</t>
              <t indent="0">This document describes requirements, solution principles, and the architecture of the Multi-Access Management Services (MAMS) framework. The MAMS framework aims to provide best performance while being easy to implement in a wide variety of multiconnectivity deployments.  It specifies the protocol for (1) flexibly selecting the best combination of access and core network paths for the uplink and downlink, and (2) determining the user-plane treatment (e.g., tunneling, encryption) and traffic distribution over the selected links, to ensure network efficiency and the best possible application performance.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8743"/>
          <seriesInfo name="DOI" value="10.17487/RFC8743"/>
        </reference>
        <reference anchor="MPIP" target="https://eeweb.engineering.nyu.edu/faculty/yongliu/docs/MPIP_Tech.pdf" quoteTitle="true" derivedAnchor="MPIP">
          <front>
            <title>Multipath IP Routing on End Devices: Motivation, Design, and Performance</title>
            <author initials="L." surname="Sun" fullname="Liyang Sun"/>
            <author initials="G." surname="Tian" fullname="Guibin Tian"/>
            <author initials="G." surname="Zhu" fullname="Guanyu Zhu"/>
            <author initials="Y." surname="Liu" fullname="Yong Liu"/>
            <author initials="H." surname="Shi" fullname="Hang Shi"/>
            <author initials="D." surname="Dai" fullname="David Dai"/>
            <date year="2017"/>
          </front>
        </reference>
        <reference anchor="RFC0791" target="https://www.rfc-editor.org/info/rfc791" quoteTitle="true" derivedAnchor="RFC0791">
          <front>
            <title>Internet Protocol</title>
            <author initials="J." surname="Postel" fullname="J. Postel">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1981" month="September"/>
          </front>
          <seriesInfo name="STD" value="5"/>
          <seriesInfo name="RFC" value="791"/>
          <seriesInfo name="DOI" value="10.17487/RFC0791"/>
        </reference>
        <reference anchor="RFC8900" target="https://www.rfc-editor.org/info/rfc8900" quoteTitle="true" derivedAnchor="RFC8900">
          <front>
            <title>IP Fragmentation Considered Fragile</title>
            <author initials="R." surname="Bonica" fullname="R. Bonica">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Baker" fullname="F. Baker">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Huston" fullname="G. Huston">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Hinden" fullname="R. Hinden">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Troan" fullname="O. Troan">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Gont" fullname="F. Gont">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="September"/>
            <abstract>
              <t indent="0">This document describes IP fragmentation and explains how it introduces fragility to Internet communication.</t>
              <t indent="0">This document also proposes alternatives to IP fragmentation and provides recommendations for developers and network operators.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="230"/>
          <seriesInfo name="RFC" value="8900"/>
          <seriesInfo name="DOI" value="10.17487/RFC8900"/>
        </reference>
      </references>
    </references>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author initials="J." surname="Zhu" fullname="Jing Zhu">
        <organization showOnFrontPage="true">Intel</organization>
        <address>
          <email>jing.z.zhu@intel.com</email>
        </address>
      </author>
      <author initials="S." surname="Kanugovi" fullname="Satish Kanugovi">
        <organization showOnFrontPage="true">Nokia</organization>
        <address>
          <email>satish.k@nokia.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
