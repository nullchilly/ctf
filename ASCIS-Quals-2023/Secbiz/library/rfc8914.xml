<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-dnsop-extended-error-16" indexInclude="true" ipr="trust200902" number="8914" prepTime="2020-10-23T14:04:43" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dnsop-extended-error-16" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc8914" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="Extended DNS Errors">Extended DNS Errors</title>
    <seriesInfo name="RFC" value="8914" stream="IETF"/>
    <author fullname="Warren Kumari" initials="W." surname="Kumari">
      <organization showOnFrontPage="true">Google</organization>
      <address>
        <postal>
          <street>1600 Amphitheatre Parkway</street>
          <city>Mountain View</city>
          <region>CA</region>
          <code>94043</code>
          <country>United States of America</country>
        </postal>
        <email>warren@kumari.net</email>
      </address>
    </author>
    <author fullname="Evan Hunt" initials="E." surname="Hunt">
      <organization showOnFrontPage="true">ISC</organization>
      <address>
        <postal>
          <street>950 Charter St</street>
          <city>Redwood City</city>
          <region>CA</region>
          <code>94063</code>
          <country>United States of America</country>
        </postal>
        <email>each@isc.org</email>
      </address>
    </author>
    <author fullname="Roy Arends" initials="R." surname="Arends">
      <organization showOnFrontPage="true">ICANN</organization>
      <address>
        <postal>
          <street/>
        </postal>
        <email>roy.arends@icann.org</email>
      </address>
    </author>
    <author fullname="Wes Hardaker" initials="W." surname="Hardaker">
      <organization showOnFrontPage="true">USC/ISI</organization>
      <address>
        <postal>
          <street>P.O. Box 382</street>
          <city>Davis</city>
          <region>CA</region>
          <code>95617</code>
          <country>United States of America</country>
        </postal>
        <email>ietf@hardakers.net</email>
      </address>
    </author>
    <author fullname="David C Lawrence" initials="D." surname="Lawrence">
      <organization showOnFrontPage="true">Salesforce</organization>
      <address>
        <postal>
          <street>415 Mission St</street>
          <city>San Francisco</city>
          <region>CA</region>
          <code>94105</code>
          <country>United States of America</country>
        </postal>
        <email>tale@dd.org</email>
      </address>
    </author>
    <date month="10" year="2020"/>
    <keyword>DNS</keyword>
    <keyword>Error</keyword>
    <keyword>Domain</keyword>
    <keyword>Name</keyword>
    <keyword>System</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">This document defines an extensible method to return
     additional information about the cause of DNS errors. Though
     created primarily to extend SERVFAIL to provide additional
     information about the cause of DNS and DNSSEC failures, the
     Extended DNS Errors option defined in this document allows all
     response types to contain extended error information. Extended
     DNS Error information does not change the processing of RCODEs.</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc8914" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction-and-background">Introduction and Background</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.1.2">
              <li pn="section-toc.1-1.1.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.2.1.1"><xref derivedContent="1.1" format="counter" sectionFormat="of" target="section-1.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-notation">Requirements Notation</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-edns0-op">Extended DNS Error EDNS0 Option Format</xref></t>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-processi">Extended DNS Error Processing</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-defined-extended-dns-errors">Defined Extended DNS Errors</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-0-o">Extended DNS Error Code 0 - Other</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-1-u">Extended DNS Error Code 1 - Unsupported DNSKEY Algorithm</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-2-u">Extended DNS Error Code 2 - Unsupported DS Digest Type</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.4">
                <t indent="0" pn="section-toc.1-1.4.2.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-3-s">Extended DNS Error Code 3 - Stale Answer</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.5">
                <t indent="0" pn="section-toc.1-1.4.2.5.1"><xref derivedContent="4.5" format="counter" sectionFormat="of" target="section-4.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-4-f">Extended DNS Error Code 4 - Forged Answer</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.6">
                <t indent="0" pn="section-toc.1-1.4.2.6.1"><xref derivedContent="4.6" format="counter" sectionFormat="of" target="section-4.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-5-d">Extended DNS Error Code 5 - DNSSEC Indeterminate</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.7">
                <t indent="0" pn="section-toc.1-1.4.2.7.1"><xref derivedContent="4.7" format="counter" sectionFormat="of" target="section-4.7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-6-d">Extended DNS Error Code 6 - DNSSEC Bogus</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.8">
                <t indent="0" pn="section-toc.1-1.4.2.8.1"><xref derivedContent="4.8" format="counter" sectionFormat="of" target="section-4.8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-7-s">Extended DNS Error Code 7 - Signature Expired</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.9">
                <t indent="0" pn="section-toc.1-1.4.2.9.1"><xref derivedContent="4.9" format="counter" sectionFormat="of" target="section-4.9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-8-s">Extended DNS Error Code 8 - Signature Not Yet Valid</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.10">
                <t indent="0" pn="section-toc.1-1.4.2.10.1"><xref derivedContent="4.10" format="counter" sectionFormat="of" target="section-4.10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-9-d">Extended DNS Error Code 9 - DNSKEY Missing</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.11">
                <t indent="0" pn="section-toc.1-1.4.2.11.1"><xref derivedContent="4.11" format="counter" sectionFormat="of" target="section-4.11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-10-">Extended DNS Error Code 10 - RRSIGs Missing</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.12">
                <t indent="0" pn="section-toc.1-1.4.2.12.1"><xref derivedContent="4.12" format="counter" sectionFormat="of" target="section-4.12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-11-">Extended DNS Error Code 11 - No Zone Key Bit Set</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.13">
                <t indent="0" pn="section-toc.1-1.4.2.13.1"><xref derivedContent="4.13" format="counter" sectionFormat="of" target="section-4.13"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-12-">Extended DNS Error Code 12 - NSEC Missing</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.14">
                <t indent="0" pn="section-toc.1-1.4.2.14.1"><xref derivedContent="4.14" format="counter" sectionFormat="of" target="section-4.14"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-13-">Extended DNS Error Code 13 - Cached Error</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.15">
                <t indent="0" pn="section-toc.1-1.4.2.15.1"><xref derivedContent="4.15" format="counter" sectionFormat="of" target="section-4.15"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-14-">Extended DNS Error Code 14 - Not Ready</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.16">
                <t indent="0" pn="section-toc.1-1.4.2.16.1"><xref derivedContent="4.16" format="counter" sectionFormat="of" target="section-4.16"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-15-">Extended DNS Error Code 15 - Blocked</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.17">
                <t indent="0" pn="section-toc.1-1.4.2.17.1"><xref derivedContent="4.17" format="counter" sectionFormat="of" target="section-4.17"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-16-">Extended DNS Error Code 16 - Censored</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.18">
                <t indent="0" pn="section-toc.1-1.4.2.18.1"><xref derivedContent="4.18" format="counter" sectionFormat="of" target="section-4.18"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-17-">Extended DNS Error Code 17 - Filtered</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.19">
                <t indent="0" pn="section-toc.1-1.4.2.19.1"><xref derivedContent="4.19" format="counter" sectionFormat="of" target="section-4.19"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-18-">Extended DNS Error Code 18 - Prohibited</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.20">
                <t indent="0" pn="section-toc.1-1.4.2.20.1"><xref derivedContent="4.20" format="counter" sectionFormat="of" target="section-4.20"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-19-">Extended DNS Error Code 19 - Stale NXDOMAIN Answer</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.21">
                <t indent="0" pn="section-toc.1-1.4.2.21.1"><xref derivedContent="4.21" format="counter" sectionFormat="of" target="section-4.21"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-20-">Extended DNS Error Code 20 - Not Authoritative</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.22">
                <t indent="0" pn="section-toc.1-1.4.2.22.1"><xref derivedContent="4.22" format="counter" sectionFormat="of" target="section-4.22"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-21-">Extended DNS Error Code 21 - Not Supported</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.23">
                <t indent="0" pn="section-toc.1-1.4.2.23.1"><xref derivedContent="4.23" format="counter" sectionFormat="of" target="section-4.23"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-22-">Extended DNS Error Code 22 - No Reachable Authority</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.24">
                <t indent="0" pn="section-toc.1-1.4.2.24.1"><xref derivedContent="4.24" format="counter" sectionFormat="of" target="section-4.24"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-23-">Extended DNS Error Code 23 - Network Error</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.25">
                <t indent="0" pn="section-toc.1-1.4.2.25.1"><xref derivedContent="4.25" format="counter" sectionFormat="of" target="section-4.25"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-dns-error-code-24-">Extended DNS Error Code 24 - Invalid Data</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-a-new-extended-dns-error-co">A New Extended DNS Error Code EDNS Option</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-new-registry-for-extended-d">New Registry for Extended DNS Error Codes</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.7.2">
              <li pn="section-toc.1-1.7.2.1">
                <t indent="0" pn="section-toc.1-1.7.2.1.1"><xref derivedContent="7.1" format="counter" sectionFormat="of" target="section-7.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.7.2.2">
                <t indent="0" pn="section-toc.1-1.7.2.2.1"><xref derivedContent="7.2" format="counter" sectionFormat="of" target="section-7.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="intro" numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction-and-background">Introduction and Background</name>
      <t indent="0" pn="section-1-1">There are many reasons that a DNS query may fail -- some of
     them transient, some permanent; some can be resolved by querying
     another server, some are likely best handled by stopping
     resolution.  Unfortunately, the error signals that a DNS server
     can return are very limited and are not very expressive. This
     means that applications and resolvers often have to "guess" at
     what the issue is, e.g., was the answer marked REFUSED because
     of a lame delegation or because the nameserver is still
     starting up and loading zones? Is a SERVFAIL a DNSSEC validation
     issue, or is the nameserver experiencing some other failure?
     What error messages should be presented to the user or logged
     under these conditions?</t>
      <t indent="0" pn="section-1-2">A good example of issues that would benefit from additional
     error information are errors caused by DNSSEC validation
     issues. When a stub resolver queries a name that is DNSSEC
     bogus <xref target="RFC8499" format="default" sectionFormat="of" derivedContent="RFC8499"/> (using a validating resolver),
     the stub resolver receives only a SERVFAIL in
     response. Unfortunately, the SERVFAIL Response Code (RCODE) is
     used to signal many sorts of DNS errors, and so the stub
     resolver's only option is to ask the next configured DNS
     resolver. The result of trying the next resolver is one of two
     outcomes: either the next resolver also validates and a
     SERVFAIL is returned again or the next resolver is not a
     validating resolver and the user is returned a potentially
     harmful result.  With an Extended DNS Error (EDE) option
     enclosed in the response message, the resolver is able to return
     a more descriptive reason as to why any failures happened or
     add additional context to a message containing a NOERROR
     RCODE.</t>
      <t indent="0" pn="section-1-3">This document specifies a mechanism to extend DNS errors to
     provide additional information about the cause of an error.
     The Extended DNS Error codes described in this document
     can be used by any system that sends DNS queries and receives a
     response containing an EDE option. Different codes are useful
     in different circumstances, and thus different systems (stub
     resolvers, recursive resolvers, and authoritative resolvers)
     might receive and use them.</t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-1.1">
        <name slugifiedName="name-requirements-notation">Requirements Notation</name>
        <t indent="0" pn="section-1.1-1">
   The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
   "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>",
   "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
   "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are
   to be interpreted as described in BCP 14 <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/>
          <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> when, and only when, they appear in all capitals,
   as shown here.
        </t>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-extended-dns-error-edns0-op">Extended DNS Error EDNS0 Option Format</name>
      <t indent="0" pn="section-2-1">This document uses an Extended Mechanism for DNS (EDNS0) <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/> option to include 
     Extended DNS Error (EDE) information in DNS messages. The option
     is structured as follows:</t>
      <artwork align="left" name="" type="" alt="" pn="section-2-2">
                                             1   1   1   1   1   1
     0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
0: |                            OPTION-CODE                        |
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
2: |                           OPTION-LENGTH                       |
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
4: | INFO-CODE                                                     |
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
6: / EXTRA-TEXT ...                                                /
   +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
</artwork>
      <t indent="0" pn="section-2-3"/>
      <t indent="0" pn="section-2-4">Field definition details:</t>
      <dl newline="true" indent="3" spacing="normal" pn="section-2-5">
        <dt pn="section-2-5.1">OPTION-CODE: </dt>
        <dd pn="section-2-5.2">2 octets / 16 bits (defined in <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/>) contains the value 15 for EDE.</dd>
        <dt pn="section-2-5.3">OPTION-LENGTH: </dt>
        <dd pn="section-2-5.4">2 octets / 16 bits (defined in <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/>) contains
         the length of the payload (everything after OPTION-LENGTH)
         in octets and should be 2 plus the length of the EXTRA-TEXT
         field (which may be a zero-length string).</dd>
        <dt pn="section-2-5.5">INFO-CODE:</dt>
        <dd pn="section-2-5.6">16 bits, which is the principal contribution
         of this document.  This 16-bit value, encoded in network
         most significant bit (MSB) byte order, provides the additional context for the
         RESPONSE-CODE of the DNS message. The INFO-CODE serves as an
         index into the "Extended DNS Errors" registry, defined and
         created in <xref target="IANA" format="default" sectionFormat="of" derivedContent="Section 5.2"/>.</dd>
        <dt pn="section-2-5.7">EXTRA-TEXT: </dt>
        <dd pn="section-2-5.8">a variable-length, UTF-8-encoded <xref target="RFC5198" format="default" sectionFormat="of" derivedContent="RFC5198"/> text field that may hold additional 
         textual information. This information is intended for human
         consumption (not automated parsing).  EDE text may be null
         terminated but <bcp14>MUST NOT</bcp14> be assumed to be; the length <bcp14>MUST</bcp14> be
         derived from the OPTION-LENGTH field. The EXTRA-TEXT field
         may be zero octets in length, indicating that there is no
         EXTRA-TEXT included.  Care should be taken not to include
         private information in the EXTRA-TEXT field that an observer
         would not otherwise have access to, such as account
         numbers.</dd>
      </dl>
      <t indent="0" pn="section-2-6">The Extended DNS Error (EDE) option can be included in any
     response (SERVFAIL, NXDOMAIN, REFUSED, even NOERROR, etc.) to
     a query that includes an OPT pseudo-RR <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/>.
     This document includes a set of initial codepoints but is
     extensible via the IANA registry defined and created in <xref target="IANA" format="default" sectionFormat="of" derivedContent="Section 5.2"/>.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-extended-dns-error-processi">Extended DNS Error Processing</name>
      <t indent="0" pn="section-3-1">When the response grows beyond the requestor's UDP payload
     size <xref target="RFC6891" format="default" sectionFormat="of" derivedContent="RFC6891"/>, servers <bcp14>SHOULD</bcp14> truncate messages
     by dropping EDE options before dropping other data from packets.
     Implementations <bcp14>SHOULD</bcp14> set the truncation bit when dropping EDE
     options.  Because long EXTRA-TEXT fields may trigger truncation
     (which is undesirable given the supplemental nature of
     EDE), implementers and operators creating EDE options <bcp14>SHOULD</bcp14>
     avoid lengthy EXTRA-TEXT contents.</t>
      <t indent="0" pn="section-3-2">When a resolver or forwarder receives an EDE option, whether
     or not (and how) to pass along EDE information on to their
     original client is implementation dependent. Implementations <bcp14>MAY</bcp14>
     choose to not forward information, or they <bcp14>MAY</bcp14> choose to create
     a new EDE option(s) that conveys the information encoded in the
     received EDE.  When doing so, the source of the error <bcp14>SHOULD</bcp14> be
     attributed in the EXTRA-TEXT field, since an EDNS0 option
     received by the original client will appear to have come from
     the resolver or forwarder sending it.</t>
      <t indent="0" pn="section-3-3">This document does not allow or prohibit any particular
     extended error codes and information to be matched with any
     particular RCODEs. Some combinations of extended error codes and
     RCODEs may seem nonsensical (such as resolver-specific extended
     error codes received in responses from authoritative servers), so systems
     interpreting the extended error codes <bcp14>MUST NOT</bcp14> assume that a
     combination will make sense.  Receivers <bcp14>MUST</bcp14> be able to accept
     EDE codes and EXTRA-TEXT in all messages, including those with a
     NOERROR RCODE but need not act on them.  Applications <bcp14>MUST</bcp14>
     continue to follow requirements from applicable specifications on how to
     process RCODEs no matter what EDE values are also received.
     Senders <bcp14>MAY</bcp14> include more than one EDE option and receivers <bcp14>MUST</bcp14>
     be able to accept (but not necessarily process or act on)
     multiple EDE options in a DNS message.</t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-defined-extended-dns-errors">Defined Extended DNS Errors</name>
      <t indent="0" pn="section-4-1">This document defines some initial EDE codes. The mechanism
     is intended to be extensible, and additional codepoints can be
     registered in the "Extended DNS Errors" registry (<xref target="IANA" format="default" sectionFormat="of" derivedContent="Section 5.2"/>).  The INFO-CODE from the EDE EDNS option is 
     used to serve as an index into the "Extended DNS Error" IANA
     registry, the initial values for which are defined in the
     following subsections.</t>
      <section anchor="errother" numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-extended-dns-error-code-0-o">Extended DNS Error Code 0 - Other</name>
        <t indent="0" pn="section-4.1-1">The error in question falls into a category that does
	      not match known extended error codes.  Implementations
	      <bcp14>SHOULD</bcp14> include an EXTRA-TEXT value to augment this error
	      code with additional information.</t>
      </section>
      <section anchor="errbaddnskeyalg" numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-extended-dns-error-code-1-u">Extended DNS Error Code 1 - Unsupported DNSKEY Algorithm</name>
        <t indent="0" pn="section-4.2-1">The resolver attempted to perform DNSSEC validation, but a DNSKEY
         RRset contained only unsupported DNSSEC algorithms.</t>
      </section>
      <section anchor="errbaddsdigest" numbered="true" toc="include" removeInRFC="false" pn="section-4.3">
        <name slugifiedName="name-extended-dns-error-code-2-u">Extended DNS Error Code 2 - Unsupported DS Digest Type</name>
        <t indent="0" pn="section-4.3-1">The resolver attempted to perform DNSSEC validation, but a DS
         RRset contained only unsupported Digest Types.</t>
      </section>
      <section anchor="stalenoerror" numbered="true" toc="include" removeInRFC="false" pn="section-4.4">
        <name slugifiedName="name-extended-dns-error-code-3-s">Extended DNS Error Code 3 - Stale Answer</name>
        <t indent="0" pn="section-4.4-1">The resolver was unable to resolve the answer within its
         time limits and decided to answer with previously cached
         data instead of answering with an error.  This is typically
         caused by problems communicating with an authoritative
         server, possibly as result of a denial of service (DoS)
         attack against another network. (See also Code 19.)</t>
      </section>
      <section anchor="forgedanswer" numbered="true" toc="include" removeInRFC="false" pn="section-4.5">
        <name slugifiedName="name-extended-dns-error-code-4-f">Extended DNS Error Code 4 - Forged Answer</name>
        <t indent="0" pn="section-4.5-1">For policy reasons (legal obligation or malware
         filtering, for instance), an answer was forged.  Note that
         this should be used when an answer is still provided, not
         when failure codes are returned instead.  See Blocked (15),
         Censored (16), and Filtered (17) for use when returning
         other response codes.</t>
      </section>
      <section anchor="errindeterminate" numbered="true" toc="include" removeInRFC="false" pn="section-4.6">
        <name slugifiedName="name-extended-dns-error-code-5-d">Extended DNS Error Code 5 - DNSSEC Indeterminate</name>
        <t indent="0" pn="section-4.6-1">The resolver attempted to perform DNSSEC validation, but
         validation ended in the Indeterminate state <xref target="RFC4035" format="default" sectionFormat="of" derivedContent="RFC4035"/>.</t>
      </section>
      <section anchor="errbogus" numbered="true" toc="include" removeInRFC="false" pn="section-4.7">
        <name slugifiedName="name-extended-dns-error-code-6-d">Extended DNS Error Code 6 - DNSSEC Bogus</name>
        <t indent="0" pn="section-4.7-1">The resolver attempted to perform DNSSEC validation, but
         validation ended in the Bogus state.</t>
      </section>
      <section anchor="errexpired" numbered="true" toc="include" removeInRFC="false" pn="section-4.8">
        <name slugifiedName="name-extended-dns-error-code-7-s">Extended DNS Error Code 7 - Signature Expired</name>
        <t indent="0" pn="section-4.8-1">The resolver attempted to perform DNSSEC validation, but
         no signatures are presently valid and some (often all) are
         expired.</t>
      </section>
      <section anchor="errprior" numbered="true" toc="include" removeInRFC="false" pn="section-4.9">
        <name slugifiedName="name-extended-dns-error-code-8-s">Extended DNS Error Code 8 - Signature Not Yet Valid</name>
        <t indent="0" pn="section-4.9-1">The resolver attempted to perform DNSSEC validation, but
         no signatures are presently valid and at least some are
         not yet valid.</t>
      </section>
      <section anchor="errnodnskey" numbered="true" toc="include" removeInRFC="false" pn="section-4.10">
        <name slugifiedName="name-extended-dns-error-code-9-d">Extended DNS Error Code 9 - DNSKEY Missing</name>
        <t indent="0" pn="section-4.10-1">A DS record existed at a parent, but no supported
         matching DNSKEY record could be found for the child.</t>
      </section>
      <section anchor="errnorrsig" numbered="true" toc="include" removeInRFC="false" pn="section-4.11">
        <name slugifiedName="name-extended-dns-error-code-10-">Extended DNS Error Code 10 - RRSIGs Missing</name>
        <t indent="0" pn="section-4.11-1">The resolver attempted to perform DNSSEC validation, but no
         RRSIGs could be found for at least one RRset where RRSIGs were
         expected.</t>
      </section>
      <section anchor="errnozonekey" numbered="true" toc="include" removeInRFC="false" pn="section-4.12">
        <name slugifiedName="name-extended-dns-error-code-11-">Extended DNS Error Code 11 - No Zone Key Bit Set</name>
        <t indent="0" pn="section-4.12-1">The resolver attempted to perform DNSSEC validation, but no Zone
         Key Bit was set in a DNSKEY.</t>
      </section>
      <section anchor="nonsec" numbered="true" toc="include" removeInRFC="false" pn="section-4.13">
        <name slugifiedName="name-extended-dns-error-code-12-">Extended DNS Error Code 12 - NSEC Missing</name>
        <t indent="0" pn="section-4.13-1">The resolver attempted to perform DNSSEC validation, but
         the requested data was missing and a covering NSEC or NSEC3
         was not provided.</t>
      </section>
      <section anchor="cachederror" numbered="true" toc="include" removeInRFC="false" pn="section-4.14">
        <name slugifiedName="name-extended-dns-error-code-13-">Extended DNS Error Code 13 - Cached Error</name>
        <t indent="0" pn="section-4.14-1">The resolver is returning the SERVFAIL RCODE from its cache.</t>
      </section>
      <section anchor="notready" numbered="true" toc="include" removeInRFC="false" pn="section-4.15">
        <name slugifiedName="name-extended-dns-error-code-14-">Extended DNS Error Code 14 - Not Ready</name>
        <t indent="0" pn="section-4.15-1">The server is unable to answer the query, as it was not
         fully functional when the query was received.</t>
      </section>
      <section anchor="errblocked" numbered="true" toc="include" removeInRFC="false" pn="section-4.16">
        <name slugifiedName="name-extended-dns-error-code-15-">Extended DNS Error Code 15 - Blocked</name>
        <t indent="0" pn="section-4.16-1">The server is unable to respond to the request because
         the domain is on a blocklist due to an internal security policy
         imposed by the operator of the server resolving or forwarding
         the query.</t>
      </section>
      <section anchor="errcensored" numbered="true" toc="include" removeInRFC="false" pn="section-4.17">
        <name slugifiedName="name-extended-dns-error-code-16-">Extended DNS Error Code 16 - Censored</name>
        <t indent="0" pn="section-4.17-1">The server is unable to respond to the request because
         the domain is on a blocklist due to an external requirement
         imposed by an entity other than the operator of the server
         resolving or forwarding the query. Note that how the imposed
         policy is applied is irrelevant (in-band DNS filtering,
         court order, etc.).</t>
      </section>
      <section anchor="errfiltered" numbered="true" toc="include" removeInRFC="false" pn="section-4.18">
        <name slugifiedName="name-extended-dns-error-code-17-">Extended DNS Error Code 17 - Filtered</name>
        <t indent="0" pn="section-4.18-1">The server is unable to respond to the request because
         the domain is on a blocklist as requested by the client.
         Functionally, this amounts to "you requested that we filter
         domains like this one."</t>
      </section>
      <section anchor="errprohibted" numbered="true" toc="include" removeInRFC="false" pn="section-4.19">
        <name slugifiedName="name-extended-dns-error-code-18-">Extended DNS Error Code 18 - Prohibited</name>
        <t indent="0" pn="section-4.19-1">An authoritative server or recursive resolver that receives a query from
         an "unauthorized" client can annotate its REFUSED message with this
         code. Examples of "unauthorized" clients are recursive queries from
         IP addresses outside the network, blocklisted IP addresses, local
         policy, etc.</t>
      </section>
      <section anchor="stalenx" numbered="true" toc="include" removeInRFC="false" pn="section-4.20">
        <name slugifiedName="name-extended-dns-error-code-19-">Extended DNS Error Code 19 - Stale NXDOMAIN Answer</name>
        <t indent="0" pn="section-4.20-1">The resolver was unable to resolve an answer within its
         configured time limits and decided to answer with a
         previously cached NXDOMAIN answer instead of answering with
         an error. This may be caused, for example, by problems
         communicating with an authoritative server, possibly as
         result of a denial of service (DoS) attack against another
         network. (See also Code 3.) </t>
      </section>
      <section anchor="errlame" numbered="true" toc="include" removeInRFC="false" pn="section-4.21">
        <name slugifiedName="name-extended-dns-error-code-20-">Extended DNS Error Code 20 - Not Authoritative</name>
        <t indent="0" pn="section-4.21-1">An authoritative server that receives a query with the Recursion
	Desired (RD) bit clear,
        or when it is not configured for recursion for a domain for which it is
        not authoritative, <bcp14>SHOULD</bcp14> include this EDE code in the REFUSED
        response.  A resolver that receives a query with the RD bit clear
        <bcp14>SHOULD</bcp14> include this EDE code in the REFUSED response.</t>
      </section>
      <section anchor="deprecated" numbered="true" toc="include" removeInRFC="false" pn="section-4.22">
        <name slugifiedName="name-extended-dns-error-code-21-">Extended DNS Error Code 21 - Not Supported</name>
        <t indent="0" pn="section-4.22-1">The requested operation or query is not supported.</t>
      </section>
      <section anchor="noreachable" numbered="true" toc="include" removeInRFC="false" pn="section-4.23">
        <name slugifiedName="name-extended-dns-error-code-22-">Extended DNS Error Code 22 - No Reachable Authority</name>
        <t indent="0" pn="section-4.23-1">The resolver could not reach any of the authoritative name servers
         (or they potentially refused to reply).</t>
      </section>
      <section anchor="networkerror" numbered="true" toc="include" removeInRFC="false" pn="section-4.24">
        <name slugifiedName="name-extended-dns-error-code-23-">Extended DNS Error Code 23 - Network Error</name>
        <t indent="0" pn="section-4.24-1">An unrecoverable error occurred while communicating with
         another server.</t>
      </section>
      <section anchor="invaliddata" numbered="true" toc="include" removeInRFC="false" pn="section-4.25">
        <name slugifiedName="name-extended-dns-error-code-24-">Extended DNS Error Code 24 - Invalid Data</name>
        <t indent="0" pn="section-4.25-1">The authoritative server cannot answer with data for
         a zone it is otherwise configured to support.  Examples of
         this include its most recent zone being too old or having
         expired.</t>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-5.1">
        <name slugifiedName="name-a-new-extended-dns-error-co">A New Extended DNS Error Code EDNS Option</name>
        <t indent="0" pn="section-5.1-1">This document defines a new EDNS(0) option, entitled
       "Extended DNS Error", with the assigned value of 15 from the "DNS
       EDNS0 Option Codes (OPT)" registry:
        </t>
        <table anchor="ext-DNS" align="center" pn="table-1">
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1"> Value </th>
              <th align="left" colspan="1" rowspan="1"> Name </th>
              <th align="left" colspan="1" rowspan="1"> Status </th>
              <th align="left" colspan="1" rowspan="1"> Reference </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">15</td>
              <td align="left" colspan="1" rowspan="1">Extended DNS Error</td>
              <td align="left" colspan="1" rowspan="1">Standard</td>
              <td align="left" colspan="1" rowspan="1">RFC 8914</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="IANA" numbered="true" toc="include" removeInRFC="false" pn="section-5.2">
        <name slugifiedName="name-new-registry-for-extended-d">New Registry for Extended DNS Error Codes</name>
        <t indent="0" pn="section-5.2-1">IANA has created and will maintain a new registry
       called "Extended DNS Error Codes" on the "Domain Name
       System (DNS) Parameters" web page as follows:</t>
        <table anchor="reg_proc" align="center" pn="table-2">
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">Range</th>
              <th align="left" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0 - 49151</td>
              <td align="left" colspan="1" rowspan="1">First Come First Served</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">49152 - 65535</td>
              <td align="left" colspan="1" rowspan="1">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-5.2-3">The "Extended DNS Error Codes" registry is a table with
       three columns: INFO-CODE, Purpose, and Reference. The initial
       content is as below.</t>
        <table align="center" pn="table-3">
          <thead>
            <tr>
              <th align="left" colspan="1" rowspan="1">INFO-CODE </th>
              <th align="left" colspan="1" rowspan="1">Purpose </th>
              <th align="left" colspan="1" rowspan="1">Reference </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1"> 0 </td>
              <td align="left" colspan="1" rowspan="1"> Other Error</td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errother" format="default" sectionFormat="of" derivedContent="Section 4.1"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"> 1  </td>
              <td align="center" colspan="1" rowspan="1"> Unsupported DNSKEY Algorithm  </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errbaddnskeyalg" format="default" sectionFormat="of" derivedContent="Section 4.2"/>  </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"> 2  </td>
              <td align="left" colspan="1" rowspan="1">Unsupported DS Digest Type </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errbaddsdigest" format="default" sectionFormat="of" derivedContent="Section 4.3"/>  </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"> 3  </td>
              <td align="left" colspan="1" rowspan="1"> Stale Answer  </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="stalenoerror" format="default" sectionFormat="of" derivedContent="Section 4.4"/> and
   <xref target="RFC8767" format="default" sectionFormat="of" derivedContent="RFC8767"/>  </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"> 4  </td>
              <td align="left" colspan="1" rowspan="1"> Forged Answer  </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="forgedanswer" format="default" sectionFormat="of" derivedContent="Section 4.5"/>  </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"> 5  </td>
              <td align="left" colspan="1" rowspan="1"> DNSSEC Indeterminate  </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errindeterminate" format="default" sectionFormat="of" derivedContent="Section 4.6"/>  </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"> 6  </td>
              <td align="left" colspan="1" rowspan="1">DNSSEC Bogus </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errbogus" format="default" sectionFormat="of" derivedContent="Section 4.7"/>   </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"> 7  </td>
              <td align="left" colspan="1" rowspan="1"> Signature Expired  </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errexpired" format="default" sectionFormat="of" derivedContent="Section 4.8"/>   </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">8 </td>
              <td align="left" colspan="1" rowspan="1">Signature Not Yet Valid </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errprior" format="default" sectionFormat="of" derivedContent="Section 4.9"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">9 </td>
              <td align="left" colspan="1" rowspan="1">DNSKEY Missing </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errnodnskey" format="default" sectionFormat="of" derivedContent="Section 4.10"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">10 </td>
              <td align="left" colspan="1" rowspan="1">RRSIGs Missing </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errnorrsig" format="default" sectionFormat="of" derivedContent="Section 4.11"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">11 </td>
              <td align="left" colspan="1" rowspan="1">No Zone Key Bit Set </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errnozonekey" format="default" sectionFormat="of" derivedContent="Section 4.12"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">12 </td>
              <td align="left" colspan="1" rowspan="1">NSEC Missing </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="nonsec" format="default" sectionFormat="of" derivedContent="Section 4.13"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">13 </td>
              <td align="left" colspan="1" rowspan="1">Cached Error </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="cachederror" format="default" sectionFormat="of" derivedContent="Section 4.14"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">14 </td>
              <td align="left" colspan="1" rowspan="1">Not Ready</td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="notready" format="default" sectionFormat="of" derivedContent="Section 4.15"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">15 </td>
              <td align="left" colspan="1" rowspan="1">Blocked </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errblocked" format="default" sectionFormat="of" derivedContent="Section 4.16"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">16 </td>
              <td align="left" colspan="1" rowspan="1">Censored </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errcensored" format="default" sectionFormat="of" derivedContent="Section 4.17"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">17 </td>
              <td align="left" colspan="1" rowspan="1">Filtered </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errfiltered" format="default" sectionFormat="of" derivedContent="Section 4.18"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">18 </td>
              <td align="left" colspan="1" rowspan="1">Prohibited </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errprohibted" format="default" sectionFormat="of" derivedContent="Section 4.19"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">19 </td>
              <td align="left" colspan="1" rowspan="1">Stale NXDomain Answer </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="stalenx" format="default" sectionFormat="of" derivedContent="Section 4.20"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">20 </td>
              <td align="left" colspan="1" rowspan="1">Not Authoritative </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="errlame" format="default" sectionFormat="of" derivedContent="Section 4.21"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">21 </td>
              <td align="left" colspan="1" rowspan="1">Not Supported </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="deprecated" format="default" sectionFormat="of" derivedContent="Section 4.22"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">22 </td>
              <td align="left" colspan="1" rowspan="1">No Reachable Authority </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="noreachable" format="default" sectionFormat="of" derivedContent="Section 4.23"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">23 </td>
              <td align="left" colspan="1" rowspan="1">Network Error </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="networkerror" format="default" sectionFormat="of" derivedContent="Section 4.24"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">24 </td>
              <td align="left" colspan="1" rowspan="1">Invalid Data </td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="invaliddata" format="default" sectionFormat="of" derivedContent="Section 4.25"/> </td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">25-49151</td>
              <td align="left" colspan="1" rowspan="1">Unassigned</td>
              <td align="left" colspan="1" rowspan="1"/>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">49152-65535</td>
              <td align="left" colspan="1" rowspan="1">Reserved for Private Use</td>
              <td align="left" colspan="1" rowspan="1">
                <xref target="IANA" format="default" sectionFormat="of" derivedContent="Section 5.2"/></td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section anchor="security" numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-6-1">Though DNSSEC continues to be deployed, unfortunately a
     significant number of clients (~11% according to <xref target="GeoffValidation" format="default" sectionFormat="of" derivedContent="GeoffValidation"/>) that receive a SERVFAIL from a
     validating resolver because of a DNSSEC validation issue will
     simply ask the next (potentially non-validating) resolver in
     their list and thus don't get the protections that
     DNSSEC should provide.</t>
      <t indent="0" pn="section-6-2">EDE information is unauthenticated information, unless
     secured by a form of secured DNS transaction, such as <xref target="RFC2845" format="default" sectionFormat="of" derivedContent="RFC2845"/>, <xref target="RFC2931" format="default" sectionFormat="of" derivedContent="RFC2931"/>, <xref target="RFC8094" format="default" sectionFormat="of" derivedContent="RFC8094"/>, or <xref target="RFC8484" format="default" sectionFormat="of" derivedContent="RFC8484"/>. An attacker (e.g., a man in the
     middle (MITM) or malicious
     recursive server) could insert an extended error response into
     untrusted data -- although, ideally, clients and resolvers
     would not trust any unauthenticated information.  As such, EDE
     content should be treated only as diagnostic information and
     <bcp14>MUST NOT</bcp14> alter DNS protocol processing.  Until all DNS answers
     are authenticated via DNSSEC or the other mechanisms mentioned
     above, there are some trade-offs. As an example, an attacker who
     is able to insert the DNSSEC Bogus Extended Error into a DNS
     message could instead simply reply with a fictitious address (A
     or AAAA) record.  Note that DNS RCODEs also
     contain no authentication and can be just as easily manipulated.
      </t>
      <t indent="0" pn="section-6-3">By design, EDE potentially exposes additional information
     via DNS resolution processes that may leak information. 

     An example
     of this is the Prohibited EDE code (18), which may leak the fact
     that the name is on a blocklist.</t>
    </section>
  </middle>
  <back>
    <references pn="section-7">
      <name slugifiedName="name-references">References</name>
      <references pn="section-7.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC4035" target="https://www.rfc-editor.org/info/rfc4035" quoteTitle="true" derivedAnchor="RFC4035">
          <front>
            <title>Protocol Modifications for the DNS Security Extensions</title>
            <author initials="R." surname="Arends" fullname="R. Arends">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Austein" fullname="R. Austein">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Larson" fullname="M. Larson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Massey" fullname="D. Massey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Rose" fullname="S. Rose">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2005" month="March"/>
            <abstract>
              <t indent="0">This document is part of a family of documents that describe the DNS Security Extensions (DNSSEC).  The DNS Security Extensions are a collection of new resource records and protocol modifications that add data origin authentication and data integrity to the DNS.  This document describes the DNSSEC protocol modifications.  This document defines the concept of a signed zone, along with the requirements for serving and resolving by using DNSSEC.  These techniques allow a security-aware resolver to authenticate both DNS resource records and authoritative DNS error indications. </t>
              <t indent="0"> This document obsoletes RFC 2535 and incorporates changes from all updates to RFC 2535.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4035"/>
          <seriesInfo name="DOI" value="10.17487/RFC4035"/>
        </reference>
        <reference anchor="RFC5198" target="https://www.rfc-editor.org/info/rfc5198" quoteTitle="true" derivedAnchor="RFC5198">
          <front>
            <title>Unicode Format for Network Interchange</title>
            <author initials="J." surname="Klensin" fullname="J. Klensin">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Padlipsky" fullname="M. Padlipsky">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2008" month="March"/>
            <abstract>
              <t indent="0">The Internet today is in need of a standardized form for the transmission of internationalized "text" information, paralleling the specifications for the use of ASCII that date from the early days of the ARPANET.  This document specifies that format, using UTF-8 with normalization and specific line-ending sequences.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5198"/>
          <seriesInfo name="DOI" value="10.17487/RFC5198"/>
        </reference>
        <reference anchor="RFC6891" target="https://www.rfc-editor.org/info/rfc6891" quoteTitle="true" derivedAnchor="RFC6891">
          <front>
            <title>Extension Mechanisms for DNS (EDNS(0))</title>
            <author initials="J." surname="Damas" fullname="J. Damas">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Graff" fullname="M. Graff">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="April"/>
            <abstract>
              <t indent="0">The Domain Name System's wire protocol includes a number of fixed fields whose range has been or soon will be exhausted and does not allow requestors to advertise their capabilities to responders.  This document describes backward-compatible mechanisms for allowing the protocol to grow.</t>
              <t indent="0">This document updates the Extension Mechanisms for DNS (EDNS(0)) specification (and obsoletes RFC 2671) based on feedback from deployment experience in several implementations.  It also obsoletes RFC 2673 ("Binary Labels in the Domain Name System") and adds considerations on the use of extended labels in the DNS.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="75"/>
          <seriesInfo name="RFC" value="6891"/>
          <seriesInfo name="DOI" value="10.17487/RFC6891"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8499" target="https://www.rfc-editor.org/info/rfc8499" quoteTitle="true" derivedAnchor="RFC8499">
          <front>
            <title>DNS Terminology</title>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Sullivan" fullname="A. Sullivan">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Fujiwara" fullname="K. Fujiwara">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="January"/>
            <abstract>
              <t indent="0">The Domain Name System (DNS) is defined in literally dozens of different RFCs.  The terminology used by implementers and developers of DNS protocols, and by operators of DNS systems, has sometimes changed in the decades since the DNS was first defined.  This document gives current definitions for many of the terms used in the DNS in a single document.</t>
              <t indent="0">This document obsoletes RFC 7719 and updates RFC 2308.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="219"/>
          <seriesInfo name="RFC" value="8499"/>
          <seriesInfo name="DOI" value="10.17487/RFC8499"/>
        </reference>
        <reference anchor="RFC8767" target="https://www.rfc-editor.org/info/rfc8767" quoteTitle="true" derivedAnchor="RFC8767">
          <front>
            <title>Serving Stale Data to Improve DNS Resiliency</title>
            <author initials="D." surname="Lawrence" fullname="D. Lawrence">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Kumari" fullname="W. Kumari">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Sood" fullname="P. Sood">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="March"/>
            <abstract>
              <t indent="0">This document defines a method (serve-stale) for recursive resolvers to use stale DNS data to avoid outages when authoritative nameservers cannot be reached to refresh expired data. One of the motivations for serve-stale is to make the DNS more resilient to DoS attacks and thereby make them less attractive as an attack vector. This document updates the definitions of TTL from RFCs 1034 and 1035 so that data can be kept in the cache beyond the TTL expiry; it also updates RFC 2181 by interpreting values with the high-order bit set as being positive, rather than 0, and suggests a cap of 7 days.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8767"/>
          <seriesInfo name="DOI" value="10.17487/RFC8767"/>
        </reference>
      </references>
      <references pn="section-7.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="GeoffValidation" target="http://www.potaroo.net/presentations/2016-06-27-dnssec.pdf" quoteTitle="true" derivedAnchor="GeoffValidation">
          <front>
            <title abbrev="Validation today">A quick review of DNSSEC Validation in today's Internet</title>
            <author initials="G" surname="Huston" fullname="Geoff Huston">
              <organization showOnFrontPage="true">APNIC</organization>
            </author>
            <date month="June" year="2016"/>
          </front>
        </reference>
        <reference anchor="RFC2845" target="https://www.rfc-editor.org/info/rfc2845" quoteTitle="true" derivedAnchor="RFC2845">
          <front>
            <title>Secret Key Transaction Authentication for DNS (TSIG)</title>
            <author initials="P." surname="Vixie" fullname="P. Vixie">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="O." surname="Gudmundsson" fullname="O. Gudmundsson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Wellington" fullname="B. Wellington">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2000" month="May"/>
            <abstract>
              <t indent="0">This protocol allows for transaction level authentication using shared secrets and one way hashing.  It can be used to authenticate dynamic updates as coming from an approved client, or to authenticate responses as coming from an approved recursive name server.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2845"/>
          <seriesInfo name="DOI" value="10.17487/RFC2845"/>
        </reference>
        <reference anchor="RFC2931" target="https://www.rfc-editor.org/info/rfc2931" quoteTitle="true" derivedAnchor="RFC2931">
          <front>
            <title>DNS Request and Transaction Signatures ( SIG(0)s )</title>
            <author initials="D." surname="Eastlake 3rd" fullname="D. Eastlake 3rd">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2000" month="September"/>
            <abstract>
              <t indent="0">This document describes the minor but non-interoperable changes in Request and Transaction signature resource records ( SIG(0)s ) that implementation experience has deemed necessary.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="2931"/>
          <seriesInfo name="DOI" value="10.17487/RFC2931"/>
        </reference>
        <reference anchor="RFC8094" target="https://www.rfc-editor.org/info/rfc8094" quoteTitle="true" derivedAnchor="RFC8094">
          <front>
            <title>DNS over Datagram Transport Layer Security (DTLS)</title>
            <author initials="T." surname="Reddy" fullname="T. Reddy">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Wing" fullname="D. Wing">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Patil" fullname="P. Patil">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="February"/>
            <abstract>
              <t indent="0">DNS queries and responses are visible to network elements on the path between the DNS client and its server.  These queries and responses can contain privacy-sensitive information, which is valuable to protect.</t>
              <t indent="0">This document proposes the use of Datagram Transport Layer Security (DTLS) for DNS, to protect against passive listeners and certain active attacks.  As latency is critical for DNS, this proposal also discusses mechanisms to reduce DTLS round trips and reduce the DTLS handshake size.  The proposed mechanism runs over port 853.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8094"/>
          <seriesInfo name="DOI" value="10.17487/RFC8094"/>
        </reference>
        <reference anchor="RFC8484" target="https://www.rfc-editor.org/info/rfc8484" quoteTitle="true" derivedAnchor="RFC8484">
          <front>
            <title>DNS Queries over HTTPS (DoH)</title>
            <author initials="P." surname="Hoffman" fullname="P. Hoffman">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="McManus" fullname="P. McManus">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="October"/>
            <abstract>
              <t indent="0">This document defines a protocol for sending DNS queries and getting DNS responses over HTTPS.  Each DNS query-response pair is mapped into an HTTP exchange.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8484"/>
          <seriesInfo name="DOI" value="10.17487/RFC8484"/>
        </reference>
      </references>
    </references>
    <section numbered="false" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.a-1">The authors wish to thank <contact fullname="Joe Abley"/>, <contact fullname="Mark Andrews"/>, <contact fullname="Tim April"/>, <contact fullname="Vittorio Bertola"/>, <contact fullname="Stephane      Bortzmeyer"/>, <contact fullname="Vladimir Cunat"/>, <contact fullname="Ralph Dolmans"/>, <contact fullname="Peter DeVries"/>,
     <contact fullname="Peter van Dijk"/>, <contact fullname="Mats      Dufberg"/>, <contact fullname="Donald Eastlake"/>, <contact fullname="Bob Harold"/>, <contact fullname="Paul Hoffman"/>, <contact fullname="Geoff Huston"/>, <contact fullname="Shane Kerr"/>, <contact fullname="Edward Lewis"/>, <contact fullname="Carlos M. Martinez"/>,
     <contact fullname="George Michelson"/>, <contact fullname="Eric Orth"/>,
     <contact fullname="Michael Sheldon"/>, <contact fullname="Puneet      Sood"/>, <contact fullname="Petr Spacek"/>, <contact fullname="Ondrej      Sury"/>, <contact fullname="John Todd"/>, <contact fullname="Loganaden      Velvindron"/>, and <contact fullname="Paul Vixie"/>.  They also vaguely
     remember discussing this with a number of people over the years but have
     forgotten who all of them were. Apologies if we forgot to acknowledge
     your contributions.</t>
      <t indent="0" pn="section-appendix.a-2">One author also wants to thank the band Infected Mushroom
     for providing a good background soundtrack. Another author would like to
     thank the band Mushroom Infectors. This was funny at the time
     we wrote it, but we cannot remember why...</t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author fullname="Warren Kumari" initials="W." surname="Kumari">
        <organization showOnFrontPage="true">Google</organization>
        <address>
          <postal>
            <street>1600 Amphitheatre Parkway</street>
            <city>Mountain View</city>
            <region>CA</region>
            <code>94043</code>
            <country>United States of America</country>
          </postal>
          <email>warren@kumari.net</email>
        </address>
      </author>
      <author fullname="Evan Hunt" initials="E." surname="Hunt">
        <organization showOnFrontPage="true">ISC</organization>
        <address>
          <postal>
            <street>950 Charter St</street>
            <city>Redwood City</city>
            <region>CA</region>
            <code>94063</code>
            <country>United States of America</country>
          </postal>
          <email>each@isc.org</email>
        </address>
      </author>
      <author fullname="Roy Arends" initials="R." surname="Arends">
        <organization showOnFrontPage="true">ICANN</organization>
        <address>
          <postal>
            <street/>
          </postal>
          <email>roy.arends@icann.org</email>
        </address>
      </author>
      <author fullname="Wes Hardaker" initials="W." surname="Hardaker">
        <organization showOnFrontPage="true">USC/ISI</organization>
        <address>
          <postal>
            <street>P.O. Box 382</street>
            <city>Davis</city>
            <region>CA</region>
            <code>95617</code>
            <country>United States of America</country>
          </postal>
          <email>ietf@hardakers.net</email>
        </address>
      </author>
      <author fullname="David C Lawrence" initials="D." surname="Lawrence">
        <organization showOnFrontPage="true">Salesforce</organization>
        <address>
          <postal>
            <street>415 Mission St</street>
            <city>San Francisco</city>
            <region>CA</region>
            <code>94105</code>
            <country>United States of America</country>
          </postal>
          <email>tale@dd.org</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
