<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="info" consensus="true" docName="draft-ietf-detnet-mpls-over-tsn-07" indexInclude="true" ipr="trust200902" number="9037" prepTime="2021-06-02T15:29:22" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-detnet-mpls-over-tsn-07" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9037" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="DetNet MPLS over TSN">Deterministic Networking (DetNet) Data Plane: MPLS over IEEE 802.1 Time-Sensitive Networking (TSN)</title>
    <seriesInfo name="RFC" value="9037" stream="IETF"/>
    <author role="editor" fullname="Balázs Varga" initials="B." surname="Varga">
      <organization showOnFrontPage="true">Ericsson</organization>
      <address>
        <postal>
          <street>Magyar Tudosok krt. 11.</street>
          <city>Budapest</city>
          <country>Hungary</country>
          <code>1117</code>
        </postal>
        <email>balazs.a.varga@ericsson.com</email>
      </address>
    </author>
    <author fullname="János Farkas" initials="J." surname="Farkas">
      <organization showOnFrontPage="true">Ericsson</organization>
      <address>
        <postal>
          <street>Magyar Tudosok krt. 11.</street>
          <city>Budapest</city>
          <country>Hungary</country>
          <code>1117</code>
        </postal>
        <email>janos.farkas@ericsson.com</email>
      </address>
    </author>
    <author fullname="Andrew G. Malis" initials="A." surname="Malis">
      <organization showOnFrontPage="true">Malis Consulting</organization>
      <address>
        <email>agmalis@gmail.com</email>
      </address>
    </author>
    <author fullname="Stewart Bryant" initials="S." surname="Bryant">
      <organization showOnFrontPage="true">Futurewei Technologies</organization>
      <address>
        <email>sb@stewartbryant.com</email>
      </address>
    </author>
    <date month="06" year="2021"/>
    <workgroup>DetNet</workgroup>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
     This document specifies the Deterministic Networking (DetNet) MPLS data plane
     when operating over an IEEE 802.1 Time-Sensitive Networking (TSN) 
	 sub-network. This document does not define 
	 new procedures or processes.  Whenever this document makes  
	 statements or recommendations, they are taken from normative text in the 
	 referenced RFCs.
      </t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.  
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841. 
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9037" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-terminology">Terminology</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2">
              <li pn="section-toc.1-1.2.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.1.1"><xref derivedContent="2.1" format="counter" sectionFormat="of" target="section-2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-terms-used-in-this-document">Terms Used in This Document</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.2.1"><xref derivedContent="2.2" format="counter" sectionFormat="of" target="section-2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-abbreviations">Abbreviations</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-detnet-mpls-data-plane-over">DetNet MPLS Data Plane Overview</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-detnet-mpls-operation-over-">DetNet MPLS Operation over IEEE 802.1 TSN Sub-networks</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-functions-for-detnet-flow-t">Functions for DetNet Flow to TSN Stream Mapping</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tsn-requirements-of-mpls-de">TSN Requirements of MPLS DetNet Nodes</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-service-protection-within-t">Service Protection within the TSN Sub-network</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.4">
                <t indent="0" pn="section-toc.1-1.4.2.4.1"><xref derivedContent="4.4" format="counter" sectionFormat="of" target="section-4.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-aggregation-during-detnet-f">Aggregation during DetNet Flow to TSN Stream Mapping</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-management-and-control-impl">Management and Control Implications</xref></t>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.8.2">
              <li pn="section-toc.1-1.8.2.1">
                <t indent="0" pn="section-toc.1-1.8.2.1.1"><xref derivedContent="8.1" format="counter" sectionFormat="of" target="section-8.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.8.2.2">
                <t indent="0" pn="section-toc.1-1.8.2.2.1"><xref derivedContent="8.2" format="counter" sectionFormat="of" target="section-8.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.a"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgements">Acknowledgements</xref></t>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="sec_intro" numbered="true" toc="include" removeInRFC="false" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">
    Deterministic Networking (DetNet) is a service that can be offered by a
    network to DetNet flows.  DetNet provides these flows with low packet loss
    rate and assured maximum end-to-end delivery latency.  General background
    and concepts of DetNet can be found in <xref target="RFC8655" format="default" sectionFormat="of" derivedContent="RFC8655"/>.
      </t>
      <t indent="0" pn="section-1-2">
    The DetNet architecture decomposes DetNet-related data plane
    functions into two sub-layers: a service sub-layer and a forwarding sub-layer.
    The service sub-layer is used to provide DetNet service protection and
    reordering. The forwarding sub-layer is used to provide congestion
    protection (low loss, assured latency, and limited reordering)
    leveraging MPLS Traffic Engineering mechanisms.
      </t>
      <t indent="0" pn="section-1-3">
	<xref target="RFC8964" format="default" sectionFormat="of" derivedContent="RFC8964"/> specifies the DetNet data plane 
	operation for an MPLS-based PSN.  MPLS-encapsulated 
	DetNet flows can be carried over network technologies that can provide the 
	DetNet-required level of service. This document focuses on the scenario 
	where MPLS (DetNet) nodes are interconnected by an IEEE 802.1 TSN sub-network.
	There is close cooperation between the IETF DetNet Working Group and the IEEE 802.1 Time-Sensitive Networking Task Group (TSN TG).
      </t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-2">
      <name slugifiedName="name-terminology">Terminology</name>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.1">
        <name slugifiedName="name-terms-used-in-this-document">Terms Used in This Document</name>
        <t indent="0" pn="section-2.1-1">
   This document uses the terminology established in the DetNet architecture
   <xref target="RFC8655" format="default" sectionFormat="of" derivedContent="RFC8655"/>
          <xref target="RFC8964" format="default" sectionFormat="of" derivedContent="RFC8964"/>.  TSN-specific terms are defined in the TSN TG
		of the IEEE 802.1 Working Group.  The reader is assumed
   to be familiar with these documents and their terminology.
        </t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-2.2">
        <name slugifiedName="name-abbreviations">Abbreviations</name>
        <t indent="0" pn="section-2.2-1">
   The following abbreviations are used in this document:
        </t>
        <dl newline="false" spacing="normal" indent="14" pn="section-2.2-2">
          <dt pn="section-2.2-2.1">A-Label</dt>
          <dd pn="section-2.2-2.2">Aggregation label; a special case of an S-Label.</dd>
          <dt pn="section-2.2-2.3">d-CW</dt>
          <dd pn="section-2.2-2.4">DetNet Control Word</dd>
          <dt pn="section-2.2-2.5">DetNet</dt>
          <dd pn="section-2.2-2.6">Deterministic Networking</dd>
          <dt pn="section-2.2-2.7">F-Label</dt>
          <dd pn="section-2.2-2.8">Forwarding label that identifies the LSP used by a 
	DetNet flow.</dd>
          <dt pn="section-2.2-2.9">FRER</dt>
          <dd pn="section-2.2-2.10">Frame Replication and Elimination for Redundancy 
	(TSN function)</dd>
          <dt pn="section-2.2-2.11">L2</dt>
          <dd pn="section-2.2-2.12">Layer 2</dd>
          <dt pn="section-2.2-2.13">L3</dt>
          <dd pn="section-2.2-2.14">Layer 3</dd>
          <dt pn="section-2.2-2.15">LSP</dt>
          <dd pn="section-2.2-2.16">Label Switched Path</dd>
          <dt pn="section-2.2-2.17">MPLS</dt>
          <dd pn="section-2.2-2.18">Multiprotocol Label Switching</dd>
          <dt pn="section-2.2-2.19">PREOF</dt>
          <dd pn="section-2.2-2.20">Packet Replication, Elimination, and Ordering Functions</dd>
          <dt pn="section-2.2-2.21">PSN</dt>
          <dd pn="section-2.2-2.22">Packet Switched Network</dd>
          <dt pn="section-2.2-2.23">PW</dt>
          <dd pn="section-2.2-2.24">Pseudowire</dd>
          <dt pn="section-2.2-2.25">RSVP-TE</dt>
          <dd pn="section-2.2-2.26">Resource Reservation Protocol - Traffic Engineering</dd>
          <dt pn="section-2.2-2.27">S-Label</dt>
          <dd pn="section-2.2-2.28">Service label</dd>
          <dt pn="section-2.2-2.29">TSN</dt>
          <dd pn="section-2.2-2.30">Time-Sensitive Networking</dd>
        </dl>
      </section>
    </section>
    <section anchor="sec_dt_dp" numbered="true" toc="include" removeInRFC="false" pn="section-3">
      <name slugifiedName="name-detnet-mpls-data-plane-over">DetNet MPLS Data Plane Overview</name>
      <t indent="0" pn="section-3-1">
	The basic approach defined in <xref target="RFC8964" format="default" sectionFormat="of" derivedContent="RFC8964"/>
	supports the DetNet service sub-layer based on existing PW 
	encapsulations and mechanisms and supports the DetNet forwarding 
	sub-layer based on existing MPLS Traffic Engineering encapsulations 
	and mechanisms. 
      </t>
      <t indent="0" pn="section-3-2">
  A node operates on a DetNet flow in the DetNet service sub-layer, i.e., 
  a node processing a DetNet packet that has the service label (S-Label) as the top of stack uses 
  the local context associated with that S-Label, for example, a received 
  forwarding label (F-Label), to determine what local DetNet operation(s) is applied to that 
  packet. An S-Label may be unique when taken from the platform
  label space <xref target="RFC3031" format="default" sectionFormat="of" derivedContent="RFC3031"/>, which would enable correct DetNet flow
  identification regardless of which input interface or LSP the packet arrives 
  on. The service sub-layer functions (i.e., PREOF) use a d-CW.
      </t>
      <t indent="0" pn="section-3-3">
    The DetNet MPLS data plane builds on MPLS Traffic Engineering
    encapsulations and mechanisms to provide a forwarding sub-layer that
    is responsible for providing resource allocation and explicit
    routes.  The forwarding sub-layer is supported by one or more
    F-Labels.
      </t>
      <t indent="0" pn="section-3-4">
        DetNet edge/relay nodes are DetNet service sub-layer-aware,
        understand the particular needs of DetNet flows, and
        provide both DetNet service and forwarding sub-layer functions.
        They add, remove, and process d-CWs, S-Labels, and F-Labels as
        needed.  MPLS DetNet nodes and transit nodes include
        DetNet forwarding sub-layer functions, notable support for 
        explicit routes, and resource allocation to eliminate (or
        reduce) congestion loss and jitter. Unlike other DetNet node types, 
		transit nodes provide no service sub-layer processing.
      </t>
      <t indent="0" pn="section-3-5">
		MPLS (DetNet) nodes and transit nodes interconnected by a TSN 
		sub-network are the primary focus of this document. 
		The mapping of DetNet MPLS flows to TSN Streams and TSN protection 
		mechanisms are covered in <xref target="mpls-over-tsn" format="default" sectionFormat="of" derivedContent="Section 4"/>.
      </t>
    </section>
    <section anchor="mpls-over-tsn" numbered="true" toc="include" removeInRFC="false" pn="section-4">
      <name slugifiedName="name-detnet-mpls-operation-over-">DetNet MPLS Operation over IEEE 802.1 TSN Sub-networks</name>
      <t indent="0" pn="section-4-1">
		The DetNet WG collaborates with IEEE 802.1 TSN in order to define a 
		common architecture for both Layer 2 and Layer 3 that maintains 
		consistency across diverse networks. Both DetNet MPLS and TSN use
		the same techniques to provide their deterministic service:
      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-4-2">
        <li pn="section-4-2.1">
				Service protection
			</li>
        <li pn="section-4-2.2">
				Resource allocation
			</li>
        <li pn="section-4-2.3">
				Explicit routes
			</li>
      </ul>
      <t indent="0" pn="section-4-3">
		As described in the DetNet architecture 
		<xref target="RFC8655" format="default" sectionFormat="of" derivedContent="RFC8655"/>, from the MPLS perspective, a sub-network provides 
	        a single-hop connection between MPLS (DetNet) nodes. 
		Functions used for resource allocation and explicit routes 
		are treated as domain internal functions and do not require function
		interworking across the DetNet MPLS network and the TSN sub-network. 
      </t>
      <t indent="0" pn="section-4-4">
		In the case of the service protection function, due to the similarities of 
		the DetNet PREOF and TSN FRER functions, some level of interworking is 
		possible. However, such interworking is out of scope of this document 
		and left for further study.
      </t>
      <t indent="0" pn="section-4-5">
      <xref target="fig_mpls_detnet_to_tsn" format="default" sectionFormat="of" derivedContent="Figure 1"/> illustrates a scenario where 
	  two MPLS (DetNet) nodes are interconnected by a TSN sub-network. Node-1 
	  is single-homed, and Node-2 is dual-homed to the TSN sub-network.
      </t>
      <figure anchor="fig_mpls_detnet_to_tsn" align="left" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-detnet-enabled-mpls-network">DetNet-Enabled MPLS Network over a TSN Sub-network</name>
        <artwork name="" type="" align="left" alt="" pn="section-4-6.1">
   MPLS (DetNet)                 MPLS (DetNet)
      Node-1                        Node-2

   +----------+                  +----------+
&lt;--| Service* |-- DetNet flow ---| Service* |--&gt;
   +----------+                  +----------+
   |Forwarding|                  |Forwarding|
   +--------.-+    &lt;-TSN Str-&gt;   +-.-----.--+
             \      ,-------.     /     /
              +----[ TSN Sub-]---+     /
                   [ network ]--------+
                    `-------'
&lt;---------------- DetNet MPLS ---------------&gt;

Note: * no service sub-layer required for transit nodes
</artwork>
      </figure>
      <t indent="0" pn="section-4-7">
		At the time of this writing,
		the TSN TG of the IEEE 802.1 
		Working Group have defined (and are defining) a number of amendments 
		to <xref target="IEEE8021Q" format="default" sectionFormat="of" derivedContent="IEEE8021Q"/> that provide zero 
		congestion loss and bounded latency in bridged networks. Furthermore,
		<xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/> defines frame replication
		and elimination functions for reliability that should prove both 
		compatible with and useful to DetNet networks. All these functions 
		have to identify flows that require TSN treatment (i.e., applying TSN 
		functions during forwarding).
      </t>
      <t indent="0" pn="section-4-8">
        TSN capabilities of the TSN sub-network are made available for MPLS
        (DetNet) flows via the protocol interworking function defined in Annex C.5 of 
        <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/>. For example,
        when applied on the TSN edge port, it can convert an ingress unicast 
		MPLS (DetNet) flow to use a specific Layer 2 multicast destination 
		Media Access Control (MAC) address and a VLAN, in order to direct the packet through a 
		specific path inside the bridged network. 
		A similar interworking function pair at the 
		other end of the TSN sub-network would restore the packet to its 
		original Layer 2 destination MAC address and VLAN.
      </t>
      <t indent="0" pn="section-4-9">
        The placement of TSN functions depends on the TSN capabilities of the
        nodes along the path. MPLS (DetNet) nodes may or may not support TSN functions. For
        a given TSN Stream (i.e., DetNet flow), an MPLS (DetNet) node is
        treated as a Talker or a Listener inside the TSN sub-network.
      </t>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.1">
        <name slugifiedName="name-functions-for-detnet-flow-t">Functions for DetNet Flow to TSN Stream Mapping</name>
        <t indent="0" pn="section-4.1-1">
              Mapping of a DetNet MPLS flow to a TSN Stream is provided via 
			  the combination of a passive and an active Stream identification 
			  function that operate at the frame level. The passive Stream
			  identification function is used to catch the MPLS label(s) of a 
			  DetNet MPLS flow, and the active Stream identification function 
			  is used to modify the Ethernet header according to the ID of the 
			  mapped TSN Stream.  
        </t>
        <t indent="0" pn="section-4.1-2">
			  Clause 6.8 of <xref target="IEEEP8021CBdb" format="default" sectionFormat="of" derivedContent="IEEEP8021CBdb"/> defines a
			  Mask-and-Match Stream identification function that can be used 
			  as a passive function for MPLS DetNet flows.
        </t>
        <t indent="0" pn="section-4.1-3">
	      Clause 6.6 of <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/> defines an
              Active Destination MAC and a VLAN Stream identification function
              that can replace some Ethernet header fields, namely (1) the
              destination MAC address, (2) the VLAN-ID, and (3) priority
              parameters with alternate values. Replacement is provided for
              the frame that is passed either down the stack from the upper layers or up the
              stack from the lower layers.
        </t>
        <t indent="0" pn="section-4.1-4">
              Active Destination MAC and VLAN Stream identification can be
              used within a Talker to set flow identity or a Listener to
              recover the original addressing information. It can also be used
              in a TSN bridge that is providing translation as a proxy service
              for an end system. 
        </t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.2">
        <name slugifiedName="name-tsn-requirements-of-mpls-de">TSN Requirements of MPLS DetNet Nodes</name>
        <t indent="0" pn="section-4.2-1">
              This section covers required behavior of a TSN-aware MPLS (DetNet)
			  node using a TSN sub-network. The implementation of TSN packet-processing 
			  functions must be compliant with the relevant IEEE 802.1 
			  standards.
        </t>
        <t indent="0" pn="section-4.2-2">
              From the TSN sub-network perspective, MPLS (DetNet) nodes are treated 
			  as a Talker or Listener, which may be (1) TSN-unaware or 
			  (2) TSN-aware.
        </t>
        <t indent="0" pn="section-4.2-3">
              In cases of TSN-unaware MPLS DetNet nodes, the TSN relay nodes 
			  within the TSN sub-network must modify the Ethernet encapsulation 
			  of the DetNet MPLS flow (e.g., MAC translation, VLAN-ID setting, 
			  sequence number addition, etc.) to allow proper TSN-specific 
			  handling inside the sub-network.  There are no requirements 
			  defined for TSN-unaware MPLS DetNet nodes in this document.
        </t>
        <t indent="0" pn="section-4.2-4">
              MPLS (DetNet) nodes that are TSN-aware can be treated as a
              combination of a TSN-unaware Talker/Listener and a TSN-Relay, as
              shown in <xref target="fig_mpls_with_tsn" format="default" sectionFormat="of" derivedContent="Figure 2"/>.  In such cases, the 
			  MPLS (DetNet) node must provide the TSN sub-network-specific 
			  Ethernet encapsulation over the link(s) towards the sub-network. 
        </t>
        <figure anchor="fig_mpls_with_tsn" align="left" suppress-title="false" pn="figure-2">
          <name slugifiedName="name-mpls-detnet-node-with-tsn-f">MPLS (DetNet) Node with TSN Functions</name>
          <artwork name="" type="" align="left" alt="" pn="section-4.2-5.1">
              MPLS (DetNet)
                  Node
   &lt;----------------------------------&gt;

   +----------+
&lt;--| Service* |-- DetNet flow ------------------
   +----------+
   |Forwarding|
   +----------+    +---------------+
   |    L2    |    | L2 Relay with |&lt;--- TSN ---
   |          |    | TSN function  |    Stream
   +-----.----+    +--.------.---.-+
          \__________/        \   \______
                               \_________
    TSN-unaware
     Talker /          TSN-Bridge
     Listener             Relay
                                       &lt;----- TSN Sub-network -----
   &lt;------- TSN-aware Tlk/Lstn -------&gt;

Note: * no service sub-layer required for transit nodes
</artwork>
        </figure>
        <t indent="0" pn="section-4.2-6">
			  A TSN-aware MPLS (DetNet) node implementation must support the 
			  Stream identification TSN component for recognizing flows.
        </t>
        <t indent="0" pn="section-4.2-7">
              A Stream identification component must be able to instantiate
              the following functions: (1) Active Destination MAC and VLAN
              Stream identification function, 
			  (2) Mask-and-Match Stream identification function, and 
			  (3) the related managed objects in Clause 9 of
              <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/> and 
			  <xref target="IEEEP8021CBdb" format="default" sectionFormat="of" derivedContent="IEEEP8021CBdb"/>.
        </t>
        <t indent="0" pn="section-4.2-8">
			  A TSN-aware MPLS (DetNet) node implementation must support the 
			  Sequencing function and the Sequence encode/decode function as 
			  defined in Clauses 7.4 and 7.6 of <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/> 
			  in order for FRER to be used inside the TSN sub-network.
        </t>
        <t indent="0" pn="section-4.2-9">
              The Sequence encode/decode function must support the Redundancy
              tag (R-TAG) format as per Clause 7.8 of <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/>.
        </t>
        <t indent="0" pn="section-4.2-10">
			  A TSN-aware MPLS (DetNet) node implementation must support the 
			  Stream splitting 
			  function and the Individual recovery function as defined in 
			  Clauses 7.5 and 7.7 of <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/> 
			  in order for that node to be a replication or elimination 
			  point for FRER.
        </t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.3">
        <name slugifiedName="name-service-protection-within-t">Service Protection within the TSN Sub-network</name>
        <t indent="0" pn="section-4.3-1">
              TSN Streams supporting DetNet flows may use FRER as defined in Clause 8 of
			  <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/> based on the
              loss service requirements of the TSN Stream, which is derived
              from the DetNet service requirements of the DetNet mapped flow.
              The specific operation of FRER is not modified by the use of
              DetNet and follows <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/>.
        </t>
        <t indent="0" pn="section-4.3-2">
              FRER function and the provided service recovery is available
              only within the TSN sub-network as the TSN Stream-ID and the TSN
              sequence number are not valid outside the sub-network.  An MPLS
              (DetNet) node represents an L3 border, and as such, it terminates
              all related information elements encoded in the L2 frames.
        </t>
        <t indent="0" pn="section-4.3-3">
			  As the Stream-ID and the TSN sequence number are paired with 
			  similar MPLS flow parameters, FRER can be combined with PREOF 
			  functions. Such service protection interworking scenarios may 
			  require moving sequence number fields among TSN (L2) and PW 
			  (MPLS) encapsulations, and they are left for further study.
        </t>
      </section>
      <section numbered="true" toc="include" removeInRFC="false" pn="section-4.4">
        <name slugifiedName="name-aggregation-during-detnet-f">Aggregation during DetNet Flow to TSN Stream Mapping</name>
        <t indent="0" pn="section-4.4-1">
			Implementation of this document shall use management and
			control information to map a DetNet flow to a TSN
			Stream. N:1 mapping (aggregating DetNet flows in a single
			TSN Stream) shall be supported. The management or control
			function that provisions flow mapping shall ensure that
			adequate resources are allocated and configured to provide
			proper service requirements of the mapped flows.
        </t>
      </section>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-5">
      <name slugifiedName="name-management-and-control-impl">Management and Control Implications</name>
      <t indent="0" pn="section-5-1">
			Information related to DetNet flow and TSN Stream mapping is
			required only for TSN-aware MPLS (DetNet) nodes. From the
			data plane perspective, there is no practical difference
			based on the origin of flow-mapping-related information
			(management plane or control plane).
      </t>
      <t indent="0" pn="section-5-2">
            The following summarizes the set of information that is needed to
            configure DetNet MPLS over TSN:
      </t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-5-3">
        <li pn="section-5-3.1">DetNet MPLS-related configuration information according to the 
			     DetNet role of the DetNet MPLS node, as per 
			     <xref target="RFC8964" format="default" sectionFormat="of" derivedContent="RFC8964"/>. </li>
        <li pn="section-5-3.2">TSN-related configuration information according to the 
			     TSN role of the DetNet MPLS node, as per 
				 <xref target="IEEE8021Q" format="default" sectionFormat="of" derivedContent="IEEE8021Q"/>, <xref target="IEEE8021CB" format="default" sectionFormat="of" derivedContent="IEEE8021CB"/>, and
			     <xref target="IEEEP8021CBdb" format="default" sectionFormat="of" derivedContent="IEEEP8021CBdb"/>. </li>
        <li pn="section-5-3.3">Mapping between a DetNet MPLS flow(s) (label information: 
			  A-Labels, S-Labels, and F-Labels as defined in 
			  <xref target="RFC8964" format="default" sectionFormat="of" derivedContent="RFC8964"/>) and a TSN 
			  Stream(s) (as Stream identification information defined in 
			  <xref target="IEEEP8021CBdb" format="default" sectionFormat="of" derivedContent="IEEEP8021CBdb"/>).
			  Note that managed objects for TSN Stream identification can be 
			  found in <xref target="IEEEP8021CBcv" format="default" sectionFormat="of" derivedContent="IEEEP8021CBcv"/>.			  
			  </li>
      </ul>
      <t indent="0" pn="section-5-4">
            This information must be provisioned per DetNet flow.
      </t>
      <t indent="0" pn="section-5-5">
			Mappings between DetNet and TSN management and control planes are 
			out of scope of this document. Some of the challenges are 
			highlighted below.
      </t>
      <t indent="0" pn="section-5-6">
			TSN-aware MPLS DetNet nodes are members of both the DetNet
			domain and the TSN sub-network.  Within the TSN
			sub-network, the TSN-aware MPLS (DetNet) node has a TSN-aware
			Talker/Listener role, so TSN-specific management and
			control plane functionalities must be implemented.  There
			are many similarities in the management plane techniques
			used in DetNet and TSN, but that is not the case for the
			control plane protocols. For example, RSVP-TE and the
			Multiple Stream Registration Protocol (MSRP)
			behave differently. Therefore, management and control plane
			design are important aspects of scenarios where
			mapping between DetNet and TSN is required.
      </t>
      <t indent="0" pn="section-5-7">
	      In order to use a TSN sub-network between DetNet nodes,
	      DetNet-specific information must be converted to information specific to the TSN
	      sub-network. DetNet flow ID and flow-related
	      parameters/requirements must be converted to a TSN Stream
	      ID and stream-related parameters/requirements.

	      Note that,
	      as the TSN sub-network is just a portion of the end-to-end
	      DetNet path (i.e., a single hop from the MPLS perspective), some
	      parameters (e.g., delay) may differ significantly. Other
	      parameters (like bandwidth) also may have to be tuned due
	      to the L2 encapsulation used within the TSN sub-network.
      </t>
      <t indent="0" pn="section-5-8">
	      In some cases, it may be challenging to determine some TSN-Stream-related
	      information. For example, on a TSN-aware MPLS
	      (DetNet) node that acts as a Talker, it is quite obvious
	      which DetNet node is the Listener of the mapped TSN Stream
	      (i.e., the MPLS next hop). However, it may be not trivial to
	      locate the point/interface where that Listener is
	      connected to the TSN sub-network. Such attributes may
	      require interaction between control and management plane
	      functions and between DetNet and TSN domains.
      </t>
      <t indent="0" pn="section-5-9">
	      Mapping between DetNet flow identifiers and TSN Stream
	      identifiers, if not provided explicitly, can be done by a
	      TSN-aware MPLS (DetNet) node locally based on information
	      provided for configuration of the TSN Stream
	      identification functions (Mask-and-Match Stream identification 
		  and active Stream identification).
      </t>
      <t indent="0" pn="section-5-10">
	      Triggering the setup/modification of a TSN Stream in the
	      TSN sub-network is an example where management and/or
	      control plane interactions are required between the DetNet
	      and TSN sub-network. TSN-unaware MPLS (DetNet) nodes make
	      such a triggering even more complicated as they are fully
	      unaware of the sub-network and run independently.
      </t>
      <t indent="0" pn="section-5-11">
	      Configuration of TSN-specific functions (e.g., FRER)
	      inside the TSN sub-network is a TSN-domain-specific decision 
		  and may not be visible in the DetNet domain. Service protection
		  interworking scenarios are left for further study.
      </t>
    </section>
    <section numbered="true" toc="include" removeInRFC="false" pn="section-6">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-6-1">
	  Security considerations for DetNet are described in detail in
	  <xref target="I-D.ietf-detnet-security" format="default" sectionFormat="of" derivedContent="DETNET-SECURITY"/>. General security considerations
      are described in <xref target="RFC8655" format="default" sectionFormat="of" derivedContent="RFC8655"/>. 
	  Considerations specific to the DetNet MPLS data plane are summarized in 
	  <xref target="RFC8964" format="default" sectionFormat="of" derivedContent="RFC8964"/>. 
	  This section considers exclusively security considerations that are 
	  specific to the DetNet MPLS over TSN sub-network scenario.
      </t>
      <t indent="0" pn="section-6-2">
	  The sub-network between DetNet nodes needs to be subject to appropriate 
	  confidentiality. Additionally, knowledge of what DetNet/TSN services are 
	  provided by a sub-network may supply information that can be used in a 
	  variety of security attacks. The ability to modify information exchanges 
	  between connected DetNet nodes may result in bogus operations. Therefore, 
	  it is important that the interface between DetNet nodes and the TSN 
	  sub-network are subject to authorization, authentication, and encryption.
      </t>
      <t indent="0" pn="section-6-3">
	  The TSN sub-network operates at Layer 2, so various security mechanisms 
	  defined by IEEE can be used to secure the connection between the DetNet 
	  nodes (e.g., encryption may be provided using MACsec 
	  <xref target="IEEE802.1AE-2018" format="default" sectionFormat="of" derivedContent="IEEE802.1AE-2018"/>).
      </t>
    </section>
    <section anchor="iana" numbered="true" toc="include" removeInRFC="false" pn="section-7">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <t indent="0" pn="section-7-1">
      This document has no IANA actions.
      </t>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-detnet-security" to="DETNET-SECURITY"/>
    <references pn="section-8">
      <name slugifiedName="name-references">References</name>
      <references pn="section-8.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="IEEE8021CB" target="https://ieeexplore.ieee.org/document/8091139" quoteTitle="true" derivedAnchor="IEEE8021CB">
          <front>
            <title>IEEE Standard for Local and metropolitan area networks -- Frame Replication and Elimination for Reliability</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="October" year="2017"/>
          </front>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2017.8091139"/>
          <refcontent>IEEE Std 802.1CB-2017</refcontent>
        </reference>
        <reference anchor="IEEEP8021CBdb" target="https://1.ieee802.org/tsn/802-1cbdb/" quoteTitle="true" derivedAnchor="IEEEP8021CBdb">
          <front>
            <title>Draft Standard for Local and metropolitan area networks -- Frame Replication and Elimination for Reliability -- Amendment: Extended Stream Identification Functions</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="April" year="2021"/>
          </front>
          <refcontent>IEEE P802.1CBdb / D1.3</refcontent>
        </reference>
        <reference anchor="RFC3031" target="https://www.rfc-editor.org/info/rfc3031" quoteTitle="true" derivedAnchor="RFC3031">
          <front>
            <title>Multiprotocol Label Switching Architecture</title>
            <author initials="E." surname="Rosen" fullname="E. Rosen">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Viswanathan" fullname="A. Viswanathan">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Callon" fullname="R. Callon">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2001" month="January"/>
            <abstract>
              <t indent="0">This document specifies the architecture for Multiprotocol Label Switching (MPLS).  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3031"/>
          <seriesInfo name="DOI" value="10.17487/RFC3031"/>
        </reference>
        <reference anchor="RFC8655" target="https://www.rfc-editor.org/info/rfc8655" quoteTitle="true" derivedAnchor="RFC8655">
          <front>
            <title>Deterministic Networking Architecture</title>
            <author initials="N." surname="Finn" fullname="N. Finn">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Thubert" fullname="P. Thubert">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Varga" fullname="B. Varga">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Farkas" fullname="J. Farkas">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="October"/>
            <abstract>
              <t indent="0">This document provides the overall architecture for Deterministic Networking (DetNet), which provides a capability to carry specified unicast or multicast data flows for real-time applications with extremely low data loss rates and bounded latency within a network domain.  Techniques used include 1) reserving data-plane resources for individual (or aggregated) DetNet flows in some or all of the intermediate nodes along the path of the flow, 2) providing explicit routes for DetNet flows that do not immediately change with the network topology, and 3) distributing data from DetNet flow packets over time and/or space to ensure delivery of each packet's data in spite of the loss of a path.  DetNet operates at the IP layer and delivers service over lower-layer technologies such as MPLS and Time- Sensitive Networking (TSN) as defined by IEEE 802.1.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8655"/>
          <seriesInfo name="DOI" value="10.17487/RFC8655"/>
        </reference>
        <reference anchor="RFC8964" target="https://www.rfc-editor.org/info/rfc8964" quoteTitle="true" derivedAnchor="RFC8964">
          <front>
            <title>Deterministic Networking (DetNet) Data Plane: MPLS</title>
            <author initials="B." surname="Varga" fullname="B. Varga" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Farkas" fullname="J. Farkas">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Berger" fullname="L. Berger">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Malis" fullname="A. Malis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Bryant" fullname="S. Bryant">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Korhonen" fullname="J. Korhonen">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2021" month="January"/>
            <abstract>
              <t indent="0">This document specifies the Deterministic Networking (DetNet) data plane when operating over an MPLS Packet Switched Network.  It leverages existing pseudowire (PW) encapsulations and MPLS Traffic Engineering (MPLS-TE) encapsulations and mechanisms.  This document builds on the DetNet architecture and data plane framework.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8964"/>
          <seriesInfo name="DOI" value="10.17487/RFC8964"/>
        </reference>
      </references>
      <references pn="section-8.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="I-D.ietf-detnet-security" quoteTitle="true" target="https://tools.ietf.org/html/draft-ietf-detnet-security-16" derivedAnchor="DETNET-SECURITY">
          <front>
            <title>Deterministic Networking (DetNet) Security Considerations</title>
            <author initials="E." surname="Grossman" fullname="Ethan Grossman" role="editor">
              <organization showOnFrontPage="true">Dolby Laboratories, Inc.</organization>
            </author>
            <author initials="T." surname="Mizrahi" fullname="Tal Mizrahi">
              <organization showOnFrontPage="true">Huawei Network.IO Innovation Lab</organization>
            </author>
            <author initials="A." surname="Hacker" fullname="Andrew J. Hacker">
              <organization showOnFrontPage="true">MistIQ Technologies, Inc</organization>
            </author>
            <date month="March" day="2" year="2021"/>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-ietf-detnet-security-16"/>
          <format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-detnet-security-16.txt"/>
          <refcontent>Work in Progress</refcontent>
        </reference>
        <reference anchor="IEEE802.1AE-2018" target="https://ieeexplore.ieee.org/document/8585421" quoteTitle="true" derivedAnchor="IEEE802.1AE-2018">
          <front>
            <title>IEEE Standard for Local and metropolitan area networks-Media Access Control (MAC) Security</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="December" year="2018"/>
          </front>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2018.8585421"/>
          <refcontent>IEEE Std 802.1AE-2018</refcontent>
        </reference>
        <reference anchor="IEEE8021Q" target="https://ieeexplore.ieee.org/document/8403927/" quoteTitle="true" derivedAnchor="IEEE8021Q">
          <front>
            <title>IEEE Standard for Local and metropolitan area networks -- Bridges and Bridged Networks</title>
            <author>
              <organization showOnFrontPage="true">IEEE</organization>
            </author>
            <date month="July" year="2018"/>
          </front>
          <seriesInfo name="DOI" value="10.1109/IEEESTD.2018.8403927"/>
          <refcontent>IEEE Std 802.1Q-2018</refcontent>
        </reference>
        <reference anchor="IEEEP8021CBcv" target="https://1.ieee802.org/tsn/802-1cbcv/" quoteTitle="true" derivedAnchor="IEEEP8021CBcv">
          <front>
            <title>Draft Standard for Local and metropolitan area networks -- Frame Replication and Elimination for Reliability -- Amendment: Information Model, YANG Data Model and Management Information Base Module</title>
            <author>
              <organization showOnFrontPage="true">IEEE 802.1</organization>
            </author>
            <date month="February" year="2021"/>
          </front>
          <refcontent>IEEE P802.1CBcv, Draft 1.1</refcontent>
        </reference>
      </references>
    </references>
    <section anchor="acks" numbered="false" toc="include" removeInRFC="false" pn="section-appendix.a">
      <name slugifiedName="name-acknowledgements">Acknowledgements</name>
      <t indent="0" pn="section-appendix.a-1">
		The authors wish to thank <contact fullname="Norman Finn"/>,  <contact fullname="Lou Berger"/>,  <contact fullname="Craig Gunther"/>,
		 <contact fullname="Christophe Mangin"/>, and  <contact fullname="Jouni Korhonen"/> for their various contributions 
		to this work.
      </t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author role="editor" fullname="Balázs Varga" initials="B." surname="Varga">
        <organization showOnFrontPage="true">Ericsson</organization>
        <address>
          <postal>
            <street>Magyar Tudosok krt. 11.</street>
            <city>Budapest</city>
            <country>Hungary</country>
            <code>1117</code>
          </postal>
          <email>balazs.a.varga@ericsson.com</email>
        </address>
      </author>
      <author fullname="János Farkas" initials="J." surname="Farkas">
        <organization showOnFrontPage="true">Ericsson</organization>
        <address>
          <postal>
            <street>Magyar Tudosok krt. 11.</street>
            <city>Budapest</city>
            <country>Hungary</country>
            <code>1117</code>
          </postal>
          <email>janos.farkas@ericsson.com</email>
        </address>
      </author>
      <author fullname="Andrew G. Malis" initials="A." surname="Malis">
        <organization showOnFrontPage="true">Malis Consulting</organization>
        <address>
          <email>agmalis@gmail.com</email>
        </address>
      </author>
      <author fullname="Stewart Bryant" initials="S." surname="Bryant">
        <organization showOnFrontPage="true">Futurewei Technologies</organization>
        <address>
          <email>sb@stewartbryant.com</email>
        </address>
      </author>
    </section>
  </back>
</rfc>
