<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" category="std" consensus="true" docName="draft-ietf-roll-unaware-leaves-30" indexInclude="true" ipr="trust200902" number="9010" prepTime="2021-04-09T15:15:05" scripts="Common,Latin" sortRefs="true" submissionType="IETF" symRefs="true" tocDepth="3" tocInclude="true" updates="6550, 6775, 8505" xml:lang="en">
  <link href="https://datatracker.ietf.org/doc/draft-ietf-roll-unaware-leaves-30" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9010" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <front>
    <title abbrev="RPL-Unaware Leaves">Routing for RPL (Routing Protocol for Low-Power and Lossy Networks) Leaves</title>
    <seriesInfo name="RFC" value="9010" stream="IETF"/>
    <author initials="P" surname="Thubert" fullname="Pascal Thubert" role="editor">
      <organization abbrev="Cisco Systems" showOnFrontPage="true">Cisco Systems, Inc.</organization>
      <address>
        <postal>
          <street>Building D</street>
          <street>45 Allee des Ormes - BP1200</street>
          <city>MOUGINS - Sophia Antipolis</city>
          <code>06254</code>
          <country>France</country>
        </postal>
        <phone>+33 497 23 26 34</phone>
        <email>pthubert@cisco.com</email>
      </address>
    </author>
    <author fullname="Michael C. Richardson" initials="M." surname="Richardson">
      <organization abbrev="Sandelman" showOnFrontPage="true">Sandelman Software Works</organization>
      <address>
        <email>mcr+ietf@sandelman.ca</email>
        <uri>https://www.sandelman.ca/</uri>
      </address>
    </author>
    <date month="04" year="2021"/>
    <keyword>IPv6</keyword>
    <keyword>ND</keyword>
    <keyword>Redistribution</keyword>
    <abstract pn="section-abstract">
      <t indent="0" pn="section-abstract-1">
  This specification provides a mechanism for a host that implements a 
  routing-agnostic interface based on IPv6 over Low-Power Wireless Personal Area 
  Network (6LoWPAN) Neighbor Discovery to obtain reachability services across a
  network that leverages RFC 6550 for its routing operations. It updates RFCs 6550,
  6775, and 8505.
</t>
    </abstract>
    <boilerplate>
      <section anchor="status-of-memo" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.1">
        <name slugifiedName="name-status-of-this-memo">Status of This Memo</name>
        <t indent="0" pn="section-boilerplate.1-1">
            This is an Internet Standards Track document.
        </t>
        <t indent="0" pn="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.
        </t>
        <t indent="0" pn="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <eref target="https://www.rfc-editor.org/info/rfc9010" brackets="none"/>.
        </t>
      </section>
      <section anchor="copyright" numbered="false" removeInRFC="false" toc="exclude" pn="section-boilerplate.2">
        <name slugifiedName="name-copyright-notice">Copyright Notice</name>
        <t indent="0" pn="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        </t>
        <t indent="0" pn="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<eref target="https://trustee.ietf.org/license-info" brackets="none"/>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        </t>
      </section>
    </boilerplate>
    <toc>
      <section anchor="toc" numbered="false" removeInRFC="false" toc="exclude" pn="section-toc.1">
        <name slugifiedName="name-table-of-contents">Table of Contents</name>
        <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1">
          <li pn="section-toc.1-1.1">
            <t indent="0" keepWithNext="true" pn="section-toc.1-1.1.1"><xref derivedContent="1" format="counter" sectionFormat="of" target="section-1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-introduction">Introduction</xref></t>
          </li>
          <li pn="section-toc.1-1.2">
            <t indent="0" pn="section-toc.1-1.2.1"><xref derivedContent="2" format="counter" sectionFormat="of" target="section-2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-terminology">Terminology</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.2.2">
              <li pn="section-toc.1-1.2.2.1">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.1.1"><xref derivedContent="2.1" format="counter" sectionFormat="of" target="section-2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-language">Requirements Language</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.2">
                <t indent="0" keepWithNext="true" pn="section-toc.1-1.2.2.2.1"><xref derivedContent="2.2" format="counter" sectionFormat="of" target="section-2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-glossary">Glossary</xref></t>
              </li>
              <li pn="section-toc.1-1.2.2.3">
                <t indent="0" pn="section-toc.1-1.2.2.3.1"><xref derivedContent="2.3" format="counter" sectionFormat="of" target="section-2.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-related-documents">Related Documents</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.3">
            <t indent="0" pn="section-toc.1-1.3.1"><xref derivedContent="3" format="counter" sectionFormat="of" target="section-3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rpl-external-routes-and-dat">RPL External Routes and Data-Plane Artifacts</xref></t>
          </li>
          <li pn="section-toc.1-1.4">
            <t indent="0" pn="section-toc.1-1.4.1"><xref derivedContent="4" format="counter" sectionFormat="of" target="section-4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-6lowpan-neighbor-discovery">6LoWPAN Neighbor Discovery</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2">
              <li pn="section-toc.1-1.4.2.1">
                <t indent="0" pn="section-toc.1-1.4.2.1.1"><xref derivedContent="4.1" format="counter" sectionFormat="of" target="section-4.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-address-registration-per-rf">Address Registration per RFC 6775</xref></t>
              </li>
              <li pn="section-toc.1-1.4.2.2">
                <t indent="0" pn="section-toc.1-1.4.2.2.1"><xref derivedContent="4.2" format="counter" sectionFormat="of" target="section-4.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-extended-address-registrati">Extended Address Registration per RFC 8505</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.2.2">
                  <li pn="section-toc.1-1.4.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.1.1"><xref derivedContent="4.2.1" format="counter" sectionFormat="of" target="section-4.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-r-flag">R Flag</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.2.2.2">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.2.1"><xref derivedContent="4.2.2" format="counter" sectionFormat="of" target="section-4.2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-tid-i-field-and-opaque-fiel">TID, "I" Field, and Opaque Field</xref></t>
                  </li>
                  <li pn="section-toc.1-1.4.2.2.2.3">
                    <t indent="0" pn="section-toc.1-1.4.2.2.2.3.1"><xref derivedContent="4.2.3" format="counter" sectionFormat="of" target="section-4.2.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-route-ownership-verifier">Route Ownership Verifier</xref></t>
                  </li>
                </ul>
              </li>
              <li pn="section-toc.1-1.4.2.3">
                <t indent="0" pn="section-toc.1-1.4.2.3.1"><xref derivedContent="4.3" format="counter" sectionFormat="of" target="section-4.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-edar-edac-per-rfc-8505">EDAR/EDAC per RFC 8505</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.4.2.3.2">
                  <li pn="section-toc.1-1.4.2.3.2.1">
                    <t indent="0" pn="section-toc.1-1.4.2.3.2.1.1"><xref derivedContent="4.3.1" format="counter" sectionFormat="of" target="section-4.3.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-capability-indication-optio">Capability Indication Option per RFC 7400</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.5">
            <t indent="0" pn="section-toc.1-1.5.1"><xref derivedContent="5" format="counter" sectionFormat="of" target="section-5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-requirements-for-the-rpl-un">Requirements for the RPL-Unaware Leaf</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.5.2">
              <li pn="section-toc.1-1.5.2.1">
                <t indent="0" pn="section-toc.1-1.5.2.1.1"><xref derivedContent="5.1" format="counter" sectionFormat="of" target="section-5.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-support-of-6lowpan-nd">Support of 6LoWPAN ND</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.2">
                <t indent="0" pn="section-toc.1-1.5.2.2.1"><xref derivedContent="5.2" format="counter" sectionFormat="of" target="section-5.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-support-of-ipv6-encapsulati">Support of IPv6 Encapsulation</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.3">
                <t indent="0" pn="section-toc.1-1.5.2.3.1"><xref derivedContent="5.3" format="counter" sectionFormat="of" target="section-5.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-support-of-the-hop-by-hop-h">Support of the Hop-by-Hop Header</xref></t>
              </li>
              <li pn="section-toc.1-1.5.2.4">
                <t indent="0" pn="section-toc.1-1.5.2.4.1"><xref derivedContent="5.4" format="counter" sectionFormat="of" target="section-5.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-support-of-the-routing-head">Support of the Routing Header</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.6">
            <t indent="0" pn="section-toc.1-1.6.1"><xref derivedContent="6" format="counter" sectionFormat="of" target="section-6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-enhancements-to-rfc-6550">Enhancements to RFC 6550</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.6.2">
              <li pn="section-toc.1-1.6.2.1">
                <t indent="0" pn="section-toc.1-1.6.2.1.1"><xref derivedContent="6.1" format="counter" sectionFormat="of" target="section-6.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-updated-rpl-target-option">Updated RPL Target Option</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.2">
                <t indent="0" pn="section-toc.1-1.6.2.2.1"><xref derivedContent="6.2" format="counter" sectionFormat="of" target="section-6.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-additional-flag-in-the-rpl-">Additional Flag in the RPL DODAG Configuration Option</xref></t>
              </li>
              <li pn="section-toc.1-1.6.2.3">
                <t indent="0" pn="section-toc.1-1.6.2.3.1"><xref derivedContent="6.3" format="counter" sectionFormat="of" target="section-6.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-updated-rpl-status">Updated RPL Status</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.7">
            <t indent="0" pn="section-toc.1-1.7.1"><xref derivedContent="7" format="counter" sectionFormat="of" target="section-7"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-enhancements-to-rfc-9009">Enhancements to RFC 9009</xref></t>
          </li>
          <li pn="section-toc.1-1.8">
            <t indent="0" pn="section-toc.1-1.8.1"><xref derivedContent="8" format="counter" sectionFormat="of" target="section-8"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-enhancements-to-rfcs-6775-a">Enhancements to RFCs 6775 and 8505</xref></t>
          </li>
          <li pn="section-toc.1-1.9">
            <t indent="0" pn="section-toc.1-1.9.1"><xref derivedContent="9" format="counter" sectionFormat="of" target="section-9"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-protocol-operations-for-uni">Protocol Operations for Unicast Addresses</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2">
              <li pn="section-toc.1-1.9.2.1">
                <t indent="0" pn="section-toc.1-1.9.2.1.1"><xref derivedContent="9.1" format="counter" sectionFormat="of" target="section-9.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-general-flow">General Flow</xref></t>
              </li>
              <li pn="section-toc.1-1.9.2.2">
                <t indent="0" pn="section-toc.1-1.9.2.2.1"><xref derivedContent="9.2" format="counter" sectionFormat="of" target="section-9.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-detailed-operation">Detailed Operation</xref></t>
                <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.9.2.2.2">
                  <li pn="section-toc.1-1.9.2.2.2.1">
                    <t indent="0" pn="section-toc.1-1.9.2.2.2.1.1"><xref derivedContent="9.2.1" format="counter" sectionFormat="of" target="section-9.2.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-perspective-of-the-6ln-acti">Perspective of the 6LN Acting as a RUL</xref></t>
                  </li>
                  <li pn="section-toc.1-1.9.2.2.2.2">
                    <t indent="0" pn="section-toc.1-1.9.2.2.2.2.1"><xref derivedContent="9.2.2" format="counter" sectionFormat="of" target="section-9.2.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-perspective-of-the-6lr-acti">Perspective of the 6LR Acting as a Border Router</xref></t>
                  </li>
                  <li pn="section-toc.1-1.9.2.2.2.3">
                    <t indent="0" pn="section-toc.1-1.9.2.2.2.3.1"><xref derivedContent="9.2.3" format="counter" sectionFormat="of" target="section-9.2.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-perspective-of-the-rpl-doda">Perspective of the RPL DODAG Root</xref></t>
                  </li>
                  <li pn="section-toc.1-1.9.2.2.2.4">
                    <t indent="0" pn="section-toc.1-1.9.2.2.2.4.1"><xref derivedContent="9.2.4" format="counter" sectionFormat="of" target="section-9.2.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-perspective-of-the-6lbr">Perspective of the 6LBR</xref></t>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.10">
            <t indent="0" pn="section-toc.1-1.10.1"><xref derivedContent="10" format="counter" sectionFormat="of" target="section-10"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-protocol-operations-for-mul">Protocol Operations for Multicast Addresses</xref></t>
          </li>
          <li pn="section-toc.1-1.11">
            <t indent="0" pn="section-toc.1-1.11.1"><xref derivedContent="11" format="counter" sectionFormat="of" target="section-11"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-security-considerations">Security Considerations</xref></t>
          </li>
          <li pn="section-toc.1-1.12">
            <t indent="0" pn="section-toc.1-1.12.1"><xref derivedContent="12" format="counter" sectionFormat="of" target="section-12"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-iana-considerations">IANA Considerations</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.12.2">
              <li pn="section-toc.1-1.12.2.1">
                <t indent="0" pn="section-toc.1-1.12.2.1.1"><xref derivedContent="12.1" format="counter" sectionFormat="of" target="section-12.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-fixing-the-address-registra">Fixing the Address Registration Option Flags</xref></t>
              </li>
              <li pn="section-toc.1-1.12.2.2">
                <t indent="0" pn="section-toc.1-1.12.2.2.1"><xref derivedContent="12.2" format="counter" sectionFormat="of" target="section-12.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-resizing-the-aro-status-val">Resizing the ARO Status Values</xref></t>
              </li>
              <li pn="section-toc.1-1.12.2.3">
                <t indent="0" pn="section-toc.1-1.12.2.3.1"><xref derivedContent="12.3" format="counter" sectionFormat="of" target="section-12.3"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-new-rpl-dodag-configuration">New RPL DODAG Configuration Option Flag</xref></t>
              </li>
              <li pn="section-toc.1-1.12.2.4">
                <t indent="0" pn="section-toc.1-1.12.2.4.1"><xref derivedContent="12.4" format="counter" sectionFormat="of" target="section-12.4"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-rpl-target-option-flags-reg">RPL Target Option Flags Registry</xref></t>
              </li>
              <li pn="section-toc.1-1.12.2.5">
                <t indent="0" pn="section-toc.1-1.12.2.5.1"><xref derivedContent="12.5" format="counter" sectionFormat="of" target="section-12.5"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-new-subregistry-for-rpl-non">New Subregistry for RPL Non-Rejection Status Values</xref></t>
              </li>
              <li pn="section-toc.1-1.12.2.6">
                <t indent="0" pn="section-toc.1-1.12.2.6.1"><xref derivedContent="12.6" format="counter" sectionFormat="of" target="section-12.6"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-new-subregistry-for-rpl-rej">New Subregistry for RPL Rejection Status Values</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.13">
            <t indent="0" pn="section-toc.1-1.13.1"><xref derivedContent="13" format="counter" sectionFormat="of" target="section-13"/>. <xref derivedContent="" format="title" sectionFormat="of" target="name-references">References</xref></t>
            <ul bare="true" empty="true" indent="2" spacing="compact" pn="section-toc.1-1.13.2">
              <li pn="section-toc.1-1.13.2.1">
                <t indent="0" pn="section-toc.1-1.13.2.1.1"><xref derivedContent="13.1" format="counter" sectionFormat="of" target="section-13.1"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-normative-references">Normative References</xref></t>
              </li>
              <li pn="section-toc.1-1.13.2.2">
                <t indent="0" pn="section-toc.1-1.13.2.2.1"><xref derivedContent="13.2" format="counter" sectionFormat="of" target="section-13.2"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-informative-references">Informative References</xref></t>
              </li>
            </ul>
          </li>
          <li pn="section-toc.1-1.14">
            <t indent="0" pn="section-toc.1-1.14.1"><xref derivedContent="Appendix A" format="default" sectionFormat="of" target="section-appendix.a"/>.  <xref derivedContent="" format="title" sectionFormat="of" target="name-example-compression">Example Compression</xref></t>
          </li>
          <li pn="section-toc.1-1.15">
            <t indent="0" pn="section-toc.1-1.15.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.b"/><xref derivedContent="" format="title" sectionFormat="of" target="name-acknowledgments">Acknowledgments</xref></t>
          </li>
          <li pn="section-toc.1-1.16">
            <t indent="0" pn="section-toc.1-1.16.1"><xref derivedContent="" format="none" sectionFormat="of" target="section-appendix.c"/><xref derivedContent="" format="title" sectionFormat="of" target="name-authors-addresses">Authors' Addresses</xref></t>
          </li>
        </ul>
      </section>
    </toc>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" removeInRFC="false" toc="include" pn="section-1">
      <name slugifiedName="name-introduction">Introduction</name>
      <t indent="0" pn="section-1-1">The design of Low-Power and Lossy Networks (LLNs) is generally focused on
   saving energy, which is the most constrained resource of all. Other design
   constraints, such as a limited memory capacity, duty cycling of the LLN
   devices, and low-power lossy transmissions, derive from that primary concern.
</t>
      <t indent="0" pn="section-1-2">The IETF produced "<xref target="RFC6550" format="title" sectionFormat="of" derivedContent="RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"/>" <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/> to provide routing services for IPv6 <xref target="RFC8200" format="default" sectionFormat="of" derivedContent="RFC8200"/> within such constraints. RPL belongs to the class of
distance-vector protocols -- which, compared to link-state protocols, limit
the amount of topological knowledge that needs to be installed and maintained
in each node -- and does not require convergence to avoid micro-loops.
</t>
      <t indent="0" pn="section-1-3">
   To save signaling and routing state in constrained networks,
   RPL allows a path stretch (see <xref target="RFC6687" format="default" sectionFormat="of" derivedContent="RFC6687"/>), whereby routing
   is only performed along a Destination-Oriented Directed Acyclic Graph (DODAG) that is optimized to reach a root node, as opposed to along the shortest path
   between two peers, whatever that would mean in a given LLN.
   This trades the quality of peer-to-peer (P2P) paths for a vastly reduced
   amount of control traffic and routing state that would be required to
   operate an any-to-any shortest-path protocol. Additionally,
   broken routes may be fixed lazily and on demand, based on data-plane
   inconsistency discovery, which avoids wasting energy in the proactive repair
   of unused paths.

</t>
      <t indent="0" pn="section-1-4">
   For many of the nodes, though not all, the DODAG provides multiple
   forwarding solutions towards the root of the topology via so-called parents.
RPL installs the routes proactively, but to adapt to fuzzy connectivity
-- whereby the physical topology cannot be expected to reach a stable state --
it uses a lazy route maintenance operation that may only fix them reactively, 
upon actual traffic.
   The result is that RPL provides reachability for most of the LLN nodes, most
   of the time, but may not converge in the classical sense.
</t>
      <t indent="0" pn="section-1-5">
   RPL can be deployed in conjunction with IPv6 Neighbor Discovery (ND)
   <xref target="RFC4861" format="default" sectionFormat="of" derivedContent="RFC4861"/> <xref target="RFC4862" format="default" sectionFormat="of" derivedContent="RFC4862"/> and IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) ND
   <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> to maintain reachability
   within a Non-Broadcast Multi-Access (NBMA) multi-link subnet.
</t>
      <t indent="0" pn="section-1-6">
   In that mode, IPv6 addresses are advertised individually as host routes.
   Some nodes may act as routers and participate in the forwarding operations,
   whereas others will only receive/originate packets, acting as hosts in the
   data plane.
   Per the terminology of <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>, an IPv6 host <xref target="RFC8504" format="default" sectionFormat="of" derivedContent="RFC8504"/>
   that is reachable over the RPL network is called a "leaf".
</t>
      <t indent="0" pn="section-1-7">
   <xref target="RFC9008" sectionFormat="of" section="2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9008#section-2" derivedContent="RFC9008"/> defines the terms
   "RPL leaf", "RPL-Aware Leaf" (RAL), and "RPL-Unaware Leaf" (RUL).
   A RPL leaf is a host attached to one or more RPL routers; as such, it
   relies on the RPL router(s) to forward its traffic across the RPL domain but
   does not forward traffic from another node. As opposed to the RAL, the RUL does not
 participate in RPL and relies on its RPL router(s) to also inject the
 routes to its IPv6 addresses in the RPL domain.
</t>
      <t indent="0" pn="section-1-8">
   A RUL may be unable to participate because it is very energy constrained
   or code-space constrained, or because it would be unsafe to let it inject
   routes in RPL. Using 6LoWPAN ND as opposed to RPL as the host-to-router
   interface limits the surface of the possible attacks by the RUL against the
   RPL domain. If all RULs and RPL-Aware Nodes (RANs) use 6LoWPAN ND for the neighbor discovery process, it is
   also possible to protect the address ownership of all nodes, including the
   RULs.
</t>
      <t indent="0" pn="section-1-9">
   This document specifies how the router injects the host routes in the RPL
   domain on behalf of the RUL. <xref target="prereq" format="default" sectionFormat="of" derivedContent="Section 5"/> details how the RUL
   can leverage 6LoWPAN ND to obtain the routing services from the router.
   In that model, the RUL is also a 6LoWPAN Node (6LN) and the RPL-aware router
   is also a 6LoWPAN Router (6LR). Using the 6LoWPAN ND Address Registration
   mechanism, the RUL signals that the router must inject a host route for the
   Registered Address.
</t>
      <figure anchor="injectfig" align="left" suppress-title="false" pn="figure-1">
        <name slugifiedName="name-injecting-routes-on-behalf-">Injecting Routes on Behalf of RULs</name>
        <artwork align="left" pn="section-1-10.1">
         ------+---------
               |          Internet
               |
            +-----+
            |     | &lt;------------- 6LBR / RPL DODAG Root
            +-----+                     ^
               |                        |
         o    o   o  o                  | RPL
     o o   o  o   o  o     o    o       |
    o  o o  o o    o   o  o   o  o      |  +
    o   o      o     o   o   o    o     |
   o  o   o  o   o  o    o    o  o      | 6LoWPAN ND
      o  o  o  o        o   o           |
     o       o            o    o        v
   o      o     o &lt;------------- 6LR / RPL Border Router
                                        ^
                                        | 6LoWPAN ND only
                                        v
                u &lt;------------- 6LN / RPL-Unaware Leaf</artwork>
      </figure>
      <t indent="0" pn="section-1-11">
   The RPL Non-Storing mode mechanism is used to extend the routing state with
   connectivity to the RULs even when the DODAG is operated in Storing mode.
   The unicast packet-forwarding operation by the 6LR serving a RUL is described
   in <xref target="RFC9008" sectionFormat="of" section="4.1.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9008#section-4.1.1" derivedContent="RFC9008"/>.
</t>
      <t indent="0" pn="section-1-12">
   Examples of possible RULs include severely energy-constrained sensors such as
   window smash sensors (alarm system) and kinetically powered light switches.
   Other applications of this specification may include a smart grid network that
   controls appliances -- such as washing machines or the heating system -- in the
   home. Appliances may not participate in the RPL protocol operated in the
   smart grid network but can still interact with the smart grid for control and/or
   metering.
</t>
      <t indent="0" pn="section-1-13">
   This specification can be deployed incrementally in a network that implements
   <xref target="RFC9008" format="default" sectionFormat="of" derivedContent="RFC9008"/>. Only the root and the 6LRs that
   connect the RULs need to be upgraded. The RPL routers on the path will only see
   unicast IPv6 traffic between the root and the 6LR.
</t>
      <t indent="0" pn="section-1-14">
   This document is organized as follows:
</t>
      <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-1-15">
        <li pn="section-1-15.1">
    Sections <xref target="prereqv6" format="counter" sectionFormat="of" derivedContent="3"/> and <xref target="lpnd" format="counter" sectionFormat="of" derivedContent="4"/> present in a
    non-normative fashion the salient aspects of RPL and 6LoWPAN ND,
    respectively, that are leveraged in this specification to provide
    connectivity to a 6LN acting as a RUL across a RPL network.
</li>
        <li pn="section-1-15.2">
          <xref target="prereq" format="default" sectionFormat="of" derivedContent="Section 5"/> lists the requirements that a RUL needs to match
    in order to be served by a RPL router that complies with this specification.
</li>
        <li pn="section-1-15.3">
          <xref target="upd" format="default" sectionFormat="of" derivedContent="Section 6"/> presents the changes made to <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>;
    a new behavior is introduced whereby the 6LR advertises the 6LN's addresses in a RPL Destination Advertisement Object (DAO) message based on the ND registration by the 6LN, and the RPL DODAG root performs the Extended Duplicate Address Request / Extended Duplicate Address Confirmation (EDAR/EDAC) exchange with the 6LoWPAN Border Router (6LBR) on behalf of the 6LR;
    modifications are introduced to some RPL options and to the RPL Status to
    facilitate the integration of the protocols.
</li>
        <li pn="section-1-15.4">
          <xref target="updnpdao" format="default" sectionFormat="of" derivedContent="Section 7"/> presents the changes made to
    <xref target="RFC9009" format="default" sectionFormat="of" derivedContent="RFC9009"/>; the use of the Destination Cleanup Object (DCO) message is extended to the Non-Storing RPL Mode of Operation (MOP) to report asynchronous issues from the root to the 6LR.
</li>
        <li pn="section-1-15.5">
          <xref target="upd2" format="default" sectionFormat="of" derivedContent="Section 8"/> presents the changes made to <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>
    and <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>; the range of the Address Registration Option / Extended Address Registration Option (ARO/EARO) Status values is reduced
    to 64 values, and the remaining bits in the original status field are
    now reserved.
</li>
        <li pn="section-1-15.6">
    Sections <xref target="op" format="counter" sectionFormat="of" derivedContent="9"/> and <xref target="multiop" format="counter" sectionFormat="of" derivedContent="10"/> present the operation of
    this specification for unicast and multicast flows, respectively, and
    <xref target="security-considerations" format="default" sectionFormat="of" derivedContent="Section 11"/> presents associated security
    considerations.
</li>
      </ul>
    </section>
    <section numbered="true" removeInRFC="false" toc="include" pn="section-2">
      <name slugifiedName="name-terminology">Terminology</name>
      <section anchor="bcp" numbered="true" removeInRFC="false" toc="include" pn="section-2.1">
        <name slugifiedName="name-requirements-language">Requirements Language</name>
        <t indent="0" pn="section-2.1-1">The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
   "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>",
   "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>",
   "<bcp14>SHOULD NOT</bcp14>",
   "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
   "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document
   are to be interpreted as described in BCP 14
   <xref target="RFC2119" format="default" sectionFormat="of" derivedContent="RFC2119"/> <xref target="RFC8174" format="default" sectionFormat="of" derivedContent="RFC8174"/> when, and only
   when, they appear in all capitals, as shown here.</t>
      </section>
      <section anchor="gloss" numbered="true" removeInRFC="false" toc="include" pn="section-2.2">
        <name slugifiedName="name-glossary">Glossary</name>
        <t indent="0" pn="section-2.2-1"> This document uses the following abbreviations:
        </t>
        <dl spacing="compact" indent="3" newline="false" pn="section-2.2-2">
          <dt pn="section-2.2-2.1">6BBR:</dt>
          <dd pn="section-2.2-2.2">6LoWPAN Backbone Router</dd>
          <dt pn="section-2.2-2.3">6CIO:</dt>
          <dd pn="section-2.2-2.4">6LoWPAN Capability Indication Option</dd>
          <dt pn="section-2.2-2.5">6LBR:</dt>
          <dd pn="section-2.2-2.6">6LoWPAN Border Router</dd>
          <dt pn="section-2.2-2.7">6LN:</dt>
          <dd pn="section-2.2-2.8">6LoWPAN Node (a low-power host or router)</dd>
          <dt pn="section-2.2-2.9">6LoRH:</dt>
          <dd pn="section-2.2-2.10">6LoWPAN Routing Header</dd>
          <dt pn="section-2.2-2.11">6LoWPAN:</dt>
          <dd pn="section-2.2-2.12">IPv6 over Low-Power Wireless Personal Area Network</dd>
          <dt pn="section-2.2-2.13">6LR:</dt>
          <dd pn="section-2.2-2.14">6LoWPAN Router</dd>
          <dt pn="section-2.2-2.15">AP-ND:</dt>
          <dd pn="section-2.2-2.16">Address-Protected Neighbor Discovery</dd>
          <dt pn="section-2.2-2.17">ARO:</dt>
          <dd pn="section-2.2-2.18">Address Registration Option</dd>
          <dt pn="section-2.2-2.19">DAC:</dt>
          <dd pn="section-2.2-2.20">Duplicate Address Confirmation</dd>
          <dt pn="section-2.2-2.21">DAD:</dt>
          <dd pn="section-2.2-2.22">Duplicate Address Detection</dd>
          <dt pn="section-2.2-2.23">DAO:</dt>
          <dd pn="section-2.2-2.24">Destination Advertisement Object (a RPL message)</dd>
          <dt pn="section-2.2-2.25">DAR:</dt>
          <dd pn="section-2.2-2.26">Duplicate Address Request</dd>
          <dt pn="section-2.2-2.27">DCO:</dt>
          <dd pn="section-2.2-2.28">Destination Cleanup Object (a RPL message)</dd>
          <dt pn="section-2.2-2.29">DIO:</dt>
          <dd pn="section-2.2-2.30">DODAG Information Object (a RPL message)</dd>
          <dt pn="section-2.2-2.31">DODAG:</dt>
          <dd pn="section-2.2-2.32">Destination-Oriented Directed Acyclic Graph</dd>
          <dt pn="section-2.2-2.33">EARO:</dt>
          <dd pn="section-2.2-2.34">Extended Address Registration Option</dd>
          <dt pn="section-2.2-2.35">EDAC:</dt>
          <dd pn="section-2.2-2.36">Extended Duplicate Address Confirmation</dd>
          <dt pn="section-2.2-2.37">EDAR:</dt>
          <dd pn="section-2.2-2.38">Extended Duplicate Address Request</dd>
          <dt pn="section-2.2-2.39">EUI:</dt>
          <dd pn="section-2.2-2.40">Extended Unique Identifier</dd>
          <dt pn="section-2.2-2.41">LLN:</dt>
          <dd pn="section-2.2-2.42">Low-Power and Lossy Network</dd>
          <dt pn="section-2.2-2.43">MLD:</dt>
          <dd pn="section-2.2-2.44">Multicast Listener Discovery</dd>
          <dt pn="section-2.2-2.45">MOP:</dt>
          <dd pn="section-2.2-2.46">RPL Mode of Operation</dd>
          <dt pn="section-2.2-2.47">NA:</dt>
          <dd pn="section-2.2-2.48">Neighbor Advertisement</dd>
          <dt pn="section-2.2-2.49">NBMA:</dt>
          <dd pn="section-2.2-2.50">Non-Broadcast Multi-Access</dd>
          <dt pn="section-2.2-2.51">NCE:</dt>
          <dd pn="section-2.2-2.52">Neighbor Cache Entry</dd>
          <dt pn="section-2.2-2.53">ND:</dt>
          <dd pn="section-2.2-2.54">Neighbor Discovery</dd>
          <dt pn="section-2.2-2.55">NS:</dt>
          <dd pn="section-2.2-2.56">Neighbor Solicitation</dd>
          <dt pn="section-2.2-2.57">PIO:</dt>
          <dd pn="section-2.2-2.58">Prefix Information Option</dd>
          <dt pn="section-2.2-2.59">RA:</dt>
          <dd pn="section-2.2-2.60">Router Advertisement</dd>
          <dt pn="section-2.2-2.61">RAL:</dt>
          <dd pn="section-2.2-2.62">RPL-Aware Leaf</dd>
          <dt pn="section-2.2-2.63">RAN:</dt>
          <dd pn="section-2.2-2.64">RPL-Aware Node (either a RPL router or a RPL-Aware Leaf)</dd>
          <dt pn="section-2.2-2.65">RH3:</dt>
          <dd pn="section-2.2-2.66">Routing Header for IPv6 (type 3)</dd>
          <dt pn="section-2.2-2.67">ROVR:</dt>
          <dd pn="section-2.2-2.68">Registration Ownership Verifier</dd>
          <dt pn="section-2.2-2.69">RPI:</dt>
          <dd pn="section-2.2-2.70">RPL Packet Information</dd>
          <dt pn="section-2.2-2.71">RPL:</dt>
          <dd pn="section-2.2-2.72">Routing Protocol for Low-Power and Lossy Networks</dd>
          <dt pn="section-2.2-2.73">RUL:</dt>
          <dd pn="section-2.2-2.74">RPL-Unaware Leaf</dd>
          <dt pn="section-2.2-2.75">SAVI:</dt>
          <dd pn="section-2.2-2.76">Source Address Validation Improvement</dd>
          <dt pn="section-2.2-2.77">SLAAC:</dt>
          <dd pn="section-2.2-2.78">Stateless Address Autoconfiguration</dd>
          <dt pn="section-2.2-2.79">SRH:</dt>
          <dd pn="section-2.2-2.80">Source Routing Header</dd>
          <dt pn="section-2.2-2.81">TID:</dt>
          <dd pn="section-2.2-2.82">Transaction ID (a sequence counter in the EARO)</dd>
          <dt pn="section-2.2-2.83">TIO:</dt>
          <dd pn="section-2.2-2.84">Transit Information Option</dd>
        </dl>
      </section>
      <section anchor="lo" numbered="true" removeInRFC="false" toc="include" pn="section-2.3">
        <name slugifiedName="name-related-documents">Related Documents</name>
        <t indent="0" pn="section-2.3-1">
   The terminology used in this document is consistent with, and incorporates
   the terms provided in, "<xref target="RFC7102" format="title" sectionFormat="of" derivedContent="Terms Used in Routing for Low-Power and Lossy Networks"/>" <xref target="RFC7102" format="default" sectionFormat="of" derivedContent="RFC7102"/>. A glossary of classical 6LoWPAN abbreviations is given in <xref target="gloss" format="default" sectionFormat="of" derivedContent="Section 2.2"/>.
   Other terms in use in LLNs are found in "<xref target="RFC7228" format="title" sectionFormat="of" derivedContent="Terminology for Constrained-Node Networks"/>" <xref target="RFC7228" format="default" sectionFormat="of" derivedContent="RFC7228"/>.
   This specification uses the terms "6LN" and "6LR" to refer specifically to nodes
   that implement the 6LN and 6LR roles in 6LoWPAN ND and does not expect other
   functionality such as 6LoWPAN Header Compression <xref target="RFC6282" format="default" sectionFormat="of" derivedContent="RFC6282"/>
   from those nodes.
</t>
        <t indent="0" pn="section-2.3-2">"RPL", "RPI", "RPL Instance" (indexed by a
   RPLInstanceID), "up", and "down" are defined in "<xref target="RFC6550" format="title" sectionFormat="of" derivedContent="RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"/>" <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>. The RPI is the abstract
   information that RPL defines to be placed in data packets, e.g., as the RPL
   Option <xref target="RFC6553" format="default" sectionFormat="of" derivedContent="RFC6553"/> within the IPv6 Hop-By-Hop Header.
   By extension, the term "RPI" is often used to refer to the RPL Option itself.
   The DAO and DIO messages are also specified in
   <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>. The DCO message is defined in <xref target="RFC9009" format="default" sectionFormat="of" derivedContent="RFC9009"/>.
</t>
        <t indent="0" pn="section-2.3-3">

   This document uses the terms "RUL", "RAN", and "RAL" consistently with <xref target="RFC9008" format="default" sectionFormat="of" derivedContent="RFC9008"/>.
   A RAN is either a RAL or a RPL router. As opposed to a RUL, a RAN manages
   the reachability of its addresses and prefixes by injecting them in RPL by
   itself.
</t>
        <t indent="0" pn="section-2.3-4">
        In this document, readers will encounter terms and concepts
        that are discussed in the following documents:
        </t>
        <dl indent="3" newline="false" spacing="normal" pn="section-2.3-5">
          <dt pn="section-2.3-5.1">Classical IPv6 ND:</dt>
          <dd pn="section-2.3-5.2">"<xref target="RFC4861" format="title" sectionFormat="of" derivedContent="Neighbor Discovery for IP version 6 (IPv6)"/>" <xref target="RFC4861" format="default" sectionFormat="of" derivedContent="RFC4861"/> and
        "<xref target="RFC4862" format="title" sectionFormat="of" derivedContent="IPv6 Stateless Address Autoconfiguration"/>" <xref target="RFC4862" format="default" sectionFormat="of" derivedContent="RFC4862"/>,</dd>
          <dt pn="section-2.3-5.3">6LoWPAN:</dt>
          <dd pn="section-2.3-5.4">"<xref target="RFC6606" format="title" sectionFormat="of" derivedContent="Problem Statement and Requirements for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing"/>" <xref target="RFC6606" format="default" sectionFormat="of" derivedContent="RFC6606"/> and "<xref target="RFC4919" format="title" sectionFormat="of" derivedContent="IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"/>" <xref target="RFC4919" format="default" sectionFormat="of" derivedContent="RFC4919"/>, and</dd>
          <dt pn="section-2.3-5.5">6LoWPAN ND:</dt>
          <dd pn="section-2.3-5.6">"<xref target="RFC6775" format="title" sectionFormat="of" derivedContent="Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"/>" <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>,
        "<xref target="RFC8505" format="title" sectionFormat="of" derivedContent="Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"/>" <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>,
        "<xref target="RFC8928" format="title" sectionFormat="of" derivedContent="Address-Protected Neighbor Discovery for Low-Power and Lossy Networks"/>" <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/>, and "<xref target="RFC8929" format="title" sectionFormat="of" derivedContent="IPv6 Backbone Router"/>" <xref target="RFC8929" format="default" sectionFormat="of" derivedContent="RFC8929"/>.</dd>
        </dl>
      </section>
    </section>
    <section anchor="prereqv6" numbered="true" removeInRFC="false" toc="include" pn="section-3">
      <name slugifiedName="name-rpl-external-routes-and-dat">RPL External Routes and Data-Plane Artifacts</name>
      <t indent="0" pn="section-3-1">
   RPL was initially designed to build stub networks whereby the only border
   router would be the RPL DODAG root (typically co-located with the 6LBR) and all
   the nodes in the stub would be RPL aware. But <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/> was also prepared to be extended for external routes ("targets" in RPL parlance), via
   the External ('E') flag in the Transit Information Option (TIO).
   External targets provide the ability to reach destinations that are outside the RPL domain
   and connected to the RPL domain via RPL border routers that are not the root.
   <xref target="RFC9008" sectionFormat="of" section="4.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9008#section-4.1" derivedContent="RFC9008"/> provides a set of
   rules (summarized below) that must be followed for routing packets to and from
   an external destination. A RUL is a special case of an external target that
   is also a host directly connected to the RPL domain.
</t>
      <t indent="0" pn="section-3-2">
   A 6LR that acts as a border router for external routes advertises them using
   Non-Storing mode DAO messages that are unicast directly to the root, even if
   the DODAG is operated in Storing mode.
   Non-Storing mode routes are not visible inside the RPL domain, and all packets
   are routed via the root. The RPL DODAG root tunnels the data packets directly to the
   6LR that advertised the external route, which decapsulates and forwards the
   original (inner) packets.
</t>
      <t indent="0" pn="section-3-3">
   The RPL Non-Storing MOP signaling and the associated IPv6-in-IPv6 encapsulated
   packets appear as normal traffic to the intermediate routers. Support
   of external routes only impacts the root and the 6LR. It can be operated with
   legacy intermediate routers and does not add to the amount of state that must
   be maintained in those routers.
   A RUL is an example of a destination that is reachable via an external route
   that happens to also be a host route.
</t>
      <t indent="0" pn="section-3-4">
   The RPL data packets typically carry a Hop-by-Hop Header with a RPL Option
   <xref target="RFC6553" format="default" sectionFormat="of" derivedContent="RFC6553"/> that contains the RPI (the RPL Packet Information, as defined
   in <xref target="RFC6550" sectionFormat="of" section="11.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-11.2" derivedContent="RFC6550"/>).
   Unless the RUL already placed a RPL Option in the outer header chain, the packets
   from and to the RUL are encapsulated using an IPv6-in-IPv6 tunnel between the
   root and the 6LR that serves the RUL
   (see Sections <xref target="RFC9008" section="7" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9008#section-7" derivedContent="RFC9008"/> and <xref target="RFC9008" section="8" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9008#section-8" derivedContent="RFC9008"/> of <xref target="RFC9008" format="default" sectionFormat="of" derivedContent="RFC9008"/> for details).
   If the packet from the RUL has an RPI, the 6LR acting as a RPL border router
   rewrites the RPI to indicate the selected RPL Instance and set the flags,
   but it does not need to encapsulate the packet (see <xref target="lr" format="default" sectionFormat="of" derivedContent="Section 9.2.2"/>).
</t>
      <t indent="0" pn="section-3-5">
   In Non-Storing mode, packets going down the DODAG carry a Source Routing Header (SRH).  The IPv6-in-IPv6 encapsulation, the RPI, and the SRH are collectively called the
   "RPL artifacts" and can be compressed using the method defined in <xref target="RFC8138" format="default" sectionFormat="of" derivedContent="RFC8138"/>.
   <xref target="u8138" format="default" sectionFormat="of" derivedContent="Appendix A"/> presents an example compressed format for a packet
   forwarded by the root to a RUL in a Storing mode DODAG.
</t>
      <t indent="0" pn="section-3-6">
   The inner packet that is forwarded to the RUL may carry some RPL artifacts,
   e.g., an RPI if the original packet was generated with it, and an SRH in a
   Non-Storing mode DODAG.
   <xref target="RFC9008" format="default" sectionFormat="of" derivedContent="RFC9008"/> expects the RUL to support the
   basic IPv6 node requirements per <xref target="RFC8504" format="default" sectionFormat="of" derivedContent="RFC8504"/> and, in particular,
   the mandates in Sections <xref target="RFC8200" section="4.2" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8200#section-4.2" derivedContent="RFC8200"/> and <xref target="RFC8200" section="4.4" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8200#section-4.4" derivedContent="RFC8200"/> of <xref target="RFC8200" format="default" sectionFormat="of" derivedContent="RFC8200"/>. As such,
   the RUL is expected to ignore the RPL artifacts that may be left over -- either
   an SRH whose Segments Left is zero or a RPL Option in the Hop-by-Hop Header
   (which can be skipped when not recognized; see <xref target="prereqv6hh" format="default" sectionFormat="of" derivedContent="Section 5.3"/> for
   details).
</t>
      <t indent="0" pn="section-3-7">
   A RUL is not expected to support the compression method defined in
   <xref target="RFC8138" format="default" sectionFormat="of" derivedContent="RFC8138"/>. For that reason, the border router (the 6LR here)
   uncompresses the packet before forwarding it over an external route to a RUL
   <xref target="RFC9008" format="default" sectionFormat="of" derivedContent="RFC9008"/>.
</t>
    </section>
    <section anchor="lpnd" numbered="true" removeInRFC="false" toc="include" pn="section-4">
      <name slugifiedName="name-6lowpan-neighbor-discovery">6LoWPAN Neighbor Discovery</name>
      <t indent="0" pn="section-4-1">
This section goes through the 6LoWPAN ND mechanisms that this specification leverages, as a non-normative reference to the reader.
The full normative text is to be found in <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>, and <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/>.
</t>
      <section anchor="R6775" numbered="true" removeInRFC="false" toc="include" pn="section-4.1">
        <name slugifiedName="name-address-registration-per-rf">Address Registration per RFC 6775</name>
        <t indent="0" pn="section-4.1-1">
   The classical IPv6 Neighbor Discovery (IPv6 ND) protocol
   <xref target="RFC4861" format="default" sectionFormat="of" derivedContent="RFC4861"/> <xref target="RFC4862" format="default" sectionFormat="of" derivedContent="RFC4862"/> was defined for serial
   links and transit media such as Ethernet. It is a reactive protocol that
   relies heavily on multicast operations for Address Discovery (aka address lookup) and
   Duplicate Address Detection (DAD).
</t>
        <t indent="0" pn="section-4.1-2">
   "<xref target="RFC6775" format="title" sectionFormat="of" derivedContent="Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"/>" <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>
   adapts IPv6 ND for operations over energy-constrained LLNs.
   The main functions of <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> are to proactively establish
   the Neighbor Cache Entry (NCE) in the 6LR and to prevent address duplication.
   To that effect, <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> introduces a unicast Address
   Registration mechanism that contributes to reducing the use of multicast
   messages compared to the classical IPv6 ND protocol.
</t>
        <t indent="0" pn="section-4.1-3"><xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> also introduces the Address
   Registration Option (ARO), which is carried in the unicast
   Neighbor Solicitation (NS) and Neighbor Advertisement (NA) messages between
   the 6LoWPAN Node (6LN) and the 6LoWPAN router (6LR).

   It also defines the Duplicate Address Request (DAR) and Duplicate
   Address Confirmation (DAC) messages between the 6LR and the 6LBR).
   In an LLN, the 6LBR is the central repository of all the Registered Addresses
   in its domain and the source of truth for uniqueness and ownership.
</t>
      </section>
      <section anchor="R8505E" numbered="true" removeInRFC="false" toc="include" pn="section-4.2">
        <name slugifiedName="name-extended-address-registrati">Extended Address Registration per RFC 8505</name>
        <t indent="0" pn="section-4.2-1">
   "<xref target="RFC8505" format="title" sectionFormat="of" derivedContent="Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"/>" <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>
   updates RFC 6775 with a generic Address Registration mechanism that can be
   used to access services such as routing and ND proxy functions. To that effect,
   <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> defines the Extended Address Registration Option
   (EARO), as shown in <xref target="EARO" format="default" sectionFormat="of" derivedContent="Figure 2"/>:
</t>
        <figure anchor="EARO" align="left" suppress-title="false" pn="figure-2">
          <name slugifiedName="name-earo-format">EARO Format</name>
          <artwork align="center" pn="section-4.2-2.1">   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |     Length    |    Status     |    Opaque     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |  Rsvd | I |R|T|     TID       |     Registration Lifetime     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...          Registration Ownership Verifier (ROVR)             ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</artwork>
        </figure>
        <section anchor="R8505ER" numbered="true" removeInRFC="false" toc="include" pn="section-4.2.1">
          <name slugifiedName="name-r-flag">R Flag</name>
          <t indent="0" pn="section-4.2.1-1">
<xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> introduces the R flag in the EARO.
   The Registering Node sets the R flag to indicate whether the 6LR should
   ensure reachability for the Registered Address.
   If the R flag is set to 0, then the Registering Node handles the reachability
   of the Registered Address by other means. In a RPL network, this means that
   either it is a RAN that injects the route by itself or it uses another
   RPL router for reachability services.
</t>
          <t indent="0" pn="section-4.2.1-2">
   This document specifies how the R flag is used in the context of RPL.
   A RPL leaf that implements the 6LN functionality from <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>
   requires reachability services for an IPv6 address if and only if it sets
   the R flag in the NS(EARO) used to register the address to a 6LR acting as
   a RPL border router. Upon receiving the NS(EARO), the RPL router
   generates a DAO message for the Registered Address if and only if the R
   flag is set to 1.
</t>
          <t indent="0" pn="section-4.2.1-3">
   <xref target="oper" format="default" sectionFormat="of" derivedContent="Section 9.2"/> specifies additional operations when the R flag is set to 1 in an EARO that is placed in either an NS message or an NA message.
</t>
        </section>
        <section anchor="R8505ETID" numbered="true" removeInRFC="false" toc="include" pn="section-4.2.2">
          <name slugifiedName="name-tid-i-field-and-opaque-fiel">TID, "I" Field, and Opaque Field</name>
          <t indent="0" pn="section-4.2.2-1">
   When the T flag is set to 1, the EARO includes a sequence counter called the
   "Transaction ID" (TID), which is needed to fill the Path Sequence field in the
   RPL Transit Information Option (TIO). For this reason, support of <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>
   by the RUL, as opposed to only <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, is a prerequisite for
   this specification; this requirement is fully explained in
   <xref target="prereq6lp" format="default" sectionFormat="of" derivedContent="Section 5.1"/>. The EARO also
   transports an Opaque field and an associated "I" field that describes what
   the Opaque field transports and how to use it.
</t>
          <t indent="0" pn="section-4.2.2-2">
   <xref target="ln" format="default" sectionFormat="of" derivedContent="Section 9.2.1"/> specifies the use of the "I" field and the Opaque
   field by a RUL.
</t>
        </section>
        <section anchor="R8505EROVR" numbered="true" removeInRFC="false" toc="include" pn="section-4.2.3">
          <name slugifiedName="name-route-ownership-verifier">Route Ownership Verifier</name>
          <t indent="0" pn="section-4.2.3-1">
   <xref target="RFC8505" sectionFormat="of" section="5.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8505#section-5.3" derivedContent="RFC8505"/> introduces the Registration
   Ownership Verifier (ROVR) field, which has a variable length of 64 to 256 bits.
   The ROVR replaces the 64-bit Extended Unique Identifier (EUI‑64) in the ARO
   <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, which was used to uniquely identify an Address
   Registration with the link-layer address of the owner but provided no
   protection against spoofing.
</t>
          <t indent="0" pn="section-4.2.3-2">

   "<xref target="RFC8928" format="title" sectionFormat="of" derivedContent="Address-Protected Neighbor Discovery for Low-Power and Lossy Networks"/>" <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/>
   leverages the ROVR field as a
   cryptographic proof of ownership to prevent a rogue third party from
   registering an address that is already owned.
   The use of the ROVR field enables the 6LR to block traffic that is not
   sourced at an owned address.
</t>
          <t indent="0" pn="section-4.2.3-3">

   This specification does not address how the protection offered by
   <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/> could be extended for use in RPL.
   On the other hand, it adds the ROVR to the DAO to build the proxied EDAR at the root (see <xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/>), which means that nodes that are aware of the host route are also aware of the ROVR associated to the Target Address.
</t>
        </section>
      </section>
      <section anchor="R8505D" numbered="true" removeInRFC="false" toc="include" pn="section-4.3">
        <name slugifiedName="name-edar-edac-per-rfc-8505">EDAR/EDAC per RFC 8505</name>
        <t indent="0" pn="section-4.3-1">
   <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> updates the DAR/DAC messages to EDAR/EDAC messages to carry the ROVR field.
   The EDAR/EDAC exchange takes place
   between the 6LR and the 6LBR. It is triggered by an NS(EARO) message from a 6LN to create, refresh, and delete the corresponding state in the 6LBR.
   The exchange is protected by the retry mechanism specified in <xref target="RFC6775" sectionFormat="of" section="8.2.6" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-8.2.6" derivedContent="RFC6775"/>, though in an LLN, a duration longer than
   the default value of the RetransTimer (RETRANS_TIMER)
 <xref target="RFC4861" format="default" sectionFormat="of" derivedContent="RFC4861"/> of 1 second may be necessary to
   cover the round-trip delay between the 6LR and the 6LBR.

</t>
        <t indent="0" pn="section-4.3-2">
   RPL <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/> specifies a periodic DAO from the 6LN all the way to
   the root that maintains the routing state in the RPL network for the lifetime
   indicated by the source of the DAO.
   This means that for each address, there are two keep-alive messages
   that traverse the whole network: one to the root and one to the 6LBR.
</t>
        <t indent="0" pn="section-4.3-3">

   This specification avoids the periodic EDAR/EDAC exchange across the LLN.
   The 6LR turns
   the periodic NS(EARO) from the RUL into a DAO message to the
   root on every refresh, but it only generates the EDAR upon the first
   registration, for the purpose of DAD, which must be verified before the
   address is injected in RPL.
   Upon the DAO message, the root proxies the EDAR exchange to refresh the state at the 6LBR on behalf of the 6LR, as illustrated in <xref target="fReg2" format="default" sectionFormat="of" derivedContent="Figure 8"/> in <xref target="flow" format="default" sectionFormat="of" derivedContent="Section 9.1"/>.
</t>
        <section anchor="R7400" numbered="true" removeInRFC="false" toc="include" pn="section-4.3.1">
          <name slugifiedName="name-capability-indication-optio">Capability Indication Option per RFC 7400</name>
          <t indent="0" pn="section-4.3.1-1">
   "<xref target="RFC7400" format="title" sectionFormat="of" derivedContent="6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"/>" <xref target="RFC7400" format="default" sectionFormat="of" derivedContent="RFC7400"/>
   defines the 6LoWPAN Capability Indication Option (6CIO), which enables a node to expose its
   capabilities in Router Advertisement (RA) messages.
</t>
          <t indent="0" pn="section-4.3.1-2">
   <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> defines a number of bits in the 6CIO; in particular:
</t>
          <dl spacing="compact" indent="4" newline="false" pn="section-4.3.1-3">
            <dt pn="section-4.3.1-3.1">L:</dt>
            <dd pn="section-4.3.1-3.2">The node is a 6LR.</dd>
            <dt pn="section-4.3.1-3.3">E:</dt>
            <dd pn="section-4.3.1-3.4">The node is an IPv6 ND Registrar -- i.e., it supports
        registrations based on EARO.</dd>
            <dt pn="section-4.3.1-3.5">P:</dt>
            <dd pn="section-4.3.1-3.6">The node is a Routing Registrar -- i.e., an IPv6 ND Registrar
         that also provides reachability services for the Registered Address.</dd>
          </dl>
          <figure anchor="CIO" align="left" suppress-title="false" pn="figure-3">
            <name slugifiedName="name-6cio-flags">6CIO Flags</name>
            <artwork align="center" pn="section-4.3.1-4.1">
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Length = 1  |     Reserved      |D|L|B|P|E|G|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</artwork>
          </figure>
          <t indent="0" pn="section-4.3.1-5">

    A 6LR that provides reachability services for a RUL in a RPL network
    as specified in this document includes a 6CIO in its RA messages and
    set the L, P, and E flags to 1 as prescribed by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>;
    this is fully explained in <xref target="oper" format="default" sectionFormat="of" derivedContent="Section 9.2"/>.
          </t>
        </section>
      </section>
    </section>
    <section anchor="prereq" numbered="true" removeInRFC="false" toc="include" pn="section-5">
      <name slugifiedName="name-requirements-for-the-rpl-un">Requirements for the RPL-Unaware Leaf</name>
      <t indent="0" pn="section-5-1">
   This document describes how RPL routing can be extended to reach a RUL.
   This section specifies the minimal RPL-independent functionality that the RUL
   needs to implement in order to obtain routing services for its addresses.
</t>
      <section anchor="prereq6lp" numbered="true" removeInRFC="false" toc="include" pn="section-5.1">
        <name slugifiedName="name-support-of-6lowpan-nd">Support of 6LoWPAN ND</name>
        <t indent="0" pn="section-5.1-1">
   To obtain routing services from a router that implements this specification,
   a RUL needs to implement <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> and sets the "R" and "T"
   flags in the EARO to 1 as discussed in Sections <xref target="R8505ER" format="counter" sectionFormat="of" derivedContent="4.2.1"/> and
   <xref target="R8505ETID" format="counter" sectionFormat="of" derivedContent="4.2.2"/>, respectively. <xref target="ln" format="default" sectionFormat="of" derivedContent="Section 9.2.1"/> specifies new behaviors for the RUL, e.g., when the R flag set to 1 in an NS(EARO) is not echoed in the NA(EARO), which indicates that the route injection failed.
</t>
        <t indent="0" pn="section-5.1-2">
   The RUL is expected to request routing services from a router only if that router originates RA messages with a 6CIO that has the L, P, and E flags all set to 1
   as discussed in <xref target="R7400" format="default" sectionFormat="of" derivedContent="Section 4.3.1"/>, unless configured to do so.
   It is suggested that the RUL also implement
   <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/> to protect the ownership of its addresses.
</t>
        <t indent="0" pn="section-5.1-3">
   A RUL that may attach to multiple 6LRs is expected to prefer those that provide routing services.
   The RUL needs to register with all the 6LRs from which it desires routing services.
</t>
        <t indent="0" pn="section-5.1-4">
   Parallel Address Registrations to several 6LRs should be performed in a rapid sequence, using the same EARO for the same address. Gaps between
   the Address Registrations will invalidate some of the routes until the Address
   Registration finally shows on those routes.
</t>
        <t indent="0" pn="section-5.1-5"><xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> introduces error Status values in the NA(EARO)
   that can be received synchronously upon an NS(EARO) or asynchronously. The
   RUL needs to support both cases and refrain from using the address
   when the Status value indicates a rejection (see <xref target="stat" format="default" sectionFormat="of" derivedContent="Section 6.3"/>).

</t>
      </section>
      <section anchor="prereqv6ip" numbered="true" removeInRFC="false" toc="include" pn="section-5.2">
        <name slugifiedName="name-support-of-ipv6-encapsulati">Support of IPv6 Encapsulation</name>
        <t indent="0" pn="section-5.2-1">
   <xref target="RFC9008" sectionFormat="of" section="4.1.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9008#section-4.1.1" derivedContent="RFC9008"/> defines the rules
   for signaling an external destination (e.g., a RUL) and tunneling to its 
   attachment router (designated as a 6LR). In order to terminate the IPv6-in-IPv6
   tunnel, the RUL, as an IPv6 host, would have to be capable of decapsulating
   the tunneled packet and either drop the encapsulated packet if it is not the
   final destination or pass it to the upper layer for further processing.
   As indicated in <xref target="RFC9008" sectionFormat="of" section="4.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9008#section-4.1" derivedContent="RFC9008"/>,
   this is not mandated by <xref target="RFC8504" format="default" sectionFormat="of" derivedContent="RFC8504"/>, and the IPv6-in-IPv6 tunnel
   from the root is terminated at the parent 6LR. It is thus not necessary
   for a RUL to support IPv6-in-IPv6 decapsulation.
</t>
      </section>
      <section anchor="prereqv6hh" numbered="true" removeInRFC="false" toc="include" pn="section-5.3">
        <name slugifiedName="name-support-of-the-hop-by-hop-h">Support of the Hop-by-Hop Header</name>
        <t indent="0" pn="section-5.3-1">
   A RUL is expected to process an Option Type in a Hop-by-Hop Header as
   prescribed by <xref target="RFC8200" sectionFormat="of" section="4.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8200#section-4.2" derivedContent="RFC8200"/>.
   An RPI with an Option Type of 0x23 <xref target="RFC9008" format="default" sectionFormat="of" derivedContent="RFC9008"/> is thus skipped when not recognized.
</t>
      </section>
      <section anchor="prereqv6rh" numbered="true" removeInRFC="false" toc="include" pn="section-5.4">
        <name slugifiedName="name-support-of-the-routing-head">Support of the Routing Header</name>
        <t indent="0" pn="section-5.4-1">
   A RUL is expected to process an unknown Routing Header Type as
   prescribed by <xref target="RFC8200" sectionFormat="of" section="4.4" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8200#section-4.4" derivedContent="RFC8200"/>.
   This implies that the SRH, which has a Routing Type of 3
   <xref target="RFC6554" format="default" sectionFormat="of" derivedContent="RFC6554"/>, is ignored when Segments Left is zero.
   When Segments Left is non-zero, the RUL discards the packet and
   sends an ICMP Parameter Problem message with Code 0 to the packet's
   source address, pointing to the unrecognized Routing Type.
</t>
      </section>
    </section>
    <section anchor="upd" numbered="true" removeInRFC="false" toc="include" pn="section-6">
      <name slugifiedName="name-enhancements-to-rfc-6550">Enhancements to RFC 6550</name>
      <t indent="0" pn="section-6-1">
   This document specifies a new behavior whereby a 6LR injects DAO messages
   for unicast addresses (see <xref target="op" format="default" sectionFormat="of" derivedContent="Section 9"/>) and multicast addresses
   (see <xref target="multiop" format="default" sectionFormat="of" derivedContent="Section 10"/>) on behalf of leaves that are not aware of RPL.
   The RUL addresses are exposed as external targets <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>.
   Conforming to
   <xref target="RFC9008" format="default" sectionFormat="of" derivedContent="RFC9008"/>, IPv6-in-IPv6 encapsulation between the 6LR and the RPL DODAG root is used to carry the RPL artifacts and remove them when forwarding outside the RPL domain, e.g., to a RUL.

</t>
      <t indent="0" pn="section-6-2">
   This document also synchronizes the liveness monitoring at the root and the
   6LBR. The same lifetime value is used for both, and a single keep-alive
   message, the RPL DAO, traverses the RPL network. Another new behavior is introduced
   whereby the RPL DODAG root proxies the EDAR message to the 6LBR on behalf of the
   6LR (see <xref target="upd2" format="default" sectionFormat="of" derivedContent="Section 8"/>), for any leaf node that implements the
   6LN functionality described in <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.

</t>
      <t indent="0" pn="section-6-3">
   <xref target="RFC6550" sectionFormat="of" section="6.7.7" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-6.7.7" derivedContent="RFC6550"/> introduces the RPL Target option,
   which can be used in RPL control messages such as the DAO message to signal a
   destination prefix. This document adds capabilities for
   transporting the ROVR field (see <xref target="R8505EROVR" format="default" sectionFormat="of" derivedContent="Section 4.2.3"/>) and the
   IPv6 address of the prefix advertiser when the Target is a shorter prefix.
   Their use is signaled by a new ROVR Size field being non-zero
   and a new "Advertiser address in Full (F)" flag set to 1, respectively; see <xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/>.
</t>
      <t indent="0" pn="section-6-4">
   This specification defines a new flag, "Root Proxies EDAR/EDAC (P)", in the
   RPL DODAG Configuration option; see <xref target="pflag" format="default" sectionFormat="of" derivedContent="Section 6.2"/>.
</t>
      <t indent="0" pn="section-6-5">
 Furthermore, this
   specification provides the ability to carry the EARO Status defined for 6LoWPAN ND
   in RPL DAO and DCO messages, embedded in a RPL Status; see
   <xref target="stat" format="default" sectionFormat="of" derivedContent="Section 6.3"/>.

</t>
      <t indent="0" pn="section-6-6">
    <xref target="RFC6550" sectionFormat="of" section="12" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-12" derivedContent="RFC6550"/> details RPL support for
    multicast flows when the RPL Instance is operated with a MOP setting of 3
    ("Storing Mode of Operation with multicast support").
    This specification extends the RPL DODAG root operation to proxy-relay the MLDv2 operation <xref target="RFC3810" format="default" sectionFormat="of" derivedContent="RFC3810"/> between the RUL and the 6LR; see <xref target="multiop" format="default" sectionFormat="of" derivedContent="Section 10"/>.
</t>
      <section anchor="tgt" numbered="true" removeInRFC="false" toc="include" pn="section-6.1">
        <name slugifiedName="name-updated-rpl-target-option">Updated RPL Target Option</name>
        <t indent="0" pn="section-6.1-1"> This specification updates the RPL Target option to transport the ROVR
    that was also defined for 6LoWPAN ND messages.
    This enables the RPL DODAG root to generate the proxied EDAR message to the 6LBR.
        </t>
        <t indent="0" pn="section-6.1-2">
   The Target Prefix of the RPL Target option is left (high bit) justified and
   contains the advertised prefix; its size may be smaller than 128 when
   it indicates a prefix route. The Prefix Length field signals the number
   of bits that correspond to the advertised prefix; it is 128 for a
   host route or less in the case of a prefix route. This remains unchanged.
        </t>
        <t indent="0" pn="section-6.1-3">
   This specification defines the new 'F' flag. When it is set to 1, the size of
   the Target Prefix field <bcp14>MUST</bcp14> be 128 bits and it <bcp14>MUST</bcp14> contain an IPv6 address
   of the advertising node taken from the advertised prefix. In that case, the
   Target Prefix field carries two distinct pieces of information: a route that
   can be a host route or a prefix route, depending on the Prefix Length; and an
   IPv6 address that can be used to reach the advertising node and validate the
   route.
        </t>
        <t indent="0" pn="section-6.1-4">
   If the 'F' flag is set to 0, the Target Prefix field can be shorter than
   128 bits, and it <bcp14>MUST</bcp14> be aligned to the next byte boundary after the end of
   the prefix.
   Any additional bits in the rightmost octet are filled with padding bits.
   Padding bits are reserved and set to 0 as specified in <xref target="RFC6550" sectionFormat="of" section="6.7.7" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-6.7.7" derivedContent="RFC6550"/>.
        </t>
        <t indent="0" pn="section-6.1-5">
    With this specification, the ROVR is the remainder of the RPL Target option.
    The size of the ROVR is indicated in a new ROVR Size field that is encoded
    to map one to one with the Code Suffix in the EDAR message
    (see Table 4 of <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>). The ROVR Size field is taken
    from the Flags field, which is an update to the "RPL Target Option Flags" IANA registry.
        </t>
        <t indent="0" pn="section-6.1-6">
    The updated format is illustrated in <xref target="frpltgt" format="default" sectionFormat="of" derivedContent="Figure 4"/>.
    It is backward compatible with the Target option defined in
    <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>.
    It is recommended that the updated format be used as a replacement in new
    implementations in all MOPs in preparation for upcoming route ownership
    validation mechanisms based on the ROVR, unless the device or the network is
    so constrained that this is not feasible.
        </t>
        <figure anchor="frpltgt" suppress-title="false" align="left" pn="figure-4">
          <name slugifiedName="name-updated-target-option">Updated Target Option</name>
          <artwork align="left" pn="section-6.1-7.1">
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Type = 0x05 | Option Length |F|X|Flg|ROVRsz | Prefix Length |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                Target Prefix (Variable Length)                |
  .                                                               .
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...            Registration Ownership Verifier (ROVR)           ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</artwork>
        </figure>
        <t indent="0" pn="section-6.1-8"> New fields:
        </t>
        <dl spacing="normal" indent="4" newline="false" pn="section-6.1-9">
          <dt pn="section-6.1-9.1">F:</dt>
          <dd pn="section-6.1-9.2"> 1-bit flag. Set to 1 to indicate that the Target Prefix field
    contains the complete (128-bit) IPv6 address of the advertising node.</dd>
          <dt pn="section-6.1-9.3">X:</dt>
          <dd pn="section-6.1-9.4">
            <t indent="0" pn="section-6.1-9.4.1">1-bit flag. Set to 1 to request that the root perform a
    proxy EDAR/EDAC exchange. </t>
            <t indent="0" pn="section-6.1-9.4.2">The 'X' flag can only be set to 1 if the DODAG is
    operating in Non-Storing mode and if the root sets the "Root Proxies EDAR/EDAC
    (P)" flag to 1 in the DODAG Configuration option; see <xref target="pflag" format="default" sectionFormat="of" derivedContent="Section 6.2"/>.
            </t>
            <t indent="0" pn="section-6.1-9.4.3">
    The 'X' flag can be set for host routes to RULs and RANs; it can also be set
    for internal prefix routes if the 'F' flag is set, using the node's address
    in the Target Prefix field to form the EDAR, but it cannot be used otherwise.
            </t>
          </dd>
          <dt pn="section-6.1-9.5">Flg (Flags):</dt>
          <dd pn="section-6.1-9.6">  The 2 bits remaining unused in the Flags field
    are reserved for flags.  The field <bcp14>MUST</bcp14> be initialized to 0 by the sender
    and <bcp14>MUST</bcp14> be ignored by the receiver.</dd>
          <dt pn="section-6.1-9.7">ROVRsz (ROVR Size):</dt>
          <dd pn="section-6.1-9.8">
            <t indent="0" pn="section-6.1-9.8.1"> Indicates the size of the ROVR.
        It <bcp14>MUST</bcp14> be set to 1, 2, 3, or 4, indicating a ROVR size of 64, 128, 192,
        or 256 bits, respectively.
            </t>
            <t indent="0" pn="section-6.1-9.8.2">
        If a legacy Target option is used, then the value must
        remain 0, as specified in <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>.
            </t>
            <t indent="0" pn="section-6.1-9.8.3">
        In the case of a value above 4, the size of the ROVR is undetermined and
        this node cannot validate the ROVR; an implementation <bcp14>SHOULD</bcp14> propagate
        the whole Target option upwards as received to enable the verification
        by an ancestor that would support the upgraded ROVR.
            </t>
          </dd>
          <dt pn="section-6.1-9.9">Registration Ownership Verifier (ROVR):</dt>
          <dd pn="section-6.1-9.10">
                  This is the same field as in the EARO;
                  see <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.</dd>
        </dl>
      </section>
      <section anchor="pflag" numbered="true" removeInRFC="false" toc="include" pn="section-6.2">
        <name slugifiedName="name-additional-flag-in-the-rpl-">Additional Flag in the RPL DODAG Configuration Option</name>
        <t indent="0" pn="section-6.2-1">
   The DODAG Configuration option is defined in <xref target="RFC6550" sectionFormat="of" section="6.7.6" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-6.7.6" derivedContent="RFC6550"/>. Its purpose is extended to distribute configuration
   information affecting the construction and maintenance of the DODAG, as
   well as operational parameters for RPL on the DODAG, through the DODAG.

   This option was originally designed with four bit positions reserved for future use as flags.
        </t>
        <figure anchor="RPLDCO" align="left" suppress-title="false" pn="figure-5">
          <name slugifiedName="name-dodag-configuration-option-">DODAG Configuration Option (Partial View) </name>
          <artwork align="center" name="" type="" alt="" pn="section-6.2-2.1">
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 0x04 |Opt Length = 14| |P| | |A|       ...           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                     +
                                |4 bits |</artwork>
        </figure>
        <t indent="0" pn="section-6.2-3">
   This specification defines a new flag, "Root Proxies EDAR/EDAC (P)".
   The 'P' flag is encoded
   in bit position 1 of the reserved flags in the DODAG Configuration option
   (counting from bit 0 as the most significant bit), and it is set to 0 in
   legacy implementations as specified in Sections <xref target="RFC6550" section="20.14" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-20.14" derivedContent="RFC6550"/> and <xref target="RFC6550" section="6.7.6" sectionFormat="bare" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-6.7.6" derivedContent="RFC6550"/> of <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>, respectively.
        </t>
        <t indent="0" pn="section-6.2-4">
   The 'P' flag is set to 1 to indicate that the root performs the proxy
   operation, which implies that it supports this specification and the updated
   RPL Target option (see <xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/>).
        </t>
        <t indent="0" pn="section-6.2-5">
   <xref target="RFC9008" sectionFormat="of" section="4.1.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc9008#section-4.1.3" derivedContent="RFC9008"/> updates
   <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/> to indicate that the definition of the flags applies
   to MOP values from zero (0) to six (6) only. For a MOP value of 7, the implementation <bcp14>MUST</bcp14> assume that the root
   performs the proxy operation.
        </t>
        <t indent="0" pn="section-6.2-6">
   The RPL DODAG Configuration option is typically placed in
   a DODAG Information Object (DIO) message. The DIO message propagates down the
   DODAG to form and then maintain its structure. The DODAG Configuration option
   is copied unmodified from parents to children.
   <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/> states that "Nodes other than the DODAG root <bcp14>MUST NOT</bcp14> modify this information when propagating the DODAG Configuration option."
   Therefore, a legacy parent propagates the 'P' flag as set by the root, and
   when the 'P' flag is set to 1, it is transparently flooded to all the nodes
   in the DODAG.
        </t>
      </section>
      <section anchor="stat" numbered="true" removeInRFC="false" toc="include" pn="section-6.3">
        <name slugifiedName="name-updated-rpl-status">Updated RPL Status</name>
        <t indent="0" pn="section-6.3-1">The RPL Status is defined in <xref target="RFC6550" sectionFormat="of" section="6.5.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-6.5.1" derivedContent="RFC6550"/> for use in the DAO-ACK message. Values are assigned as follows:</t>
        <table anchor="irplStatusbl" align="center" pn="table-1">
          <name slugifiedName="name-rpl-status-per-rfc-6550">RPL Status per RFC 6550</name>
          <thead>
            <tr>
              <td align="left" colspan="1" rowspan="1">Range</td>
              <td align="left" colspan="1" rowspan="1">Meaning</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="left" colspan="1" rowspan="1">Success / Unqualified acceptance</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1-127</td>
              <td align="left" colspan="1" rowspan="1">Not an outright rejection</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">128-255</td>
              <td align="left" colspan="1" rowspan="1">Rejection</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-6.3-3">

    The 6LoWPAN ND Status was defined for use in the EARO; see <xref target="RFC8505" sectionFormat="of" section="4.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8505#section-4.1" derivedContent="RFC8505"/>.
    This specification adds the ability to allow the carriage of 6LoWPAN ND
    Status values in RPL DAO and DCO messages, embedded in the RPL Status field.
        </t>
        <t indent="0" pn="section-6.3-4">
    To achieve this, the range of the ARO/EARO Status values is reduced to 0-63,
    which updates the IANA registry created for <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>.
    This reduction ensures that the values fit within a RPL Status as shown in
    <xref target="rpst" format="default" sectionFormat="of" derivedContent="Figure 6"/>. See Sections <xref target="iana-aro" format="counter" sectionFormat="of" derivedContent="12.2"/>,
    <xref target="iana-stats-nonrej" format="counter" sectionFormat="of" derivedContent="12.5"/>, and <xref target="iana-stats-rej" format="counter" sectionFormat="of" derivedContent="12.6"/>
    for the respective IANA declarations.
    These updates are reasonable because the associated registry relies on
    the Standards Action policy <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/> for registration and only values up to 10 are currently allocated.
        </t>
        <figure anchor="rpst" suppress-title="false" align="left" pn="figure-6">
          <name slugifiedName="name-rpl-status-format">RPL Status Format</name>
          <artwork align="center" name="" type="" alt="" pn="section-6.3-5.1">
    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |U|A|StatusValue|
   +-+-+-+-+-+-+-+-+</artwork>
        </figure>
        <t indent="0" pn="section-6.3-6"> This specification updates the RPL Status with the following subfields:
        </t>
        <dl spacing="normal" indent="4" newline="false" pn="section-6.3-7">
          <dt pn="section-6.3-7.1">U:</dt>
          <dd pn="section-6.3-7.2"> 1-bit flag. Set to 1 to indicate a rejection. When set to 0, a Status value of 0
    indicates Success / Unqualified acceptance and other values indicate "Not an
    outright rejection" as per RFC 6550.</dd>
          <dt pn="section-6.3-7.3">A:</dt>
          <dd pn="section-6.3-7.4">1-bit flag. Indicates the type of the RPL Status value.</dd>
          <dt pn="section-6.3-7.5">Status Value:</dt>
          <dd pn="section-6.3-7.6">
            <t indent="0" pn="section-6.3-7.6.1">6-bit unsigned integer.</t>
            <t indent="0" pn="section-6.3-7.6.2">If the 'A' flag is set to 1, this field transports a value defined for the
    6LoWPAN ND EARO Status.
            </t>
            <t indent="0" pn="section-6.3-7.6.3">
    When the 'A' flag is set to 0, this field transports a Status value defined
    for RPL.
            </t>
          </dd>
        </dl>
        <t indent="0" pn="section-6.3-8">
   When building a DCO or a DAO-ACK message upon an IPv6 ND NA or an EDAC message,
   the RPL DODAG root <bcp14>MUST</bcp14> copy the 6LoWPAN ND status code unchanged in the RPL Status Value field and set the 'A' flag to 1.
   The RPL DODAG root <bcp14>MUST</bcp14> set the 'U' flag to 1 for all rejection and unknown status codes.  The status codes in the 1-10 range <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> are all considered rejections.

        </t>
        <t indent="0" pn="section-6.3-9">
   Reciprocally, upon a DCO or a DAO-ACK message from the RPL DODAG root with a RPL
   Status that has the 'A' flag set, the 6LR <bcp14>MUST</bcp14> copy the RPL Status value
   unchanged in the Status field of the EARO when generating an NA to the RUL.
        </t>
      </section>
    </section>
    <section anchor="updnpdao" numbered="true" removeInRFC="false" toc="include" pn="section-7">
      <name slugifiedName="name-enhancements-to-rfc-9009">Enhancements to RFC 9009</name>
      <t indent="0" pn="section-7-1">
<xref target="RFC9009" format="default" sectionFormat="of" derivedContent="RFC9009"/> defines the DCO message for RPL Storing mode only, with a link-local scope. All nodes in the RPL network are expected to support the specification, since the message is processed hop by hop along the path that is being cleaned up.
</t>
      <t indent="0" pn="section-7-2">
This specification extends the use of the DCO message to the Non-Storing MOP, whereby the DCO is sent end to end by the root directly to the RAN that injected the DAO message for the considered target. In that case, intermediate nodes do not need to support <xref target="RFC9009" format="default" sectionFormat="of" derivedContent="RFC9009"/>; they forward the DCO message as a plain IPv6 packet between the root and the RAN.
      </t>
      <t indent="0" pn="section-7-3">
In the case of a RUL, the 6LR that serves the RUL acts as the RAN that receives
the Non-Storing DCO.
This specification leverages the Non-Storing DCO between the root and the 6LR that serves as the attachment router for a RUL. A 6LR and a root that support this specification <bcp14>MUST</bcp14> implement the Non-Storing DCO.
</t>
    </section>
    <section anchor="upd2" numbered="true" removeInRFC="false" toc="include" pn="section-8">
      <name slugifiedName="name-enhancements-to-rfcs-6775-a">Enhancements to RFCs 6775 and 8505</name>
      <t indent="0" pn="section-8-1">
   This document updates <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/> and <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>
   to reduce the range of the ARO/EARO Status values to 64 values. The two most significant (leftmost) bits of the original ND Status field are now reserved; they <bcp14>MUST</bcp14> be set to 0 by the sender and ignored by the receiver.
      </t>
      <t indent="0" pn="section-8-2">
   This document also updates the behavior of a 6LR acting as a RPL router and of a 6LN acting as a RUL in the 6LoWPAN ND Address Registration as follows:
      </t>
      <ul bare="false" empty="false" indent="3" spacing="normal" pn="section-8-3">
        <li pn="section-8-3.1">
   If the RPL DODAG root advertises the ability to proxy the EDAR/EDAC
   exchange to the 6LBR, the 6LR refrains from sending the keep-alive EDAR
   message. If it is separated from the 6LBR, the root regenerates the
   EDAR message to the 6LBR periodically, upon a DAO message that signals the liveliness of the address.
   </li>
        <li pn="section-8-3.2">
   The use of the R flag is extended to the NA(EARO) to confirm whether the route was installed.
 </li>
      </ul>
    </section>
    <section anchor="op" numbered="true" removeInRFC="false" toc="include" pn="section-9">
      <name slugifiedName="name-protocol-operations-for-uni">Protocol Operations for Unicast Addresses</name>
      <t indent="0" pn="section-9-1">

  The description below assumes that the root sets the 'P' flag in the
  DODAG Configuration option and performs the EDAR proxy operation presented in
  <xref target="R8505D" format="default" sectionFormat="of" derivedContent="Section 4.3"/>.
</t>
      <t indent="0" pn="section-9-2">
  If the 'P' flag is set to 0, the 6LR <bcp14>MUST</bcp14> generate the periodic EDAR messages and
  process the returned status as specified in <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.
  If the EDAC indicates success, the rest of the flow takes place as presented
  but without the proxied EDAR/EDAC exchange.
</t>
      <t indent="0" pn="section-9-3">
  <xref target="flow" format="default" sectionFormat="of" derivedContent="Section 9.1"/> provides an overview of the route injection in RPL, whereas <xref target="oper" format="default" sectionFormat="of" derivedContent="Section 9.2"/> offers more details from the perspective of the
  different nodes involved in the flow.
</t>
      <section anchor="flow" numbered="true" removeInRFC="false" toc="include" pn="section-9.1">
        <name slugifiedName="name-general-flow">General Flow</name>
        <t indent="0" pn="section-9.1-1">
   This specification eliminates the need to exchange keep-alive EDAR and EDAC messages all the way from a 6LN to the 6LBR across a RPL mesh.
 Instead, the EDAR/EDAC exchange with the 6LBR is proxied
   by the RPL DODAG root upon the DAO message that refreshes the RPL routing state.
   The first EDAR upon a new Address Registration cannot be proxied, though, as it
   is generated for the purpose of DAD, which must be verified before the address is
   injected in RPL.
        </t>
        <t indent="0" pn="section-9.1-2">
   In a RPL
   network where the function is enabled, refreshing the state in the 6LBR is
   the responsibility of the root. Consequently, only addresses that are
   injected in RPL will be kept alive at the 6LBR by the RPL DODAG root.
   Since RULs are advertised using Non-Storing mode, the DAO message flow
   and the keep-alive EDAR/EDAC can be nested within the Address
   (re)Registration flow.
   <xref target="fReg1" format="default" sectionFormat="of" derivedContent="Figure 7"/> illustrates that, for the first Address Registration,
   both the DAD and the keep-alive EDAR⁠/EDAC exchanges happen in the same
   sequence.
        </t>
        <figure anchor="fReg1" suppress-title="false" align="left" pn="figure-7">
          <name slugifiedName="name-first-rul-registration-flow">First RUL Registration Flow</name>
          <artwork align="center" pn="section-9.1-3.1">
   6LN/RUL            6LR   &lt;6LR*&gt;   Root               6LBR
      |&lt;---Using ND---&gt;|&lt;--Using RPL-&gt;|&lt;-----Using ND----&gt;|
      |                |&lt;-----------Using ND-------------&gt;|
      |                |              |                   |
      |   NS(EARO)     |              |                   |
      |---------------&gt;|                                  |
      |                |            EDAR                  |
      |                |---------------------------------&gt;|
      |                |                                  |
      |                |             EDAC                 |
      |                |&lt;---------------------------------|
      |                |                                  |
      |                |   DAO(X=0)   |                   |
      |                |-------------&gt;|                   |
      |                |                                  |
      |                |    DAO-ACK   |                   |
      |                |&lt;-------------|                   |
      |   NA(EARO)     |              |                   |
      |&lt;---------------|              |                   |
      |                |              |                   |</artwork>
        </figure>
        <t indent="0" pn="section-9.1-4">
   This flow requires that the lifetimes and sequence counters in 6LoWPAN ND and RPL be aligned.
        </t>
        <t indent="0" pn="section-9.1-5">
   To achieve this, the Path
   Sequence and the Path Lifetime in the DAO message are taken from the
   Transaction ID and the Address Registration lifetime in the NS(EARO) message
   from the 6LN.

</t>
        <t indent="0" pn="section-9.1-6">
   On the first Address Registration, illustrated in <xref target="fReg1" format="default" sectionFormat="of" derivedContent="Figure 7"/>
   for RPL Non-Storing mode, the EDAR/EDAC exchange takes place
   as prescribed by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>. If the exchange fails, the 6LR returns an NA message with a non-zero status to the 6LN, the NCE is not created, and the address is not injected in RPL.

   Otherwise, the 6LR creates an NCE and injects the Registered
   Address in the RPL routing using a DAO/DAO-ACK exchange with the RPL DODAG
   root.
</t>
        <t indent="0" pn="section-9.1-7">
    An Address Registration refresh is performed by the 6LN to keep the NCE
    in the 6LR alive before the lifetime expires. Upon the refresh of a
    registration, the 6LR reinjects the corresponding route in RPL before it expires, as illustrated in <xref target="fReg2" format="default" sectionFormat="of" derivedContent="Figure 8"/>.
        </t>
        <figure anchor="fReg2" suppress-title="false" align="left" pn="figure-8">
          <name slugifiedName="name-next-rul-registration-flow">Next RUL Registration Flow</name>
          <artwork align="center" pn="section-9.1-8.1">
   6LN/RUL   &lt;-ND-&gt;   6LR   &lt;-RPL-&gt;  Root   &lt;-ND-&gt;      6LBR
      |                |              |                   |
      |   NS(EARO)     |              |                   |
      |---------------&gt;|              |                   |
      |                |   DAO(X=1)   |                   |
      |                |-------------&gt;|                   |
      |                |              |       EDAR        |
      |                |              |------------------&gt;|
      |                |              |       EDAC        |
      |                |              |&lt;------------------|
      |                |    DAO-ACK   |                   |
      |                |&lt;-------------|                   |
      |   NA(EARO)     |              |                   |
      |&lt;---------------|              |                   |</artwork>
        </figure>
        <t indent="0" pn="section-9.1-9">
    This is what causes the RPL DODAG root to refresh the state in the 6LBR, using an
    EDAC message.
    In the case of an error in the proxied EDAR flow, the error is
    returned in the DAO-ACK using a RPL Status with the 'A' flag set to 1, which embeds
    a 6LoWPAN Status value as discussed in <xref target="stat" format="default" sectionFormat="of" derivedContent="Section 6.3"/>.

        </t>
        <t indent="0" pn="section-9.1-10">

    The 6LR may receive a requested DAO-ACK after it received an asynchronous
    Non-Storing DCO, but the non-zero status in the DCO supersedes a positive
    status in the DAO-ACK, regardless of the order in which they are received.
    Upon the DAO-ACK -- or the DCO, if one arrives first -- the 6LR responds to the
    RUL with an NA(EARO).

        </t>
        <t indent="0" pn="section-9.1-11">
   An issue may be detected later, e.g., the address moves to a different
   DODAG with the 6LBR attached to a different 6LoWPAN Backbone Router (6BBR);
   see Figure 5 in <xref target="RFC8929" sectionFormat="of" section="3.3" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8929#section-3.3" derivedContent="RFC8929"/>.
   The 6BBR may send a negative ND Status, e.g., in an asynchronous NA(EARO)
   to the 6LBR.
        </t>
        <t indent="0" pn="section-9.1-12">
   <xref target="RFC8929" format="default" sectionFormat="of" derivedContent="RFC8929"/> expects that the 6LBR is co-located with the RPL DODAG root,  but if not, the 6LBR <bcp14>MUST</bcp14> forward the status code to the originator of the EDAR -- either the 6LR or the RPL DODAG root that proxies for it.
   The ND status code is mapped in a RPL Status value by the RPL DODAG root, and then back to an ND Status by the 6LR to the 6LN.
   Note that a legacy RAN that receives a Non-Storing DCO that it does not
   support will ignore it silently, as specified in <xref target="RFC6550" sectionFormat="of" section="6" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-6" derivedContent="RFC6550"/>. The result is that it will remain unaware that it is no longer reachable until its next RPL exchange happens. This situation will be cleared upon the next Non-Storing DAO
   exchange if the error is returned in a DAO-ACK.
</t>
        <t indent="0" pn="section-9.1-13">

   <xref target="fReg1.5" format="default" sectionFormat="of" derivedContent="Figure 9"/> illustrates this in the case where the 6LBR and the root are not co-located, and the root proxies the EDAR/EDAC flow.
        </t>
        <figure anchor="fReg1.5" suppress-title="false" align="left" pn="figure-9">
          <name slugifiedName="name-asynchronous-issue">Asynchronous Issue</name>
          <artwork align="center" pn="section-9.1-14.1">
6LN/RUL  &lt;-ND-&gt;  6LR  &lt;-RPL-&gt;  Root  &lt;-ND-&gt;  6LBR  &lt;-ND-&gt;  6BBR
   |              |             |              |             |
   |              |             |              |   NA(EARO)  |
   |              |             |              |&lt;------------|
   |              |             |     EDAC     |             |
   |              |             |&lt;-------------|             |
   |              |     DCO     |              |             |
   |              |&lt;------------|              |             |
   |   NA(EARO)   |             |              |             |
   |&lt;-------------|             |              |             |
   |              |             |              |             |</artwork>
        </figure>
        <t indent="0" pn="section-9.1-15">

   If the root does not proxy, then the EDAC with a non-zero status reaches the
   6LR directly. In that case, the 6LR <bcp14>MUST</bcp14> clean up the route using a DAO with
   a Lifetime of 0, and it <bcp14>MUST</bcp14> propagate the status back to the RUL in an NA(EARO) with the R flag set to 0.
        </t>
        <t indent="0" pn="section-9.1-16">
    The RUL may terminate the registration at any time by using a Registration
    Lifetime of 0.
    This specification requires that the RPL Target option transport the ROVR.
    This way, the same flow as the heartbeat flow is sufficient to inform the
    6LBR using the root as a proxy, as illustrated in <xref target="fReg2" format="default" sectionFormat="of" derivedContent="Figure 8"/>.

        </t>
        <t indent="0" pn="section-9.1-17">
All or any combination of the 6LR, the root, and the 6LBR might be
collapsed in a single node.
</t>
      </section>
      <section anchor="oper" numbered="true" removeInRFC="false" toc="include" pn="section-9.2">
        <name slugifiedName="name-detailed-operation">Detailed Operation</name>
        <t indent="0" pn="section-9.2-1">
 The following sections specify the behavior of (1) the 6LN acting as
 a RUL, (2) the 6LR acting as a border router and serving the
 6LN, (3) the RPL DODAG root, and (4) the 6LBR in the control flows that
 enable RPL routing back to the RUL, respectively.
</t>
        <section anchor="ln" numbered="true" removeInRFC="false" toc="include" pn="section-9.2.1">
          <name slugifiedName="name-perspective-of-the-6ln-acti">Perspective of the 6LN Acting as a RUL</name>
          <t indent="0" pn="section-9.2.1-1">
  This specification builds on the operation of a 6LoWPAN ND-compliant
  6LN/RUL, which is expected to operate as follows:
</t>
          <ol spacing="normal" indent="adaptive" start="1" type="1" pn="section-9.2.1-2">
<li pn="section-9.2.1-2.1" derivedCounter="1.">
    The 6LN selects a 6LR that provides reachability services for a RUL. This
    is signaled by a 6CIO in the RA messages with the L, P, and E flags set to 1
    as prescribed by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.
</li>
            <li pn="section-9.2.1-2.2" derivedCounter="2.">
   The 6LN obtains an IPv6 global address, via either (1) Stateless Address Autoconfiguration (SLAAC) <xref target="RFC4862" format="default" sectionFormat="of" derivedContent="RFC4862"/> based on a Prefix
   Information Option (PIO) <xref target="RFC4861" format="default" sectionFormat="of" derivedContent="RFC4861"/> found in an RA message or
   (2) some other means, such as DHCPv6 <xref target="RFC8415" format="default" sectionFormat="of" derivedContent="RFC8415"/>.

</li>
            <li pn="section-9.2.1-2.3" derivedCounter="3.">
   Once it has formed an address, the 6LN registers its address and refreshes its registration periodically, early enough
   within the lifetime of the previous Address Registration, as prescribed by
   <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, to refresh the NCE before the lifetime indicated
   in the EARO expires. It sets the T flag to 1 as prescribed in <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.
   The TID is incremented each time and wraps in a lollipop fashion (see
   <xref target="RFC8505" sectionFormat="of" section="5.2.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8505#section-5.2.1" derivedContent="RFC8505"/>, which is fully compatible with
   <xref target="RFC6550" sectionFormat="of" section="7.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-7.2" derivedContent="RFC6550"/>).
</li>
            <li pn="section-9.2.1-2.4" derivedCounter="4.">
   As stated in <xref target="RFC8505" sectionFormat="of" section="5.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8505#section-5.2" derivedContent="RFC8505"/>, the 6LN can register
   with more than one 6LR at the same time.
In that case, all the fields in the EARO are set to the same value
for all of the parallel Address Registrations, with the exception
of the Registration Lifetime field and the R flag, which may be set to
different values.
The 6LN may cancel a subset of its registrations or may transfer a
   registration from one or more old 6LRs to one or more new 6LRs. To do
   so, the 6LN sends a series of NS(EARO) messages, all with the same TID,
   with a zero Registration Lifetime to the old 6LR(s) and
   with a non-zero Registration Lifetime to the new 6LR(s). In that process,
   the 6LN <bcp14>SHOULD</bcp14> send the NS(EARO) with a non-zero Registration Lifetime and
   ensure that at least one succeeds before it sends an NS(EARO) that
   terminates another registration. This avoids the churn related to transient
   route invalidation in the RPL network above the common parent of the
   involved 6LRs.
</li>
            <li pn="section-9.2.1-2.5" derivedCounter="5.">
  Following <xref target="RFC8505" sectionFormat="of" section="5.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8505#section-5.1" derivedContent="RFC8505"/>,
  a 6LN acting as a RUL sets the R flag in the EARO of its registration(s)
  for which it requires routing services. If the R flag is not echoed in the
  NA, the RUL <bcp14>MUST</bcp14> assume that establishing the routing services via this 6LR
  failed, and it <bcp14>SHOULD</bcp14> attempt to use another 6LR.
  The RUL <bcp14>SHOULD</bcp14> ensure that one registration succeeds before setting the R flag to 0.  In the case of a conflict with the preceding rule regarding the lifetime, the rule regarding the lifetime has precedence.

</li>
            <li pn="section-9.2.1-2.6" derivedCounter="6.">
   The 6LN may use any of the 6LRs to which it registered as the default
   gateway.
   Using a 6LR to which the 6LN is not registered may result in packets dropped
   at the 6LR by a Source Address Validation Improvement (SAVI) function <xref target="RFC7039" format="default" sectionFormat="of" derivedContent="RFC7039"/> and thus is not recommended.
</li>
          </ol>
          <t indent="0" pn="section-9.2.1-3">
   Even without support for RPL, the RUL may be configured with an opaque value
   to be provided to the routing protocol. If the RUL has knowledge of the RPL
   Instance into which the packet should be injected, then it <bcp14>SHOULD</bcp14> set the Opaque
   field in the EARO to the RPLInstanceID; otherwise, it <bcp14>MUST</bcp14> leave the Opaque
   field as 0.
</t>
          <t indent="0" pn="section-9.2.1-4">
   Regardless of the setting of the Opaque field, the 6LN <bcp14>MUST</bcp14> set the "I"
   field to 0 to signal "topological information to be passed to a routing
   process", as specified in <xref target="RFC8505" sectionFormat="of" section="5.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8505#section-5.1" derivedContent="RFC8505"/>.
</t>
          <t indent="0" pn="section-9.2.1-5">
   A RUL is not expected to produce RPL artifacts in the data packets, but it
   may do so. For instance, if the RUL has minimal awareness of the RPL
   Instance, then it can build an RPI. A RUL that places an RPI in a data packet
   <bcp14>SHOULD</bcp14> indicate the RPLInstanceID of the RPL Instance where the
   packet should be forwarded. It is up to the 6LR (e.g., by policy) to use the
   RPLInstanceID information provided by the RUL or rewrite it to the selected
   RPLInstanceID for forwarding inside the RPL domain.
   All the flags and the SenderRank field are set
   to 0 as specified by <xref target="RFC6550" sectionFormat="of" section="11.2" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-11.2" derivedContent="RFC6550"/>.
</t>
        </section>
        <section anchor="lr" numbered="true" removeInRFC="false" toc="include" pn="section-9.2.2">
          <name slugifiedName="name-perspective-of-the-6lr-acti">Perspective of the 6LR Acting as a Border Router</name>
          <t indent="0" pn="section-9.2.2-1">
    A 6LR that provides reachability services for a RUL in a RPL network
    as specified in this document <bcp14>MUST</bcp14> include a 6CIO in its RA messages and
    set the L, P, and E flags to 1 as prescribed by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.
</t>
          <t indent="0" pn="section-9.2.2-2">
   As prescribed by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>,
   the 6LR generates an EDAR message upon reception of a valid NS(EARO)
   message for the registration of a new IPv6 address by a 6LN.
   If the initial EDAR/EDAC exchange succeeds, then the 6LR installs an NCE
   for the Registration Lifetime.
</t>
          <t indent="0" pn="section-9.2.2-3">
   If the R flag is set to 1 in the NS(EARO), the 6LR <bcp14>SHOULD</bcp14> inject the
   host route in RPL, unless this is barred for other reasons, such as the saturation of the RPL parents. The 6LR <bcp14>MUST</bcp14> use RPL Non-Storing mode
   signaling and the updated Target option (see <xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/>). To avoid a
redundant EDAR/EDAC flow to the 6LBR, the 6LR <bcp14>SHOULD</bcp14> refrain from setting the 'X' flag.
 The 6LR <bcp14>MUST</bcp14> request a DAO-ACK by setting the 'K' flag in the
   DAO message. Successfully injecting the route to the RUL's address will be indicated via
   the 'U' flag set to 0 in the RPL Status of the DAO-ACK message.
</t>
          <t indent="0" pn="section-9.2.2-4">
   For the registration refreshes, if the RPL DODAG root sets the 'P' flag in the DODAG Configuration option to 1, then the 6LR <bcp14>MUST</bcp14> refrain from sending the keep-alive EDAR; instead, it <bcp14>MUST</bcp14> set the 'X' flag to 1 in the Target option of the DAO messages, to request that the root proxy the keep-alive EDAR/EDAC exchange with the 6LBR (see <xref target="upd" format="default" sectionFormat="of" derivedContent="Section 6"/>); if the 'P' flag is set to 0,
   then the 6LR <bcp14>MUST</bcp14> set the 'X' flag to 0 and handle the EDAR/EDAC flow itself.
</t>
          <t indent="0" pn="section-9.2.2-5">
   The Opaque field in the EARO provides a means to signal which RPL Instance is to be used for the DAO advertisements and the forwarding of packets sourced at the Registered Address when there is no RPI in the packet.
</t>
          <t indent="0" pn="section-9.2.2-6">
   As described in <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>, if the "I" field is 0, then the Opaque field is expected to carry the RPLInstanceID suggested by the 6LN; otherwise, there is no suggested RPL Instance.
   If the 6LR participates in the suggested RPL Instance, then the
   6LR <bcp14>MUST</bcp14> use that RPL Instance for the Registered Address.
</t>
          <t indent="0" pn="section-9.2.2-7">
   If there is no suggested RPL Instance or if the 6LR does not participate in 
the suggested RPL Instance, it is expected that the packets coming from the 6LN "can unambiguously be associated to at least one RPL Instance" <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/> by the 6LR, e.g., using a policy that
   maps the 6-tuple to a RPL Instance.
</t>
          <t indent="0" pn="section-9.2.2-8">
  The DAO message advertising the Registered Address <bcp14>MUST</bcp14> be constructed as
  follows:
          </t>
          <ol spacing="normal" indent="adaptive" start="1" type="1" pn="section-9.2.2-9">
  <li pn="section-9.2.2-9.1" derivedCounter="1.">The Registered Address is signaled as the Target Prefix in the updated Target option in the DAO message; the Prefix Length is set to 128 but the 'F' flag is set to 0, since the advertiser is not the RUL. The ROVR field is copied unchanged from the EARO (see <xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/>).
  </li>
            <li pn="section-9.2.2-9.2" derivedCounter="2.">
  The 6LR indicates one of its global or unique-local IPv6 unicast addresses as the Parent Address in the TIO associated with the Target option.
  </li>
            <li pn="section-9.2.2-9.3" derivedCounter="3.">
  The 6LR sets the External ('E') flag in the TIO to indicate that it is redistributing
  an external target into the RPL network.
  </li>
            <li pn="section-9.2.2-9.4" derivedCounter="4.">
              <t indent="0" pn="section-9.2.2-9.4.1">
  The Path Lifetime in the TIO is computed from the Registration Lifetime in the EARO. This operation converts seconds to the Lifetime Units used in the RPL operation. This creates the deployment constraint that the Lifetime Unit is reasonably compatible with the expression of the Registration Lifetime; e.g., a Lifetime Unit of 0x4000 maps the most significant byte of the Registration Lifetime to the Path Lifetime.
              </t>
              <t indent="0" pn="section-9.2.2-9.4.2">
  In that operation, the Path Lifetime must be set to ensure that the path has a longer lifetime than the registration and also covers the round-trip time to the root.
              </t>
              <t indent="0" pn="section-9.2.2-9.4.3">
  Note that if the Registration Lifetime is 0, then the Path Lifetime is also 0 and the DAO message becomes a No-Path DAO, which cleans up the routes down to the RUL's address; this also causes the root as a proxy to send an EDAR message to the 6LBR with a Lifetime of 0.
              </t>
            </li>
            <li pn="section-9.2.2-9.5" derivedCounter="5.">
  The Path Sequence in the TIO is set to the TID value found in the EARO.
  </li>
          </ol>
          <t indent="0" pn="section-9.2.2-10">

   Upon receiving or timing out the DAO-ACK after an implementation-specific
   number of retries, the 6LR <bcp14>MUST</bcp14> send the corresponding NA(EARO) to the RUL.
   Upon receiving an asynchronous DCO message, it <bcp14>MUST</bcp14> send an asynchronous
   NA(EARO) to the RUL immediately but still be capable of processing the
   DAO-ACK if one is pending.

</t>
          <t indent="0" pn="section-9.2.2-11">
The 6LR <bcp14>MUST</bcp14> set the R flag to 1 in the NA(EARO) that it sends back to the 6LN if and only if the 'U' flag in the RPL Status is set to 0, indicating that the 6LR injected the Registered Address in the RPL routing successfully and that the EDAR proxy operation succeeded.
</t>
          <t indent="0" pn="section-9.2.2-12">

   If the 'A' flag in the RPL Status is set to 1, the embedded Status value is passed back to the RUL in the EARO Status.
   If the 'U' flag is also set to 1, the registration failed for
   6LoWPAN-ND-related reasons, and the NCE is removed.
</t>
          <t indent="0" pn="section-9.2.2-13">

   An error injecting the route causes the 'U' flag to be set to 1. If the error is not related to ND, the 'A' flag is set to 0. In that case, the registration succeeds, but the RPL route is not installed. So, the NA(EARO) is returned
   with a status indicating success but the R flag set to 0, which means that
   the 6LN obtained a binding but no route.
</t>
          <t indent="0" pn="section-9.2.2-14">
   If the 'A' flag is set to 0 in the RPL Status of the DAO-ACK, then the 6LoWPAN
   ND operation succeeded, and an EARO Status of 0 (Success) <bcp14>MUST</bcp14> be returned to
   the 6LN. The EARO Status of 0 <bcp14>MUST</bcp14> also be used if the 6LR did not attempt to inject the route but could create the binding after a successful EDAR/EDAC exchange or refresh it.
</t>
          <t indent="0" pn="section-9.2.2-15">
   If the 'U' flag is set to 1 in the RPL Status of the DAO-ACK, then the route was not installed, and the R flag <bcp14>MUST</bcp14> be set to 0 in the NA(EARO). The R flag <bcp14>MUST</bcp14> be set to 0 if the 6LR did not attempt to inject the route.

</t>
          <t indent="0" pn="section-9.2.2-16">
   In a network where Address-Protected Neighbor Discovery (AP-ND) is enabled,
   in the case of a DAO-ACK or a DCO transporting an EARO
   Status value of 5 (Validation Requested), the 6LR <bcp14>MUST</bcp14>
   challenge the 6LN for ownership of the address, as described in <xref target="RFC8928" sectionFormat="of" section="6.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8928#section-6.1" derivedContent="RFC8928"/>, before the registration is
   complete. This flow, illustrated in <xref target="Dynamic-fig" format="default" sectionFormat="of" derivedContent="Figure 10"/>, ensures that the address is validated before it is injected in the RPL routing.
</t>
          <figure anchor="Dynamic-fig" suppress-title="false" align="left" pn="figure-10">
            <name slugifiedName="name-address-protection">Address Protection</name>
            <artwork align="left" pn="section-9.2.2-17.1">
6LN                                       6LR        Root        6LBR
 |                                         |           |           |
 |&lt;--------------- RA ---------------------|           |           |
 |                                         |           |           |
 |------ NS(EARO) (ROVR=Crypto-ID) -------&gt;|           |           |
 |                                         |           |           |
 |&lt;-NA(EARO) (Status=Validation Requested)-|           |           |
 |                                         |           |           |
 |---- NS(EARO) and proof of ownership ---&gt;|           |           |
 |                                         |           |           |
 |                                &lt;validate the proof&gt; |           |
 |                                                     |           |
 |&lt;------- NA(EARO) (Status=10) -----&lt;if failed&gt;       |           |
 |                                                     |           |
 |                                       &lt;else&gt;        |           |
 |                                         |           |           |
 |                                         |--------- EDAR -------&gt;|
 |                                         |                       |
 |                                         |&lt;-------- EDAC --------|
 |                                         |                       |
 |                                         |           |           |
 |                                         |-DAO(X=0)-&gt;|           |
 |                                         |           |           |
 |                                         |&lt;- DAO-ACK-|           |
 |                                         |           |           |
 |&lt;---------- NA(EARO) (Status=0) ---------|           |           |
 |                                         |           |           |
                                     ...
 |                                         |           |           |
 |------ NS(EARO) (ROVR=Crypto-ID) -------&gt;|           |           |
 |                                         |-DAO(X=1)-&gt;|           |
 |                                         |           |-- EDAR --&gt;|
 |                                         |           |           |
 |                                         |           |&lt;-- EDAC --|
 |                                         |&lt;- DAO-ACK-|           |
 |&lt;---------- NA(EARO) (Status=0) ---------|           |           |
 |                                         |           |           |
                                     ...</artwork>
          </figure>
          <t indent="0" pn="section-9.2.2-18">
   If the challenge succeeded, then the operations continue as normal.
   In particular, a DAO message is generated
   upon the NS(EARO) that proves the ownership of the address. If the challenge
   failed, the 6LR rejects the registration as prescribed by AP-ND and may take
   actions to protect itself against Denial-Of-Service (DoS) attacks by a rogue 6LN; see
   <xref target="security-considerations" format="default" sectionFormat="of" derivedContent="Section 11"/>.
</t>
          <t indent="0" pn="section-9.2.2-19">
   The 6LR may, at any time, send a unicast asynchronous NA(EARO) with the R flag set to 0 to signal that it has stopped providing routing services, and/or with an EARO Status of 2 (Neighbor Cache Full) to signal that it removed the NCE. It may also send a final RA -- unicast or multicast -- with a router Lifetime field of 0, to signal that it will cease to serve as the router, as specified in <xref target="RFC4861" sectionFormat="of" section="6.2.5" format="default" derivedLink="https://rfc-editor.org/rfc/rfc4861#section-6.2.5" derivedContent="RFC4861"/>. This may happen upon a
   DCO or a DAO-ACK message indicating that the path is already removed; otherwise, the
   6LR <bcp14>MUST</bcp14> remove the host route to the 6LN using a DAO message with a Path
   Lifetime of 0.
</t>
          <t indent="0" pn="section-9.2.2-20">

   A valid NS(EARO) message with the R flag set to 0 and a Registration Lifetime that is not zero signals that the 6LN wishes to maintain the binding but does not require (i.e., no longer requires) the routing services from the 6LR.

   Upon this message, if, due to a previous NS(EARO) with the R flag set to 1 the
   6LR was injecting the host route to the Registered Address in RPL using DAO
   messages, then the 6LR <bcp14>MUST</bcp14> invalidate the host route in RPL using a DAO
   with a Path Lifetime of 0.

   It is up to the registering 6LN to maintain the corresponding route from then
   on, by either (1) keeping it active via a different 6LR or (2) acting as a RAN and managing its own reachability.

</t>
          <t indent="0" pn="section-9.2.2-21">
   When forwarding a packet from the RUL into the RPL domain, if the packet does
   not have an RPI, the 6LR <bcp14>MUST</bcp14> encapsulate the packet to the root and add
   an RPI. If there is an RPI in the packet, the 6LR <bcp14>MUST</bcp14> rewrite the RPI, but it
   does not need to encapsulate.
</t>
        </section>
        <section anchor="Root" numbered="true" removeInRFC="false" toc="include" pn="section-9.2.3">
          <name slugifiedName="name-perspective-of-the-rpl-doda">Perspective of the RPL DODAG Root</name>
          <t indent="0" pn="section-9.2.3-1">
   A RPL DODAG root <bcp14>MUST</bcp14> set the 'P' flag to 1 in the RPL DODAG Configuration option of
   the DIO messages that it generates (see <xref target="upd" format="default" sectionFormat="of" derivedContent="Section 6"/>) to signal
   that it proxies the EDAR/EDAC exchange and supports the updated RPL Target
   option.
</t>
          <t indent="0" pn="section-9.2.3-2">
   Upon reception of a DAO message, for each updated RPL Target option
   (see <xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/>) with the 'X' flag set to 1, the root <bcp14>MUST</bcp14> notify
   the 6LBR by using a proxied EDAR/EDAC exchange; if the RPL DODAG root and the 6LBR
   are integrated, an internal API can be used instead.


</t>
          <t indent="0" pn="section-9.2.3-3">
  The EDAR message <bcp14>MUST</bcp14> be constructed as follows:
          </t>
          <ol spacing="normal" indent="adaptive" start="1" type="1" pn="section-9.2.3-4">
  <li pn="section-9.2.3-4.1" derivedCounter="1.">
  The target IPv6 address from the RPL Target option is placed in the
  Registered Address field of the EDAR message;
  </li>
            <li pn="section-9.2.3-4.2" derivedCounter="2.">
  The Registration Lifetime is adapted from the Path Lifetime in the TIO by
  converting the Lifetime Units used in RPL into units of 60 seconds used in the
  6LoWPAN ND messages;
  </li>
            <li pn="section-9.2.3-4.3" derivedCounter="3.">
  The TID value is set to the Path Sequence in the TIO and indicated with an ICMP
  code of 1 in the EDAR message;
  </li>
            <li pn="section-9.2.3-4.4" derivedCounter="4.">
  The ROVR in the RPL Target option is copied as is in the
  EDAR, and the ICMP Code Suffix is set to the appropriate value as shown in
  Table 4 of <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>, depending on the size of the ROVR field.
  </li>
          </ol>
          <t indent="0" pn="section-9.2.3-5">
   Upon receiving an EDAC message from the 6LBR, if a DAO is pending, then the
   root <bcp14>MUST</bcp14> send a DAO-ACK back to the 6LR. Otherwise, if the status in the EDAC message is not "Success", then it <bcp14>MUST</bcp14> send an asynchronous DCO to the 6LR.
</t>
          <t indent="0" pn="section-9.2.3-6">
   In either case, the EDAC Status is embedded in the RPL Status with the 'A'
   flag set to 1.
</t>
          <t indent="0" pn="section-9.2.3-7">
The proxied EDAR/EDAC exchange <bcp14>MUST</bcp14> be protected with a timer whose
appropriate duration and number of retries (1) are implementation dependent and (2) <bcp14>SHOULD</bcp14> be configurable, since the root and the 6LBR are
typically nodes with a higher capacity and manageability than 6LRs.
   Upon timing out, the root <bcp14>MUST</bcp14> send an error back to the 6LR as above, using either a DAO-ACK or a DCO, as appropriate, with the 'A' and 'U' flags set to 1 in the RPL Status, and a RPL Status value of "6LBR Registry Saturated" <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.

</t>
        </section>
        <section anchor="lbr" numbered="true" removeInRFC="false" toc="include" pn="section-9.2.4">
          <name slugifiedName="name-perspective-of-the-6lbr">Perspective of the 6LBR</name>
          <t indent="0" pn="section-9.2.4-1">
  The 6LBR is unaware that the RPL DODAG root is not the new attachment 6LR of the RUL,
  so it is not impacted by this specification.
</t>
          <t indent="0" pn="section-9.2.4-2">
   Upon reception of an EDAR message,
   the 6LBR behaves as prescribed by <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> and returns an EDAC message to the sender.
</t>
        </section>
      </section>
    </section>
    <section anchor="multiop" numbered="true" removeInRFC="false" toc="include" pn="section-10">
      <name slugifiedName="name-protocol-operations-for-mul">Protocol Operations for Multicast Addresses</name>
      <t indent="0" pn="section-10-1"><xref target="RFC6550" sectionFormat="of" section="12" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-12" derivedContent="RFC6550"/> details RPL support for
    multicast flows. This support is activated by setting the MOP value to 3 ("Storing Mode of Operation with multicast support") in the DIO messages that form the DODAG. This section also applies if and only if the MOP of the RPL Instance is 3.
      </t>
      <t indent="0" pn="section-10-2">
    RPL support for multicast is not source specific and only operates as
    an extension to the Storing mode of operation for unicast packets.
    Note that
    it is the RPL model that the multicast packet is copied and transmitted as a Layer 2 unicast
    to each of the interested children.  This remains true when forwarding between the 6LR and the listener 6LN.
      </t>
      <t indent="0" pn="section-10-3">
    "<xref target="RFC3810" format="title" sectionFormat="of" derivedContent="Multicast Listener Discovery Version 2 (MLDv2) for IPv6"/>" <xref target="RFC3810" format="default" sectionFormat="of" derivedContent="RFC3810"/>
    provides an interface for a listener to register with multicast flows.
    In the MLD model, the router is a "querier", and the host is a multicast
    listener that registers with the querier to obtain copies of the particular
    flows it is interested in.
      </t>
      <t indent="0" pn="section-10-4">
     The equivalent of the first Address Registration happens as illustrated in <xref target="fReg3" format="default" sectionFormat="of" derivedContent="Figure 11"/>. The 6LN, as an MLD listener, sends an unsolicited Report to the 6LR. This enables it to start receiving the flow immediately and causes the 6LR to inject the multicast route in RPL.
      </t>
      <figure anchor="fReg3" suppress-title="false" align="left" pn="figure-11">
        <name slugifiedName="name-first-multicast-registratio">First Multicast Registration Flow</name>
        <artwork align="left" pn="section-10-5.1">
   6LN/RUL                6LR             Root                   6LBR
      |                    |               |                       |
      | unsolicited Report |               |                       |
      |-------------------&gt;|               |                       |
      |                    | DAO           |                       |
      |                    |--------------&gt;|                       |
      |                    |    DAO-ACK    |                       |
      |                    |&lt;--------------|                       |
      |                    |               | &lt;if not done already&gt; |
      |                    |               |  unsolicited Report   |
      |                    |               |----------------------&gt;|
      |                    |               |                       |</artwork>
      </figure>
      <t indent="0" pn="section-10-6"> This specification does not change MLD but will operate more efficiently
     if the asynchronous messages for unsolicited Report and Done are sent by
     the 6LN as Layer 2 unicast to the 6LR, particularly on wireless.
      </t>
      <t indent="0" pn="section-10-7">
     The 6LR acts as a generic MLD querier and generates a DAO with the multicast address as the Target Prefix as described in <xref target="RFC6550" sectionFormat="of" section="12" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-12" derivedContent="RFC6550"/>. As for the unicast host routes, the Path Lifetime associated to the Target is mapped from the Query Interval and is set to be larger, to account for variable propagation delays to the root.
     The root proxies the MLD exchange as a listener with the 6LBR acting as the
     querier, so as to get packets from a source external to the RPL domain.

      </t>
      <t indent="0" pn="section-10-8">
     Upon a DAO with a Target option for a multicast address, the RPL DODAG root checks to see if it is already registered as a listener for that address, and if not, it performs its own unsolicited Report for the multicast address as described in <xref target="RFC3810" sectionFormat="of" section="6.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc3810#section-6.1" derivedContent="RFC3810"/>.  The Report is source independent, so there is no source address listed.
      </t>
      <t indent="0" pn="section-10-9">
    The equivalent of the registration refresh is pulled periodically by the 6LR acting as the querier. Upon the timing out of the Query Interval, the 6LR sends a Multicast Address Specific Query to each of its listeners, for each multicast address. The listeners respond with a Report. Based on the Reports, the 6LR maintains the aggregated list of all the multicast addresses for which there is a listener and advertises them using DAO messages as specified in <xref target="RFC6550" sectionFormat="of" section="12" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-12" derivedContent="RFC6550"/>. Optionally, the 6LR <bcp14>MAY</bcp14> send a General Query, where the Multicast Address field is set to 0. In that case, the multicast packet is passed as a Layer 2 unicast to each of the interested children.
      </t>
      <t indent="0" pn="section-10-10">
    Upon a Report, the 6LR generates a DAO with as many Target options as there are Multicast Address Records in the Report message, copying the
    Multicast Address field in the Target Prefix of the RPL Target option.
    The DAO message is a Storing mode DAO, passed to a selection of the 6LR's
    parents.
      </t>
      <t indent="0" pn="section-10-11">
    Asynchronously to this, a similar procedure happens between the root and a router, such as the 6LBR, that serves multicast flows on the link where the root is located. Again, the Query and Report messages are source independent. The root lists exactly once each multicast address for which it has at least one active multicast DAO state, copying the multicast address in the DAO state in the Multicast Address field of the
    Multicast Address Records in the Report message.

      </t>
      <t indent="0" pn="section-10-12">

    This is illustrated in <xref target="fReg4" format="default" sectionFormat="of" derivedContent="Figure 12"/>:
      </t>
      <figure anchor="fReg4" suppress-title="false" align="left" pn="figure-12">
        <name slugifiedName="name-next-registration-flow">Next Registration Flow</name>
        <artwork align="left" pn="section-10-13.1">
   6LN/RUL                6LR             Root                6LBR
      |                    |               |                    |
      |       Query        |               |                    |
      |&lt;-------------------|               |                    |
      |       Report       |               |                    |
      |-------------------&gt;|               |                    |
      |                    | DAO           |                    |
      |                    |--------------&gt;|                    |
      |                    |    DAO-ACK    |                    |
      |                    |&lt;--------------|                    |
      |                    |               |       Query        |
      |                    |               |&lt;-------------------|
      |                    |               |       Report       |
      |                    |               |-------------------&gt;|
      |                    |               |                    |</artwork>
      </figure>
      <t indent="0" pn="section-10-14">Note that all or any combination of the 6LR, the root, and the 6LBR might be
collapsed in a single node, in which case the flow above happens internally, and possibly
    through internal API calls as opposed to messaging.
      </t>
    </section>
    <section anchor="security-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-11">
      <name slugifiedName="name-security-considerations">Security Considerations</name>
      <t indent="0" pn="section-11-1">
   It is worth noting that with <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>, every
   node in the LLN is RPL aware and can inject any RPL-based attack in the
   network. This specification improves this situation by isolating edge nodes
    that can only interact with the RPL routers using 6LoWPAN ND, meaning that they cannot perform RPL insider attacks.
      </t>
      <t indent="0" pn="section-11-2">
        The LLN nodes depend on the 6LBR and the RPL participants for their
    operation.
        A trust model must be put in place to ensure that the right devices are
        acting in these roles, so as to avoid such threats as black-holing
        (see <xref target="RFC7416" sectionFormat="of" section="7" format="default" derivedLink="https://rfc-editor.org/rfc/rfc7416#section-7" derivedContent="RFC7416"/>),
    DoS attacks whereby a rogue 6LR creates a high churn in the RPL network by advertising and removing many forged addresses,
        or a bombing attack whereby an impersonated 6LBR would destroy state in
        the network by using a status code of 4 ("Removed") <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/>.

      </t>
      <t indent="0" pn="section-11-3">
    This trust model could be,
    at a minimum, based on Layer 2 secure joining and link-layer security.
    This is a generic 6LoWPAN requirement; see Req-5.1 in 
<xref target="RFC8505" format="default" section="B.5" sectionFormat="of" derivedLink="https://rfc-editor.org/rfc/rfc8505#appendix-B.5" derivedContent="RFC8505"/>.
      </t>
      <t indent="0" pn="section-11-4">
    In a general manner, the Security Considerations sections of <xref target="RFC6550" format="default" sectionFormat="of" derivedContent="RFC6550"/>,
    <xref target="RFC7416" format="default" sectionFormat="of" derivedContent="RFC7416"/>, <xref target="RFC6775" format="default" sectionFormat="of" derivedContent="RFC6775"/>, and <xref target="RFC8505" format="default" sectionFormat="of" derivedContent="RFC8505"/> apply to this specification as well.
      </t>
      <t indent="0" pn="section-11-5">
    In particular, link-layer security is needed to prevent
    DoS attacks whereby a rogue 6LN creates a high churn in the
    RPL network by constantly registering and deregistering addresses with the
    R flag set to 1 in the EARO.

      </t>
      <t indent="0" pn="section-11-6">
   <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/> updated 6LoWPAN ND with AP-ND. AP-ND protects the owner of an address against address theft and impersonation attacks in an LLN. Nodes supporting the extension compute a cryptographic identifier (Crypto-ID) and use it with one or more of their Registered Addresses. The Crypto-ID identifies the owner of the Registered Address and can be used to provide proof of ownership of the Registered Addresses. Once an address is registered with the Crypto‑ID and proof of ownership is provided, only the owner of that address can modify the registration information, thereby enforcing SAVI.
   <xref target="RFC8928" format="default" sectionFormat="of" derivedContent="RFC8928"/> reduces even further
   the attack perimeter that is available to the edge nodes,
   and its use is suggested in this specification.
      </t>
      <t indent="0" pn="section-11-7">
    Additionally, the trust model could include role validation (e.g., using
    role-based authorization) to ensure that the node that
    claims to be a 6LBR or a RPL DODAG root is entitled to do so.
      </t>
      <t indent="0" pn="section-11-8">
    The Opaque field in the EARO enables the RUL to suggest a RPLInstanceID
    where its traffic is placed. It is also possible for an attacker RUL to
    include an RPI in the packet. This opens the door to attacks where a RPL Instance
    would be reserved for critical traffic, e.g., with a specific bandwidth
    reservation, that the additional traffic generated by a rogue may disrupt.
    The attack may be alleviated by traditional access control and traffic-shaping mechanisms where the 6LR controls the incoming traffic from the
    6LN. More importantly, the 6LR is the node that injects the traffic in the
    RPL domain, so it has the final word on which RPL Instance is to be used
    for the traffic coming from the RUL, per its own policy. In particular, a
    policy can override the formal language that forces the use of the Opaque field
    or the rewriting of the RPI provided by the RUL, in a situation where the
    network administrator finds it relevant.
      </t>
      <t indent="0" pn="section-11-9">
    At the time of this writing, RPL does not have a route ownership validation
    model whereby it is possible to validate the origin of an address that is
    injected in a DAO.
    This specification makes a first step in that direction by
    allowing the root to challenge the RUL via the 6LR that serves it.

      </t>
      <t indent="0" pn="section-11-10">
   <xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/> indicates that when the length of the ROVR field is unknown, the RPL Target option must be passed on as received in RPL Storing mode. This creates a possible opening for using DAO messages as a
   covert channel. Note that DAO messages are rare, and overusing that channel could be detected. An implementation <bcp14>SHOULD</bcp14> notify the network
   management system when a RPL Target option is received with an unknown ROVR field size, to ensure that the network administrator is aware of the situation.
      </t>
      <t indent="0" pn="section-11-11">
     <xref target="RFC9009" format="default" sectionFormat="of" derivedContent="RFC9009"/> introduces the ability for
     a rogue common ancestor node to invalidate a route on behalf of the target
     node. In this case, the RPL Status in the DCO has the 'A' flag set to 0, and an NA(EARO) is returned to the 6LN with the R flag set to 0. This encourages the 6LN to try another 6LR. If a 6LR exists that does not use
     the rogue common ancestor, then the 6LN will eventually succeed gaining
     reachability over the RPL network in spite of the rogue node.

      </t>
    </section>
    <section anchor="iana-considerations" numbered="true" removeInRFC="false" toc="include" pn="section-12">
      <name slugifiedName="name-iana-considerations">IANA Considerations</name>
      <section anchor="iana-arof" numbered="true" removeInRFC="false" toc="include" pn="section-12.1">
        <name slugifiedName="name-fixing-the-address-registra">Fixing the Address Registration Option Flags</name>
        <t indent="0" pn="section-12.1-1"><xref target="RFC8505" sectionFormat="of" section="9.1" format="default" derivedLink="https://rfc-editor.org/rfc/rfc8505#section-9.1" derivedContent="RFC8505"/> created a registry for the 8-bit
    Address Registration Option Flags field.
    IANA has renamed the first column of the table from "ARO Status" to "Bit Number".
</t>
      </section>
      <section anchor="iana-aro" numbered="true" removeInRFC="false" toc="include" pn="section-12.2">
        <name slugifiedName="name-resizing-the-aro-status-val">Resizing the ARO Status Values</name>
        <t indent="0" pn="section-12.2-1"><xref target="RFC6775" sectionFormat="of" section="12" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6775#section-12" derivedContent="RFC6775"/> created the
    "Address Registration Option Status Values" registry with a range of 0-255.
        </t>
        <t indent="0" pn="section-12.2-2">
    This specification reduces that range to 0-63; see <xref target="stat" format="default" sectionFormat="of" derivedContent="Section 6.3"/>.
        </t>
        <t indent="0" pn="section-12.2-3">
    IANA has modified the "Address Registration Option Status Values"
    registry so that the upper bound of the unassigned values is 63.  This
    document has been added as a reference.  The registration procedure has
    not changed.
        </t>
      </section>
      <section anchor="iana-conf" numbered="true" removeInRFC="false" toc="include" pn="section-12.3">
        <name slugifiedName="name-new-rpl-dodag-configuration">New RPL DODAG Configuration Option Flag</name>
        <t indent="0" pn="section-12.3-1">
    IANA has assigned the following flag in the "DODAG Configuration Option
    Flags for MOP 0..6" registry <xref target="RFC9008" format="default" sectionFormat="of" derivedContent="RFC9008"/>:
        </t>
        <table anchor="nexndopt" align="center" pn="table-2">
          <name slugifiedName="name-new-dodag-configuration-opt">New DODAG Configuration Option Flag</name>
          <thead>
            <tr>
              <td align="left" colspan="1" rowspan="1">Bit Number</td>
              <td align="left" colspan="1" rowspan="1">Capability Description</td>
              <td align="left" colspan="1" rowspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">Root Proxies EDAR/EDAC (P)</td>
              <td align="left" colspan="1" rowspan="1">RFC 9010</td>
            </tr>
          </tbody>
        </table>
        <t indent="0" pn="section-12.3-3">IANA has added this document as a reference for MOP 7 in the RPL
"Mode of Operation" registry.
</t>
      </section>
      <section anchor="iana-full" numbered="true" removeInRFC="false" toc="include" pn="section-12.4">
        <name slugifiedName="name-rpl-target-option-flags-reg">RPL Target Option Flags Registry</name>
        <t indent="0" pn="section-12.4-1">
   This document modifies the "RPL Target Option Flags" registry initially
   created per <xref target="RFC6550" sectionFormat="of" section="20.15" format="default" derivedLink="https://rfc-editor.org/rfc/rfc6550#section-20.15" derivedContent="RFC6550"/>. The registry now
   includes only 4 bits (<xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/>) and lists this
   document as an additional reference. The registration procedure has not
   changed.
</t>
        <t indent="0" pn="section-12.4-2">
  <xref target="tgt" format="default" sectionFormat="of" derivedContent="Section 6.1"/> also defines two new entries in the registry, as follows:
        </t>
        <table anchor="ianatarget" align="center" pn="table-3">
          <name slugifiedName="name-rpl-target-option-flags-regi">RPL Target Option Flags Registry</name>
          <thead>
            <tr>
              <td align="left" colspan="1" rowspan="1">Bit Number</td>
              <td align="left" colspan="1" rowspan="1">Capability Description</td>
              <td align="left" colspan="1" rowspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="left" colspan="1" rowspan="1">Advertiser address in Full (F)</td>
              <td align="left" colspan="1" rowspan="1">RFC 9010</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">Proxy EDAR Requested (X)</td>
              <td align="left" colspan="1" rowspan="1">RFC 9010</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-stats-nonrej" numbered="true" removeInRFC="false" toc="include" pn="section-12.5">
        <name slugifiedName="name-new-subregistry-for-rpl-non">New Subregistry for RPL Non-Rejection Status Values</name>
        <t indent="0" pn="section-12.5-1">
        IANA has created a new subregistry for the RPL Non-Rejection Status values for use in the RPL DAO-ACK, DCO, and DCO-ACK messages with the 'A' flag set to 0 and the 'U' flag set to 1, under the "Routing Protocol for Low Power and Lossy Networks (RPL)" registry.
</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-12.5-2">
          <li pn="section-12.5-2.1">Possible values are 6-bit unsigned integers (0..63).</li>
          <li pn="section-12.5-2.2">The registration procedure is IETF Review <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>.</li>
          <li pn="section-12.5-2.3">The initial allocation is as indicated in <xref target="iana-ACK-Status" format="default" sectionFormat="of" derivedContent="Table 4"/>:</li>
        </ul>
        <table anchor="iana-ACK-Status" align="center" pn="table-4">
          <name slugifiedName="name-acceptance-values-of-the-rp">Acceptance Values of the RPL Status</name>
          <thead>
            <tr>
              <td align="left" colspan="1" rowspan="1">Value</td>
              <td align="left" colspan="1" rowspan="1">Meaning</td>
              <td align="left" colspan="1" rowspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="left" colspan="1" rowspan="1">Success / Unqualified acceptance</td>
              <td align="left" colspan="1" rowspan="1">RFC 6550 / RFC 9010</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1..63</td>
              <td align="left" colspan="1" rowspan="1">Unassigned</td>
              <td align="left" colspan="1" rowspan="1"/>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-stats-rej" numbered="true" removeInRFC="false" toc="include" pn="section-12.6">
        <name slugifiedName="name-new-subregistry-for-rpl-rej">New Subregistry for RPL Rejection Status Values</name>
        <t indent="0" pn="section-12.6-1">
        IANA has created a new subregistry for the RPL Rejection Status values for use in the RPL DAO-ACK and DCO messages with the 'A' flag set to 0 and the 'U' flag set to 1, under the "Routing Protocol for Low Power and Lossy Networks (RPL)" registry.
</t>
        <ul spacing="normal" bare="false" empty="false" indent="3" pn="section-12.6-2">
          <li pn="section-12.6-2.1">Possible values are 6-bit unsigned integers (0..63).</li>
          <li pn="section-12.6-2.2">The registration procedure is IETF Review <xref target="RFC8126" format="default" sectionFormat="of" derivedContent="RFC8126"/>.</li>
          <li pn="section-12.6-2.3">The initial allocation is as indicated in <xref target="iana-nack-Status" format="default" sectionFormat="of" derivedContent="Table 5"/>:</li>
        </ul>
        <table anchor="iana-nack-Status" align="center" pn="table-5">
          <name slugifiedName="name-rejection-values-of-the-rpl">Rejection Values of the RPL Status</name>
          <thead>
            <tr>
              <td align="left" colspan="1" rowspan="1">Value</td>
              <td align="left" colspan="1" rowspan="1">Meaning</td>
              <td align="left" colspan="1" rowspan="1">Reference</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">0</td>
              <td align="left" colspan="1" rowspan="1">Unqualified rejection</td>
              <td align="left" colspan="1" rowspan="1">RFC 9010</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">1</td>
              <td align="left" colspan="1" rowspan="1">No routing entry</td>
              <td align="left" colspan="1" rowspan="1">RFC 9009</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">2..63</td>
              <td align="left" colspan="1" rowspan="1">Unassigned</td>
              <td align="left" colspan="1" rowspan="1"/>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
  </middle>
  <back>
    <references pn="section-13">
      <name slugifiedName="name-references">References</name>
      <references pn="section-13.1">
        <name slugifiedName="name-normative-references">Normative References</name>
        <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" quoteTitle="true" derivedAnchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author initials="S." surname="Bradner" fullname="S. Bradner">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="1997" month="March"/>
            <abstract>
              <t indent="0">In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC3810" target="https://www.rfc-editor.org/info/rfc3810" quoteTitle="true" derivedAnchor="RFC3810">
          <front>
            <title>Multicast Listener Discovery Version 2 (MLDv2) for IPv6</title>
            <author initials="R." surname="Vida" fullname="R. Vida" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Costa" fullname="L. Costa" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2004" month="June"/>
            <abstract>
              <t indent="0">This document updates RFC 2710, and it specifies Version 2 of the ulticast Listener Discovery Protocol (MLDv2).  MLD is used by an IPv6 router to discover the presence of multicast listeners on directly attached links, and to discover which multicast addresses are of interest to those neighboring nodes.  MLDv2 is designed to be interoperable with MLDv1.  MLDv2 adds the ability for a node to report interest in listening to packets with a particular multicast address only from specific source addresses or from all sources except for specific source addresses.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="3810"/>
          <seriesInfo name="DOI" value="10.17487/RFC3810"/>
        </reference>
        <reference anchor="RFC4861" target="https://www.rfc-editor.org/info/rfc4861" quoteTitle="true" derivedAnchor="RFC4861">
          <front>
            <title>Neighbor Discovery for IP version 6 (IPv6)</title>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Nordmark" fullname="E. Nordmark">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="W." surname="Simpson" fullname="W. Simpson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="H." surname="Soliman" fullname="H. Soliman">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="September"/>
            <abstract>
              <t indent="0">This document specifies the Neighbor Discovery protocol for IP Version 6.  IPv6 nodes on the same link use Neighbor Discovery to discover each other's presence, to determine each other's link-layer addresses, to find routers, and to maintain reachability information about the paths to active neighbors.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4861"/>
          <seriesInfo name="DOI" value="10.17487/RFC4861"/>
        </reference>
        <reference anchor="RFC6550" target="https://www.rfc-editor.org/info/rfc6550" quoteTitle="true" derivedAnchor="RFC6550">
          <front>
            <title>RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks</title>
            <author initials="T." surname="Winter" fullname="T. Winter" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Thubert" fullname="P. Thubert" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Brandt" fullname="A. Brandt">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Hui" fullname="J. Hui">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Kelsey" fullname="R. Kelsey">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Levis" fullname="P. Levis">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="K." surname="Pister" fullname="K. Pister">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Struik" fullname="R. Struik">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="JP." surname="Vasseur" fullname="JP. Vasseur">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Alexander" fullname="R. Alexander">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="March"/>
            <abstract>
              <t indent="0">Low-Power and Lossy Networks (LLNs) are a class of network in which both the routers and their interconnect are constrained.  LLN routers typically operate with constraints on processing power, memory, and energy (battery power).  Their interconnects are characterized by high loss rates, low data rates, and instability.  LLNs are comprised of anything from a few dozen to thousands of routers.  Supported traffic flows include point-to-point (between devices inside the LLN), point-to-multipoint (from a central control point to a subset of devices inside the LLN), and multipoint-to-point (from devices inside the LLN towards a central control point).  This document specifies the IPv6 Routing Protocol for Low-Power and Lossy Networks (RPL), which provides a mechanism whereby multipoint-to-point traffic from devices inside the LLN towards a central control point as well as point-to-multipoint traffic from the central control point to the devices inside the LLN are supported.  Support for point-to-point traffic is also available.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6550"/>
          <seriesInfo name="DOI" value="10.17487/RFC6550"/>
        </reference>
        <reference anchor="RFC6775" target="https://www.rfc-editor.org/info/rfc6775" quoteTitle="true" derivedAnchor="RFC6775">
          <front>
            <title>Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)</title>
            <author initials="Z." surname="Shelby" fullname="Z. Shelby" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Chakrabarti" fullname="S. Chakrabarti">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Nordmark" fullname="E. Nordmark">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Bormann" fullname="C. Bormann">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="November"/>
            <abstract>
              <t indent="0">The IETF work in IPv6 over Low-power Wireless Personal Area Network (6LoWPAN) defines 6LoWPANs such as IEEE 802.15.4.  This and other similar link technologies have limited or no usage of multicast signaling due to energy conservation.  In addition, the wireless network may not strictly follow the traditional concept of IP subnets and IP links.  IPv6 Neighbor Discovery was not designed for non- transitive wireless links, as its reliance on the traditional IPv6 link concept and its heavy use of multicast make it inefficient and sometimes impractical in a low-power and lossy network.  This document describes simple optimizations to IPv6 Neighbor Discovery, its addressing mechanisms, and duplicate address detection for Low- power Wireless Personal Area Networks and similar networks.  The document thus updates RFC 4944 to specify the use of the optimizations defined here.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6775"/>
          <seriesInfo name="DOI" value="10.17487/RFC6775"/>
        </reference>
        <reference anchor="RFC7102" target="https://www.rfc-editor.org/info/rfc7102" quoteTitle="true" derivedAnchor="RFC7102">
          <front>
            <title>Terms Used in Routing for Low-Power and Lossy Networks</title>
            <author initials="JP." surname="Vasseur" fullname="JP. Vasseur">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="January"/>
            <abstract>
              <t indent="0">This document provides a glossary of terminology used in routing requirements and solutions for networks referred to as Low-Power and Lossy Networks (LLNs).  An LLN is typically composed of many embedded devices with limited power, memory, and processing resources interconnected by a variety of links.  There is a wide scope of application areas for LLNs, including industrial monitoring, building automation (e.g., heating, ventilation, air conditioning, lighting, access control, fire), connected home, health care, environmental monitoring, urban sensor networks, energy management, assets tracking, and refrigeration.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7102"/>
          <seriesInfo name="DOI" value="10.17487/RFC7102"/>
        </reference>
        <reference anchor="RFC7400" target="https://www.rfc-editor.org/info/rfc7400" quoteTitle="true" derivedAnchor="RFC7400">
          <front>
            <title>6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)</title>
            <author initials="C." surname="Bormann" fullname="C. Bormann">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="November"/>
            <abstract>
              <t indent="0">RFC 6282 defines header compression in 6LoWPAN packets (where "6LoWPAN" refers to "IPv6 over Low-Power Wireless Personal Area Network").  The present document specifies a simple addition that enables the compression of generic headers and header-like payloads, without a need to define a new header compression scheme for each such new header or header-like payload.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7400"/>
          <seriesInfo name="DOI" value="10.17487/RFC7400"/>
        </reference>
        <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" quoteTitle="true" derivedAnchor="RFC8126">
          <front>
            <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
            <author initials="M." surname="Cotton" fullname="M. Cotton">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="June"/>
            <abstract>
              <t indent="0">Many protocols make use of points of extensibility that use constants to identify various protocol parameters.  To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper.  For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
              <t indent="0">To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed.  This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
              <t indent="0">This is the third edition of this document; it obsoletes RFC 5226.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="26"/>
          <seriesInfo name="RFC" value="8126"/>
          <seriesInfo name="DOI" value="10.17487/RFC8126"/>
        </reference>
        <reference anchor="RFC8174" target="https://www.rfc-editor.org/info/rfc8174" quoteTitle="true" derivedAnchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author initials="B." surname="Leiba" fullname="B. Leiba">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="May"/>
            <abstract>
              <t indent="0">RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC8200" target="https://www.rfc-editor.org/info/rfc8200" quoteTitle="true" derivedAnchor="RFC8200">
          <front>
            <title>Internet Protocol, Version 6 (IPv6) Specification</title>
            <author initials="S." surname="Deering" fullname="S. Deering">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Hinden" fullname="R. Hinden">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="July"/>
            <abstract>
              <t indent="0">This document specifies version 6 of the Internet Protocol (IPv6). It obsoletes RFC 2460.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="86"/>
          <seriesInfo name="RFC" value="8200"/>
          <seriesInfo name="DOI" value="10.17487/RFC8200"/>
        </reference>
        <reference anchor="RFC8504" target="https://www.rfc-editor.org/info/rfc8504" quoteTitle="true" derivedAnchor="RFC8504">
          <front>
            <title>IPv6 Node Requirements</title>
            <author initials="T." surname="Chown" fullname="T. Chown">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Loughney" fullname="J. Loughney">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Winters" fullname="T. Winters">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2019" month="January"/>
            <abstract>
              <t indent="0">This document defines requirements for IPv6 nodes.  It is expected that IPv6 will be deployed in a wide range of devices and situations. Specifying the requirements for IPv6 nodes allows IPv6 to function well and interoperate in a large number of situations and deployments.</t>
              <t indent="0">This document obsoletes RFC 6434, and in turn RFC 4294.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="220"/>
          <seriesInfo name="RFC" value="8504"/>
          <seriesInfo name="DOI" value="10.17487/RFC8504"/>
        </reference>
        <reference anchor="RFC8505" target="https://www.rfc-editor.org/info/rfc8505" quoteTitle="true" derivedAnchor="RFC8505">
          <front>
            <title>Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery</title>
            <author initials="P." surname="Thubert" fullname="P. Thubert" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Nordmark" fullname="E. Nordmark">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Chakrabarti" fullname="S. Chakrabarti">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Perkins" fullname="C. Perkins">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="November"/>
            <abstract>
              <t indent="0">This specification updates RFC 6775 -- the Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery specification -- to clarify the role of the protocol as a registration technique and simplify the registration operation in 6LoWPAN routers, as well as to provide enhancements to the registration capabilities and mobility detection for different network topologies, including the Routing Registrars performing routing for host routes and/or proxy Neighbor Discovery in a low-power network.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8505"/>
          <seriesInfo name="DOI" value="10.17487/RFC8505"/>
        </reference>
        <reference anchor="RFC8928" target="https://www.rfc-editor.org/info/rfc8928" quoteTitle="true" derivedAnchor="RFC8928">
          <front>
            <title>Address-Protected Neighbor Discovery for Low-Power and Lossy Networks</title>
            <author initials="P." surname="Thubert" fullname="P. Thubert" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Sarikaya" fullname="B. Sarikaya">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Sethi" fullname="M. Sethi">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Struik" fullname="R. Struik">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="November"/>
            <abstract>
              <t indent="0">This document updates the IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery (ND) protocol defined in RFCs 6775 and 8505.  The new extension is called Address-Protected Neighbor Discovery (AP-ND), and it protects the owner of an address against address theft and impersonation attacks in a Low-Power and Lossy Network (LLN).  Nodes supporting this extension compute a cryptographic identifier (Crypto-ID), and use it with one or more of their Registered Addresses. The Crypto-ID identifies the owner of the Registered Address and can be used to provide proof of ownership of the Registered Addresses. Once an address is registered with the Crypto-ID and a proof of ownership is provided, only the owner of that address can modify the registration information, thereby enforcing Source Address Validation.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8928"/>
          <seriesInfo name="DOI" value="10.17487/RFC8928"/>
        </reference>
        <reference anchor="RFC9008" target="https://www.rfc-editor.org/info/rfc9008" quoteTitle="true" derivedAnchor="RFC9008">
          <front>
            <title>Using RPI Option Type, Routing Header for Source Routes, and IPv6-in-IPv6 Encapsulation in the RPL Data Plane</title>
            <author initials="M.I." surname="Robles" fullname="Ines Robles">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M" surname="Richardson" fullname="Michael Richardson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P" surname="Thubert" fullname="Pascal Thubert">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="April" year="2021"/>
          </front>
          <seriesInfo name="RFC" value="9008"/>
          <seriesInfo name="DOI" value="10.17487/RFC9008"/>
        </reference>
        <reference anchor="RFC9009" target="https://www.rfc-editor.org/info/rfc9009" quoteTitle="true" derivedAnchor="RFC9009">
          <front>
            <title>Efficient Route Invalidation</title>
            <author initials="R.A" surname="Jadhav" fullname="Rahul Jadhav" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P" surname="Thubert" fullname="Pascal Thubert">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R.N" surname="Sahoo" fullname="Rabi Sahoo">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="Z" surname="Cao" fullname="Zhen Cao">
              <organization showOnFrontPage="true"/>
            </author>
            <date month="April" year="2021"/>
          </front>
          <seriesInfo name="RFC" value="9009"/>
          <seriesInfo name="DOI" value="10.17487/RFC9009"/>
        </reference>
      </references>
      <references pn="section-13.2">
        <name slugifiedName="name-informative-references">Informative References</name>
        <reference anchor="RFC4862" target="https://www.rfc-editor.org/info/rfc4862" quoteTitle="true" derivedAnchor="RFC4862">
          <front>
            <title>IPv6 Stateless Address Autoconfiguration</title>
            <author initials="S." surname="Thomson" fullname="S. Thomson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Narten" fullname="T. Narten">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Jinmei" fullname="T. Jinmei">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="September"/>
            <abstract>
              <t indent="0">This document specifies the steps a host takes in deciding how to autoconfigure its interfaces in IP version 6.  The autoconfiguration process includes generating a link-local address, generating global addresses via stateless address autoconfiguration, and the Duplicate Address Detection procedure to verify the uniqueness of the addresses on a link.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4862"/>
          <seriesInfo name="DOI" value="10.17487/RFC4862"/>
        </reference>
        <reference anchor="RFC4919" target="https://www.rfc-editor.org/info/rfc4919" quoteTitle="true" derivedAnchor="RFC4919">
          <front>
            <title>IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals</title>
            <author initials="N." surname="Kushalnagar" fullname="N. Kushalnagar">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="G." surname="Montenegro" fullname="G. Montenegro">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Schumacher" fullname="C. Schumacher">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2007" month="August"/>
            <abstract>
              <t indent="0">This document describes the assumptions, problem statement, and goals for transmitting IP over IEEE 802.15.4 networks.  The set of goals enumerated in this document form an initial set only.  This memo provides information for the Internet community.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="4919"/>
          <seriesInfo name="DOI" value="10.17487/RFC4919"/>
        </reference>
        <reference anchor="RFC6282" target="https://www.rfc-editor.org/info/rfc6282" quoteTitle="true" derivedAnchor="RFC6282">
          <front>
            <title>Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks</title>
            <author initials="J." surname="Hui" fullname="J. Hui" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="P." surname="Thubert" fullname="P. Thubert">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2011" month="September"/>
            <abstract>
              <t indent="0">This document updates RFC 4944, "Transmission of IPv6 Packets over IEEE 802.15.4 Networks".  This document specifies an IPv6 header compression format for IPv6 packet delivery in Low Power Wireless Personal Area Networks (6LoWPANs).  The compression format relies on shared context to allow compression of arbitrary prefixes.  How the information is maintained in that shared context is out of scope. This document specifies compression of multicast addresses and a framework for compressing next headers.  UDP header compression is specified within this framework.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6282"/>
          <seriesInfo name="DOI" value="10.17487/RFC6282"/>
        </reference>
        <reference anchor="RFC6553" target="https://www.rfc-editor.org/info/rfc6553" quoteTitle="true" derivedAnchor="RFC6553">
          <front>
            <title>The Routing Protocol for Low-Power and Lossy Networks (RPL) Option for Carrying RPL Information in Data-Plane Datagrams</title>
            <author initials="J." surname="Hui" fullname="J. Hui">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="JP." surname="Vasseur" fullname="JP. Vasseur">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="March"/>
            <abstract>
              <t indent="0">The Routing Protocol for Low-Power and Lossy Networks (RPL) includes routing information in data-plane datagrams to quickly identify inconsistencies in the routing topology.  This document describes the RPL Option for use among RPL routers to include such routing information.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6553"/>
          <seriesInfo name="DOI" value="10.17487/RFC6553"/>
        </reference>
        <reference anchor="RFC6554" target="https://www.rfc-editor.org/info/rfc6554" quoteTitle="true" derivedAnchor="RFC6554">
          <front>
            <title>An IPv6 Routing Header for Source Routes with the Routing Protocol for Low-Power and Lossy Networks (RPL)</title>
            <author initials="J." surname="Hui" fullname="J. Hui">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="JP." surname="Vasseur" fullname="JP. Vasseur">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Culler" fullname="D. Culler">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="V." surname="Manral" fullname="V. Manral">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="March"/>
            <abstract>
              <t indent="0">In Low-Power and Lossy Networks (LLNs), memory constraints on routers may limit them to maintaining, at most, a few routes.  In some configurations, it is necessary to use these memory-constrained routers to deliver datagrams to nodes within the LLN.  The Routing Protocol for Low-Power and Lossy Networks (RPL) can be used in some deployments to store most, if not all, routes on one (e.g., the Directed Acyclic Graph (DAG) root) or a few routers and forward the IPv6 datagram using a source routing technique to avoid large routing tables on memory-constrained routers.  This document specifies a new IPv6 Routing header type for delivering datagrams within a RPL routing domain.  [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6554"/>
          <seriesInfo name="DOI" value="10.17487/RFC6554"/>
        </reference>
        <reference anchor="RFC6606" target="https://www.rfc-editor.org/info/rfc6606" quoteTitle="true" derivedAnchor="RFC6606">
          <front>
            <title>Problem Statement and Requirements for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing</title>
            <author initials="E." surname="Kim" fullname="E. Kim">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="D." surname="Kaspar" fullname="D. Kaspar">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Gomez" fullname="C. Gomez">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Bormann" fullname="C. Bormann">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="May"/>
            <abstract>
              <t indent="0">IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs) are formed by devices that are compatible with the IEEE 802.15.4 standard.  However, neither the IEEE 802.15.4 standard nor the 6LoWPAN format specification defines how mesh topologies could be obtained and maintained.  Thus, it should be considered how 6LoWPAN formation and multi-hop routing could be supported.</t>
              <t indent="0">This document provides the problem statement and design space for 6LoWPAN routing.  It defines the routing requirements for 6LoWPANs, considering the low-power and other particular characteristics of the devices and links.  The purpose of this document is not to recommend specific solutions but to provide general, layer-agnostic guidelines about the design of 6LoWPAN routing that can lead to further analysis and protocol design.  This document is intended as input to groups working on routing protocols relevant to 6LoWPANs, such as the IETF ROLL WG.  This document is not an Internet Standards Track specification;  it is published for informational purposes.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6606"/>
          <seriesInfo name="DOI" value="10.17487/RFC6606"/>
        </reference>
        <reference anchor="RFC6687" target="https://www.rfc-editor.org/info/rfc6687" quoteTitle="true" derivedAnchor="RFC6687">
          <front>
            <title>Performance Evaluation of the Routing Protocol for Low-Power and Lossy Networks (RPL)</title>
            <author initials="J." surname="Tripathi" fullname="J. Tripathi" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="de Oliveira" fullname="J. de Oliveira" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="JP." surname="Vasseur" fullname="JP. Vasseur" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2012" month="October"/>
            <abstract>
              <t indent="0">This document presents a performance evaluation of the Routing Protocol for Low-Power and Lossy Networks (RPL) for a small outdoor deployment of sensor nodes and for a large-scale smart meter network. Detailed simulations are carried out to produce several routing performance metrics using these real-life deployment scenarios. Please refer to the PDF version of this document, which includes several plots for the performance metrics not shown in the plain-text version.  This document is not an Internet Standards Track specification; it is published for informational purposes.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="6687"/>
          <seriesInfo name="DOI" value="10.17487/RFC6687"/>
        </reference>
        <reference anchor="RFC7039" target="https://www.rfc-editor.org/info/rfc7039" quoteTitle="true" derivedAnchor="RFC7039">
          <front>
            <title>Source Address Validation Improvement (SAVI) Framework</title>
            <author initials="J." surname="Wu" fullname="J. Wu">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="J." surname="Bi" fullname="J. Bi">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Bagnulo" fullname="M. Bagnulo">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="F." surname="Baker" fullname="F. Baker">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Vogt" fullname="C. Vogt" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2013" month="October"/>
            <abstract>
              <t indent="0">Source Address Validation Improvement (SAVI) methods were developed to prevent nodes attached to the same IP link from spoofing each other's IP addresses, so as to complement ingress filtering with finer-grained, standardized IP source address validation.  This document is a framework document that describes and motivates the design of the SAVI methods.  Particular SAVI methods are described in other documents.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7039"/>
          <seriesInfo name="DOI" value="10.17487/RFC7039"/>
        </reference>
        <reference anchor="RFC7228" target="https://www.rfc-editor.org/info/rfc7228" quoteTitle="true" derivedAnchor="RFC7228">
          <front>
            <title>Terminology for Constrained-Node Networks</title>
            <author initials="C." surname="Bormann" fullname="C. Bormann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Ersue" fullname="M. Ersue">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Keranen" fullname="A. Keranen">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2014" month="May"/>
            <abstract>
              <t indent="0">The Internet Protocol Suite is increasingly used on small devices with severe constraints on power, memory, and processing resources, creating constrained-node networks.  This document provides a number of basic terms that have been useful in the standardization work for constrained-node networks.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7228"/>
          <seriesInfo name="DOI" value="10.17487/RFC7228"/>
        </reference>
        <reference anchor="RFC7416" target="https://www.rfc-editor.org/info/rfc7416" quoteTitle="true" derivedAnchor="RFC7416">
          <front>
            <title>A Security Threat Analysis for the Routing Protocol for Low-Power and Lossy Networks (RPLs)</title>
            <author initials="T." surname="Tsao" fullname="T. Tsao">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Alexander" fullname="R. Alexander">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Dohler" fullname="M. Dohler">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="V." surname="Daza" fullname="V. Daza">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Lozano" fullname="A. Lozano">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Richardson" fullname="M. Richardson" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2015" month="January"/>
            <abstract>
              <t indent="0">This document presents a security threat analysis for the Routing Protocol for Low-Power and Lossy Networks (RPLs).  The development builds upon previous work on routing security and adapts the assessments to the issues and constraints specific to low-power and lossy networks.  A systematic approach is used in defining and evaluating the security threats.  Applicable countermeasures are application specific and are addressed in relevant applicability statements.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="7416"/>
          <seriesInfo name="DOI" value="10.17487/RFC7416"/>
        </reference>
        <reference anchor="RFC8025" target="https://www.rfc-editor.org/info/rfc8025" quoteTitle="true" derivedAnchor="RFC8025">
          <front>
            <title>IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Paging Dispatch</title>
            <author initials="P." surname="Thubert" fullname="P. Thubert" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Cragie" fullname="R. Cragie">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2016" month="November"/>
            <abstract>
              <t indent="0">This specification updates RFC 4944 to introduce a new context switch mechanism for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) compression, expressed in terms of Pages and signaled by a new Paging Dispatch.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8025"/>
          <seriesInfo name="DOI" value="10.17487/RFC8025"/>
        </reference>
        <reference anchor="RFC8138" target="https://www.rfc-editor.org/info/rfc8138" quoteTitle="true" derivedAnchor="RFC8138">
          <front>
            <title>IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing Header</title>
            <author initials="P." surname="Thubert" fullname="P. Thubert" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C." surname="Bormann" fullname="C. Bormann">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="L." surname="Toutain" fullname="L. Toutain">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="R." surname="Cragie" fullname="R. Cragie">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2017" month="April"/>
            <abstract>
              <t indent="0">This specification introduces a new IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) dispatch type for use in 6LoWPAN route-over topologies, which initially covers the needs of Routing Protocol for Low-Power and Lossy Networks (RPL) data packet compression (RFC 6550).  Using this dispatch type, this specification defines a method to compress the RPL Option (RFC 6553) information and Routing Header type 3 (RFC 6554), an efficient IP-in-IP technique, and is extensible for more applications.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8138"/>
          <seriesInfo name="DOI" value="10.17487/RFC8138"/>
        </reference>
        <reference anchor="RFC8415" target="https://www.rfc-editor.org/info/rfc8415" quoteTitle="true" derivedAnchor="RFC8415">
          <front>
            <title>Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</title>
            <author initials="T." surname="Mrugalski" fullname="T. Mrugalski">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Siodelski" fullname="M. Siodelski">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="B." surname="Volz" fullname="B. Volz">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="A." surname="Yourtchenko" fullname="A. Yourtchenko">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="M." surname="Richardson" fullname="M. Richardson">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="S." surname="Jiang" fullname="S. Jiang">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Lemon" fullname="T. Lemon">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="T." surname="Winters" fullname="T. Winters">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2018" month="November"/>
            <abstract>
              <t indent="0">This document describes the Dynamic Host Configuration Protocol for IPv6 (DHCPv6): an extensible mechanism for configuring nodes with network configuration parameters, IP addresses, and prefixes. Parameters can be provided statelessly, or in combination with stateful assignment of one or more IPv6 addresses and/or IPv6 prefixes.  DHCPv6 can operate either in place of or in addition to stateless address autoconfiguration (SLAAC).</t>
              <t indent="0">This document updates the text from RFC 3315 (the original DHCPv6 specification) and incorporates prefix delegation (RFC 3633), stateless DHCPv6 (RFC 3736), an option to specify an upper bound for how long a client should wait before refreshing information (RFC 4242), a mechanism for throttling DHCPv6 clients when DHCPv6 service is not available (RFC 7083), and relay agent handling of unknown messages (RFC 7283).  In addition, this document clarifies the interactions between models of operation (RFC 7550).  As such, this document obsoletes RFC 3315, RFC 3633, RFC 3736, RFC 4242, RFC 7083, RFC 7283, and RFC 7550.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8415"/>
          <seriesInfo name="DOI" value="10.17487/RFC8415"/>
        </reference>
        <reference anchor="RFC8929" target="https://www.rfc-editor.org/info/rfc8929" quoteTitle="true" derivedAnchor="RFC8929">
          <front>
            <title>IPv6 Backbone Router</title>
            <author initials="P." surname="Thubert" fullname="P. Thubert" role="editor">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="C.E." surname="Perkins" fullname="C.E. Perkins">
              <organization showOnFrontPage="true"/>
            </author>
            <author initials="E." surname="Levy-Abegnoli" fullname="E. Levy-Abegnoli">
              <organization showOnFrontPage="true"/>
            </author>
            <date year="2020" month="November"/>
            <abstract>
              <t indent="0">This document updates RFCs 6775 and 8505 in order to enable proxy services for IPv6 Neighbor Discovery by Routing Registrars called "Backbone Routers". Backbone Routers are placed along the wireless edge of a backbone and federate multiple wireless links to form a single Multi-Link Subnet (MLSN).</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="8929"/>
          <seriesInfo name="DOI" value="10.17487/RFC8929"/>
        </reference>
      </references>
    </references>
    <section anchor="u8138" numbered="true" removeInRFC="false" toc="include" pn="section-appendix.a">
      <name slugifiedName="name-example-compression">Example Compression</name>
      <t indent="0" pn="section-appendix.a-1">

 <xref target="rtghc" format="default" sectionFormat="of" derivedContent="Figure 13"/> illustrates the case in Storing mode where the packet
    is received from the Internet, then the root encapsulates the packet to
    insert the RPI and deliver it to the 6LR that is the parent and last hop to the
    final destination, which is not known to support <xref target="RFC8138" format="default" sectionFormat="of" derivedContent="RFC8138"/>.

      </t>
      <figure anchor="rtghc" align="left" suppress-title="false" pn="figure-13">
        <name slugifiedName="name-encapsulation-to-parent-6lr">Encapsulation to Parent 6LR in Storing Mode</name>
        <artwork align="left" pn="section-appendix.a-2.1">

+-+ ... -+-+ ... +-+- ... -+-+ ... -+-+-+ ... +-+-+ ... -+ ... +-...
|11110001|SRH-6LoRH| RPI-  |IP-in-IP| NH=1      |11110CPP| UDP | UDP
|Page 1  |Type1 S=0| 6LoRH | 6LoRH  |LOWPAN_IPHC| UDP    | hdr |Payld
+-+ ... -+-+ ... +-+- ... -+-+ ... -+-+-+ ... +-+-+ ... -+ ... +-...
         &lt;-4 bytes-&gt;                &lt;-        RFC 6282        -&gt;
                                    &lt;-     No RPL artifact ...</artwork>
      </figure>
      <t indent="0" pn="section-appendix.a-3">
    The difference from the example presented in Figure 19 of
    <xref target="RFC8138" format="default" sectionFormat="of" derivedContent="RFC8138"/> is the addition of an SRH-6LoRH before the RPI-6LoRH
    to transport the compressed address of the 6LR as the destination address of
    the outer IPv6 header. In Figure 19 of <xref target="RFC8138" format="default" sectionFormat="of" derivedContent="RFC8138"/>, the destination IP of the
    outer header was elided and was implicitly the same address as the
    destination of the inner header.

    Type 1 was arbitrarily chosen, and the size of 0 denotes a single address in
    the SRH.
      </t>
      <t indent="0" pn="section-appendix.a-4">
     In <xref target="rtghc" format="default" sectionFormat="of" derivedContent="Figure 13"/>, the source of the IPv6-in-IPv6 encapsulation is
          the root, so it is elided in the IPv6-in-IPv6 6LoRH. The destination is
          the parent 6LR of the destination of the encapsulated packet, so it
          cannot be elided. If the DODAG is operated in Storing mode, it is the
          single entry in the SRH-6LoRH and the SRH-6LoRH Size is encoded as 0.
          The SRH-6LoRH is the first 6LoRH in the chain.
          In this particular example, the 6LR address can
          be compressed to 2 bytes, so a Type of 1 is used.
          The result is that the total length of the SRH-6LoRH is 4 bytes.

      </t>
      <t indent="0" pn="section-appendix.a-5">
          In Non-Storing mode, the encapsulation from the root would be similar
          to that represented in <xref target="rtghc" format="default" sectionFormat="of" derivedContent="Figure 13"/> with possibly more hops
          in the SRH‑6LoRH and possibly multiple SRH-6LoRHs if the various
          addresses in the routing header are not compressed to the same format.
          Note that on the last hop to the parent 6LR, the RH3 is consumed and
          removed from the compressed form, so the use of Non-Storing mode vs. Storing mode is indistinguishable from the packet format.
      </t>
      <t indent="0" pn="section-appendix.a-6">
          The SRH-6LoRHs are followed by the RPI-6LoRH and then the IPv6-in-IPv6 6LoRH.
          When the IPv6-in-IPv6 6LoRH is removed, all the 6LoRH Headers that
          precede it are also removed.
          The Paging Dispatch <xref target="RFC8025" format="default" sectionFormat="of" derivedContent="RFC8025"/> may also be removed if
          there was no previous Page change to a Page other than 0 or 1, since
          the LOWPAN_IPHC is encoded in the same fashion in the default Page 0
          and in Page 1. The resulting packet to the destination is the
          encapsulated packet compressed per <xref target="RFC6282" format="default" sectionFormat="of" derivedContent="RFC6282"/>.
      </t>
    </section>
    <section anchor="Acks" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.b">
      <name slugifiedName="name-acknowledgments">Acknowledgments</name>
      <t indent="0" pn="section-appendix.b-1">
   The authors wish to thank <contact fullname="Ines Robles"/>, <contact fullname="Georgios Papadopoulos"/>, and
   especially <contact fullname="Rahul Jadhav"/> and <contact fullname="Alvaro Retana"/>
   for their reviews and contributions to this document.
   Also many thanks to <contact fullname="Éric Vyncke"/>, <contact fullname="Erik Kline"/>, <contact fullname="Murray Kucherawy"/>,
   <contact fullname="Peter van der Stok"/>, <contact fullname="Carl Wallace"/>, <contact fullname="Barry Leiba"/>, <contact fullname="Julien Meuric"/>,
   and especially <contact fullname="Benjamin Kaduk"/> and <contact fullname="Elwyn Davies"/>,

   for their reviews and useful comments
   during the IETF Last Call and the IESG review sessions.
      </t>
    </section>
    <section anchor="authors-addresses" numbered="false" removeInRFC="false" toc="include" pn="section-appendix.c">
      <name slugifiedName="name-authors-addresses">Authors' Addresses</name>
      <author initials="P" surname="Thubert" fullname="Pascal Thubert" role="editor">
        <organization abbrev="Cisco Systems" showOnFrontPage="true">Cisco Systems, Inc.</organization>
        <address>
          <postal>
            <street>Building D</street>
            <street>45 Allee des Ormes - BP1200</street>
            <city>MOUGINS - Sophia Antipolis</city>
            <code>06254</code>
            <country>France</country>
          </postal>
          <phone>+33 497 23 26 34</phone>
          <email>pthubert@cisco.com</email>
        </address>
      </author>
      <author fullname="Michael C. Richardson" initials="M." surname="Richardson">
        <organization abbrev="Sandelman" showOnFrontPage="true">Sandelman Software Works</organization>
        <address>
          <email>mcr+ietf@sandelman.ca</email>
          <uri>https://www.sandelman.ca/</uri>
        </address>
      </author>
    </section>
  </back>
</rfc>
